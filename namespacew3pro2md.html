<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: w3pro2md Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacew3pro2md.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">w3pro2md Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Bundles routines for third order porpagation scheme in single module.  
<a href="namespacew3pro2md.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aaa7a36f453793970b41eabd01a22efd8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3pro2md.html#aaa7a36f453793970b41eabd01a22efd8">w3map2</a></td></tr>
<tr class="memdesc:aaa7a36f453793970b41eabd01a22efd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate 'map' arrays for the ULTIMATE QUICKEST scheme.  <a href="namespacew3pro2md.html#aaa7a36f453793970b41eabd01a22efd8">More...</a><br /></td></tr>
<tr class="separator:aaa7a36f453793970b41eabd01a22efd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e542a8d41f921542394a284bf08ed5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3pro2md.html#a74e542a8d41f921542394a284bf08ed5">w3xyp2</a> (ISP, DTG, MAPSTA, MAPFS, VQ, VGX, VGY)</td></tr>
<tr class="memdesc:a74e542a8d41f921542394a284bf08ed5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagation in physical space for a given spectral component.  <a href="namespacew3pro2md.html#a74e542a8d41f921542394a284bf08ed5">More...</a><br /></td></tr>
<tr class="separator:a74e542a8d41f921542394a284bf08ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece5b76209f20456b27e78c092fd6b4b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3pro2md.html#aece5b76209f20456b27e78c092fd6b4b">w3ktp2</a> (ISEA, FACTH, FACK, CTHG0, CG, WN, DEPTH, DDDX, DDDY, CX, CY, DCXDX, DCXDY, DCYDX, DCYDY, DCDX, DCDY, VA)</td></tr>
<tr class="memdesc:aece5b76209f20456b27e78c092fd6b4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Propagation in spectral space.  <a href="namespacew3pro2md.html#aece5b76209f20456b27e78c092fd6b4b">More...</a><br /></td></tr>
<tr class="separator:aece5b76209f20456b27e78c092fd6b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Bundles routines for third order porpagation scheme in single module. </p>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>29-May-2014</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2009-2022 National Weather Service (NWS), National Oceanic and Atmospheric Administration. All rights reserved. WAVEWATCH III is a trademark of the NWS. No unauthorized use without permission. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aece5b76209f20456b27e78c092fd6b4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece5b76209f20456b27e78c092fd6b4b">&#9670;&nbsp;</a></span>w3ktp2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3pro2md::w3ktp2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISEA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>FACTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>FACK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CTHG0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(0:nk+1), intent(in)&#160;</td>
          <td class="paramname"><em>CG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(0:nk+1), intent(in)&#160;</td>
          <td class="paramname"><em>WN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DEPTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DDDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DDDY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DCXDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DCXDY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DCYDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DCYDY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(0:nk+1), intent(in)&#160;</td>
          <td class="paramname"><em>DCDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(0:nk+1), intent(in)&#160;</td>
          <td class="paramname"><em>DCDY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(inout)&#160;</td>
          <td class="paramname"><em>VA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Propagation in spectral space. </p>
<p>Third order QUICKEST scheme with ULTIMATE limiter.</p>
<p>As with the spatial propagation, the two spaces are considered independently, but the propagation is performed in a 2-D space. Compared to the propagation in physical space, the directions represent a closed space and are therefore comparable to the longitudinal or 'X' propagation. The wavenumber space has to be extended to allow for boundary treatment. Using a simple first order boundary treatment at both sided, two points need to be added. This implies that the spectrum needs to be extended, shifted and rotated, as is performed using MAPTH2 as set in W3MAP3.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ISEA</td><td>Number of sea point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FACTH</td><td>Factor in propagation velocity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FACK</td><td>Factor in propagation velocity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CTHG0</td><td>Factor in great circle refracftion term. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CG</td><td>Local group velocities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WN</td><td>Local wavenumbers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DEPTH</td><td>Depth. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DDDX</td><td>Depth gradient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DDDY</td><td>Depth gradient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CX</td><td>Current component. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CY</td><td>Current component. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DCXDX</td><td>Current gradients. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DCXDY</td><td>Current gradients. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DCYDX</td><td>Current gradients. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DCYDY</td><td>Current gradients. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DCDX</td><td>Phase speed gradient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DCDY</td><td>Phase speed gradient. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">VA</td><td>Spectrum.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>01-Jul-2013 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3pro2md_8F90_source.html#l01305">1305</a> of file <a class="el" href="w3pro2md_8F90_source.html">w3pro2md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="comment">!/                  | Last update :         01-Jul-2013 |</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">!/    14-Feb-2000 : Origination.                        ( version 2.08 )</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="comment">!/    17-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">!/    01-Jul-2013 : Adding UQ and UNO switches to chose between third</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">!/                  and second order schemes.           ( version 4.12 )</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">!     Propagation in spectral space.</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">!     Third order QUICKEST scheme with ULTIMATE limiter.</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">!     As with the spatial propagation, the two spaces are considered</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="comment">!     independently, but the propagation is performed in a 2-D space.</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="comment">!     Compared to the propagation in physical space, the directions</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="comment">!     rerpesent a closed space and are therefore comparable to the</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">!     longitudinal or &#39;X&#39; propagation. The wavenumber space has to be</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">!     extended to allow for boundary treatment. Using a simple first</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">!     order boundary treatment at both sided, two points need to</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">!     be added. This implies that the spectrum needs to be extended,</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="comment">!     shifted and rotated, as is performed using MAPTH2 as set</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="comment">!     in W3MAP3.</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="comment">!       ISEA    Int.   I   Number of sea point.</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="comment">!       FACTH/K Real   I   Factor in propagation velocity.</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">!       CTHG0   Real   I   Factor in great circle refracftion term.</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="comment">!       MAPxx2  I.A.   I   Propagation and storage maps.</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="comment">!       CG      R.A.   I   Local group velocities.</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">!       WN      R.A.   I   Local wavenumbers.</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">!       DEPTH   R.A.   I   Depth.</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="comment">!       DDDx    Real   I   Depth gradients.</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="comment">!       CX/Y    Real   I   Current components.</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="comment">!       DCxDx   Real   I   Current gradients.</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    <span class="comment">!       DCDX-Y  Real   I   Phase speed gradients.</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">!       VA      R.A.  I/O  Spectrum.</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <span class="comment">!     Local variables.</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">!       DSDD    R.A.  Partial derivative of sigma for depth.</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="comment">!       FDD, FDU, FDG, FCD, FCU</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">!               R.A.  Directionally varying part of depth, current and</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="comment">!                     great-circle refraction terms and of consit.</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="comment">!                     of Ck term.</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="comment">!       CFLT-K  R.A.  Propagation velocities of local fluxes.</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="comment">!       DB      R.A.  Wavenumber band widths at cell centers.</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">!       DM      R.A.  Wavenumber band widths between cell centers and</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="comment">!                     next cell center.</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="comment">!       Q       R.A.  Extracted spectrum</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">!       W3QCK1   Actual propagation routine.</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">!       W3QCK2   Actual propagation routine.</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">!       STRACE   Service routine.</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="comment">!       W3WAVE   Wave model routine.</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">!       None.</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">!     -----------------------------------------------------------------</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">!       1.  Preparations</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="comment">!         a Initialize arrays</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">!         b Set constants and counters</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">!       2.  Point  preparations</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">!         a Calculate DSDD</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">!         b Extract spectrum</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">!       3.  Refraction velocities</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">!         a Filter level depth reffraction.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="comment">!         b Depth refratcion velocity.</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="comment">!         c Current refraction velocity.</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">!       4.  Wavenumber shift velocities</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="comment">!         a Prepare directional arrays</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">!         b Calcuate velocity.</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">!       5.  Propagate.</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">!       6.  Store results.</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">!     -----------------------------------------------------------------</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">!       !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">!       !/T     Enable general test output.</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: nk, nk2, nth, nspec, <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>, <a class="code" href="namespacew3gdatmd.html#af3b6f2595ef8286e10e29db9a16652a4">dsip</a>, <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>, <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>, &amp;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         <a class="code" href="namespacew3gdatmd.html#a5cbed3f13d9dfa812a468e69b77b8271">ec2</a>, <a class="code" href="namespacew3gdatmd.html#abb691eacfa4234e3a34feb5ab0425990">esc</a>, <a class="code" href="namespacew3gdatmd.html#a80483bc599d405d1e970135d63f28c4b">es2</a>, <a class="code" href="namespacew3gdatmd.html#a3db0bb5af0ebfb018aef89118e8225ad">fachfa</a>, <a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>, <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a>, <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a>,  &amp;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;         <a class="code" href="namespacew3gdatmd.html#a14df2409ebe7f5f534e61e775d2c486f">ctmax</a></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>, <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3idatmd.html">w3idatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3uqckmd.html">w3uqckmd</a></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3uno2md.html">w3uno2md</a></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: ISEA</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: FACTH, FACK, CTHG0, CG(0:NK+1),      &amp;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;         WN(0:NK+1), DEPTH, DDDX, DDDY,       &amp;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;         CX, CY, DCXDX, DCXDY, DCYDX, DCYDY</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: DCDX(0:NK+1), DCDY(0:NK+1)</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(INOUT)</span>     :: VA(NSPEC)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: ITH, IK, ISP</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>                    :: FDDMAX, FDG, FKD, FKD0, DCYX,        &amp;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;         DCXXYY, DCXY, DCXX, DCXYYX, DCYY</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="keywordtype">    REAL</span>                    :: DSDD(0:NK+1), FRK(NK), FRG(NK),      &amp;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;         FKC(NTH), VQ(-NK-1:NK2*(NTH+2)),     &amp;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;         DB(NK2,NTH+1), DM(NK2,0:NTH+1),      &amp;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;         VCFLT(NK2*(NTH+1)), CFLK(NK2,NTH)</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3KTP2&#39;</span>)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">! 1.  Preparations --------------------------------------------------- *</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="comment">! 1.a Initialize arrays</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> ) vq = 0.</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a>, <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a>, facth, fack, <a class="code" href="namespacew3gdatmd.html#a14df2409ebe7f5f534e61e775d2c486f">ctmax</a></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9010) isea, depth, cx, cy, dddx, dddy,           &amp;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;         dcxdx, dcxdy, dcydx, dcydy</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">! 2.  Preparation for point ------------------------------------------ *</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">! 2.a Array with partial derivative of sigma versus depth</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">DO</span> ik=0, nk+1</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">IF</span> ( depth*wn(ik) .LT. 5. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        dsdd(ik) = max( 0. ,                                     &amp;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;             cg(ik)*wn(ik)-0.5*<a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik) ) / depth</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        dsdd(ik) = 0.</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9020)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk+1</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9021) ik, <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a>/<a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik), <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a>/wn(ik),             &amp;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;           cg(ik), dsdd(ik)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">! 2.b Extract spectrum</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">DO</span> isp=1, nspec</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      vq(<a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp)) = va(isp)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">! 3.  Refraction velocities ------------------------------------------ *</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="comment">! 3.a Set slope filter for depth refraction</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      fddmax = 0.</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      fdg    = facth * cthg0</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth/2</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        fddmax = max(fddmax,abs(<a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith)*dddx-<a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith)*dddy))</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        frk(ik) = facth * dsdd(ik) / wn(ik)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        frk(ik) = frk(ik) / max( 1. , frk(ik)*fddmax/<a class="code" href="namespacew3gdatmd.html#a14df2409ebe7f5f534e61e775d2c486f">ctmax</a> )</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        frg(ik) = fdg * cg(ik)</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="comment">! 3.b Depth refraction and great-circle propagation</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="keywordflow">DO</span> isp=1, nspec</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        vcflt(<a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp)) = frg(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) * <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(isp)          &amp;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;             + frk(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) * ( <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(isp)*dddx - <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(isp)*dddy )</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor">#ifdef W3_REFRX</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="preprocessor"></span>      <span class="comment">! 3.c @C/@x refraction and great-circle propagation</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      vcflt  = 0.</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      frk    = 0.</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      fddmax = 0.</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="keywordflow">DO</span> isp=1, nspec</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        fddmax = max( fddmax , abs(                      &amp;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;             <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(isp)*dcdx(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) - <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(isp)*dcdy(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) ) )</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        frk(ik) = facth * cg(ik) * wn(ik) / <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <span class="keywordflow">DO</span> isp=1, nspec</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        vcflt(<a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp)) = frg(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) * <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(isp)   &amp;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;             + frk(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) * ( <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(isp)*dcdx(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) &amp;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;             - <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(isp)*dcdy(<a class="code" href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">mapwn</a>(isp)) )</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">! 3.d Current refraction</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        dcyx   = facth *   dcydx</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        dcxxyy = facth * ( dcxdx - dcydy )</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        dcxy   = facth *   dcxdy</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="keywordflow">DO</span> isp=1, nspec</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;          vcflt(<a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp)) = vcflt(<a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp)) +             &amp;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;               <a class="code" href="namespacew3gdatmd.html#a80483bc599d405d1e970135d63f28c4b">es2</a>(isp)*dcyx  + <a class="code" href="namespacew3gdatmd.html#abb691eacfa4234e3a34feb5ab0425990">esc</a>(isp)*dcxxyy - <a class="code" href="namespacew3gdatmd.html#a5cbed3f13d9dfa812a468e69b77b8271">ec2</a>(isp)*dcxy</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">! 4.  Wavenumber shift velocities ------------------------------------ *</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">!     FACK is just the time step, which is accounted for in W3QCK2</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="comment">! 4.a Directionally dependent part</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      dcxx   =  -   dcxdx</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      dcxyyx =  - ( dcxdy + dcydx )</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      dcyy   =  -   dcydy</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      fkd    =    ( cx*dddx + cy*dddy )</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        fkc(ith) = <a class="code" href="namespacew3gdatmd.html#a5cbed3f13d9dfa812a468e69b77b8271">ec2</a>(ith)*dcxx +                                &amp;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;             <a class="code" href="namespacew3gdatmd.html#abb691eacfa4234e3a34feb5ab0425990">esc</a>(ith)*dcxyyx + <a class="code" href="namespacew3gdatmd.html#a80483bc599d405d1e970135d63f28c4b">es2</a>(ith)*dcyy</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="comment">! 4.b Velocities</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">DO</span> ik=0, nk+1</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        fkd0   = fkd / cg(ik) * dsdd(ik)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          cflk(ik+1,ith) = fkd0 + wn(ik)*fkc(ith)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="comment">! 4.c Band widths</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">DO</span> ik=0, nk</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        db(ik+1,1) = <a class="code" href="namespacew3gdatmd.html#af3b6f2595ef8286e10e29db9a16652a4">dsip</a>(ik) / cg(ik)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        dm(ik+1,1) = wn(ik+1) - wn(ik)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      db(nk+2,1) = <a class="code" href="namespacew3gdatmd.html#af3b6f2595ef8286e10e29db9a16652a4">dsip</a>(nk+1) / cg(nk+1)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      dm(nk+2,1) = 0.</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="keywordflow">DO</span> ith=2, nth</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="keywordflow">DO</span> ik=1, nk+2</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;          db(ik,ith) = db(ik,1)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;          dm(ik,ith) = dm(ik,1)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">! 5.  Propagate ------------------------------------------------------ *</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">IF</span> ( mod(<a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>,2) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          vq(nk+2+(ith-1)*nk2) = <a class="code" href="namespacew3gdatmd.html#a3db0bb5af0ebfb018aef89118e8225ad">fachfa</a> * vq(nk+1+(ith-1)*nk2)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#a65614fe2cf564b2b3c635c635c71ad49">w3qck2</a> ( nth, nk2, nth, nk2, cflk, fack, db, dm,   &amp;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;             vq, .false., 1, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec,            &amp;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;             <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>, nspec-nth, nspec, nspec+nth,      &amp;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;             <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#a7a1a4031e0af5b9bc81abcdd373c5597">w3uno2</a> ( nth, nk2, nth, nk2, cflk, fack, db, dm,  &amp;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;             vq, .false., 1, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec,           &amp;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;             <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>, nspec-nth, nspec, nspec+nth,     &amp;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;             <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#aad72b1a2ab82cf887f53356fa3cdc5fa">w3qck1</a> ( nth, nk2, nth, nk2, vcflt, vq, .true.,    &amp;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;             nk2, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, nspec, &amp;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;             nspec, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#ad384a499814a2dc15b2d5b41dbd877a5">w3uno2r</a>( nth, nk2, nth, nk2, vcflt, vq, .true.,   &amp;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;             nk2, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, nspec,&amp;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;             nspec, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#aad72b1a2ab82cf887f53356fa3cdc5fa">w3qck1</a> ( nth, nk2, nth, nk2, vcflt, vq, .true.,    &amp;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;             nk2, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, nspec, &amp;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;             nspec, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#ad384a499814a2dc15b2d5b41dbd877a5">w3uno2r</a>( nth, nk2, nth, nk2, vcflt, vq, .true.,   &amp;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;             nk2, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec, nspec,&amp;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;             nspec, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> )  <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          vq(nk+2+(ith-1)*nk2) = <a class="code" href="namespacew3gdatmd.html#a3db0bb5af0ebfb018aef89118e8225ad">fachfa</a> * vq(nk+1+(ith-1)*nk2)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#a65614fe2cf564b2b3c635c635c71ad49">w3qck2</a> ( nth, nk2, nth, nk2, cflk, fack, db, dm,   &amp;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;             vq, .false., 1, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec,            &amp;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;             <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>, nspec-nth, nspec, nspec+nth,      &amp;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;             <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#a7a1a4031e0af5b9bc81abcdd373c5597">w3uno2</a> ( nth, nk2, nth, nk2, cflk, fack, db, dm,  &amp;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;             vq, .false., 1, <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, nspec,           &amp;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;             <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>, nspec-nth, nspec, nspec+nth,     &amp;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;             <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="comment">! 6.  Store reults --------------------------------------------------- *</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">DO</span> isp=1, nspec</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      va(isp) = vq(<a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp))</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST W3KTP2 : FLCTH-K, FACTH-K, CTMAX  :&#39;</span>,        &amp;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;         2l2,2e10.3,f7.3)</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;9010 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST W3KTP2 : LOCAL DATA :&#39;</span>,i7,f7.1,2f6.2,1x,6e10.2)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;9020 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST W3KTP2 : IK, T, L, CG, DSDD : &#39;</span>)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;9021 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39;              &#39;</span>,i3,f7.2,f7.1,f7.2,e11.3)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="preprocessor">#ifdef W3_T0</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="preprocessor"></span>9040 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; TEST W3KTP2 : NORMALIZED &#39;</span>,a/)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;9041 <span class="keyword">FORMAT</span> (1x,60(1x,i2))</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;9042 <span class="keyword">FORMAT</span> (1x,60i3)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="comment">!/ End of W3KTP2 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::ctmax</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dsip</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::ec2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::ecos</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::es2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::esc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::esin</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::fachfa</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flck</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flcth</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::flcur</a>, <a class="el" href="w3adatmd_8F90_source.html#l00686">w3adatmd::itime</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapth2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01231">w3gdatmd::mapwn</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapwn2</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="constants_8F90_source.html#l00072">constants::tpi</a>, <a class="el" href="w3uqckmd_8F90_source.html#l00120">w3uqckmd::w3qck1()</a>, <a class="el" href="w3uqckmd_8F90_source.html#l00517">w3uqckmd::w3qck2()</a>, <a class="el" href="w3uno2md_8F90_source.html#l00105">w3uno2md::w3uno2()</a>, and <a class="el" href="w3uno2md_8F90_source.html#l00475">w3uno2md::w3uno2r()</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wavemd::w3wave()</a>.</p>

</div>
</div>
<a id="aaa7a36f453793970b41eabd01a22efd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa7a36f453793970b41eabd01a22efd8">&#9670;&nbsp;</a></span>w3map2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3pro2md::w3map2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate 'map' arrays for the ULTIMATE QUICKEST scheme. </p>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>09-Nov-2005 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3pro2md_8F90_source.html#l00136">136</a> of file <a class="el" href="w3pro2md_8F90_source.html">w3pro2md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!/                  | Last update :         09-Nov-2005 |</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">!/    19-Dec-1996 : Final FORTRAN 77                    ( version 1.18 )</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">!/    15-Dec-1999 : Upgrade to FORTRAN 90               ( version 2.00 )</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">!/    09-Feb-2001 : Clean up of parameter lists         ( version 2.08 )</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">!/    20-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">!/    09-Nov-2005 : Removing soft boundary option.      ( version 3.08 )</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">!     Generate &#39;map&#39; arrays for the ULTIMATE QUICKEST scheme.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">!     MAPX2, MAPY2, MAPTH2 and MAPWN2 contain consecutive 1-D spatial</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">!     grid counters (e.g., IXY = (IX-1)*MY + IY). The arrays are</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">!     devided in three parts. For MAPX2, these ranges are :</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">!         1    - NMX0  Counters IXY for which grid point (IX,IY) and</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">!                      (IX+1,IY) both are active grid points.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">!       NMX0+1 - NMX1  Id. only (IX,IY) active.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">!       NMX1+1 - NMX2  Id. only (IX+1,IY) active.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">!     The array MAPY2 has a similar layout varying IY instead of IX.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">!     MAPXY contains similar information for the cross term in the</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!     diffusion correction (counter NMXY only).</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">!     See module documentation.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!      W3WAVE    Subr. W3WAVEMD Wave model routine.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!     ---------------------------------------------------------------</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">!     ------------------------------------------------------</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">!      1.   Map MAPX2</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">!        a  Range 1 to NMX0</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!        b  Range NMX0+1 to NMX1</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!        c  Range NMX1+1 to NMX2</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!      2.   Map MAPY2</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!        a  Range 1 to NMY0</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">!        b  Range NMY0+1 to NMY1</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!        c  Range NMY1+1 to NMY2</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!      3.   Map MAPAXY and MAPXY</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!      4.   Maps for intra-spectral propagation</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!        a  MAPTH2, MAPATK</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">!        b  MAPWN2</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">!     ------------------------------------------------------</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!     !/S   Enable subroutine tracing.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">!     !/T   Enable test output.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: nk, nth, nspec, nx, ny, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>, mapsta</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>, <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>, <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>,   &amp;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;         <a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a>, <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>, <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a83d8c689a07bb13732d8608e65d97938">mapxy</a>,          &amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;         <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>, <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: IX, IY, IXY0, IX2, IY2, IX0, IY0,    &amp;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;         IK, ITH, ISP, ISP0, ISP2</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: MAPTXY(NY,NX), I, IXY</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: MAPTST(NK+2,NTH)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3MAP2&#39;</span>)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">! 1.  Map MAPX2 ------------------------------------------------------ *</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">! 1.a Range 1 to NMX0</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor"></span>    maptxy = 0.</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>   = 0</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      ix2    = 1 + mod(ix,nx)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">DO</span> iy=2, ny-1</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).EQ.1 .AND. mapsta(iy,ix2).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>   = <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a> + 1</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>(<a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>) = ixy0 + iy</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor"></span>          maptxy(iy,ix) = maptxy(iy,ix) + 1</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">! 1.b Range NMX0+1 to NMX1</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>   = <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      ix2    = 1 + mod(ix,nx)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">DO</span> iy=2, ny-1</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).EQ.1 .AND. mapsta(iy,ix2).NE.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>   = <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a> + 1</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>(<a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>) = ixy0 + iy</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor"></span>          maptxy(iy,ix) = maptxy(iy,ix) + 2</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">! 1.c Range NMX1+1 to NMX2</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>   = <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      ix2    = 1 + mod(ix,nx)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">DO</span> iy=2, ny-1</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).NE.1 .AND. mapsta(iy,ix2).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>   = <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a> + 1</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>(<a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>) = ixy0 + iy</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor"></span>          maptxy(iy,ix) = maptxy(iy,ix) + 4</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) <span class="stringliteral">&#39;MAPX2&#39;</span>, <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>, <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>-<a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>,                  &amp;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;         <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>-<a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">DO</span> iy=ny, 1, -1</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9001) (maptxy(iy,ix),ix=1, nx)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">! 2.  Map MAPY2 ------------------------------------------------------ *</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">! 2.a Range 1 to NMY0</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor"></span>    maptxy = 0.</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>   = 0</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">DO</span> iy=1, ny-1</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        iy2    = iy + 1</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).EQ.1 .AND. mapsta(iy2,ix).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>   = <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a> + 1</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>(<a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>) = ixy0 + iy</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor"></span>          maptxy(iy,ix) = maptxy(iy,ix) + 1</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">! 2.b Range NMY0+1 to NMY1</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>   = <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">DO</span> iy=1, ny-1</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        iy2    = iy + 1</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).EQ.1 .AND. mapsta(iy2,ix).NE.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>   = <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a> + 1</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>(<a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>) = ixy0 + iy</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor"></span>          maptxy(iy,ix) = maptxy(iy,ix) + 2</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">! 2.c Range NMY1+1 to NMY2</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>   = <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">DO</span> iy=1, ny-1</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        iy2    = iy + 1</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).NE.1 .AND. mapsta(iy2,ix).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>   = <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a> + 1</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>(<a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>) = ixy0 + iy</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor"></span>          maptxy(iy,ix) = maptxy(iy,ix) + 4</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) <span class="stringliteral">&#39;MAPY2&#39;</span>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>, <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>-<a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>,                  &amp;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>-<a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">DO</span> iy=ny, 1, -1</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9001) (maptxy(iy,ix),ix=1, nx)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">! 3.  Map MAPAXY and MAPXY ------------------------------------------- *</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>   = 0</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      iy0    = (ix-1)*ny</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">DO</span> iy=2, ny-1</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">IF</span> ( mapsta(iy,ix).EQ.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>         = <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a> + 1</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>(<a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>) = iy0 + iy</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a>   = 0</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      ixy0   = (ix-1)*ny</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      ix2    = ix+1</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="keywordflow">IF</span> ( ix .EQ. nx ) ix2 =  1</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">DO</span> iy=2, ny-1</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">IF</span> ( mapsta( iy ,ix ).GE.1 .AND.                            &amp;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;             mapsta( iy ,ix2).GE.1 .AND.                            &amp;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;             mapsta(iy+1,ix ).GE.1 .AND.                            &amp;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;             mapsta(iy+1,ix2).GE.1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          <a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a>   = <a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a> + 1</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <a class="code" href="namespacew3adatmd.html#a83d8c689a07bb13732d8608e65d97938">mapxy</a>(<a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a>) = ixy0 + iy</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">! 4.  Maps for intra-spectral propagation ---------------------------- *</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(1) .NE. 0 ) <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor"></span>    maptst = 0</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">! 4.a MAPTH2 and MAPBTK</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        isp    = ith + (ik-1)*nth</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        isp2   = (ik+1) + (ith-1)*(nk+2)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">mapth2</a>(isp) = isp2</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor"></span>        maptst(ik+1,ith) = maptst(ik+1,ith) + 1</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) <span class="stringliteral">&#39;MAPTH2&#39;</span>, isp, 0, 0, isp</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">DO</span> ik=nk+2, 1, -1</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9001) (maptst(ik,ith),ith=1, nth)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    maptst = 0</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">! 4.b MAPWN2</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    isp0   = 0</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk-1</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        isp0   = isp0 + 1</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        isp2   = (ik+1) + (ith-1)*(nk+2)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>(isp0) = isp2</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor"></span>        maptst(ik+1,ith) = maptst(ik+1,ith) + 1</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      isp0   = isp0 + 1</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      isp2   = nk+1 + (ith-1)*(nk+2)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>(isp0) = isp2</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor"></span>      maptst(nk+1,ith) = maptst(nk+1,ith) + 2</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      isp0   = isp0 + 1</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      isp2   = 1 + (ith-1)*(nk+2)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <a class="code" href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">mapwn2</a>(isp0) = isp2</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor"></span>      maptst(1,ith) = maptst(1,ith) + 4</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) <span class="stringliteral">&#39;MAPWN2&#39;</span>, nspec-nth, nth, nth, nspec+nth</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">DO</span> ik=nk+2, 1, -1</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9001) (maptst(ik,ith),ith=1, nth)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; TEST W3MAP2 : TEST MAP FOR PROPAGATION&#39;</span>/          &amp;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;         <span class="stringliteral">&#39;      MAP     : &#39;</span>,a/                               &amp;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;         <span class="stringliteral">&#39;      CENTRAL : &#39;</span>,i6/                              &amp;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;         <span class="stringliteral">&#39;      ABOVE   : &#39;</span>,i6/                              &amp;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;         <span class="stringliteral">&#39;      BELOW   : &#39;</span>,i6/                              &amp;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;         <span class="stringliteral">&#39;      TOTAL   : &#39;</span>,i6/)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;9001 <span class="keyword">FORMAT</span> (1x,130i1)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;9010 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3MAP2 : COMPOSITE MAPS TH2, WN2 AND BTK&#39;</span>)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;9011 <span class="keyword">FORMAT</span> (2x,60i2)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">!/ End of W3MAP2 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapaxy</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsta</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapth2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapwn2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapx2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapxy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapy2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nact</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmx0</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmx1</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmx2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmxy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmy0</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmy1</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmy2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, and <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wavemd::w3wave()</a>.</p>

</div>
</div>
<a id="a74e542a8d41f921542394a284bf08ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74e542a8d41f921542394a284bf08ed5">&#9670;&nbsp;</a></span>w3xyp2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3pro2md::w3xyp2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ny*nx), intent(in)&#160;</td>
          <td class="paramname"><em>MAPSTA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ny*nx), intent(in)&#160;</td>
          <td class="paramname"><em>MAPFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1-ny:ny*(nx+2)), intent(inout)&#160;</td>
          <td class="paramname"><em>VQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>VGX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>VGY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Propagation in physical space for a given spectral component. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ISP</td><td>Number of spectral bin (IK-1)*NTH+ITH. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DTG</td><td>Total time step. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MAPSTA</td><td>Grid point status map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MAPFS</td><td>Storage map. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">VQ</td><td>Field to propagate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VGX</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VGY</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>29-May-2014 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3pro2md_8F90_source.html#l00509">509</a> of file <a class="el" href="w3pro2md_8F90_source.html">w3pro2md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">!/                  | Last update :         29-May-2014 |</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">!/    07-Jul-1998 : Final FORTRAN 77                    ( version 1.18 )</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">!/    15-Dec-1999 : Upgrade to FORTRAN 90               ( version 2.00 )</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">!/    24-Jan-2001 : Flat grid version                   ( version 2.06 )</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">!/    09-Feb-2001 : Clean up of parameter lists         ( version 2.08 )</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">!/    14-Feb-2001 : Unit numbers in UQ routines         ( version 2.08 )</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">!/    13-Nov-2001 : Sub-grid obstructions.              ( version 2.14 )</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">!/    26-Dec-2002 : Moving grid option,                 ( version 3.02 )</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">!/    20-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">!/    07-Sep-2005 : Improved boundary conditions.       ( version 3.08 )</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">!/    09-Nov-2005 : Removing soft boundary option.      ( version 3.08 )</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">!/    05-Mar-2008 : Added NEC sxf90 compiler directives.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">!/                  (Chris Bunney, UK Met Office)       ( version 3.13 )</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">!/    30-Oct-2009 : Implement curvilinear grid type.    ( version 3.14 )</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">!/                  (W. E. Rogers &amp; T. J. Campbell, NRL)</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">!/    06-Dec-2010 : Change from GLOBAL (logical) to ICLOSE (integer) to</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">!/                  specify index closure for a grid.   ( version 3.14 )</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">!/                  (T. J. Campbell, NRL)</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">!/    23-Dec-2010 : Fix HPFAC and HQFAC by including the COS(YGRD)</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">!/                  factor with DXDP and DXDQ terms.    ( version 3.14 )</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">!/                  (T. J. Campbell, NRL)</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">!/    01-Jul-2013 : Adding UQ and UNO switches to chose between third</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">!/                  and second order schemes.           ( version 4.12 )</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">!/    29-May-2014 : Adding OMPH switch.                 ( version 5.02 )</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">!     Propagation in physical space for a given spectral component.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">!     Third-order ULTIMATE QUICKEST scheme and diffusion correction</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">!     for linear dispersion (see manual).</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">!     Curvilinear grid implementation: Fluxes are computed in index space</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">!       and then transformed back into physical space.  The diffusion term</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">!       is handled in physical space.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">!       ISP     Int.   I   Number of spectral bin (IK-1)*NTH+ITH</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">!       DTG     Real   I   Total time step.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">!       MAPSTA  I.A.   I   Grid point status map.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">!       MAPFS   I.A.   I   Storage map.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">!       VQ      R.A.  I/O  Field to propagate.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">!     Local variables.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">!       NTLOC   Int   Number of local time steps.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">!       DTLOC   Real  Local propagation time step.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">!       CGD     Real  Deep water group velocity.</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">!       DSSD, DNND    Deep water diffusion coefficients.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">!       VLCFLX  R.A.  Local courant numbers in index space (norm. velocities)</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">!       VLCFLY  R.A.</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">!       CXTOT   R.A.  Propagation velocities in physical space.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">!       CYTOT   R.A.</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">!       CELLP   Real  Cell Reynolds/Peclet number used to calculate</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">!                     diffusion coefficient for growing spectral</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">!                     components.</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">!       DFRR    Real  Relative frequency increment.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">!     See module documentation.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">!      W3WAVE    Subr. W3WAVEMD Wave model routine.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">!     ---------------------------------------------------------------</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">!       None.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">!     - Note that the ULTIMATE limiter does not guarantee non-zero</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">!       energies.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">!     - The present scheme shows a strong distortion when propaga-</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">!       ting a field under an angle with the grid in a truly 2-D</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">!       fashion. Propagation is therefore split along the two</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">!       axes.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">!     - Two boundary treatments are available. The first uses real</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">!       boundaries in each space. In this case waves will not</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">!       penetrate in narrow straights under an angle with the grid.</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">!       This behavior is improved by using a &#39;soft&#39; option, in</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">!       which the &#39;X&#39; or &#39;Y&#39; sweep allows for energy to go onto</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">!       the land. This improves the above behavior, but implies</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">!       that X-Y connenctions are required in barriers for them</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">!       to become inpenetrable.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">!     - If TDYN is set to zero, ALL diffusion is skipped. Set TDYN</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">!       to a small positive number to have growth diffusion only.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">!     - Curvilinear grid implementation. Variables FACX, FACY, CCOS, CSIN,</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">!       CCURX, CCURY are not needed and have been removed.  FACX is accounted</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">!       for as approriate in this subroutine.  FACX is also accounted for in</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">!       the case of .NOT.FLCX.  Since FACX is removed, there is now a check for</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">!       .NOT.FLCX in this subroutine.  In CFL calcs dx and dy are omitted,</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">!       since dx=dy=1 in index space.  Curvilinear grid derivatives</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">!       (DPDY, DQDX, etc.) and metric (GSQRT) are brought in via W3GDATMD.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">!     - Factors VFDIFX_FAC VFDIFY_FAC VFDIFC_FAC are introduced so that results</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">!       match for test case tp2.3.  Use of these factors is optional and removal</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">!       can significantly reduce size/cost of code. These variants are marked as</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">!       CURV1 or CURV2. NCEP will make final decision re: which version to adopt.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">!       CURV1 is the shorter version and results do not match the original code</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">!       for all test cases. CURV2 is the longer version and results do match the</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">!       original. DETAILED EXPLANATION: Discrepancies occur at the boundaries.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">!       This is because, at the boundaries, the pre-curvilinear version zeros out</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">!       some terms in the diffusion calculation. Since they are zeroed out,</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">!       they aren&#39;t there to *cancel* certain other terms: these &quot;other terms&quot;</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">!       affect the result, so they have to be retained in the long vesion (CURV2)</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">!       to get an exact match. In the short version, the &quot;canceling out&quot; is</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="comment">!       performed prior to coding the scheme, so both the canceled and canceling</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">!       terms are always omitted.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="comment">!     ---------------------------------------------</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">!       1.  Preparations</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">!         a Set constants</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">!         b Initialize arrays</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">!       2.  Prepare arrays</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">!         a Velocities and &#39;Q&#39;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">!         b diffusion coefficients</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">!       3.  Loop over sub-steps</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">!       ----------------------------------------</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">!         a Propagate</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">!         b Update boundary conditions</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">!         c Diffusion correction</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">!       ----------------------------------------</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">!       4.  Store Q field in spectra</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">!     ---------------------------------------------</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">!       !/MGP   Correct for motion of grid.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">!       !/TDYN  Dynamic increase of DTME</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">!       !/DSS0  Disable diffusion in propagation direction</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">!       !/XW0   Propagation diffusion only.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">!       !/XW1   Growth diffusion only.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">!       !/OMPH  Hybrid OpenMP directives.</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">!       !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="comment">!       !/T     Enable general test output.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">!       !/T1    Dump of input field and fluxes.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">!       !/T2    Dump of output field.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3timemd.html">w3timemd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: nk, nth, <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>, <a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>, <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>, <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>, <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>, nx, ny, &amp;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;         <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>, <a class="code" href="namespacew3gdatmd.html#ace4b7064f5b270ac5564b3484566042d">sx</a>, <a class="code" href="namespacew3gdatmd.html#ae8e13cd23548b33eaaae230040049539">sy</a>, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>, <a class="code" href="namespacew3gdatmd.html#ae1e021bb81c10a42f4ab3fd42c794c47">iclose</a>, <a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a>, <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a>,    &amp;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;         <a class="code" href="namespacew3gdatmd.html#ac5da6c76f4bceed25453dc5e5fd2ac65">iclose_none</a>, <a class="code" href="namespacew3gdatmd.html#acfb3f8afdd57fcdc453f741fe5f88837">iclose_smpl</a>, <a class="code" href="namespacew3gdatmd.html#a13dfe97ece07e7a4268b2aecd23155ae">iclose_trpl</a>,      &amp;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;         <a class="code" href="namespacew3gdatmd.html#abd608127ddae41a25988bc374c264315">dtcfl</a>, <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>, <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a>, <a class="code" href="namespacew3gdatmd.html#a50e77caf09683a65593d799710b4a188">clatmn</a>, <a class="code" href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">flagll</a>,         &amp;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;         <a class="code" href="namespacew3gdatmd.html#a26759ceeed28f07100b31cab17d5c7ea">hpfac</a>, <a class="code" href="namespacew3gdatmd.html#ad0202e8b0d4d789838ffaf63de3be312">hqfac</a>, <a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>, <a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>, <a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>, <a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>, <a class="code" href="namespacew3gdatmd.html#a539da619b5fef8a02637c861945ae9d5">gsqrt</a></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: cg, wn, <a class="code" href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">u10</a>, cx, cy, <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>, <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>, <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>,   &amp;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;         <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>, <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>, <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>,   &amp;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;         <a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a>, <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>, <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a83d8c689a07bb13732d8608e65d97938">mapxy</a></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3idatmd.html">w3idatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>, <a class="code" href="namespacew3odatmd.html#a39d5d567aa1a036c1863ced7728f1105">flbpi</a>, <a class="code" href="namespacew3odatmd.html#a54851e33aec5a99dc645432f40b764ef">nbi</a>, <a class="code" href="namespacew3odatmd.html#a8fa813e24da2f99107bb8a001a582842">tbpi0</a>, <a class="code" href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">tbpin</a>,       &amp;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;         <a class="code" href="namespacew3odatmd.html#a4178ac42bb34594dc93048493285f293">isbpi</a>, <a class="code" href="namespacew3odatmd.html#ac35b37c3a2e715fffb4d5b7eabfa7ccd">bbpi0</a>, <a class="code" href="namespacew3odatmd.html#a68b6874c578a6f4f569901fa57aa6657">bbpin</a>, <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>, <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: extcde</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3uqckmd.html">w3uqckmd</a></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3uno2md.html">w3uno2md</a></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: ISP, MAPSTA(NY*NX), MAPFS(NY*NX)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: DTG, VGX, VGY</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(INOUT)</span>     :: VQ(1-NY:NY*(NX+2))</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: ITH, IK, NTLOC, ITLOC, ISEA, IXY,    &amp;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         IX,IY, IY0, IP, IBI</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: TTEST(2),DTTST</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>                    :: CG0, CGA, CGN, CGX, CGY, CXC, CYC,  &amp;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;         CXMIN, CXMAX, CYMIN, CYMAX</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keywordtype">    REAL</span>                    :: DTLOC, DTRAD,               &amp;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         DFRR, CELLP,  CGD, DSSD,    &amp;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         DNND, DCELL, XWIND, TFAC, DSS, DNN</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keywordtype">    REAL</span>                    :: RD1, RD2</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keywordtype">    REAL</span>                    :: RFAC, DFAC, DVQ, QXX, QXY, QYY</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keywordtype">    REAL</span>                    :: CP, CQ</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordtype">LOGICAL</span>                 :: YFIRST</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">LOGICAL</span>                 :: GLOBAL</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">!/ Automatic work arrays</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordtype">    REAL</span>                    :: VLCFLX((NX+1)*NY), VLCFLY((NX+1)*NY),&amp;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;         VFDIFX(1-NY:NX*NY), VFDIFY(NX*NY),   &amp;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;         VFDIFC(1-NY:NX*NY), VDXX((NX+1)*NY), &amp;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;         VDYY(NX*NY), VDXY((NX+1)*NY)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordtype">    REAL</span>                    :: CXTOT((NX+1)*NY), CYTOT(NX*NY)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordtype">    REAL</span>                    :: VQ_OLD(1-NY:NY*(NX+2))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">!CURV2: BEGIN -----------------------------------------------------------------</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordtype">    REAL</span>                    :: VFDIFX_FAC(1-NY:NX*NY),              &amp;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;         VFDIFY_FAC(1-NY:NX*NY),              &amp;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;         VFDIFC_FAC(1-NY:NX*NY)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">!CURV2: END -------------------------------------------------------------------</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3XYP2&#39;</span>)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">!     IF ( MAXVAL(VQ) .EQ. 0. ) THEN</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">!         IF ( NBI .EQ. 0 ) THEN</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">!             RETURN</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">!           ELSE</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="comment">!             IF ( MAXVAL(BBPI0(ISP,:)) .EQ. 0. .AND.            &amp;</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">!                  MAXVAL(BBPIN(ISP,:)) .EQ. 0. ) RETURN</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">!           END IF</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="comment">!       END IF</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">! 1.  Preparations --------------------------------------------------- *</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#ae1e021bb81c10a42f4ab3fd42c794c47">iclose</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a13dfe97ece07e7a4268b2aecd23155ae">iclose_trpl</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      <span class="keywordflow">IF</span> (<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a>) &amp;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;           <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*)<span class="stringliteral">&#39;SUBROUTINE W3XYP2 IS NOT YET ADAPTED FOR &#39;</span>//    &amp;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;           <span class="stringliteral">&#39;TRIPOLE GRIDS. STOPPING NOW.&#39;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keyword">CALL </span>extcde ( 1 )</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">! 1.a Set constants</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    global = <a class="code" href="namespacew3gdatmd.html#ae1e021bb81c10a42f4ab3fd42c794c47">iclose</a>.NE.<a class="code" href="namespacew3gdatmd.html#ac5da6c76f4bceed25453dc5e5fd2ac65">iclose_none</a></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    ith    = 1 + mod(isp-1,nth)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    ik     = 1 + (isp-1)/nth</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    cg0    = 0.575 * <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a> / <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(1)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    cga    = 0.575 * <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a> / <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    cgx    = cga * <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    cgy    = cga * <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor">#ifdef W3_MGP</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor"></span>    cgx    = cgx - vgx</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    cgy    = cgy - vgy</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      cxmin  = minval( cx(1:<a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>) )</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      cxmax  = maxval( cx(1:<a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>) )</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      cymin  = minval( cy(1:<a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>) )</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      cymax  = maxval( cy(1:<a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>) )</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">IF</span> ( abs(cgx+cxmin) .GT. abs(cgx+cxmax) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        cgx    = cgx + cxmin</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        cgx    = cgx + cxmax</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">IF</span> ( abs(cgy+cymin) .GT. abs(cgy+cymax) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        cgy    = cgy + cymin</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        cgy    = cgy + cymax</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      cxc    = max( abs(cxmin) , abs(cxmax) )</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      cyc    = max( abs(cymin) , abs(cymax) )</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">#ifdef W3_MGP</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor"></span>      cxc    = max( abs(cxmin-vgx) , abs(cxmax-vgx) )</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      cyc    = max( abs(cymin-vgy) , abs(cymax-vgy) )</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      cxc    = 0.</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      cyc    = 0.</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    cgn    = 0.9999 * max( abs(cgx) , abs(cgy) , cxc, cyc, 0.001*cg0 )</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    ntloc  = 1 + int(dtg/(<a class="code" href="namespacew3gdatmd.html#abd608127ddae41a25988bc374c264315">dtcfl</a>*cg0/cgn))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    dtloc  = dtg / real(ntloc)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    dtrad  = dtloc</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">flagll</a> ) dtrad=dtrad/(<a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a>*<a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a>)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">flagll</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      rfac = <a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a> * <a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      dfac = 1. / rfac**2</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      rfac = 1.</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      dfac = 1.</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    ttest(1) = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    ttest(2) = 0</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(ttest,<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    yfirst = mod(nint(dttst/dtg),2) .EQ. 0</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) yfirst</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9001) isp, ith, ik, <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith), <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor">#ifdef W3_TDYN</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( isp .EQ. 1 ) <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> = <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> + dtg</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> .NE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      dfrr   = <a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a> - 1.</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      cellp  = 10.</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      cgd    = 0.5 * <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a> / <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      dssd   = ( dfrr * cgd )**2 * <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> / 12.</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      dnnd   = ( cgd * <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a> )**2 * <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> / 12.</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9002) dfrr, cellp, <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9003)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">! 1.b Initialize arrays</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9010)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    vlcflx = 0.</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    vlcfly = 0.</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    vfdifx = 0.</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    vfdify = 0.</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    vfdifc = 0.</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    vdxx   = 0.</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    vdyy   = 0.</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    vdxy   = 0.</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    cxtot  = 0.</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    cytot  = 0.</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">! 2.  Calculate velocities and diffusion coefficients ---------------- *</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">! 2.a Velocities</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">!     Q     = ( A / CG * CLATS )</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="comment">!     LCFLX = ( COS*CG / CLATS ) * DT / DX</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">!     LCFLY = (     SIN*CG )     * DT / DX</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9020) <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IXY)</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      ixy         = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      vq(ixy) = vq(ixy) / cg(ik,isea) * <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      cxtot(ixy) = <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith) * cg(ik,isea) / <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      cytot(ixy) = <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith) * cg(ik,isea)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="preprocessor">#ifdef W3_MGP</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor"></span>      cxtot(ixy) = cxtot(ixy) - vgx/<a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      cytot(ixy) = cytot(ixy) - vgy</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T1</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( .NOT. <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a> )                                        &amp;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;           <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9021) isea, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1), <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2), &amp;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;           vq(ixy), cxtot(ixy), cytot(ixy)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9022)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        ixy         = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        cxtot(ixy) = cxtot(ixy) + cx(isea)/<a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        cytot(ixy) = cytot(ixy) + cy(isea)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#ifdef W3_T1</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9021) isea, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1), <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2), &amp;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;             vq(ixy), cxtot(ixy), cytot(ixy)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IX, IY, IXY, CP, CQ)</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      cp=cxtot(ixy)*<a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>(iy,ix)+cytot(ixy)*<a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>(iy,ix)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      cq=cxtot(ixy)*<a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>(iy,ix)+cytot(ixy)*<a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>(iy,ix)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      vlcflx(ixy) = cp*dtrad</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      vlcfly(ixy) = cq*dtrad</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">! 2.b Diffusion coefficients</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> .NE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor"></span>      <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IX, IY, IXY, &amp;</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="comment">!$OMP&amp;                     DCELL, XWIND, TFAC, DSS, DNN)</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        ix        = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        iy        = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        ixy       = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">IF</span> ( min( <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>(ixy,1) , <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>(ixy,-1) ,                 &amp;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;             <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>(ixy,1) , <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>(ixy,-1) ) .GT. trnmin ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          dcell     = cgd * min( <a class="code" href="namespacew3gdatmd.html#a26759ceeed28f07100b31cab17d5c7ea">hpfac</a>(iy,ix)*rfac, &amp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;               <a class="code" href="namespacew3gdatmd.html#ad0202e8b0d4d789838ffaf63de3be312">hqfac</a>(iy,ix)*rfac ) / cellp</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          xwind     = 3.3 * <a class="code" href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">u10</a>(isea)*wn(ik,isea)/<a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik) - 2.3</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;          xwind     = max( 0. , min( 1. , xwind ) )</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="preprocessor">#ifdef W3_XW0</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor"></span>          xwind     = 0.</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_XW1</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="preprocessor"></span>          xwind     = 1.</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="preprocessor"></span>          tfac      = min( 1. , (<a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)/<a class="code" href="namespacew3gdatmd.html#a50e77caf09683a65593d799710b4a188">clatmn</a>)**2 )</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;          dss       = xwind * dcell + (1.-xwind) * dssd * tfac</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#ifdef W3_DSS0</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor"></span>          dss       = 0.</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor"></span>          dnn       = xwind * dcell + (1.-xwind) * dnnd * tfac</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          vdxx(ixy) = dtloc * (dss*<a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith)**2+dnn*<a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith)**2)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          vdyy(ixy) = dtloc * (dss*<a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith)**2+dnn*<a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith)**2) &amp;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;               / <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)**2</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          vdxy(ixy) = dtloc * (dss-dnn) * <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(ith)*<a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(ith)     &amp;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;               / <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="preprocessor"></span>      <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">! 3.  Loop over sub-steps -------------------------------------------- *</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">DO</span> itloc=1, ntloc</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="comment">! 3.a Propagate fields</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="preprocessor"></span>      <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IX, IY, IXY )</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        vq(ixy)= vq(ixy) * <a class="code" href="namespacew3gdatmd.html#a539da619b5fef8a02637c861945ae9d5">gsqrt</a>(iy,ix)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="preprocessor"></span>      <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keywordflow">IF</span> ( yfirst ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#a2b13171972fcf3105bf746164792491a">w3qck3</a>                               &amp;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;             (nx, ny, nx, ny, vlcfly, <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>, vq,       &amp;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;             .false., 1, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>,   &amp;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;             <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#a2b13171972fcf3105bf746164792491a">w3qck3</a>                               &amp;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;             (nx, ny, nx, ny, vlcflx, <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>, vq,       &amp;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;             global, ny, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>, <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>,   &amp;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;             <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#a1ead7b5e1cea3627fc1dce798306b37f">w3uno2s</a>                             &amp;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;             (nx, ny, nx, ny, vlcfly, <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>, vq,      &amp;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;             .false., 1, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>,  &amp;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;             <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#a1ead7b5e1cea3627fc1dce798306b37f">w3uno2s</a>                             &amp;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;             (nx, ny, nx, ny, vlcflx, <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>, vq,      &amp;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;             global, ny, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>, <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>,  &amp;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;             <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="preprocessor">#ifdef W3_UQ</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#a2b13171972fcf3105bf746164792491a">w3qck3</a>                               &amp;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;             (nx, ny, nx, ny, vlcflx, <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>, vq,       &amp;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;             global, ny, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>, <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>,   &amp;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;             <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uqckmd.html#a2b13171972fcf3105bf746164792491a">w3qck3</a>                               &amp;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;             (nx, ny, nx, ny, vlcfly, <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>, vq,       &amp;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;             .false., 1, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>,   &amp;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;             <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">#ifdef W3_UNO</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#a1ead7b5e1cea3627fc1dce798306b37f">w3uno2s</a>                             &amp;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;             (nx, ny, nx, ny, vlcflx, <a class="code" href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">atrnx</a>, vq,      &amp;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;             global, ny, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>, <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a>,  &amp;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;             <a class="code" href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">nmx1</a>, <a class="code" href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">nmx2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a> ) <span class="keyword">CALL </span><a class="code" href="namespacew3uno2md.html#a1ead7b5e1cea3627fc1dce798306b37f">w3uno2s</a>                             &amp;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;             (nx, ny, nx, ny, vlcfly, <a class="code" href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">atrny</a>, vq,      &amp;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;             .false., 1, <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a>, <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a>,  &amp;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;             <a class="code" href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">nmy1</a>, <a class="code" href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">nmy2</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="preprocessor"></span>      <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IX, IY, IXY )</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        vq(ixy)= vq(ixy) / <a class="code" href="namespacew3gdatmd.html#a539da619b5fef8a02637c861945ae9d5">gsqrt</a>(iy,ix)</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="preprocessor"></span>      <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="comment">! 3.b Update boundaries</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a39d5d567aa1a036c1863ced7728f1105">flbpi</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        rd1    = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3odatmd.html#a8fa813e24da2f99107bb8a001a582842">tbpi0</a>, <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> ) - dtg *                   &amp;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="keywordtype">             REAL</span>(NTLOC-ITLOC)/<span class="keywordtype">REAL</span>(NTLOC)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        rd2    = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3odatmd.html#a8fa813e24da2f99107bb8a001a582842">tbpi0</a>, <a class="code" href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">tbpin</a> )</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordflow">IF</span> ( rd2 .GT. 0.001 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          rd2    = min(1.,max(0.,rd1/rd2))</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          rd1    = 1. - rd2</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          rd1    = 0.</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          rd2    = 1.</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="keywordflow">DO</span> ibi=1, <a class="code" href="namespacew3odatmd.html#a54851e33aec5a99dc645432f40b764ef">nbi</a></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;          isea    = <a class="code" href="namespacew3odatmd.html#a4178ac42bb34594dc93048493285f293">isbpi</a>(ibi)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;          ixy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(<a class="code" href="namespacew3odatmd.html#a4178ac42bb34594dc93048493285f293">isbpi</a>(ibi),3)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;          vq(ixy) = ( rd1*<a class="code" href="namespacew3odatmd.html#ac35b37c3a2e715fffb4d5b7eabfa7ccd">bbpi0</a>(isp,ibi) + rd2*<a class="code" href="namespacew3odatmd.html#a68b6874c578a6f4f569901fa57aa6657">bbpin</a>(isp,ibi) )   &amp;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;               / cg(ik,isea) * <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="comment">! 3.c Diffusion correction</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">dtme</a> .NE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">IF</span> ( global ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          <span class="keywordflow">DO</span> iy=1, ny</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            vq(iy+nx*ny) = vq(iy)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="comment">!CURV2: BEGIN -----------------------------------------------------------------</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        vfdifx_fac=0.0</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">DO</span> ip=1, <a class="code" href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">nmx0</a></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          ixy         = <a class="code" href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">mapx2</a>(ip)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          vfdifx_fac(ixy) = 1.0</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        vfdify_fac=0.0</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">DO</span> ip=1, <a class="code" href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">nmy0</a></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          ixy         = <a class="code" href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">mapy2</a>(ip)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          vfdify_fac(ixy) = 1.0</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        vfdifc_fac=0.0</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">DO</span> ip=1, <a class="code" href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">nmxy</a></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          ixy         = <a class="code" href="namespacew3adatmd.html#a83d8c689a07bb13732d8608e65d97938">mapxy</a>(ip)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          vfdifc_fac(ixy) = 1.0</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="keywordflow">IF</span> ( global ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;          iy0     = (nx-1)*ny</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          <span class="keywordflow">DO</span> iy=1, ny</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            vfdifx_fac(iy-ny) = vfdifx_fac(iy+iy0)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            vfdifc_fac(iy-ny) = vfdifc_fac(iy+iy0)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="comment">!CURV2: END -------------------------------------------------------------------</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        vq_old = vq</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor"></span>        <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IX, IY, IXY, &amp;</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">!$OMP&amp;                     QXX, QYY, QXY, DVQ )</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">DO</span> ip=1, <a class="code" href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">nact</a></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          ixy    = <a class="code" href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">mapaxy</a>(ip)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;          isea   = mapfs(ixy)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;          iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          <span class="comment">!CURV1: DOES NOT GIVE EXACT MATCH TO EARLIER WW3 VERSION FOR TEST CASE TP2.3</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          <span class="comment">!CURV1: NEAR THE BOUNDARY, NOTE THAT THIS VERSION USES NON-ACTIVE GRID POINTS</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;          <span class="comment">!CURV1: IN ITS CALCS. THIS IS NO PROBLEM, AS LONG AS THE NON-ACTIVE GRID POINTS</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;          <span class="comment">!CURV1: EXIST IN THE ARRAY AND ARE VQ=0. ALSO NOTE THAT WITH THE SHORT VERSION</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;          <span class="comment">!CURV1: OF THE CODE, VFDIF?_FAC VARIABLES CAN BE REMOVED AND 3-4 DO LOOPS ABOVE</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;          <span class="comment">!CURV1: CAN BE REMOVED.</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;          <span class="comment">!CURV1: BEGIN -----------------------------------------------------------------</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;          <span class="comment">!                QXX = VQ_OLD(IXY+NY) - 2.0*VQ_OLD(IXY) + VQ_OLD(IXY-NY)</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          <span class="comment">!                QYY = VQ_OLD(IXY+1)  - 2.0*VQ_OLD(IXY) + VQ_OLD(IXY-1)</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="comment">!                QXY = VQ_OLD(IXY+NY+1) - VQ_OLD(IXY-NY+1) &amp;</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          <span class="comment">!                    - VQ_OLD(IXY+NY-1) + VQ_OLD(IXY-NY-1)</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;          <span class="comment">!CURV1: END -------------------------------------------------------------------</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;          <span class="comment">!CURV2: DOES GIVE EXACT MATCH TO EARLIER WW3 VERSION FOR TEST CASE TP2.3. NOTE</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          <span class="comment">!CURV2: THAT IF VFDIFC_FAC VARIABLES ARE ALL UNITY, MANY TERMS CANCEL OUT.</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          <span class="comment">!CURV2: HOWEVER, VFDIFC_FAC IS ZERO WHEN A RELATED VQ POINT IS NOT AN ACTIVE</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          <span class="comment">!CURV2: GRID POINT</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          <span class="comment">!CURV2: BEGIN -----------------------------------------------------------------</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          qxx = vfdifx_fac(ixy)   *vq_old(ixy+ny)     &amp;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;               - vfdifx_fac(ixy)   *vq_old(ixy)        &amp;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;               - vfdifx_fac(ixy-ny)*vq_old(ixy)        &amp;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;               + vfdifx_fac(ixy-ny)*vq_old(ixy-ny)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          qyy = vfdify_fac(ixy)   *vq_old(ixy+1)      &amp;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;               - vfdify_fac(ixy)   *vq_old(ixy)        &amp;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;               - vfdify_fac(ixy-1) *vq_old(ixy)        &amp;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;               + vfdify_fac(ixy-1) *vq_old(ixy-1)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;          qxy = vfdifc_fac(ixy)     *vq_old(ixy)      &amp;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;               + vfdifc_fac(ixy-ny-1)*vq_old(ixy)      &amp;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;               - vfdifc_fac(ixy-1)   *vq_old(ixy)      &amp;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;               - vfdifc_fac(ixy-ny)  *vq_old(ixy)      &amp;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;               + vfdifc_fac(ixy-ny)  *vq_old(ixy+1)    &amp;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;               - vfdifc_fac(ixy)     *vq_old(ixy+1)    &amp;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;               + vfdifc_fac(ixy-1)   *vq_old(ixy-1)    &amp;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;               - vfdifc_fac(ixy-ny-1)*vq_old(ixy-1)    &amp;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;               + vfdifc_fac(ixy-1)   *vq_old(ixy+ny)   &amp;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;               - vfdifc_fac(ixy)     *vq_old(ixy+ny)   &amp;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;               + vfdifc_fac(ixy-ny)  *vq_old(ixy-ny)   &amp;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;               - vfdifc_fac(ixy-ny-1)*vq_old(ixy-ny)   &amp;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;               + vfdifc_fac(ixy)     *vq_old(ixy+ny+1) &amp;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;               - vfdifc_fac(ixy-1)   *vq_old(ixy+ny-1) &amp;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;               + vfdifc_fac(ixy-ny-1)*vq_old(ixy-ny-1) &amp;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;               - vfdifc_fac(ixy-ny)  *vq_old(ixy-ny+1)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;          <span class="comment">!CURV2: END -------------------------------------------------------------------</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          qxy = 0.25*qxy</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;          dvq = vdxx(ixy)*(  <a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>(iy,ix)*qxx          &amp;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;               + 2.0*<a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>(iy,ix)*qxy      &amp;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;               + <a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>(iy,ix)*qyy )        &amp;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;               + vdyy(ixy)*(  <a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>(iy,ix)*qxx          &amp;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;               + 2.0*<a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>(iy,ix)*qxy      &amp;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;               + <a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>(iy,ix)*qyy)         &amp;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;               + 2.0*vdxy(ixy)*(  <a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>(iy,ix)*qxx      &amp;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;               + <a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>(iy,ix)*qyy      &amp;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;               +      (  <a class="code" href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">dpdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">dqdy</a>(iy,ix)  &amp;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;               + <a class="code" href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">dqdx</a>(iy,ix)*<a class="code" href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">dpdy</a>(iy,ix) )*qxy )</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          vq(ixy) = vq_old(ixy) + dvq * dfac</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor"></span>        <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      yfirst = .NOT. yfirst</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">! 4.  Store results in VQ in proper format --------------------------- *</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9040) <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP PARALLEL DO PRIVATE (ISEA, IXY )</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">IF</span> ( mapsta(ixy) .GT. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">#ifdef W3_T2</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9041) isea, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1), <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2), vq(ixy)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor"></span>        vq(ixy) =  max( 0. , cg(ik,isea) / <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea) * vq(ixy) )</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="comment">!         ELSE</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="comment">!           VQ(IXY) =  0.</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="preprocessor">#ifdef W3_OMPH</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : YFIRST  :&#39;</span>,l2)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;9001 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : ISP, ITH, IK, COS-SIN :&#39;</span>,i8,2i4,2f7.3)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;9002 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : DFRR, CELLP, DTME     :&#39;</span>,3e10.3)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;9003 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : NO DISPERSION CORRECTION &#39;</span>)</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;9010 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : INITIALIZE ARRAYS&#39;</span>)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;9020 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : CALCULATING LCFLX/Y AND DSS/NN (NSEA=&#39;</span>, &amp;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         i6,<span class="stringliteral">&#39;)&#39;</span>)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;9022 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : CORRECTING FOR CURRENT&#39;</span>)</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;9040 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3XYP2 : FIELD AFTER PROP. (NSEA=&#39;</span>,i6,<span class="stringliteral">&#39;)&#39;</span>)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T1</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="preprocessor"></span>9021 <span class="keyword">FORMAT</span> (1x,i6,2i5,e12.4,2f7.3)</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T2</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="preprocessor"></span>9041 <span class="keyword">FORMAT</span> (1x,i6,2i5,e12.4)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">!/ End of W3XYP2 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3adatmd_8F90_source.html#l00578">w3adatmd::atrnx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00578">w3adatmd::atrny</a>, <a class="el" href="w3odatmd_8F90_source.html#l00541">w3odatmd::bbpi0</a>, <a class="el" href="w3odatmd_8F90_source.html#l00541">w3odatmd::bbpin</a>, <a class="el" href="w3adatmd_8F90_source.html#l00575">w3adatmd::cg</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01257">w3gdatmd::clatmn</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01196">w3gdatmd::clats</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::cx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::cy</a>, <a class="el" href="constants_8F90_source.html#l00077">constants::dera</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01208">w3gdatmd::dpdx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01208">w3gdatmd::dpdy</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01209">w3gdatmd::dqdx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01209">w3gdatmd::dqdy</a>, <a class="el" href="w3timemd_8F90_source.html#l00333">w3timemd::dsec21()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dtcfl</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01257">w3gdatmd::dtme</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::ecos</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::esin</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01219">w3gdatmd::flagll</a>, <a class="el" href="w3odatmd_8F90_source.html#l00546">w3odatmd::flbpi</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::flcur</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flcx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flcy</a>, <a class="el" href="constants_8F90_source.html#l00061">constants::grav</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01210">w3gdatmd::gsqrt</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01211">w3gdatmd::hpfac</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01212">w3gdatmd::hqfac</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01096">w3gdatmd::iclose</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00629">w3gdatmd::iclose_none</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00630">w3gdatmd::iclose_smpl</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00631">w3gdatmd::iclose_trpl</a>, <a class="el" href="w3odatmd_8F90_source.html#l00535">w3odatmd::isbpi</a>, <a class="el" href="w3adatmd_8F90_source.html#l00686">w3adatmd::itime</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapaxy</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapx2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapxy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00642">w3adatmd::mapy2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nact</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naperr</a>, <a class="el" href="w3odatmd_8F90_source.html#l00530">w3odatmd::nbi</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmx0</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmx1</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmx2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmxy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmy0</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmy1</a>, <a class="el" href="w3adatmd_8F90_source.html#l00640">w3adatmd::nmy2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="constants_8F90_source.html#l00079">constants::radius</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::sx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::sy</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tbpi0</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tbpin</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::time</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::u10</a>, <a class="el" href="w3uqckmd_8F90_source.html#l00922">w3uqckmd::w3qck3()</a>, <a class="el" href="w3uno2md_8F90_source.html#l00839">w3uno2md::w3uno2s()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00575">w3adatmd::wn</a>, and <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::xfr</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wavemd::w3wave()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacew3gdatmd_html_abb691eacfa4234e3a34feb5ab0425990"><div class="ttname"><a href="namespacew3gdatmd.html#abb691eacfa4234e3a34feb5ab0425990">w3gdatmd::esc</a></div><div class="ttdeci">real, dimension(:), pointer esc</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a8fa813e24da2f99107bb8a001a582842"><div class="ttname"><a href="namespacew3odatmd.html#a8fa813e24da2f99107bb8a001a582842">w3odatmd::tbpi0</a></div><div class="ttdeci">integer, dimension(:), pointer tbpi0</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a32487c213ce877b1194cb0244ebfafc7"><div class="ttname"><a href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">w3timemd::dsec21</a></div><div class="ttdeci">real function dsec21(TIME1, TIME2)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00333">w3timemd.F90:333</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a4b6f7577a00b480afcec77e672fb25b2"><div class="ttname"><a href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">w3gdatmd::dth</a></div><div class="ttdeci">real, pointer dth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3uno2md_html"><div class="ttname"><a href="namespacew3uno2md.html">w3uno2md</a></div><div class="ttdoc">Portable UNO2 scheme on irregular grid.</div><div class="ttdef"><b>Definition:</b> <a href="w3uno2md_8F90_source.html#l00014">w3uno2md.F90:14</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html"><div class="ttname"><a href="namespacew3adatmd.html">w3adatmd</a></div><div class="ttdoc">Define data structures to set up wave model auxiliary data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00026">w3adatmd.F90:26</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a09487c7ba1bf478633e08c5cd449cefc"><div class="ttname"><a href="namespacew3adatmd.html#a09487c7ba1bf478633e08c5cd449cefc">w3adatmd::mapy2</a></div><div class="ttdeci">integer, dimension(:), pointer mapy2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00642">w3adatmd.F90:642</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a7ca2bfab88e5cd9e0eda00a6147d1806"><div class="ttname"><a href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">constants::dera</a></div><div class="ttdeci">real, parameter dera</div><div class="ttdoc">DERA Conversion factor from degrees to radians.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00077">constants.F90:77</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html"><div class="ttname"><a href="namespacew3wdatmd.html">w3wdatmd</a></div><div class="ttdoc">Define data structures to set up wave model dynamic data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00018">w3wdatmd.F90:18</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a4c66b7b624c1dbeea538e045de1b695f"><div class="ttname"><a href="namespacew3adatmd.html#a4c66b7b624c1dbeea538e045de1b695f">w3adatmd::atrnx</a></div><div class="ttdeci">real, dimension(:,:), pointer atrnx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00578">w3adatmd.F90:578</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a83d8c689a07bb13732d8608e65d97938"><div class="ttname"><a href="namespacew3adatmd.html#a83d8c689a07bb13732d8608e65d97938">w3adatmd::mapxy</a></div><div class="ttdeci">integer, dimension(:), pointer mapxy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00642">w3adatmd.F90:642</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a1954ef27053b5650eb47fddc1ea057ce"><div class="ttname"><a href="namespacew3adatmd.html#a1954ef27053b5650eb47fddc1ea057ce">w3adatmd::nmx0</a></div><div class="ttdeci">integer, pointer nmx0</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a26bdd2a41eff73bc32405928d93c156d"><div class="ttname"><a href="namespacew3adatmd.html#a26bdd2a41eff73bc32405928d93c156d">w3adatmd::atrny</a></div><div class="ttdeci">real, dimension(:,:), pointer atrny</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00578">w3adatmd.F90:578</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad451ba3fd6cfdb044986de89e4e4e4f8"><div class="ttname"><a href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">w3gdatmd::sig</a></div><div class="ttdeci">real, dimension(:), pointer sig</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ae8e13cd23548b33eaaae230040049539"><div class="ttname"><a href="namespacew3gdatmd.html#ae8e13cd23548b33eaaae230040049539">w3gdatmd::sy</a></div><div class="ttdeci">real, pointer sy</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a05aad32a966c3b74189f5c783e8a0624"><div class="ttname"><a href="namespacew3adatmd.html#a05aad32a966c3b74189f5c783e8a0624">w3adatmd::mapwn2</a></div><div class="ttdeci">integer, dimension(:), pointer mapwn2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00642">w3adatmd.F90:642</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_abaa3489602a308c21fefc7e3359dfa6e"><div class="ttname"><a href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">w3gdatmd::flck</a></div><div class="ttdeci">logical, pointer flck</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a36a4047055987bb52cab303f0207f676"><div class="ttname"><a href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">w3odatmd::iaproc</a></div><div class="ttdeci">integer, pointer iaproc</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a91e6f2e680d6b6e615a4eb6828182bf6"><div class="ttname"><a href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">w3wdatmd::time</a></div><div class="ttdeci">integer, dimension(:), pointer time</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3uqckmd_html_a65614fe2cf564b2b3c635c635c71ad49"><div class="ttname"><a href="namespacew3uqckmd.html#a65614fe2cf564b2b3c635c635c71ad49">w3uqckmd::w3qck2</a></div><div class="ttdeci">subroutine w3qck2(MX, MY, NX, NY, VELO, DT, DX1, DX2, Q, CLOSE, INC, MAPACT, NACT, MAPBOU, NB0, NB1, NB2, NDSE, NDST)</div><div class="ttdoc">Like W3QCK1 with variable grid spacing.</div><div class="ttdef"><b>Definition:</b> <a href="w3uqckmd_8F90_source.html#l00517">w3uqckmd.F90:517</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a77230bde44d23a91e680520547fcaeb9"><div class="ttname"><a href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">w3gdatmd::ecos</a></div><div class="ttdeci">real, dimension(:), pointer ecos</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ac35b37c3a2e715fffb4d5b7eabfa7ccd"><div class="ttname"><a href="namespacew3odatmd.html#ac35b37c3a2e715fffb4d5b7eabfa7ccd">w3odatmd::bbpi0</a></div><div class="ttdeci">real, dimension(:,:), pointer bbpi0</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00541">w3odatmd.F90:541</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a6fe933a63abaaed11d4e7c61c9ecd8c2"><div class="ttname"><a href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">w3odatmd::tbpin</a></div><div class="ttdeci">integer, dimension(:), pointer tbpin</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_af3b6f2595ef8286e10e29db9a16652a4"><div class="ttname"><a href="namespacew3gdatmd.html#af3b6f2595ef8286e10e29db9a16652a4">w3gdatmd::dsip</a></div><div class="ttdeci">real, dimension(:), pointer dsip</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a54851e33aec5a99dc645432f40b764ef"><div class="ttname"><a href="namespacew3odatmd.html#a54851e33aec5a99dc645432f40b764ef">w3odatmd::nbi</a></div><div class="ttdeci">integer, pointer nbi</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00530">w3odatmd.F90:530</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a39d5d567aa1a036c1863ced7728f1105"><div class="ttname"><a href="namespacew3odatmd.html#a39d5d567aa1a036c1863ced7728f1105">w3odatmd::flbpi</a></div><div class="ttdeci">logical, pointer flbpi</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00546">w3odatmd.F90:546</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ae03d5d6e45e60d9f331592664b703b19"><div class="ttname"><a href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">w3idatmd::flcur</a></div><div class="ttdeci">logical, pointer flcur</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ac5da6c76f4bceed25453dc5e5fd2ac65"><div class="ttname"><a href="namespacew3gdatmd.html#ac5da6c76f4bceed25453dc5e5fd2ac65">w3gdatmd::iclose_none</a></div><div class="ttdeci">integer, parameter iclose_none</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00629">w3gdatmd.F90:629</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad0202e8b0d4d789838ffaf63de3be312"><div class="ttname"><a href="namespacew3gdatmd.html#ad0202e8b0d4d789838ffaf63de3be312">w3gdatmd::hqfac</a></div><div class="ttdeci">real, dimension(:,:), pointer hqfac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01212">w3gdatmd.F90:1212</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a2e5aeb0943bf5031dc1f9552e5159290"><div class="ttname"><a href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">w3odatmd::ndse</a></div><div class="ttdeci">integer, pointer ndse</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a3db0bb5af0ebfb018aef89118e8225ad"><div class="ttname"><a href="namespacew3gdatmd.html#a3db0bb5af0ebfb018aef89118e8225ad">w3gdatmd::fachfa</a></div><div class="ttdeci">real, pointer fachfa</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a50e77caf09683a65593d799710b4a188"><div class="ttname"><a href="namespacew3gdatmd.html#a50e77caf09683a65593d799710b4a188">w3gdatmd::clatmn</a></div><div class="ttdeci">real, pointer clatmn</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01257">w3gdatmd.F90:1257</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a80483bc599d405d1e970135d63f28c4b"><div class="ttname"><a href="namespacew3gdatmd.html#a80483bc599d405d1e970135d63f28c4b">w3gdatmd::es2</a></div><div class="ttdeci">real, dimension(:), pointer es2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adc40b349d780fe03284b7d91624081d9"><div class="ttname"><a href="namespacew3gdatmd.html#adc40b349d780fe03284b7d91624081d9">w3gdatmd::dqdy</a></div><div class="ttdeci">real, dimension(:,:), pointer dqdy</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01209">w3gdatmd.F90:1209</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a345f95d975f7c29614d7096b4a2c4073"><div class="ttname"><a href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">w3gdatmd::esin</a></div><div class="ttdeci">real, dimension(:), pointer esin</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ad8349dc3d81fccb0311084ccecfe6f49"><div class="ttname"><a href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">w3odatmd::naperr</a></div><div class="ttdeci">integer, pointer naperr</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3uno2md_html_a1ead7b5e1cea3627fc1dce798306b37f"><div class="ttname"><a href="namespacew3uno2md.html#a1ead7b5e1cea3627fc1dce798306b37f">w3uno2md::w3uno2s</a></div><div class="ttdeci">subroutine w3uno2s(MX, MY, NX, NY, CFLL, TRANS, Q, BCLOSE, INC, MAPACT, NACT, MAPBOU, NB0, NB1, NB2, NDSE, NDST)</div><div class="ttdoc">Like W3UNO2r with cell transparencies added.</div><div class="ttdef"><b>Definition:</b> <a href="w3uno2md_8F90_source.html#l00839">w3uno2md.F90:839</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adfe669e78e9532f40ba6888dabf3c208"><div class="ttname"><a href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">w3gdatmd::nsea</a></div><div class="ttdeci">integer, pointer nsea</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01097">w3gdatmd.F90:1097</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a642ac3886b70201ed8279aad2063e834"><div class="ttname"><a href="namespacew3gdatmd.html#a642ac3886b70201ed8279aad2063e834">w3gdatmd::dtme</a></div><div class="ttdeci">real, pointer dtme</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01257">w3gdatmd.F90:1257</a></div></div>
<div class="ttc" id="anamespacew3servmd_html"><div class="ttname"><a href="namespacew3servmd.html">w3servmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00003">w3servmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a52768c6ed6f8d86daccb2c8454bb3cb4"><div class="ttname"><a href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">w3gdatmd::flcth</a></div><div class="ttdeci">logical, pointer flcth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3uno2md_html_a7a1a4031e0af5b9bc81abcdd373c5597"><div class="ttname"><a href="namespacew3uno2md.html#a7a1a4031e0af5b9bc81abcdd373c5597">w3uno2md::w3uno2</a></div><div class="ttdeci">subroutine w3uno2(MX, MY, NX, NY, VELO, DT, DX1, DX2, Q, BCLOSE, INC, MAPACT, NACT, MAPBOU, NB0, NB1, NB2, NDSE, NDST)</div><div class="ttdoc">UNO2 scheme for irregular grid.</div><div class="ttdef"><b>Definition:</b> <a href="w3uno2md_8F90_source.html#l00105">w3uno2md.F90:105</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html"><div class="ttname"><a href="namespacew3odatmd.html">w3odatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00003">w3odatmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aad204763c51cb0df15891498f423285b"><div class="ttname"><a href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">w3gdatmd::clats</a></div><div class="ttdeci">real, dimension(:), pointer clats</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01196">w3gdatmd.F90:1196</a></div></div>
<div class="ttc" id="anamespacew3uno2md_html_ad384a499814a2dc15b2d5b41dbd877a5"><div class="ttname"><a href="namespacew3uno2md.html#ad384a499814a2dc15b2d5b41dbd877a5">w3uno2md::w3uno2r</a></div><div class="ttdeci">subroutine w3uno2r(MX, MY, NX, NY, CFLL, Q, BCLOSE, INC, MAPACT, NACT, MAPBOU, NB0, NB1, NB2, NDSE, NDST)</div><div class="ttdoc">Preform one-dimensional propagation in a two-dimensional space with irregular boundaries and regular ...</div><div class="ttdef"><b>Definition:</b> <a href="w3uno2md_8F90_source.html#l00475">w3uno2md.F90:475</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a0749d133d47bf436563c3cfd18a3130f"><div class="ttname"><a href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">w3gdatmd::mapsf</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapsf</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01163">w3gdatmd.F90:1163</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a381afdf0b7f6c0418b7d41fe04420ff0"><div class="ttname"><a href="namespacew3gdatmd.html#a381afdf0b7f6c0418b7d41fe04420ff0">w3gdatmd::dpdx</a></div><div class="ttdeci">real, dimension(:,:), pointer dpdx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01208">w3gdatmd.F90:1208</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a539da619b5fef8a02637c861945ae9d5"><div class="ttname"><a href="namespacew3gdatmd.html#a539da619b5fef8a02637c861945ae9d5">w3gdatmd::gsqrt</a></div><div class="ttdeci">real, dimension(:,:), pointer gsqrt</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01210">w3gdatmd.F90:1210</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a4c7fdbba673b7723a6b0743a639599d6"><div class="ttname"><a href="namespacew3adatmd.html#a4c7fdbba673b7723a6b0743a639599d6">w3adatmd::mapth2</a></div><div class="ttdeci">integer, dimension(:), pointer mapth2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00642">w3adatmd.F90:642</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a4dceccc29b7e5529102409498706a17f"><div class="ttname"><a href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">constants::radius</a></div><div class="ttdeci">real, parameter radius</div><div class="ttdoc">RADIUS Radius of the earth (m).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00079">constants.F90:79</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a462275896cfb782abf4f540a9b3df157"><div class="ttname"><a href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">w3adatmd::u10</a></div><div class="ttdeci">real, dimension(:), pointer u10</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a06c2256fd09fd006365fe54c0400743e"><div class="ttname"><a href="namespacew3adatmd.html#a06c2256fd09fd006365fe54c0400743e">w3adatmd::nmx2</a></div><div class="ttdeci">integer, pointer nmx2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ae1e021bb81c10a42f4ab3fd42c794c47"><div class="ttname"><a href="namespacew3gdatmd.html#ae1e021bb81c10a42f4ab3fd42c794c47">w3gdatmd::iclose</a></div><div class="ttdeci">integer, pointer iclose</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01096">w3gdatmd.F90:1096</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a5729459787df1ec9fac855545e0faaea"><div class="ttname"><a href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">constants::tpi</a></div><div class="ttdeci">real, parameter tpi</div><div class="ttdoc">TPI 2*Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00072">constants.F90:72</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a901f7b1f79c5c19a816eefcd51419864"><div class="ttname"><a href="namespacew3gdatmd.html#a901f7b1f79c5c19a816eefcd51419864">w3gdatmd::dpdy</a></div><div class="ttdeci">real, dimension(:,:), pointer dpdy</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01208">w3gdatmd.F90:1208</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a3b050f1196ad182ba44915b0c7bfb22f"><div class="ttname"><a href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">w3servmd::strace</a></div><div class="ttdeci">subroutine strace(IENT, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00148">w3servmd.F90:148</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html"><div class="ttname"><a href="namespacew3idatmd.html">w3idatmd</a></div><div class="ttdoc">Define data structures to set up wave model input data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00016">w3idatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a4551e9fa53585b84b3d1130dac7c0bac"><div class="ttname"><a href="namespacew3gdatmd.html#a4551e9fa53585b84b3d1130dac7c0bac">w3gdatmd::mapwn</a></div><div class="ttdeci">integer, dimension(:), pointer mapwn</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01231">w3gdatmd.F90:1231</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a786c419d2555ff81ae608ab9bcffd381"><div class="ttname"><a href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">w3gdatmd::xfr</a></div><div class="ttdeci">real, pointer xfr</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a16d621a05fe4a29f27135ab1d1709205"><div class="ttname"><a href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">w3gdatmd::flcy</a></div><div class="ttdeci">logical, pointer flcy</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a88c98f6be82c092c101a95de8067a79c"><div class="ttname"><a href="namespacew3adatmd.html#a88c98f6be82c092c101a95de8067a79c">w3adatmd::mapx2</a></div><div class="ttdeci">integer, dimension(:), pointer mapx2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00642">w3adatmd.F90:642</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a26759ceeed28f07100b31cab17d5c7ea"><div class="ttname"><a href="namespacew3gdatmd.html#a26759ceeed28f07100b31cab17d5c7ea">w3gdatmd::hpfac</a></div><div class="ttdeci">real, dimension(:,:), pointer hpfac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01211">w3gdatmd.F90:1211</a></div></div>
<div class="ttc" id="anamespacew3uqckmd_html"><div class="ttname"><a href="namespacew3uqckmd.html">w3uqckmd</a></div><div class="ttdoc">Portable ULTIMATE QUICKEST schemes.</div><div class="ttdef"><b>Definition:</b> <a href="w3uqckmd_8F90_source.html#l00014">w3uqckmd.F90:14</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ace4b7064f5b270ac5564b3484566042d"><div class="ttname"><a href="namespacew3gdatmd.html#ace4b7064f5b270ac5564b3484566042d">w3gdatmd::sx</a></div><div class="ttdeci">real, pointer sx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_abe07088ac5bfde0d0d6ea1d0860667c4"><div class="ttname"><a href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">w3odatmd::ndst</a></div><div class="ttdeci">integer, pointer ndst</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3uqckmd_html_a2b13171972fcf3105bf746164792491a"><div class="ttname"><a href="namespacew3uqckmd.html#a2b13171972fcf3105bf746164792491a">w3uqckmd::w3qck3</a></div><div class="ttdeci">subroutine w3qck3(MX, MY, NX, NY, CFLL, TRANS, Q, CLOSE, INC, MAPACT, NACT, MAPBOU, NB0, NB1, NB2, NDSE, NDST)</div><div class="ttdoc">Like W3QCK1 with cell transparencies added.</div><div class="ttdef"><b>Definition:</b> <a href="w3uqckmd_8F90_source.html#l00922">w3uqckmd.F90:922</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adc964175192aa2fdcbe615e5892effdd"><div class="ttname"><a href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">w3gdatmd::flcx</a></div><div class="ttdeci">logical, pointer flcx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3uqckmd_html_aad72b1a2ab82cf887f53356fa3cdc5fa"><div class="ttname"><a href="namespacew3uqckmd.html#aad72b1a2ab82cf887f53356fa3cdc5fa">w3uqckmd::w3qck1</a></div><div class="ttdeci">subroutine w3qck1(MX, MY, NX, NY, CFLL, Q, CLOSE, INC, MAPACT, NACT, MAPBOU, NB0, NB1, NB2, NDSE, NDST)</div><div class="ttdoc">Preform one-dimensional propagation in a two-dimensional space with irregular boundaries and regular ...</div><div class="ttdef"><b>Definition:</b> <a href="w3uqckmd_8F90_source.html#l00120">w3uqckmd.F90:120</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a6cb63a8ac68f3493928f2c2e3e1957d2"><div class="ttname"><a href="namespacew3adatmd.html#a6cb63a8ac68f3493928f2c2e3e1957d2">w3adatmd::nact</a></div><div class="ttdeci">integer, pointer nact</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a13dfe97ece07e7a4268b2aecd23155ae"><div class="ttname"><a href="namespacew3gdatmd.html#a13dfe97ece07e7a4268b2aecd23155ae">w3gdatmd::iclose_trpl</a></div><div class="ttdeci">integer, parameter iclose_trpl</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00631">w3gdatmd.F90:631</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a591a7728d28cafc51fc3a78240691ca8"><div class="ttname"><a href="namespacew3adatmd.html#a591a7728d28cafc51fc3a78240691ca8">w3adatmd::mapaxy</a></div><div class="ttdeci">integer, dimension(:), pointer mapaxy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00642">w3adatmd.F90:642</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_abd8542257a7c3f085db7e50a9a8c6b9f"><div class="ttname"><a href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">w3adatmd::itime</a></div><div class="ttdeci">integer, pointer itime</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00686">w3adatmd.F90:686</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a0921fce01b22aac74e85b8c8d3fa31f5"><div class="ttname"><a href="namespacew3adatmd.html#a0921fce01b22aac74e85b8c8d3fa31f5">w3adatmd::nmy1</a></div><div class="ttdeci">integer, pointer nmy1</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a4178ac42bb34594dc93048493285f293"><div class="ttname"><a href="namespacew3odatmd.html#a4178ac42bb34594dc93048493285f293">w3odatmd::isbpi</a></div><div class="ttdeci">integer, dimension(:), pointer isbpi</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00535">w3odatmd.F90:535</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_adbdb1141ab1c32ff98a6659229a7a75c"><div class="ttname"><a href="namespacew3adatmd.html#adbdb1141ab1c32ff98a6659229a7a75c">w3adatmd::nmy2</a></div><div class="ttdeci">integer, pointer nmy2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a14df2409ebe7f5f534e61e775d2c486f"><div class="ttname"><a href="namespacew3gdatmd.html#a14df2409ebe7f5f534e61e775d2c486f">w3gdatmd::ctmax</a></div><div class="ttdeci">real, pointer ctmax</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3timemd_html"><div class="ttname"><a href="namespacew3timemd.html">w3timemd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00003">w3timemd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a3e97b2fd492d964f38c2477ec052a0fb"><div class="ttname"><a href="namespacew3adatmd.html#a3e97b2fd492d964f38c2477ec052a0fb">w3adatmd::nmx1</a></div><div class="ttdeci">integer, pointer nmx1</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a51f1ec8cc14579d8c84dcd0df3e828d5"><div class="ttname"><a href="namespacew3adatmd.html#a51f1ec8cc14579d8c84dcd0df3e828d5">w3adatmd::nmy0</a></div><div class="ttdeci">integer, pointer nmy0</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a5cbed3f13d9dfa812a468e69b77b8271"><div class="ttname"><a href="namespacew3gdatmd.html#a5cbed3f13d9dfa812a468e69b77b8271">w3gdatmd::ec2</a></div><div class="ttdeci">real, dimension(:), pointer ec2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_abd608127ddae41a25988bc374c264315"><div class="ttname"><a href="namespacew3gdatmd.html#abd608127ddae41a25988bc374c264315">w3gdatmd::dtcfl</a></div><div class="ttdeci">real, pointer dtcfl</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_acfb3f8afdd57fcdc453f741fe5f88837"><div class="ttname"><a href="namespacew3gdatmd.html#acfb3f8afdd57fcdc453f741fe5f88837">w3gdatmd::iclose_smpl</a></div><div class="ttdeci">integer, parameter iclose_smpl</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00630">w3gdatmd.F90:630</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a48f5a8c6e0b5021a2b3a45089d4f9ed3"><div class="ttname"><a href="namespacew3adatmd.html#a48f5a8c6e0b5021a2b3a45089d4f9ed3">w3adatmd::nmxy</a></div><div class="ttdeci">integer, pointer nmxy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00640">w3adatmd.F90:640</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a49213843a86c0d5835e022e3182db6c4"><div class="ttname"><a href="namespacew3gdatmd.html#a49213843a86c0d5835e022e3182db6c4">w3gdatmd::dqdx</a></div><div class="ttdeci">real, dimension(:,:), pointer dqdx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01209">w3gdatmd.F90:1209</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a27ed315e4f5c61762387c7fae2eb0c38"><div class="ttname"><a href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">constants::grav</a></div><div class="ttdeci">real, parameter grav</div><div class="ttdoc">GRAV Acc.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00061">constants.F90:61</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a68b6874c578a6f4f569901fa57aa6657"><div class="ttname"><a href="namespacew3odatmd.html#a68b6874c578a6f4f569901fa57aa6657">w3odatmd::bbpin</a></div><div class="ttdeci">real, dimension(:,:), pointer bbpin</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00541">w3odatmd.F90:541</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aacc0010db11c3f9311b00a816a0e20c2"><div class="ttname"><a href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">w3gdatmd::flagll</a></div><div class="ttdeci">logical, pointer flagll</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01219">w3gdatmd.F90:1219</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacew3pro2md.html">w3pro2md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
