<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: m_xnldata Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacem__xnldata.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">m_xnldata Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module for computing the quadruplet interaction.  
<a href="namespacem__xnldata.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ab3cc0fe53cb7dc164d90dbb9f0745c36"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ab3cc0fe53cb7dc164d90dbb9f0745c36">xnl_init</a> (sigma, dird, nsigma, ndir, pftail, x_grav, depth, ndepth, iquad, iqgrid, iproc, ierr)</td></tr>
<tr class="memdesc:ab3cc0fe53cb7dc164d90dbb9f0745c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize coefficients, integration space, file i/o for computation nonlinear quadruplet wave-wave interaction.  <a href="namespacem__xnldata.html#ab3cc0fe53cb7dc164d90dbb9f0745c36">More...</a><br /></td></tr>
<tr class="separator:ab3cc0fe53cb7dc164d90dbb9f0745c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8b37be4003a263c0334436aabd8534"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2c8b37be4003a263c0334436aabd8534">xnl_main</a> (aspec, sigma, angle, nsig, ndir, depth, iquad, xnl, diag, iproc, ierr)</td></tr>
<tr class="memdesc:a2c8b37be4003a263c0334436aabd8534"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute nonlinear transfer for a given action density spectrum on a given sigma and direction grid (Webb/Resio/Tracy/Van Vledder).  <a href="namespacem__xnldata.html#a2c8b37be4003a263c0334436aabd8534">More...</a><br /></td></tr>
<tr class="separator:a2c8b37be4003a263c0334436aabd8534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06f36ef6a0e5d4fc4a984ec29bd922a0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a06f36ef6a0e5d4fc4a984ec29bd922a0">q_allocate</a></td></tr>
<tr class="memdesc:a06f36ef6a0e5d4fc4a984ec29bd922a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check configuration for non-linear transfer.  <a href="namespacem__xnldata.html#a06f36ef6a0e5d4fc4a984ec29bd922a0">More...</a><br /></td></tr>
<tr class="separator:a06f36ef6a0e5d4fc4a984ec29bd922a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91009035b1a175f20a05ad476c40efc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae91009035b1a175f20a05ad476c40efc">q_chkconfig</a></td></tr>
<tr class="memdesc:ae91009035b1a175f20a05ad476c40efc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check configuration for computation of non-linear transfer.  <a href="namespacem__xnldata.html#ae91009035b1a175f20a05ad476c40efc">More...</a><br /></td></tr>
<tr class="separator:ae91009035b1a175f20a05ad476c40efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85a2f67b2aa494b0cf93af1c893ed5c9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a85a2f67b2aa494b0cf93af1c893ed5c9">q_chkcons</a> (xnl, nk, ndir, sum_e, sum_a, sum_mx, sum_my)</td></tr>
<tr class="memdesc:a85a2f67b2aa494b0cf93af1c893ed5c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check conservation laws of non-linear transfer.  <a href="namespacem__xnldata.html#a85a2f67b2aa494b0cf93af1c893ed5c9">More...</a><br /></td></tr>
<tr class="separator:a85a2f67b2aa494b0cf93af1c893ed5c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3724a72fa0e8f60147e9a1ab2c48b0de"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3724a72fa0e8f60147e9a1ab2c48b0de">q_chkres</a> (<a class="el" href="namespacem__xnldata.html#a3acca3377ede458f0ba14e51d44b4847">k1x</a>, <a class="el" href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">k1y</a>, <a class="el" href="namespacem__xnldata.html#ae3691085cb58f456402d0f7cfe461f81">k2x</a>, <a class="el" href="namespacem__xnldata.html#a673397afc565764bdfff44ecc3086116">k2y</a>, <a class="el" href="namespacem__xnldata.html#a8df856343867fb5a121c86f605d6d53e">k3x</a>, <a class="el" href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">k3y</a>, <a class="el" href="namespacem__xnldata.html#a8616e7db84d163c9549bb3c9dd31b791">k4x</a>, <a class="el" href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">k4y</a>, dep, sum_kx, sum_ky, sum_w)</td></tr>
<tr class="memdesc:a3724a72fa0e8f60147e9a1ab2c48b0de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check resonance conditions of 4 interacting wave numbers for a given water depth and dispersion relation.  <a href="namespacem__xnldata.html#a3724a72fa0e8f60147e9a1ab2c48b0de">More...</a><br /></td></tr>
<tr class="separator:a3724a72fa0e8f60147e9a1ab2c48b0de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e4e67a61b220180d75a66edaefa86f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a82e4e67a61b220180d75a66edaefa86f">q_cmplocus</a> (ka, kb, km, kw, loclen)</td></tr>
<tr class="memdesc:a82e4e67a61b220180d75a66edaefa86f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute locus function used for the determination of the resonnance condition.  <a href="namespacem__xnldata.html#a82e4e67a61b220180d75a66edaefa86f">More...</a><br /></td></tr>
<tr class="separator:a82e4e67a61b220180d75a66edaefa86f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b2fd71e69508b41d04a3806be2f01e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad9b2fd71e69508b41d04a3806be2f01e">q_ctrgrid</a> (itask, igrid)</td></tr>
<tr class="memdesc:ad9b2fd71e69508b41d04a3806be2f01e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control of interaction grid administration.  <a href="namespacem__xnldata.html#ad9b2fd71e69508b41d04a3806be2f01e">More...</a><br /></td></tr>
<tr class="separator:ad9b2fd71e69508b41d04a3806be2f01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382336cfa41778cc7d72807f017225d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a382336cfa41778cc7d72807f017225d8">q_dscale</a> (n, sigma, angle, nsig, nang, depth, grav, q_dfac)</td></tr>
<tr class="memdesc:a382336cfa41778cc7d72807f017225d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute scaling factor for nonlinear transfer in finite depth.  <a href="namespacem__xnldata.html#a382336cfa41778cc7d72807f017225d8">More...</a><br /></td></tr>
<tr class="separator:a382336cfa41778cc7d72807f017225d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691fa6613a708672ce408f94a4c2cd9e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a691fa6613a708672ce408f94a4c2cd9e">q_error</a> (err_type, err_name, err_msg)</td></tr>
<tr class="memdesc:a691fa6613a708672ce408f94a4c2cd9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error handling routine.  <a href="namespacem__xnldata.html#a691fa6613a708672ce408f94a4c2cd9e">More...</a><br /></td></tr>
<tr class="separator:a691fa6613a708672ce408f94a4c2cd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5cdf4a9ea9f7d9101d1c4d26f7d7b2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#abb5cdf4a9ea9f7d9101d1c4d26f7d7b2">q_getlocus</a> (ik1, ia1, ik3, ia3, ifnd)</td></tr>
<tr class="memdesc:abb5cdf4a9ea9f7d9101d1c4d26f7d7b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve locus from basic locus as stored in the database.  <a href="namespacem__xnldata.html#abb5cdf4a9ea9f7d9101d1c4d26f7d7b2">More...</a><br /></td></tr>
<tr class="separator:abb5cdf4a9ea9f7d9101d1c4d26f7d7b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7634ad07c1f7c2fa732f432aecbd4203"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7634ad07c1f7c2fa732f432aecbd4203">q_init</a></td></tr>
<tr class="memdesc:a7634ad07c1f7c2fa732f432aecbd4203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializing module for quadruplets and setting default settings.  <a href="namespacem__xnldata.html#a7634ad07c1f7c2fa732f432aecbd4203">More...</a><br /></td></tr>
<tr class="separator:a7634ad07c1f7c2fa732f432aecbd4203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec7d7723e90833f240a89470fade91d2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aec7d7723e90833f240a89470fade91d2">q_locpos</a> (ka, kb, km, kw, loclen)</td></tr>
<tr class="memdesc:aec7d7723e90833f240a89470fade91d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute characteristics of locus used to optimize its acutal computation.  <a href="namespacem__xnldata.html#aec7d7723e90833f240a89470fade91d2">More...</a><br /></td></tr>
<tr class="separator:aec7d7723e90833f240a89470fade91d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f85863836ae28cb1da43540793e8137"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7f85863836ae28cb1da43540793e8137">q_makegrid</a></td></tr>
<tr class="memdesc:a7f85863836ae28cb1da43540793e8137"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set-up grid for computation of loci.  <a href="namespacem__xnldata.html#a7f85863836ae28cb1da43540793e8137">More...</a><br /></td></tr>
<tr class="separator:a7f85863836ae28cb1da43540793e8137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dc8d82ef264af5722dc4a689eff5efa"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0dc8d82ef264af5722dc4a689eff5efa">q_modify</a></td></tr>
<tr class="memdesc:a0dc8d82ef264af5722dc4a689eff5efa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify points along the locus, such that they are evenly distributed only when intended, i.e.  <a href="namespacem__xnldata.html#a0dc8d82ef264af5722dc4a689eff5efa">More...</a><br /></td></tr>
<tr class="separator:a0dc8d82ef264af5722dc4a689eff5efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff990bf181e455939b126f6129d8b172"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aff990bf181e455939b126f6129d8b172">q_polar2</a> (kmin, kmax, kx_beg, ky_beg, kx_end, ky_end, loclen, ierr)</td></tr>
<tr class="memdesc:aff990bf181e455939b126f6129d8b172"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute position of locus for given k1-k3 vector.  <a href="namespacem__xnldata.html#aff990bf181e455939b126f6129d8b172">More...</a><br /></td></tr>
<tr class="separator:aff990bf181e455939b126f6129d8b172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabdea20d05eb0859761876ad2cbaa00e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aabdea20d05eb0859761876ad2cbaa00e">q_setconfig</a> (iquad)</td></tr>
<tr class="memdesc:aabdea20d05eb0859761876ad2cbaa00e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set settings for computing the nonlinear interactions.  <a href="namespacem__xnldata.html#aabdea20d05eb0859761876ad2cbaa00e">More...</a><br /></td></tr>
<tr class="separator:aabdea20d05eb0859761876ad2cbaa00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9999672d3743c70f70d63179d3daa0f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa9999672d3743c70f70d63179d3daa0f">q_searchgrid</a> (depth, igrid)</td></tr>
<tr class="memdesc:aa9999672d3743c70f70d63179d3daa0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search nearest valid grid, read grid file and scale factor.  <a href="namespacem__xnldata.html#aa9999672d3743c70f70d63179d3daa0f">More...</a><br /></td></tr>
<tr class="separator:aa9999672d3743c70f70d63179d3daa0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a934cecc39521f8b4d683b755e8150d5e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a934cecc39521f8b4d683b755e8150d5e">q_setversion</a></td></tr>
<tr class="memdesc:a934cecc39521f8b4d683b755e8150d5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine has automatically been written by MODULE5.  <a href="namespacem__xnldata.html#a934cecc39521f8b4d683b755e8150d5e">More...</a><br /></td></tr>
<tr class="separator:a934cecc39521f8b4d683b755e8150d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20913fbb96d0c75d9f04d7c5ebd9b5e1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a20913fbb96d0c75d9f04d7c5ebd9b5e1">q_stack</a> (mod_name)</td></tr>
<tr class="memdesc:a20913fbb96d0c75d9f04d7c5ebd9b5e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add or remove mod_name name from module stack.  <a href="namespacem__xnldata.html#a20913fbb96d0c75d9f04d7c5ebd9b5e1">More...</a><br /></td></tr>
<tr class="separator:a20913fbb96d0c75d9f04d7c5ebd9b5e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6519a369a2938e895309f48a534cc555"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a6519a369a2938e895309f48a534cc555">q_summary</a></td></tr>
<tr class="memdesc:a6519a369a2938e895309f48a534cc555"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write summary of GurboQuad settings to print file.  <a href="namespacem__xnldata.html#a6519a369a2938e895309f48a534cc555">More...</a><br /></td></tr>
<tr class="separator:a6519a369a2938e895309f48a534cc555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8e77ddc1e4c7c8946c0e8b83d34ba4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3e8e77ddc1e4c7c8946c0e8b83d34ba4">q_symmetry</a> (<a class="el" href="namespacem__xnldata.html#a3acca3377ede458f0ba14e51d44b4847">k1x</a>, <a class="el" href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">k1y</a>, <a class="el" href="namespacem__xnldata.html#a8df856343867fb5a121c86f605d6d53e">k3x</a>, <a class="el" href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">k3y</a>, <a class="el" href="namespacem__xnldata.html#a8616e7db84d163c9549bb3c9dd31b791">k4x</a>, <a class="el" href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">k4y</a>, symfac, nloc)</td></tr>
<tr class="memdesc:a3e8e77ddc1e4c7c8946c0e8b83d34ba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute symmetry factor to reduce integration.  <a href="namespacem__xnldata.html#a3e8e77ddc1e4c7c8946c0e8b83d34ba4">More...</a><br /></td></tr>
<tr class="separator:a3e8e77ddc1e4c7c8946c0e8b83d34ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a865a6607dfe4d669645c8e55d7276b07"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a865a6607dfe4d669645c8e55d7276b07">q_t13v4</a> (ik1, ia1, ik3, ia3, t13, diagk1, diagk3)</td></tr>
<tr class="memdesc:a865a6607dfe4d669645c8e55d7276b07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the function T13, defined as a line integral around a locus.  <a href="namespacem__xnldata.html#a865a6607dfe4d669645c8e55d7276b07">More...</a><br /></td></tr>
<tr class="separator:a865a6607dfe4d669645c8e55d7276b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf81bd330e030f777b7d70abc2c7c446"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aaf81bd330e030f777b7d70abc2c7c446">q_weight</a></td></tr>
<tr class="memdesc:aaf81bd330e030f777b7d70abc2c7c446"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute interpolation weights of locus.  <a href="namespacem__xnldata.html#aaf81bd330e030f777b7d70abc2c7c446">More...</a><br /></td></tr>
<tr class="separator:aaf81bd330e030f777b7d70abc2c7c446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3bc59bcf3d34464be37d304e2760999"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac3bc59bcf3d34464be37d304e2760999">q_loc_w1w3</a> (<a class="el" href="namespacem__xnldata.html#a3acca3377ede458f0ba14e51d44b4847">k1x</a>, <a class="el" href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">k1y</a>, <a class="el" href="namespacem__xnldata.html#a8df856343867fb5a121c86f605d6d53e">k3x</a>, <a class="el" href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">k3y</a>, npts, <a class="el" href="namespacem__xnldata.html#ae3691085cb58f456402d0f7cfe461f81">k2x</a>, <a class="el" href="namespacem__xnldata.html#a673397afc565764bdfff44ecc3086116">k2y</a>, <a class="el" href="namespacem__xnldata.html#a8616e7db84d163c9549bb3c9dd31b791">k4x</a>, <a class="el" href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">k4y</a>, s)</td></tr>
<tr class="memdesc:ac3bc59bcf3d34464be37d304e2760999"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute locus for the special case w1=w3.  <a href="namespacem__xnldata.html#ac3bc59bcf3d34464be37d304e2760999">More...</a><br /></td></tr>
<tr class="separator:ac3bc59bcf3d34464be37d304e2760999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad49a87dce1650e20728b0f0e97057b2e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad49a87dce1650e20728b0f0e97057b2e">q_xnl4v4</a> (aspec, sigma, angle, nsig, nang, depth, xnl, diag, ierr)</td></tr>
<tr class="memdesc:ad49a87dce1650e20728b0f0e97057b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute nonlinear transfer for a given action density spectrum on a given wave number and direction grid.  <a href="namespacem__xnldata.html#ad49a87dce1650e20728b0f0e97057b2e">More...</a><br /></td></tr>
<tr class="separator:ad49a87dce1650e20728b0f0e97057b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654fb0a4a323900296af94bd7af057fd"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a654fb0a4a323900296af94bd7af057fd">x_cosk</a> (k)</td></tr>
<tr class="memdesc:a654fb0a4a323900296af94bd7af057fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute cosine of points on locus for given wave number k.  <a href="namespacem__xnldata.html#a654fb0a4a323900296af94bd7af057fd">More...</a><br /></td></tr>
<tr class="separator:a654fb0a4a323900296af94bd7af057fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1dc4bf29edc9de63dd9305afa474b20"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa1dc4bf29edc9de63dd9305afa474b20">x_cple</a> (<a class="el" href="namespacem__xnldata.html#a3acca3377ede458f0ba14e51d44b4847">k1x</a>, <a class="el" href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">k1y</a>, <a class="el" href="namespacem__xnldata.html#ae3691085cb58f456402d0f7cfe461f81">k2x</a>, <a class="el" href="namespacem__xnldata.html#a673397afc565764bdfff44ecc3086116">k2y</a>, <a class="el" href="namespacem__xnldata.html#a8df856343867fb5a121c86f605d6d53e">k3x</a>, <a class="el" href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">k3y</a>, <a class="el" href="namespacem__xnldata.html#a8616e7db84d163c9549bb3c9dd31b791">k4x</a>, <a class="el" href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">k4y</a>, <a class="el" href="namespacem__xnldata.html#a67d944a61847c21805cd528b7ed4e0a4">iq_cple</a>, depth, grav)</td></tr>
<tr class="memdesc:aa1dc4bf29edc9de63dd9305afa474b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute coupling coefficient between a quadruplet of interacting wave numbers.  <a href="namespacem__xnldata.html#aa1dc4bf29edc9de63dd9305afa474b20">More...</a><br /></td></tr>
<tr class="separator:aa1dc4bf29edc9de63dd9305afa474b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7ec991e56d49470958f6c9328f032f"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aca7ec991e56d49470958f6c9328f032f">x_flocus</a> (kxx, kyy)</td></tr>
<tr class="memdesc:aca7ec991e56d49470958f6c9328f032f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute locus function used for the determination of the resonance condition.  <a href="namespacem__xnldata.html#aca7ec991e56d49470958f6c9328f032f">More...</a><br /></td></tr>
<tr class="separator:aca7ec991e56d49470958f6c9328f032f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af8e1924217154416189d2cdd36b0e5"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5af8e1924217154416189d2cdd36b0e5">x_jacobian</a> (x2, y2, x4, y4)</td></tr>
<tr class="memdesc:a5af8e1924217154416189d2cdd36b0e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute gradient/Jacobian term for a given point on the locus.  <a href="namespacem__xnldata.html#a5af8e1924217154416189d2cdd36b0e5">More...</a><br /></td></tr>
<tr class="separator:a5af8e1924217154416189d2cdd36b0e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1fac66b5fff77cec64e90162e00f6a"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aef1fac66b5fff77cec64e90162e00f6a">x_disper</a> (k, d)</td></tr>
<tr class="memdesc:aef1fac66b5fff77cec64e90162e00f6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute radian frequency for a given wave number and water depth.  <a href="namespacem__xnldata.html#aef1fac66b5fff77cec64e90162e00f6a">More...</a><br /></td></tr>
<tr class="separator:aef1fac66b5fff77cec64e90162e00f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11f2da0fc3eec799805be1f4e1add7a"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ab11f2da0fc3eec799805be1f4e1add7a">x_locus1</a> (k2)</td></tr>
<tr class="memdesc:ab11f2da0fc3eec799805be1f4e1add7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute locus function along symmetry axis.  <a href="namespacem__xnldata.html#ab11f2da0fc3eec799805be1f4e1add7a">More...</a><br /></td></tr>
<tr class="separator:ab11f2da0fc3eec799805be1f4e1add7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada00f656eb5b3155b94a1ff88440a7af"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ada00f656eb5b3155b94a1ff88440a7af">x_locus2</a> (lambda)</td></tr>
<tr class="memdesc:ada00f656eb5b3155b94a1ff88440a7af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute locus function perpendicluar to symmetry axis.  <a href="namespacem__xnldata.html#ada00f656eb5b3155b94a1ff88440a7af">More...</a><br /></td></tr>
<tr class="separator:ada00f656eb5b3155b94a1ff88440a7af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f34c165b6e8ab48f315cdcbf3d8f58a"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1f34c165b6e8ab48f315cdcbf3d8f58a">xc_hh</a> (w1x0, w1y0, w2x0, w2y0, w3x0, w3y0, z4x, z4y, h)</td></tr>
<tr class="memdesc:a1f34c165b6e8ab48f315cdcbf3d8f58a"><td class="mdescLeft">&#160;</td><td class="mdescRight">N/A.  <a href="namespacem__xnldata.html#a1f34c165b6e8ab48f315cdcbf3d8f58a">More...</a><br /></td></tr>
<tr class="separator:a1f34c165b6e8ab48f315cdcbf3d8f58a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d">tanz</a> (x)</td></tr>
<tr class="memdesc:a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">N/A.  <a href="namespacem__xnldata.html#a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d">More...</a><br /></td></tr>
<tr class="separator:a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3157ab62f07552878f496e4ebca8daa7"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3157ab62f07552878f496e4ebca8daa7">cosz</a> (x)</td></tr>
<tr class="memdesc:a3157ab62f07552878f496e4ebca8daa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">N/A.  <a href="namespacem__xnldata.html#a3157ab62f07552878f496e4ebca8daa7">More...</a><br /></td></tr>
<tr class="separator:a3157ab62f07552878f496e4ebca8daa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6950f90ceb2167a9b4ffdd4eaf2bc16e"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a6950f90ceb2167a9b4ffdd4eaf2bc16e">xc_webb</a> (<a class="el" href="namespacem__xnldata.html#a3acca3377ede458f0ba14e51d44b4847">k1x</a>, <a class="el" href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">k1y</a>, <a class="el" href="namespacem__xnldata.html#ae3691085cb58f456402d0f7cfe461f81">k2x</a>, <a class="el" href="namespacem__xnldata.html#a673397afc565764bdfff44ecc3086116">k2y</a>, <a class="el" href="namespacem__xnldata.html#a8df856343867fb5a121c86f605d6d53e">k3x</a>, <a class="el" href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">k3y</a>, <a class="el" href="namespacem__xnldata.html#a8616e7db84d163c9549bb3c9dd31b791">k4x</a>, <a class="el" href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">k4y</a>, grav)</td></tr>
<tr class="memdesc:a6950f90ceb2167a9b4ffdd4eaf2bc16e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute deep water coupling coefficient for non-linear quadruplet interactions.  <a href="namespacem__xnldata.html#a6950f90ceb2167a9b4ffdd4eaf2bc16e">More...</a><br /></td></tr>
<tr class="separator:a6950f90ceb2167a9b4ffdd4eaf2bc16e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af861a71e902542f5524190c427fc0c76"><td class="memItemLeft" align="right" valign="top">character(len=60)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af861a71e902542f5524190c427fc0c76">q_version</a></td></tr>
<tr class="memdesc:af861a71e902542f5524190c427fc0c76"><td class="mdescLeft">&#160;</td><td class="mdescRight">version string  <a href="namespacem__xnldata.html#af861a71e902542f5524190c427fc0c76">More...</a><br /></td></tr>
<tr class="separator:af861a71e902542f5524190c427fc0c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45eaee06940165c682e7897301a8a706"><td class="memItemLeft" align="right" valign="top">character(len=20)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a45eaee06940165c682e7897301a8a706">sub_name</a></td></tr>
<tr class="memdesc:a45eaee06940165c682e7897301a8a706"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of active subroutine.  <a href="namespacem__xnldata.html#a45eaee06940165c682e7897301a8a706">More...</a><br /></td></tr>
<tr class="separator:a45eaee06940165c682e7897301a8a706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afccd3d55f6be4945f4957410cc8e6013"><td class="memItemLeft" align="right" valign="top">character(len=20)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#afccd3d55f6be4945f4957410cc8e6013">qbase</a></td></tr>
<tr class="memdesc:afccd3d55f6be4945f4957410cc8e6013"><td class="mdescLeft">&#160;</td><td class="mdescRight">base name for I/O files  <a href="namespacem__xnldata.html#afccd3d55f6be4945f4957410cc8e6013">More...</a><br /></td></tr>
<tr class="separator:afccd3d55f6be4945f4957410cc8e6013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43500618bd9c257312f55cc1870094f9"><td class="memItemLeft" align="right" valign="top">character(len=20)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a43500618bd9c257312f55cc1870094f9">qf_error</a></td></tr>
<tr class="memdesc:a43500618bd9c257312f55cc1870094f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">name of file with error messages  <a href="namespacem__xnldata.html#a43500618bd9c257312f55cc1870094f9">More...</a><br /></td></tr>
<tr class="separator:a43500618bd9c257312f55cc1870094f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d24e90b920b4e71c3da78825c60a13c"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1d24e90b920b4e71c3da78825c60a13c">iufind</a></td></tr>
<tr class="memdesc:a1d24e90b920b4e71c3da78825c60a13c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specifies handling of unit numbers, see Z_FILEIO.  <a href="namespacem__xnldata.html#a1d24e90b920b4e71c3da78825c60a13c">More...</a><br /></td></tr>
<tr class="separator:a1d24e90b920b4e71c3da78825c60a13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca2bd5d5e6eafbeb66a65072acb065d"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#acca2bd5d5e6eafbeb66a65072acb065d">iscreen</a></td></tr>
<tr class="memdesc:acca2bd5d5e6eafbeb66a65072acb065d"><td class="mdescLeft">&#160;</td><td class="mdescRight">identifier for screen, set in XNL_INIT  <a href="namespacem__xnldata.html#acca2bd5d5e6eafbeb66a65072acb065d">More...</a><br /></td></tr>
<tr class="separator:acca2bd5d5e6eafbeb66a65072acb065d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc20f07b42814fd02171cdb4307ae2d5"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#adc20f07b42814fd02171cdb4307ae2d5">luq_bqf</a></td></tr>
<tr class="memdesc:adc20f07b42814fd02171cdb4307ae2d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">binary file storing and retrieving precomputed loci  <a href="namespacem__xnldata.html#adc20f07b42814fd02171cdb4307ae2d5">More...</a><br /></td></tr>
<tr class="separator:adc20f07b42814fd02171cdb4307ae2d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2acd9b30aca3d7e0475ec8582f23b236"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2acd9b30aca3d7e0475ec8582f23b236">luq_cfg</a></td></tr>
<tr class="memdesc:a2acd9b30aca3d7e0475ec8582f23b236"><td class="mdescLeft">&#160;</td><td class="mdescRight">user defined configuration  <a href="namespacem__xnldata.html#a2acd9b30aca3d7e0475ec8582f23b236">More...</a><br /></td></tr>
<tr class="separator:a2acd9b30aca3d7e0475ec8582f23b236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad41073b37810f66db5ca6367a15cb7e"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aad41073b37810f66db5ca6367a15cb7e">luq_err</a></td></tr>
<tr class="memdesc:aad41073b37810f66db5ca6367a15cb7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">file with error messages  <a href="namespacem__xnldata.html#aad41073b37810f66db5ca6367a15cb7e">More...</a><br /></td></tr>
<tr class="separator:aad41073b37810f66db5ca6367a15cb7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21651d79bd4d62c1d07b524a62007bea"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a21651d79bd4d62c1d07b524a62007bea">luq_fil</a></td></tr>
<tr class="memdesc:a21651d79bd4d62c1d07b524a62007bea"><td class="mdescLeft">&#160;</td><td class="mdescRight">test output for filtering  <a href="namespacem__xnldata.html#a21651d79bd4d62c1d07b524a62007bea">More...</a><br /></td></tr>
<tr class="separator:a21651d79bd4d62c1d07b524a62007bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf9a9f09de8a4e162e5f24e7a6bda2a5"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#adf9a9f09de8a4e162e5f24e7a6bda2a5">luq_grd</a></td></tr>
<tr class="memdesc:adf9a9f09de8a4e162e5f24e7a6bda2a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">ASCII file storing and retrieving precomputed loci.  <a href="namespacem__xnldata.html#adf9a9f09de8a4e162e5f24e7a6bda2a5">More...</a><br /></td></tr>
<tr class="separator:adf9a9f09de8a4e162e5f24e7a6bda2a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a1e6b4cf40069be1bfe42393b374f9"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad9a1e6b4cf40069be1bfe42393b374f9">luq_int</a></td></tr>
<tr class="memdesc:ad9a1e6b4cf40069be1bfe42393b374f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">test file for test output of integration  <a href="namespacem__xnldata.html#ad9a1e6b4cf40069be1bfe42393b374f9">More...</a><br /></td></tr>
<tr class="separator:ad9a1e6b4cf40069be1bfe42393b374f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa37c58de84119f966e1bb23c61639319"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa37c58de84119f966e1bb23c61639319">luq_loc</a></td></tr>
<tr class="memdesc:aa37c58de84119f966e1bb23c61639319"><td class="mdescLeft">&#160;</td><td class="mdescRight">statistics about computed loci  <a href="namespacem__xnldata.html#aa37c58de84119f966e1bb23c61639319">More...</a><br /></td></tr>
<tr class="separator:aa37c58de84119f966e1bb23c61639319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ec49dfc7d79d18380bdeebd1dd94852"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1ec49dfc7d79d18380bdeebd1dd94852">luq_log</a></td></tr>
<tr class="memdesc:a1ec49dfc7d79d18380bdeebd1dd94852"><td class="mdescLeft">&#160;</td><td class="mdescRight">logging  <a href="namespacem__xnldata.html#a1ec49dfc7d79d18380bdeebd1dd94852">More...</a><br /></td></tr>
<tr class="separator:a1ec49dfc7d79d18380bdeebd1dd94852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ff6ed69e78c7163ddfd4899d903dff7"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8ff6ed69e78c7163ddfd4899d903dff7">luq_prt</a></td></tr>
<tr class="memdesc:a8ff6ed69e78c7163ddfd4899d903dff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">general print file for quadruplets  <a href="namespacem__xnldata.html#a8ff6ed69e78c7163ddfd4899d903dff7">More...</a><br /></td></tr>
<tr class="separator:a8ff6ed69e78c7163ddfd4899d903dff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2301404cba01dec0bafd86109736084"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac2301404cba01dec0bafd86109736084">luq_trf</a></td></tr>
<tr class="memdesc:ac2301404cba01dec0bafd86109736084"><td class="mdescLeft">&#160;</td><td class="mdescRight">testing transformation of loci  <a href="namespacem__xnldata.html#ac2301404cba01dec0bafd86109736084">More...</a><br /></td></tr>
<tr class="separator:ac2301404cba01dec0bafd86109736084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe947eb3c1c57d59e46ef98216f981e1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#afe947eb3c1c57d59e46ef98216f981e1">luq_tst</a></td></tr>
<tr class="memdesc:afe947eb3c1c57d59e46ef98216f981e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">test file for quadruplets  <a href="namespacem__xnldata.html#afe947eb3c1c57d59e46ef98216f981e1">More...</a><br /></td></tr>
<tr class="separator:afe947eb3c1c57d59e46ef98216f981e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8360cc8137e23947c0961b9c2779ed34"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8360cc8137e23947c0961b9c2779ed34">luq_txt</a></td></tr>
<tr class="memdesc:a8360cc8137e23947c0961b9c2779ed34"><td class="mdescLeft">&#160;</td><td class="mdescRight">reading (error) text file  <a href="namespacem__xnldata.html#a8360cc8137e23947c0961b9c2779ed34">More...</a><br /></td></tr>
<tr class="separator:a8360cc8137e23947c0961b9c2779ed34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a789882ef4e35c7e29b420b598e3c8"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac8a789882ef4e35c7e29b420b598e3c8">luq_t13</a></td></tr>
<tr class="memdesc:ac8a789882ef4e35c7e29b420b598e3c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">test of basis integration  <a href="namespacem__xnldata.html#ac8a789882ef4e35c7e29b420b598e3c8">More...</a><br /></td></tr>
<tr class="separator:ac8a789882ef4e35c7e29b420b598e3c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aaf6eee0e395f218469687e95f562e0"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9aaf6eee0e395f218469687e95f562e0">q_grav</a></td></tr>
<tr class="memdesc:a9aaf6eee0e395f218469687e95f562e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">gravitational acceleration (Earth = 9.81 m/s^2)  <a href="namespacem__xnldata.html#a9aaf6eee0e395f218469687e95f562e0">More...</a><br /></td></tr>
<tr class="separator:a9aaf6eee0e395f218469687e95f562e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a545f769cfbe27f5b40b37b1ca9229f43"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a545f769cfbe27f5b40b37b1ca9229f43">qf_tail</a></td></tr>
<tr class="memdesc:a545f769cfbe27f5b40b37b1ca9229f43"><td class="mdescLeft">&#160;</td><td class="mdescRight">power of spectral tail of E(f), e.g.  <a href="namespacem__xnldata.html#a545f769cfbe27f5b40b37b1ca9229f43">More...</a><br /></td></tr>
<tr class="separator:a545f769cfbe27f5b40b37b1ca9229f43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49e22f19e05ef43d0328cb1e2e84360e"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a49e22f19e05ef43d0328cb1e2e84360e">qf_krat</a></td></tr>
<tr class="memdesc:a49e22f19e05ef43d0328cb1e2e84360e"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum ratio of the interacting wave numbers k1 and k3  <a href="namespacem__xnldata.html#a49e22f19e05ef43d0328cb1e2e84360e">More...</a><br /></td></tr>
<tr class="separator:a49e22f19e05ef43d0328cb1e2e84360e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d34e8bb37044cf35eadd59e74223f21"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9d34e8bb37044cf35eadd59e74223f21">qf_dmax</a></td></tr>
<tr class="memdesc:a9d34e8bb37044cf35eadd59e74223f21"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum directional difference between k1 and k3  <a href="namespacem__xnldata.html#a9d34e8bb37044cf35eadd59e74223f21">More...</a><br /></td></tr>
<tr class="separator:a9d34e8bb37044cf35eadd59e74223f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6b21684aa8aef92a21fb613083a1683"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af6b21684aa8aef92a21fb613083a1683">qf_frac</a></td></tr>
<tr class="memdesc:af6b21684aa8aef92a21fb613083a1683"><td class="mdescLeft">&#160;</td><td class="mdescRight">fraction of maximum action density to filter  <a href="namespacem__xnldata.html#af6b21684aa8aef92a21fb613083a1683">More...</a><br /></td></tr>
<tr class="separator:af6b21684aa8aef92a21fb613083a1683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ef35cb3c4c3f59f9cd2526d51a4015"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac5ef35cb3c4c3f59f9cd2526d51a4015">iq_compact</a></td></tr>
<tr class="memdesc:ac5ef35cb3c4c3f59f9cd2526d51a4015"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to compact data == 0, do not compact == 1, compact data by elimiting zero contribution along locus  <a href="namespacem__xnldata.html#ac5ef35cb3c4c3f59f9cd2526d51a4015">More...</a><br /></td></tr>
<tr class="separator:ac5ef35cb3c4c3f59f9cd2526d51a4015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d944a61847c21805cd528b7ed4e0a4"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a67d944a61847c21805cd528b7ed4e0a4">iq_cple</a></td></tr>
<tr class="memdesc:a67d944a61847c21805cd528b7ed4e0a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of coupling coefficient == 1, deep water coefficient of Webb == 2, deep water coefficient of Zakharov == 3, finite depth coefficient of Hasselmann &amp; Herterich == 4, finite depth coefficient of Zakharov == 5, finite depth coefficient of Lin &amp; Perrie  <a href="namespacem__xnldata.html#a67d944a61847c21805cd528b7ed4e0a4">More...</a><br /></td></tr>
<tr class="separator:a67d944a61847c21805cd528b7ed4e0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97aa90a6e3636d0cf087fa71bcd3ecf7"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a97aa90a6e3636d0cf087fa71bcd3ecf7">iq_disp</a></td></tr>
<tr class="memdesc:a97aa90a6e3636d0cf087fa71bcd3ecf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of dispersion relation, viz.  <a href="namespacem__xnldata.html#a97aa90a6e3636d0cf087fa71bcd3ecf7">More...</a><br /></td></tr>
<tr class="separator:a97aa90a6e3636d0cf087fa71bcd3ecf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5abca5ce688ed9ed858f221127f9aad"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad5abca5ce688ed9ed858f221127f9aad">iq_dscale</a></td></tr>
<tr class="memdesc:ad5abca5ce688ed9ed858f221127f9aad"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate depth scaling according to Herterich and Hasselmann == 0, No depth scaling == 1, depth scaling activated  <a href="namespacem__xnldata.html#ad5abca5ce688ed9ed858f221127f9aad">More...</a><br /></td></tr>
<tr class="separator:ad5abca5ce688ed9ed858f221127f9aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1488327ff947517df554b614e71f087"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af1488327ff947517df554b614e71f087">iq_filt</a></td></tr>
<tr class="memdesc:af1488327ff947517df554b614e71f087"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate filtering in wave number space ==0, no filtering ==1, filtering activated  <a href="namespacem__xnldata.html#af1488327ff947517df554b614e71f087">More...</a><br /></td></tr>
<tr class="separator:af1488327ff947517df554b614e71f087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a19e31070fd12506b069cf5705884f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a07a19e31070fd12506b069cf5705884f">iq_gauleg</a></td></tr>
<tr class="memdesc:a07a19e31070fd12506b069cf5705884f"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch for Gauss-Legendre interpolation == 0, No Gauss-Legendre, default </p><blockquote class="doxtable">
<p>0 Gauss-Legendre, iq_gauleg is number of points </p>
</blockquote>
 <a href="namespacem__xnldata.html#a07a19e31070fd12506b069cf5705884f">More...</a><br /></td></tr>
<tr class="separator:a07a19e31070fd12506b069cf5705884f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53c4732528d3821d8b0048bc9e5d37a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa53c4732528d3821d8b0048bc9e5d37a">iq_geom</a></td></tr>
<tr class="memdesc:aa53c4732528d3821d8b0048bc9e5d37a"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of scaling == 0, no geometric scaling, only directional scaling of loci == 1, geometric scaling using Resio/Tracy method only possible in the case IQ_DISP=1  <a href="namespacem__xnldata.html#aa53c4732528d3821d8b0048bc9e5d37a">More...</a><br /></td></tr>
<tr class="separator:aa53c4732528d3821d8b0048bc9e5d37a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3658e1cbc6870ef53e061cc72036c8"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aef3658e1cbc6870ef53e061cc72036c8">iq_grid</a></td></tr>
<tr class="memdesc:aef3658e1cbc6870ef53e061cc72036c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of spectral grid == 1, sector &amp; symmetric around zero == 2, sector &amp; symmetric around zero &amp; non-symmetric == 3, full circle &amp; non-symmetric  <a href="namespacem__xnldata.html#aef3658e1cbc6870ef53e061cc72036c8">More...</a><br /></td></tr>
<tr class="separator:aef3658e1cbc6870ef53e061cc72036c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963143023740f28785564d46ed2fbcd5"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a963143023740f28785564d46ed2fbcd5">iq_integ</a></td></tr>
<tr class="memdesc:a963143023740f28785564d46ed2fbcd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">option to output integration results ==0 no output of integration ==1 only sum per locus ==2 also information per point on locus ==3 only basic line integrals  <a href="namespacem__xnldata.html#a963143023740f28785564d46ed2fbcd5">More...</a><br /></td></tr>
<tr class="separator:a963143023740f28785564d46ed2fbcd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed682103bd094932e26dfa253bdb4b17"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aed682103bd094932e26dfa253bdb4b17">iq_interp</a></td></tr>
<tr class="memdesc:aed682103bd094932e26dfa253bdb4b17"><td class="mdescLeft">&#160;</td><td class="mdescRight">type of interpolation to retrieve action density == 1, bi-linear interpolation in discrete spectrum (default) == 2, take nearest bins, on the basis of maximum weight  <a href="namespacem__xnldata.html#aed682103bd094932e26dfa253bdb4b17">More...</a><br /></td></tr>
<tr class="separator:aed682103bd094932e26dfa253bdb4b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02eb3cd3792091fbecb91aa0ba4f377f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a02eb3cd3792091fbecb91aa0ba4f377f">iq_locus</a></td></tr>
<tr class="memdesc:a02eb3cd3792091fbecb91aa0ba4f377f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Option for computation of locus ==1, explicit polar method with fixed k-step ==2, explicit polar method with adpative k-stepping ==3, explicit polar method with geometric k-spacing.  <a href="namespacem__xnldata.html#a02eb3cd3792091fbecb91aa0ba4f377f">More...</a><br /></td></tr>
<tr class="separator:a02eb3cd3792091fbecb91aa0ba4f377f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26b22f0d60d8da52d1ac23e994ffb933"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a26b22f0d60d8da52d1ac23e994ffb933">iq_log</a></td></tr>
<tr class="memdesc:a26b22f0d60d8da52d1ac23e994ffb933"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate logging to file QBASE//.LOG == 0, No print output == 1, print output  <a href="namespacem__xnldata.html#a26b22f0d60d8da52d1ac23e994ffb933">More...</a><br /></td></tr>
<tr class="separator:a26b22f0d60d8da52d1ac23e994ffb933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c7d003be1fb5c2aa2fca658ff2cc25"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a06c7d003be1fb5c2aa2fca658ff2cc25">iq_lump</a></td></tr>
<tr class="memdesc:a06c7d003be1fb5c2aa2fca658ff2cc25"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate lumping on locus == 0, No lumping == 1, Lumping along locus  <a href="namespacem__xnldata.html#a06c7d003be1fb5c2aa2fca658ff2cc25">More...</a><br /></td></tr>
<tr class="separator:a06c7d003be1fb5c2aa2fca658ff2cc25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f7f4edb872ea6752263882485507d5"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad6f7f4edb872ea6752263882485507d5">iq_make</a></td></tr>
<tr class="memdesc:ad6f7f4edb872ea6752263882485507d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">option to make quadruplet grid == 1, make when needed (default) == 2, always make quadruplet grid == 3, only make grid file  <a href="namespacem__xnldata.html#ad6f7f4edb872ea6752263882485507d5">More...</a><br /></td></tr>
<tr class="separator:ad6f7f4edb872ea6752263882485507d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9ea4aacc4d0b48d749a5405e14b908"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aab9ea4aacc4d0b48d749a5405e14b908">iq_mod</a></td></tr>
<tr class="memdesc:aab9ea4aacc4d0b48d749a5405e14b908"><td class="mdescLeft">&#160;</td><td class="mdescRight">option to redistribute points on locus == 0, Points will be used as computed by tracing algortihm == 1, Equi-distant spacing on points along locus (NLOC1)  <a href="namespacem__xnldata.html#aab9ea4aacc4d0b48d749a5405e14b908">More...</a><br /></td></tr>
<tr class="separator:aab9ea4aacc4d0b48d749a5405e14b908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d202f34d86298cd2963b740974bee7f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0d202f34d86298cd2963b740974bee7f">iq_prt</a></td></tr>
<tr class="memdesc:a0d202f34d86298cd2963b740974bee7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate print output, to file QBASE//.PRT == 0, No print output == 1, print output  <a href="namespacem__xnldata.html#a0d202f34d86298cd2963b740974bee7f">More...</a><br /></td></tr>
<tr class="separator:a0d202f34d86298cd2963b740974bee7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa99286d05e9868b1eaa97f90a9e18e1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#afa99286d05e9868b1eaa97f90a9e18e1">iq_search</a></td></tr>
<tr class="memdesc:afa99286d05e9868b1eaa97f90a9e18e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to determine search for a proper grid == 0, no search is carried out == 1, search nearest (relative) interaction grid  <a href="namespacem__xnldata.html#afa99286d05e9868b1eaa97f90a9e18e1">More...</a><br /></td></tr>
<tr class="separator:afa99286d05e9868b1eaa97f90a9e18e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50f40339e2bb037c73f2997ebae6008b"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a50f40339e2bb037c73f2997ebae6008b">iq_screen</a></td></tr>
<tr class="memdesc:a50f40339e2bb037c73f2997ebae6008b"><td class="mdescLeft">&#160;</td><td class="mdescRight">option to send output to the screen == 0, no output is send to screen == 1, output is send to screen  <a href="namespacem__xnldata.html#a50f40339e2bb037c73f2997ebae6008b">More...</a><br /></td></tr>
<tr class="separator:a50f40339e2bb037c73f2997ebae6008b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aade281f03901b3f16bd2c1498c0138f7"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aade281f03901b3f16bd2c1498c0138f7">iq_sym</a></td></tr>
<tr class="memdesc:aade281f03901b3f16bd2c1498c0138f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate use of symmetry reduction == 0, no symmetries are used == 1, symmetry activated (default)  <a href="namespacem__xnldata.html#aade281f03901b3f16bd2c1498c0138f7">More...</a><br /></td></tr>
<tr class="separator:aade281f03901b3f16bd2c1498c0138f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff335314701f2a997cf281b8ef24333e"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aff335314701f2a997cf281b8ef24333e">iq_test</a></td></tr>
<tr class="memdesc:aff335314701f2a997cf281b8ef24333e"><td class="mdescLeft">&#160;</td><td class="mdescRight">test level, output is directed to unit luqtst == 0, no test output == 1, output of basic I/O == 2, extensive test output  <a href="namespacem__xnldata.html#aff335314701f2a997cf281b8ef24333e">More...</a><br /></td></tr>
<tr class="separator:aff335314701f2a997cf281b8ef24333e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ea24b2a8c955c8cde114315c77f181"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ab2ea24b2a8c955c8cde114315c77f181">iq_trace</a></td></tr>
<tr class="memdesc:ab2ea24b2a8c955c8cde114315c77f181"><td class="mdescLeft">&#160;</td><td class="mdescRight">trace option == 0, no trace of subroutine calls </p><blockquote class="doxtable">
<p>0, maximum number of traces per subroutine </p>
</blockquote>
<p>&lt; 0, as for &gt;0 but now output is send to the screen  <a href="namespacem__xnldata.html#ab2ea24b2a8c955c8cde114315c77f181">More...</a><br /></td></tr>
<tr class="separator:ab2ea24b2a8c955c8cde114315c77f181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb85d5631ab20957d133ecf6557af63f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#abb85d5631ab20957d133ecf6557af63f">iq_trf</a></td></tr>
<tr class="memdesc:abb85d5631ab20957d133ecf6557af63f"><td class="mdescLeft">&#160;</td><td class="mdescRight">option to print transformed loci to special output file == 0, no output to data file unit luqtrf == 1, test output from routine Q_GETLOCUS  <a href="namespacem__xnldata.html#abb85d5631ab20957d133ecf6557af63f">More...</a><br /></td></tr>
<tr class="separator:abb85d5631ab20957d133ecf6557af63f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c38e70a1d9d4e22f79a1cd0bcc0094b"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2c38e70a1d9d4e22f79a1cd0bcc0094b">iq_t13</a></td></tr>
<tr class="memdesc:a2c38e70a1d9d4e22f79a1cd0bcc0094b"><td class="mdescLeft">&#160;</td><td class="mdescRight">option to output T13 integration ==0, no output ==1, test output of T13 per locus  <a href="namespacem__xnldata.html#a2c38e70a1d9d4e22f79a1cd0bcc0094b">More...</a><br /></td></tr>
<tr class="separator:a2c38e70a1d9d4e22f79a1cd0bcc0094b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ee14fd57aa10dee1011d596d345b5b3"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3ee14fd57aa10dee1011d596d345b5b3">iq_xdia</a></td></tr>
<tr class="memdesc:a3ee14fd57aa10dee1011d596d345b5b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">switch to activate output to extended DIA data file == 0, no output </p><blockquote class="doxtable">
<p>0, output to data file, but only when lumping is also </p>
</blockquote>
<p>activated  <a href="namespacem__xnldata.html#a3ee14fd57aa10dee1011d596d345b5b3">More...</a><br /></td></tr>
<tr class="separator:a3ee14fd57aa10dee1011d596d345b5b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208db23596f1f54ac998e0089dc1dde0"><td class="memItemLeft" align="right" valign="top">character(len=13)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a208db23596f1f54ac998e0089dc1dde0">aqname</a></td></tr>
<tr class="memdesc:a208db23596f1f54ac998e0089dc1dde0"><td class="mdescLeft">&#160;</td><td class="mdescRight">name of ASCII grid file  <a href="namespacem__xnldata.html#a208db23596f1f54ac998e0089dc1dde0">More...</a><br /></td></tr>
<tr class="separator:a208db23596f1f54ac998e0089dc1dde0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d6dd55b735613145f97a2bbf6f134e"><td class="memItemLeft" align="right" valign="top">character(len=13)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a07d6dd55b735613145f97a2bbf6f134e">bqname</a></td></tr>
<tr class="memdesc:a07d6dd55b735613145f97a2bbf6f134e"><td class="mdescLeft">&#160;</td><td class="mdescRight">name of binary quadruplet grid file  <a href="namespacem__xnldata.html#a07d6dd55b735613145f97a2bbf6f134e">More...</a><br /></td></tr>
<tr class="separator:a07d6dd55b735613145f97a2bbf6f134e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eff2120543a7c553e1ba636c6659115"><td class="memItemLeft" align="right" valign="top">character(len=13)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7eff2120543a7c553e1ba636c6659115">lastquadfile</a></td></tr>
<tr class="memdesc:a7eff2120543a7c553e1ba636c6659115"><td class="mdescLeft">&#160;</td><td class="mdescRight">name of last retrieved BQF file  <a href="namespacem__xnldata.html#a7eff2120543a7c553e1ba636c6659115">More...</a><br /></td></tr>
<tr class="separator:a7eff2120543a7c553e1ba636c6659115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d0ddfe44e1fba307f78c25c198a702b"><td class="memItemLeft" align="right" valign="top">character(len=21)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2d0ddfe44e1fba307f78c25c198a702b">q_header</a></td></tr>
<tr class="memdesc:a2d0ddfe44e1fba307f78c25c198a702b"><td class="mdescLeft">&#160;</td><td class="mdescRight">header of Binary Quadruplet File as intended in BQF-file  <a href="namespacem__xnldata.html#a2d0ddfe44e1fba307f78c25c198a702b">More...</a><br /></td></tr>
<tr class="separator:a2d0ddfe44e1fba307f78c25c198a702b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fdbfa6e56865892df31cc3295d9ea62"><td class="memItemLeft" align="right" valign="top">character(len=21)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a4fdbfa6e56865892df31cc3295d9ea62">r_header</a></td></tr>
<tr class="memdesc:a4fdbfa6e56865892df31cc3295d9ea62"><td class="mdescLeft">&#160;</td><td class="mdescRight">header of Binary Quadruplet File as exists in BQF-file  <a href="namespacem__xnldata.html#a4fdbfa6e56865892df31cc3295d9ea62">More...</a><br /></td></tr>
<tr class="separator:a4fdbfa6e56865892df31cc3295d9ea62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0463f0d2fdbf7d9652f8a1fd28ed95"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#acf0463f0d2fdbf7d9652f8a1fd28ed95">lq_grid</a></td></tr>
<tr class="memdesc:acf0463f0d2fdbf7d9652f8a1fd28ed95"><td class="mdescLeft">&#160;</td><td class="mdescRight">flag to make (new) interaction grid  <a href="namespacem__xnldata.html#acf0463f0d2fdbf7d9652f8a1fd28ed95">More...</a><br /></td></tr>
<tr class="separator:acf0463f0d2fdbf7d9652f8a1fd28ed95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d8e58f049a74249c26e826c42ea746"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac2d8e58f049a74249c26e826c42ea746">nkq</a></td></tr>
<tr class="memdesc:ac2d8e58f049a74249c26e826c42ea746"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of wave numbers of quad-grid  <a href="namespacem__xnldata.html#ac2d8e58f049a74249c26e826c42ea746">More...</a><br /></td></tr>
<tr class="separator:ac2d8e58f049a74249c26e826c42ea746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a892097baba649c18e166ba6ca3790627"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a892097baba649c18e166ba6ca3790627">naq</a></td></tr>
<tr class="memdesc:a892097baba649c18e166ba6ca3790627"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of angles of quad-grad  <a href="namespacem__xnldata.html#a892097baba649c18e166ba6ca3790627">More...</a><br /></td></tr>
<tr class="separator:a892097baba649c18e166ba6ca3790627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594939a0849f6bdbacb759322e2c6f3a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a594939a0849f6bdbacb759322e2c6f3a">ncirc</a></td></tr>
<tr class="memdesc:a594939a0849f6bdbacb759322e2c6f3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of angles on a full circle  <a href="namespacem__xnldata.html#a594939a0849f6bdbacb759322e2c6f3a">More...</a><br /></td></tr>
<tr class="separator:a594939a0849f6bdbacb759322e2c6f3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d95f61b9aa30b6b59b4f81559583fae"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9d95f61b9aa30b6b59b4f81559583fae">ia_k1</a></td></tr>
<tr class="separator:a9d95f61b9aa30b6b59b4f81559583fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29a58de9fb76932127349a1cd74d69a7"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a29a58de9fb76932127349a1cd74d69a7">ik_k1</a></td></tr>
<tr class="memdesc:a29a58de9fb76932127349a1cd74d69a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">indices of main loop variables  <a href="namespacem__xnldata.html#a29a58de9fb76932127349a1cd74d69a7">More...</a><br /></td></tr>
<tr class="separator:a29a58de9fb76932127349a1cd74d69a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a187d24cac99e72ac6164a44954ed1a2e"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a187d24cac99e72ac6164a44954ed1a2e">ia_k3</a></td></tr>
<tr class="separator:a187d24cac99e72ac6164a44954ed1a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef32702236c90408ad3ce954dc923979"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aef32702236c90408ad3ce954dc923979">ik_k3</a></td></tr>
<tr class="memdesc:aef32702236c90408ad3ce954dc923979"><td class="mdescLeft">&#160;</td><td class="mdescRight">indices of main loop variables  <a href="namespacem__xnldata.html#aef32702236c90408ad3ce954dc923979">More...</a><br /></td></tr>
<tr class="separator:aef32702236c90408ad3ce954dc923979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08a2f20cdabbc8461b0f0c1fa2c8a85c"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a08a2f20cdabbc8461b0f0c1fa2c8a85c">fqmin</a></td></tr>
<tr class="memdesc:a08a2f20cdabbc8461b0f0c1fa2c8a85c"><td class="mdescLeft">&#160;</td><td class="mdescRight">lowest frequency in Hz  <a href="namespacem__xnldata.html#a08a2f20cdabbc8461b0f0c1fa2c8a85c">More...</a><br /></td></tr>
<tr class="separator:a08a2f20cdabbc8461b0f0c1fa2c8a85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e456df1bcd0a78e0c5a091e4803620b"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a6e456df1bcd0a78e0c5a091e4803620b">fqmax</a></td></tr>
<tr class="memdesc:a6e456df1bcd0a78e0c5a091e4803620b"><td class="mdescLeft">&#160;</td><td class="mdescRight">highest frequency in Hz  <a href="namespacem__xnldata.html#a6e456df1bcd0a78e0c5a091e4803620b">More...</a><br /></td></tr>
<tr class="separator:a6e456df1bcd0a78e0c5a091e4803620b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d80238233004e27de64b1c08d14741"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a07d80238233004e27de64b1c08d14741">q_sector</a></td></tr>
<tr class="memdesc:a07d80238233004e27de64b1c08d14741"><td class="mdescLeft">&#160;</td><td class="mdescRight">half plane width in degrees (for iq_grid=1,2)  <a href="namespacem__xnldata.html#a07d80238233004e27de64b1c08d14741">More...</a><br /></td></tr>
<tr class="separator:a07d80238233004e27de64b1c08d14741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc7dbb0f9ee0c9ff2187b836a7daf98"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2dc7dbb0f9ee0c9ff2187b836a7daf98">q_dstep</a></td></tr>
<tr class="memdesc:a2dc7dbb0f9ee0c9ff2187b836a7daf98"><td class="mdescLeft">&#160;</td><td class="mdescRight">step size for generating BQF files  <a href="namespacem__xnldata.html#a2dc7dbb0f9ee0c9ff2187b836a7daf98">More...</a><br /></td></tr>
<tr class="separator:a2dc7dbb0f9ee0c9ff2187b836a7daf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e28829b99a12aa264b615a27367c90"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a59e28829b99a12aa264b615a27367c90">mq_stack</a> =10</td></tr>
<tr class="memdesc:a59e28829b99a12aa264b615a27367c90"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum number of elements in stack  <a href="namespacem__xnldata.html#a59e28829b99a12aa264b615a27367c90">More...</a><br /></td></tr>
<tr class="separator:a59e28829b99a12aa264b615a27367c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa3be0ccc65d9dfcc19980a7965b6d9"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aefa3be0ccc65d9dfcc19980a7965b6d9">mlocus</a></td></tr>
<tr class="memdesc:aefa3be0ccc65d9dfcc19980a7965b6d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum number of points on locus for defining arrays  <a href="namespacem__xnldata.html#aefa3be0ccc65d9dfcc19980a7965b6d9">More...</a><br /></td></tr>
<tr class="separator:aefa3be0ccc65d9dfcc19980a7965b6d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25da92c2f4d1c9b2d64fc2f6180cd71b"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a25da92c2f4d1c9b2d64fc2f6180cd71b">nlocus0</a></td></tr>
<tr class="memdesc:a25da92c2f4d1c9b2d64fc2f6180cd71b"><td class="mdescLeft">&#160;</td><td class="mdescRight">preferred number of points on locus  <a href="namespacem__xnldata.html#a25da92c2f4d1c9b2d64fc2f6180cd71b">More...</a><br /></td></tr>
<tr class="separator:a25da92c2f4d1c9b2d64fc2f6180cd71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a164925e899cc3811d6e67e27a6444668"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a164925e899cc3811d6e67e27a6444668">nlocus1</a></td></tr>
<tr class="memdesc:a164925e899cc3811d6e67e27a6444668"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of points on locus as computed in Q_CMPLOCUS  <a href="namespacem__xnldata.html#a164925e899cc3811d6e67e27a6444668">More...</a><br /></td></tr>
<tr class="separator:a164925e899cc3811d6e67e27a6444668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a3f517e3a651d8c58f341c843623cd9"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9a3f517e3a651d8c58f341c843623cd9">klocus</a></td></tr>
<tr class="memdesc:a9a3f517e3a651d8c58f341c843623cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of points on locus as stored in quadruplet database based on nlocus0, iq_gauleg and iq_lump (without compacting) used in Q_ALLOCATE to define size of data arrays  <a href="namespacem__xnldata.html#a9a3f517e3a651d8c58f341c843623cd9">More...</a><br /></td></tr>
<tr class="separator:a9a3f517e3a651d8c58f341c843623cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35d60e16256ccf677d998690848893e1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a35d60e16256ccf677d998690848893e1">nlocus</a></td></tr>
<tr class="memdesc:a35d60e16256ccf677d998690848893e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of points on locus, equal to klocus  <a href="namespacem__xnldata.html#a35d60e16256ccf677d998690848893e1">More...</a><br /></td></tr>
<tr class="separator:a35d60e16256ccf677d998690848893e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b999bfd5e20c548574dfbe58a5b6757"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5b999bfd5e20c548574dfbe58a5b6757">nlocusx</a></td></tr>
<tr class="memdesc:a5b999bfd5e20c548574dfbe58a5b6757"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of points on locus for use in computation (nlocusx &lt;= nlocus)  <a href="namespacem__xnldata.html#a5b999bfd5e20c548574dfbe58a5b6757">More...</a><br /></td></tr>
<tr class="separator:a5b999bfd5e20c548574dfbe58a5b6757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab603fdb5c4cef293ad21277b732d1e0f"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ab603fdb5c4cef293ad21277b732d1e0f">kqmin</a></td></tr>
<tr class="memdesc:ab603fdb5c4cef293ad21277b732d1e0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">lowest wave number  <a href="namespacem__xnldata.html#ab603fdb5c4cef293ad21277b732d1e0f">More...</a><br /></td></tr>
<tr class="separator:ab603fdb5c4cef293ad21277b732d1e0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08ff074f6a5223b539887fa77119ad14"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a08ff074f6a5223b539887fa77119ad14">kqmax</a></td></tr>
<tr class="memdesc:a08ff074f6a5223b539887fa77119ad14"><td class="mdescLeft">&#160;</td><td class="mdescRight">highest wave number  <a href="namespacem__xnldata.html#a08ff074f6a5223b539887fa77119ad14">More...</a><br /></td></tr>
<tr class="separator:a08ff074f6a5223b539887fa77119ad14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c848f54117cbb5d484d5147a1e5e45c"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5c848f54117cbb5d484d5147a1e5e45c">wk_max</a></td></tr>
<tr class="memdesc:a5c848f54117cbb5d484d5147a1e5e45c"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum weight for wave number interpolation, set in Q_INIT  <a href="namespacem__xnldata.html#a5c848f54117cbb5d484d5147a1e5e45c">More...</a><br /></td></tr>
<tr class="separator:a5c848f54117cbb5d484d5147a1e5e45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab6d1a00ffe8a6c91896110c640ff402"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aab6d1a00ffe8a6c91896110c640ff402">k0x</a></td></tr>
<tr class="separator:aab6d1a00ffe8a6c91896110c640ff402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a041751cc824cafdaf24624ff5af0fb69"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a041751cc824cafdaf24624ff5af0fb69">k0y</a></td></tr>
<tr class="separator:a041751cc824cafdaf24624ff5af0fb69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0911bce8e3812ac7c74e5de1f63fa7c4"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0911bce8e3812ac7c74e5de1f63fa7c4">dk0</a></td></tr>
<tr class="memdesc:a0911bce8e3812ac7c74e5de1f63fa7c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of initial wave number of locus,  <a href="namespacem__xnldata.html#a0911bce8e3812ac7c74e5de1f63fa7c4">More...</a><br /></td></tr>
<tr class="separator:a0911bce8e3812ac7c74e5de1f63fa7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95356901458fad47880a7c10d4efd04d"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a95356901458fad47880a7c10d4efd04d">krefx</a></td></tr>
<tr class="separator:a95356901458fad47880a7c10d4efd04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8dc502f4817710ba1ac75e73fa7fc5"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5d8dc502f4817710ba1ac75e73fa7fc5">krefy</a></td></tr>
<tr class="memdesc:a5d8dc502f4817710ba1ac75e73fa7fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of reference wave number for quad-grid  <a href="namespacem__xnldata.html#a5d8dc502f4817710ba1ac75e73fa7fc5">More...</a><br /></td></tr>
<tr class="separator:a5d8dc502f4817710ba1ac75e73fa7fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acca3377ede458f0ba14e51d44b4847"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3acca3377ede458f0ba14e51d44b4847">k1x</a></td></tr>
<tr class="separator:a3acca3377ede458f0ba14e51d44b4847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2558671eeb48c3f059553bf7e16e792"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">k1y</a></td></tr>
<tr class="memdesc:ae2558671eeb48c3f059553bf7e16e792"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of k1 wave number  <a href="namespacem__xnldata.html#ae2558671eeb48c3f059553bf7e16e792">More...</a><br /></td></tr>
<tr class="separator:ae2558671eeb48c3f059553bf7e16e792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3691085cb58f456402d0f7cfe461f81"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae3691085cb58f456402d0f7cfe461f81">k2x</a></td></tr>
<tr class="separator:ae3691085cb58f456402d0f7cfe461f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673397afc565764bdfff44ecc3086116"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a673397afc565764bdfff44ecc3086116">k2y</a></td></tr>
<tr class="memdesc:a673397afc565764bdfff44ecc3086116"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of k2 wave number  <a href="namespacem__xnldata.html#a673397afc565764bdfff44ecc3086116">More...</a><br /></td></tr>
<tr class="separator:a673397afc565764bdfff44ecc3086116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df856343867fb5a121c86f605d6d53e"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8df856343867fb5a121c86f605d6d53e">k3x</a></td></tr>
<tr class="separator:a8df856343867fb5a121c86f605d6d53e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e85dbc26336ce6fe32b37724c157f9c"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">k3y</a></td></tr>
<tr class="memdesc:a9e85dbc26336ce6fe32b37724c157f9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of k3 wave number  <a href="namespacem__xnldata.html#a9e85dbc26336ce6fe32b37724c157f9c">More...</a><br /></td></tr>
<tr class="separator:a9e85dbc26336ce6fe32b37724c157f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8616e7db84d163c9549bb3c9dd31b791"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8616e7db84d163c9549bb3c9dd31b791">k4x</a></td></tr>
<tr class="separator:a8616e7db84d163c9549bb3c9dd31b791"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4561119545155572e7f65e06d0d4508a"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">k4y</a></td></tr>
<tr class="memdesc:a4561119545155572e7f65e06d0d4508a"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of k4 wave number  <a href="namespacem__xnldata.html#a4561119545155572e7f65e06d0d4508a">More...</a><br /></td></tr>
<tr class="separator:a4561119545155572e7f65e06d0d4508a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aeb9d65457d61b7580470a3225da822"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2aeb9d65457d61b7580470a3225da822">px</a></td></tr>
<tr class="separator:a2aeb9d65457d61b7580470a3225da822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e9e4a82f3786e8d671bdbf12e6dd2c2"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8e9e4a82f3786e8d671bdbf12e6dd2c2">py</a></td></tr>
<tr class="memdesc:a8e9e4a82f3786e8d671bdbf12e6dd2c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">components of difference k1-k3 wave number  <a href="namespacem__xnldata.html#a8e9e4a82f3786e8d671bdbf12e6dd2c2">More...</a><br /></td></tr>
<tr class="separator:a8e9e4a82f3786e8d671bdbf12e6dd2c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fc0d051acac56c9ee6e7703854e487"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a88fc0d051acac56c9ee6e7703854e487">pmag</a></td></tr>
<tr class="memdesc:a88fc0d051acac56c9ee6e7703854e487"><td class="mdescLeft">&#160;</td><td class="mdescRight">magnitude of P-vector  <a href="namespacem__xnldata.html#a88fc0d051acac56c9ee6e7703854e487">More...</a><br /></td></tr>
<tr class="separator:a88fc0d051acac56c9ee6e7703854e487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf9102cbc1070153da7ef11c935e680"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5bf9102cbc1070153da7ef11c935e680">pang</a></td></tr>
<tr class="memdesc:a5bf9102cbc1070153da7ef11c935e680"><td class="mdescLeft">&#160;</td><td class="mdescRight">angle related of P-vector, Pang = atan2(py,px), (radians)  <a href="namespacem__xnldata.html#a5bf9102cbc1070153da7ef11c935e680">More...</a><br /></td></tr>
<tr class="separator:a5bf9102cbc1070153da7ef11c935e680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af54cda4c0a294b2beab6e9d01fffd534"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af54cda4c0a294b2beab6e9d01fffd534">sang</a></td></tr>
<tr class="memdesc:af54cda4c0a294b2beab6e9d01fffd534"><td class="mdescLeft">&#160;</td><td class="mdescRight">angle of symmytry axis of locus, SANG = PANG +/ pi (radians)  <a href="namespacem__xnldata.html#af54cda4c0a294b2beab6e9d01fffd534">More...</a><br /></td></tr>
<tr class="separator:af54cda4c0a294b2beab6e9d01fffd534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce5be605e29382f48a7cf8c9184b5ec"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7ce5be605e29382f48a7cf8c9184b5ec">xang</a></td></tr>
<tr class="memdesc:a7ce5be605e29382f48a7cf8c9184b5ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">angle of locus for the case that w1=w3, Xang=atan2(-px,py), (radians)  <a href="namespacem__xnldata.html#a7ce5be605e29382f48a7cf8c9184b5ec">More...</a><br /></td></tr>
<tr class="separator:a7ce5be605e29382f48a7cf8c9184b5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a135db6bb97ae1e726b67be80c0facc85"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a135db6bb97ae1e726b67be80c0facc85">q</a></td></tr>
<tr class="memdesc:a135db6bb97ae1e726b67be80c0facc85"><td class="mdescLeft">&#160;</td><td class="mdescRight">difference of radian frequencies, used in Resio-Tracy method  <a href="namespacem__xnldata.html#a135db6bb97ae1e726b67be80c0facc85">More...</a><br /></td></tr>
<tr class="separator:a135db6bb97ae1e726b67be80c0facc85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c7faae7970cb9c5be136a678b53e4a0"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1c7faae7970cb9c5be136a678b53e4a0">kmin_loc</a></td></tr>
<tr class="memdesc:a1c7faae7970cb9c5be136a678b53e4a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">minimum wave number of locus along symmetry axis  <a href="namespacem__xnldata.html#a1c7faae7970cb9c5be136a678b53e4a0">More...</a><br /></td></tr>
<tr class="separator:a1c7faae7970cb9c5be136a678b53e4a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8339223e9dc7b7b2b0fd4d873b9992c8"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8339223e9dc7b7b2b0fd4d873b9992c8">kmax_loc</a></td></tr>
<tr class="memdesc:a8339223e9dc7b7b2b0fd4d873b9992c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum wave number of locus along symmetry axis  <a href="namespacem__xnldata.html#a8339223e9dc7b7b2b0fd4d873b9992c8">More...</a><br /></td></tr>
<tr class="separator:a8339223e9dc7b7b2b0fd4d873b9992c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd31eece3f4e587d0bf9c3e33d49306"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#affd31eece3f4e587d0bf9c3e33d49306">kmid</a></td></tr>
<tr class="memdesc:affd31eece3f4e587d0bf9c3e33d49306"><td class="mdescLeft">&#160;</td><td class="mdescRight">wave number at midpoint of locus along symmetry axis  <a href="namespacem__xnldata.html#affd31eece3f4e587d0bf9c3e33d49306">More...</a><br /></td></tr>
<tr class="separator:affd31eece3f4e587d0bf9c3e33d49306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a149291bfacd3886cd7f72f919ea1a787"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a149291bfacd3886cd7f72f919ea1a787">kmidx</a></td></tr>
<tr class="memdesc:a149291bfacd3886cd7f72f919ea1a787"><td class="mdescLeft">&#160;</td><td class="mdescRight">x-component of wave number at midpoint of locus along symmetry axis  <a href="namespacem__xnldata.html#a149291bfacd3886cd7f72f919ea1a787">More...</a><br /></td></tr>
<tr class="separator:a149291bfacd3886cd7f72f919ea1a787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5e532e6483bc2bed978b4955bf07c3"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aed5e532e6483bc2bed978b4955bf07c3">kmidy</a></td></tr>
<tr class="memdesc:aed5e532e6483bc2bed978b4955bf07c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">y-component of wave number at midpoint of locus along symmetry axis  <a href="namespacem__xnldata.html#aed5e532e6483bc2bed978b4955bf07c3">More...</a><br /></td></tr>
<tr class="separator:aed5e532e6483bc2bed978b4955bf07c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b525effd10d546626b2ebc6628336f2"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2b525effd10d546626b2ebc6628336f2">loc_crf</a></td></tr>
<tr class="memdesc:a2b525effd10d546626b2ebc6628336f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">circumference of locus in (kx,ky)-space  <a href="namespacem__xnldata.html#a2b525effd10d546626b2ebc6628336f2">More...</a><br /></td></tr>
<tr class="separator:a2b525effd10d546626b2ebc6628336f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af991e25b021da4285ba22b9f677c34a5"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af991e25b021da4285ba22b9f677c34a5">loc_area</a></td></tr>
<tr class="memdesc:af991e25b021da4285ba22b9f677c34a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">area of locus, measured in (kx-ky)- space  <a href="namespacem__xnldata.html#af991e25b021da4285ba22b9f677c34a5">More...</a><br /></td></tr>
<tr class="separator:af991e25b021da4285ba22b9f677c34a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c39966f160780b68a982388b3b730c4"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7c39966f160780b68a982388b3b730c4">loc_xz</a></td></tr>
<tr class="memdesc:a7c39966f160780b68a982388b3b730c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">x-coordinate of center of gravity of locus in (kx,ky)-space  <a href="namespacem__xnldata.html#a7c39966f160780b68a982388b3b730c4">More...</a><br /></td></tr>
<tr class="separator:a7c39966f160780b68a982388b3b730c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20adeb936abb79f88d17054ae4b34dc5"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a20adeb936abb79f88d17054ae4b34dc5">loc_yz</a></td></tr>
<tr class="memdesc:a20adeb936abb79f88d17054ae4b34dc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">y-coordinate of center of gravity of locus in (kx,ky)-space  <a href="namespacem__xnldata.html#a20adeb936abb79f88d17054ae4b34dc5">More...</a><br /></td></tr>
<tr class="separator:a20adeb936abb79f88d17054ae4b34dc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c6570d8fa72ab30ad2a445a7486e60"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a28c6570d8fa72ab30ad2a445a7486e60">quad_nloc</a></td></tr>
<tr class="memdesc:a28c6570d8fa72ab30ad2a445a7486e60"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of points on locus  <a href="namespacem__xnldata.html#a28c6570d8fa72ab30ad2a445a7486e60">More...</a><br /></td></tr>
<tr class="separator:a28c6570d8fa72ab30ad2a445a7486e60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab423cfec06bb252849d4885942eb48"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3ab423cfec06bb252849d4885942eb48">quad_ik2</a></td></tr>
<tr class="memdesc:a3ab423cfec06bb252849d4885942eb48"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower wave number index of k2  <a href="namespacem__xnldata.html#a3ab423cfec06bb252849d4885942eb48">More...</a><br /></td></tr>
<tr class="separator:a3ab423cfec06bb252849d4885942eb48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74919ffb265b571762fc979f259d1bd"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac74919ffb265b571762fc979f259d1bd">quad_ia2</a></td></tr>
<tr class="memdesc:ac74919ffb265b571762fc979f259d1bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower direction index of k2  <a href="namespacem__xnldata.html#ac74919ffb265b571762fc979f259d1bd">More...</a><br /></td></tr>
<tr class="separator:ac74919ffb265b571762fc979f259d1bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa602bfc167b9ac4f557cee27f86d60fd"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa602bfc167b9ac4f557cee27f86d60fd">quad_ik4</a></td></tr>
<tr class="memdesc:aa602bfc167b9ac4f557cee27f86d60fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower wave number index of k4  <a href="namespacem__xnldata.html#aa602bfc167b9ac4f557cee27f86d60fd">More...</a><br /></td></tr>
<tr class="separator:aa602bfc167b9ac4f557cee27f86d60fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb30d1c8b2816175237b40558570a961"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aeb30d1c8b2816175237b40558570a961">quad_ia4</a></td></tr>
<tr class="memdesc:aeb30d1c8b2816175237b40558570a961"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower direction index of k4  <a href="namespacem__xnldata.html#aeb30d1c8b2816175237b40558570a961">More...</a><br /></td></tr>
<tr class="separator:aeb30d1c8b2816175237b40558570a961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af170a30466441836902d5b264e98c368"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af170a30466441836902d5b264e98c368">quad_w1k2</a></td></tr>
<tr class="memdesc:af170a30466441836902d5b264e98c368"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 1 of k2  <a href="namespacem__xnldata.html#af170a30466441836902d5b264e98c368">More...</a><br /></td></tr>
<tr class="separator:af170a30466441836902d5b264e98c368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2e57572040fa7681ea211168a7f971"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9a2e57572040fa7681ea211168a7f971">quad_w2k2</a></td></tr>
<tr class="memdesc:a9a2e57572040fa7681ea211168a7f971"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 2 of k2  <a href="namespacem__xnldata.html#a9a2e57572040fa7681ea211168a7f971">More...</a><br /></td></tr>
<tr class="separator:a9a2e57572040fa7681ea211168a7f971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a446449eec8f6973b036be85737f3f68b"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a446449eec8f6973b036be85737f3f68b">quad_w3k2</a></td></tr>
<tr class="memdesc:a446449eec8f6973b036be85737f3f68b"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 3 of k2  <a href="namespacem__xnldata.html#a446449eec8f6973b036be85737f3f68b">More...</a><br /></td></tr>
<tr class="separator:a446449eec8f6973b036be85737f3f68b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a969afbebcaa1d38ec5a8264837fdc014"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a969afbebcaa1d38ec5a8264837fdc014">quad_w4k2</a></td></tr>
<tr class="memdesc:a969afbebcaa1d38ec5a8264837fdc014"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 4 of k2  <a href="namespacem__xnldata.html#a969afbebcaa1d38ec5a8264837fdc014">More...</a><br /></td></tr>
<tr class="separator:a969afbebcaa1d38ec5a8264837fdc014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9543d0ea33d2ba1e00d6cbaf2669d6"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7e9543d0ea33d2ba1e00d6cbaf2669d6">quad_w1k4</a></td></tr>
<tr class="memdesc:a7e9543d0ea33d2ba1e00d6cbaf2669d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 1 of k4  <a href="namespacem__xnldata.html#a7e9543d0ea33d2ba1e00d6cbaf2669d6">More...</a><br /></td></tr>
<tr class="separator:a7e9543d0ea33d2ba1e00d6cbaf2669d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0dd352ac7a4715f12ffecae748fa16a"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa0dd352ac7a4715f12ffecae748fa16a">quad_w2k4</a></td></tr>
<tr class="memdesc:aa0dd352ac7a4715f12ffecae748fa16a"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 2 of k4  <a href="namespacem__xnldata.html#aa0dd352ac7a4715f12ffecae748fa16a">More...</a><br /></td></tr>
<tr class="separator:aa0dd352ac7a4715f12ffecae748fa16a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cccb2914229cf1a10530f5b7a101090"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a4cccb2914229cf1a10530f5b7a101090">quad_w3k4</a></td></tr>
<tr class="memdesc:a4cccb2914229cf1a10530f5b7a101090"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 3 of k4  <a href="namespacem__xnldata.html#a4cccb2914229cf1a10530f5b7a101090">More...</a><br /></td></tr>
<tr class="separator:a4cccb2914229cf1a10530f5b7a101090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a988994539cabf60fd92a75283f29c0af"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a988994539cabf60fd92a75283f29c0af">quad_w4k4</a></td></tr>
<tr class="memdesc:a988994539cabf60fd92a75283f29c0af"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight 4 of k4  <a href="namespacem__xnldata.html#a988994539cabf60fd92a75283f29c0af">More...</a><br /></td></tr>
<tr class="separator:a988994539cabf60fd92a75283f29c0af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313db439cc038063c7e44fd04b418cd2"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a313db439cc038063c7e44fd04b418cd2">quad_zz</a></td></tr>
<tr class="memdesc:a313db439cc038063c7e44fd04b418cd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">compound product of cple*ds*sym/jac  <a href="namespacem__xnldata.html#a313db439cc038063c7e44fd04b418cd2">More...</a><br /></td></tr>
<tr class="separator:a313db439cc038063c7e44fd04b418cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b8aa077cb0729373172c97f167e3a8"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a73b8aa077cb0729373172c97f167e3a8">x2_loc</a></td></tr>
<tr class="memdesc:a73b8aa077cb0729373172c97f167e3a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">k2x coordinates around locus  <a href="namespacem__xnldata.html#a73b8aa077cb0729373172c97f167e3a8">More...</a><br /></td></tr>
<tr class="separator:a73b8aa077cb0729373172c97f167e3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda9c4812401c8b56b5e04f22ca98785"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#acda9c4812401c8b56b5e04f22ca98785">y2_loc</a></td></tr>
<tr class="memdesc:acda9c4812401c8b56b5e04f22ca98785"><td class="mdescLeft">&#160;</td><td class="mdescRight">k2y coordinates around locus  <a href="namespacem__xnldata.html#acda9c4812401c8b56b5e04f22ca98785">More...</a><br /></td></tr>
<tr class="separator:acda9c4812401c8b56b5e04f22ca98785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2549291b6942c5223a7d019b8ac1c246"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2549291b6942c5223a7d019b8ac1c246">z_loc</a></td></tr>
<tr class="memdesc:a2549291b6942c5223a7d019b8ac1c246"><td class="mdescLeft">&#160;</td><td class="mdescRight">data value around locus  <a href="namespacem__xnldata.html#a2549291b6942c5223a7d019b8ac1c246">More...</a><br /></td></tr>
<tr class="separator:a2549291b6942c5223a7d019b8ac1c246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21a9a8bdc1e181d31080c3b8083d3fbc"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a21a9a8bdc1e181d31080c3b8083d3fbc">s_loc</a></td></tr>
<tr class="memdesc:a21a9a8bdc1e181d31080c3b8083d3fbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">coordinate along locus  <a href="namespacem__xnldata.html#a21a9a8bdc1e181d31080c3b8083d3fbc">More...</a><br /></td></tr>
<tr class="separator:a21a9a8bdc1e181d31080c3b8083d3fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab7b9888db6a273809757c3c6e367dc8"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aab7b9888db6a273809757c3c6e367dc8">x4_loc</a></td></tr>
<tr class="memdesc:aab7b9888db6a273809757c3c6e367dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">k4x coordinates around locus  <a href="namespacem__xnldata.html#aab7b9888db6a273809757c3c6e367dc8">More...</a><br /></td></tr>
<tr class="separator:aab7b9888db6a273809757c3c6e367dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b48f6fffce333c05365b889e43d9dc"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae0b48f6fffce333c05365b889e43d9dc">y4_loc</a></td></tr>
<tr class="memdesc:ae0b48f6fffce333c05365b889e43d9dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">k4y coordinates around locus  <a href="namespacem__xnldata.html#ae0b48f6fffce333c05365b889e43d9dc">More...</a><br /></td></tr>
<tr class="separator:ae0b48f6fffce333c05365b889e43d9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad872c37e7886dcd19fd8953cc3b17645"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad872c37e7886dcd19fd8953cc3b17645">ds_loc</a></td></tr>
<tr class="memdesc:ad872c37e7886dcd19fd8953cc3b17645"><td class="mdescLeft">&#160;</td><td class="mdescRight">step size around locus  <a href="namespacem__xnldata.html#ad872c37e7886dcd19fd8953cc3b17645">More...</a><br /></td></tr>
<tr class="separator:ad872c37e7886dcd19fd8953cc3b17645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c393865efe624bc27bfc6f068ee74a1"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a6c393865efe624bc27bfc6f068ee74a1">jac_loc</a></td></tr>
<tr class="memdesc:a6c393865efe624bc27bfc6f068ee74a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">jacobian term around locus  <a href="namespacem__xnldata.html#a6c393865efe624bc27bfc6f068ee74a1">More...</a><br /></td></tr>
<tr class="separator:a6c393865efe624bc27bfc6f068ee74a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f3d81edbb8c7205673c78c986a1428"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a91f3d81edbb8c7205673c78c986a1428">cple_loc</a></td></tr>
<tr class="memdesc:a91f3d81edbb8c7205673c78c986a1428"><td class="mdescLeft">&#160;</td><td class="mdescRight">coupling coefficient around locus  <a href="namespacem__xnldata.html#a91f3d81edbb8c7205673c78c986a1428">More...</a><br /></td></tr>
<tr class="separator:a91f3d81edbb8c7205673c78c986a1428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b032e514d6a48698dde74aeea1d391c"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5b032e514d6a48698dde74aeea1d391c">sym_loc</a></td></tr>
<tr class="memdesc:a5b032e514d6a48698dde74aeea1d391c"><td class="mdescLeft">&#160;</td><td class="mdescRight">factor for symmetry between k3 and k4  <a href="namespacem__xnldata.html#a5b032e514d6a48698dde74aeea1d391c">More...</a><br /></td></tr>
<tr class="separator:a5b032e514d6a48698dde74aeea1d391c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46bcaf9843ef210498818ecbcd030b84"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a46bcaf9843ef210498818ecbcd030b84">k_pol</a></td></tr>
<tr class="memdesc:a46bcaf9843ef210498818ecbcd030b84"><td class="mdescLeft">&#160;</td><td class="mdescRight">wave numbers during polar generation of locus  <a href="namespacem__xnldata.html#a46bcaf9843ef210498818ecbcd030b84">More...</a><br /></td></tr>
<tr class="separator:a46bcaf9843ef210498818ecbcd030b84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0177eed73a279a705ee0f8b2260d5e46"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0177eed73a279a705ee0f8b2260d5e46">c_pol</a></td></tr>
<tr class="memdesc:a0177eed73a279a705ee0f8b2260d5e46"><td class="mdescLeft">&#160;</td><td class="mdescRight">cosines during polar generation of locus  <a href="namespacem__xnldata.html#a0177eed73a279a705ee0f8b2260d5e46">More...</a><br /></td></tr>
<tr class="separator:a0177eed73a279a705ee0f8b2260d5e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b0bbc3782a7bd0a73086fdca431b05"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a29b0bbc3782a7bd0a73086fdca431b05">a_pol</a></td></tr>
<tr class="memdesc:a29b0bbc3782a7bd0a73086fdca431b05"><td class="mdescLeft">&#160;</td><td class="mdescRight">angles of polar locus  <a href="namespacem__xnldata.html#a29b0bbc3782a7bd0a73086fdca431b05">More...</a><br /></td></tr>
<tr class="separator:a29b0bbc3782a7bd0a73086fdca431b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad94cc76b6b10c7ba2b5024f56779b6b5"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad94cc76b6b10c7ba2b5024f56779b6b5">x2_mod</a></td></tr>
<tr class="memdesc:ad94cc76b6b10c7ba2b5024f56779b6b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">k2x coordinates along locus  <a href="namespacem__xnldata.html#ad94cc76b6b10c7ba2b5024f56779b6b5">More...</a><br /></td></tr>
<tr class="separator:ad94cc76b6b10c7ba2b5024f56779b6b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df03ecbf05e49b2452dc145ade574c4"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a4df03ecbf05e49b2452dc145ade574c4">y2_mod</a></td></tr>
<tr class="memdesc:a4df03ecbf05e49b2452dc145ade574c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">k2y coordinates along locus  <a href="namespacem__xnldata.html#a4df03ecbf05e49b2452dc145ade574c4">More...</a><br /></td></tr>
<tr class="separator:a4df03ecbf05e49b2452dc145ade574c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18015651e3b35cd47b1ed2df0bdc7c86"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a18015651e3b35cd47b1ed2df0bdc7c86">x4_mod</a></td></tr>
<tr class="memdesc:a18015651e3b35cd47b1ed2df0bdc7c86"><td class="mdescLeft">&#160;</td><td class="mdescRight">k4x coordinates along locus  <a href="namespacem__xnldata.html#a18015651e3b35cd47b1ed2df0bdc7c86">More...</a><br /></td></tr>
<tr class="separator:a18015651e3b35cd47b1ed2df0bdc7c86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af99dde6b89194f24b89069dd9f0ae8b9"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af99dde6b89194f24b89069dd9f0ae8b9">y4_mod</a></td></tr>
<tr class="memdesc:af99dde6b89194f24b89069dd9f0ae8b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">k4y coordinates along locus  <a href="namespacem__xnldata.html#af99dde6b89194f24b89069dd9f0ae8b9">More...</a><br /></td></tr>
<tr class="separator:af99dde6b89194f24b89069dd9f0ae8b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76093a273e70739be0c4dbcf3d94128"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad76093a273e70739be0c4dbcf3d94128">z_mod</a></td></tr>
<tr class="memdesc:ad76093a273e70739be0c4dbcf3d94128"><td class="mdescLeft">&#160;</td><td class="mdescRight">data value around locus  <a href="namespacem__xnldata.html#ad76093a273e70739be0c4dbcf3d94128">More...</a><br /></td></tr>
<tr class="separator:ad76093a273e70739be0c4dbcf3d94128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae29bdbe4a2cc599c504db786e0535da1"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae29bdbe4a2cc599c504db786e0535da1">s_mod</a></td></tr>
<tr class="memdesc:ae29bdbe4a2cc599c504db786e0535da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">coordinate along locus  <a href="namespacem__xnldata.html#ae29bdbe4a2cc599c504db786e0535da1">More...</a><br /></td></tr>
<tr class="separator:ae29bdbe4a2cc599c504db786e0535da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9fbf9cf6916bf4fd5c520749dc8dfdc"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa9fbf9cf6916bf4fd5c520749dc8dfdc">ds_mod</a></td></tr>
<tr class="memdesc:aa9fbf9cf6916bf4fd5c520749dc8dfdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">step size around locus  <a href="namespacem__xnldata.html#aa9fbf9cf6916bf4fd5c520749dc8dfdc">More...</a><br /></td></tr>
<tr class="separator:aa9fbf9cf6916bf4fd5c520749dc8dfdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0caa2f24a4e16719a0cc6c11f683d349"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0caa2f24a4e16719a0cc6c11f683d349">jac_mod</a></td></tr>
<tr class="memdesc:a0caa2f24a4e16719a0cc6c11f683d349"><td class="mdescLeft">&#160;</td><td class="mdescRight">jacobian term around locus  <a href="namespacem__xnldata.html#a0caa2f24a4e16719a0cc6c11f683d349">More...</a><br /></td></tr>
<tr class="separator:a0caa2f24a4e16719a0cc6c11f683d349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23f396086712d7c8c5defe8cd240bb7"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac23f396086712d7c8c5defe8cd240bb7">cple_mod</a></td></tr>
<tr class="memdesc:ac23f396086712d7c8c5defe8cd240bb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">coupling coefficient around locus  <a href="namespacem__xnldata.html#ac23f396086712d7c8c5defe8cd240bb7">More...</a><br /></td></tr>
<tr class="separator:ac23f396086712d7c8c5defe8cd240bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af2632155748f950599e9304f195f07"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1af2632155748f950599e9304f195f07">sym_mod</a></td></tr>
<tr class="memdesc:a1af2632155748f950599e9304f195f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">factor for symmetry between k3 and k4  <a href="namespacem__xnldata.html#a1af2632155748f950599e9304f195f07">More...</a><br /></td></tr>
<tr class="separator:a1af2632155748f950599e9304f195f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8ca8b3d951a528df659173a6e9e152e"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af8ca8b3d951a528df659173a6e9e152e">k2m_mod</a></td></tr>
<tr class="memdesc:af8ca8b3d951a528df659173a6e9e152e"><td class="mdescLeft">&#160;</td><td class="mdescRight">k2 magnitude around locus  <a href="namespacem__xnldata.html#af8ca8b3d951a528df659173a6e9e152e">More...</a><br /></td></tr>
<tr class="separator:af8ca8b3d951a528df659173a6e9e152e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f8de263206e38bc42973c764421b61d"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a5f8de263206e38bc42973c764421b61d">k2a_mod</a></td></tr>
<tr class="memdesc:a5f8de263206e38bc42973c764421b61d"><td class="mdescLeft">&#160;</td><td class="mdescRight">k2 angle around locus  <a href="namespacem__xnldata.html#a5f8de263206e38bc42973c764421b61d">More...</a><br /></td></tr>
<tr class="separator:a5f8de263206e38bc42973c764421b61d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2af97dc5f43404ffcbeb2b5b461f084"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ab2af97dc5f43404ffcbeb2b5b461f084">k4m_mod</a></td></tr>
<tr class="memdesc:ab2af97dc5f43404ffcbeb2b5b461f084"><td class="mdescLeft">&#160;</td><td class="mdescRight">k4 magnitude around locus  <a href="namespacem__xnldata.html#ab2af97dc5f43404ffcbeb2b5b461f084">More...</a><br /></td></tr>
<tr class="separator:ab2af97dc5f43404ffcbeb2b5b461f084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad632e990f940408ace63600467f6b3ec"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad632e990f940408ace63600467f6b3ec">k4a_mod</a></td></tr>
<tr class="memdesc:ad632e990f940408ace63600467f6b3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">k4 angle around locus  <a href="namespacem__xnldata.html#ad632e990f940408ace63600467f6b3ec">More...</a><br /></td></tr>
<tr class="separator:ad632e990f940408ace63600467f6b3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43978bfef04d1307631389c868cdcaba"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a43978bfef04d1307631389c868cdcaba">wk_k2</a></td></tr>
<tr class="memdesc:a43978bfef04d1307631389c868cdcaba"><td class="mdescLeft">&#160;</td><td class="mdescRight">position of k2 and k4 wave number  <a href="namespacem__xnldata.html#a43978bfef04d1307631389c868cdcaba">More...</a><br /></td></tr>
<tr class="separator:a43978bfef04d1307631389c868cdcaba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65b679dff0eea3a20bba4179510928c"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af65b679dff0eea3a20bba4179510928c">wk_k4</a></td></tr>
<tr class="memdesc:af65b679dff0eea3a20bba4179510928c"><td class="mdescLeft">&#160;</td><td class="mdescRight">w.r.t.  <a href="namespacem__xnldata.html#af65b679dff0eea3a20bba4179510928c">More...</a><br /></td></tr>
<tr class="separator:af65b679dff0eea3a20bba4179510928c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e1e4e9a3b31456f2958d71b38c6ca0"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad4e1e4e9a3b31456f2958d71b38c6ca0">wa_k2</a></td></tr>
<tr class="memdesc:ad4e1e4e9a3b31456f2958d71b38c6ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">position of k2 and k4 wave number  <a href="namespacem__xnldata.html#ad4e1e4e9a3b31456f2958d71b38c6ca0">More...</a><br /></td></tr>
<tr class="separator:ad4e1e4e9a3b31456f2958d71b38c6ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa27a047564b8f3141b0c20c55fdf73e2"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa27a047564b8f3141b0c20c55fdf73e2">wa_k4</a></td></tr>
<tr class="memdesc:aa27a047564b8f3141b0c20c55fdf73e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">w.r.t.  <a href="namespacem__xnldata.html#aa27a047564b8f3141b0c20c55fdf73e2">More...</a><br /></td></tr>
<tr class="separator:aa27a047564b8f3141b0c20c55fdf73e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc85b62ae47ee05c033b80458a39071d"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#abc85b62ae47ee05c033b80458a39071d">wt_k2</a></td></tr>
<tr class="memdesc:abc85b62ae47ee05c033b80458a39071d"><td class="mdescLeft">&#160;</td><td class="mdescRight">weight factor in tail,  <a href="namespacem__xnldata.html#abc85b62ae47ee05c033b80458a39071d">More...</a><br /></td></tr>
<tr class="separator:abc85b62ae47ee05c033b80458a39071d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f7fdb8eb2368cd3f449e36ce898f6b"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad3f7fdb8eb2368cd3f449e36ce898f6b">wt_k4</a></td></tr>
<tr class="memdesc:ad3f7fdb8eb2368cd3f449e36ce898f6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">wt==1 for wave numbers inside k-grid  <a href="namespacem__xnldata.html#ad3f7fdb8eb2368cd3f449e36ce898f6b">More...</a><br /></td></tr>
<tr class="separator:ad3f7fdb8eb2368cd3f449e36ce898f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b9e0167fd2a31137381514370bf126b"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8b9e0167fd2a31137381514370bf126b">t_ik2</a></td></tr>
<tr class="memdesc:a8b9e0167fd2a31137381514370bf126b"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight for k2-magnitude  <a href="namespacem__xnldata.html#a8b9e0167fd2a31137381514370bf126b">More...</a><br /></td></tr>
<tr class="separator:a8b9e0167fd2a31137381514370bf126b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3926919aa0063c200f44b8684444a4"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9e3926919aa0063c200f44b8684444a4">t_ia2</a></td></tr>
<tr class="memdesc:a9e3926919aa0063c200f44b8684444a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed direction for k2  <a href="namespacem__xnldata.html#a9e3926919aa0063c200f44b8684444a4">More...</a><br /></td></tr>
<tr class="separator:a9e3926919aa0063c200f44b8684444a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a08463eb3268b4456e5a4ad17bf5c5"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a59a08463eb3268b4456e5a4ad17bf5c5">t_ik4</a></td></tr>
<tr class="memdesc:a59a08463eb3268b4456e5a4ad17bf5c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed tail factor for k2  <a href="namespacem__xnldata.html#a59a08463eb3268b4456e5a4ad17bf5c5">More...</a><br /></td></tr>
<tr class="separator:a59a08463eb3268b4456e5a4ad17bf5c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accf0e00c69dc28d44aedb13a144dbc68"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#accf0e00c69dc28d44aedb13a144dbc68">t_ia4</a></td></tr>
<tr class="memdesc:accf0e00c69dc28d44aedb13a144dbc68"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight for k4  <a href="namespacem__xnldata.html#accf0e00c69dc28d44aedb13a144dbc68">More...</a><br /></td></tr>
<tr class="separator:accf0e00c69dc28d44aedb13a144dbc68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae082b94b98258fd4ffa6317f9d5da5ff"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae082b94b98258fd4ffa6317f9d5da5ff">t_w1k2</a></td></tr>
<tr class="memdesc:ae082b94b98258fd4ffa6317f9d5da5ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 1 for k2  <a href="namespacem__xnldata.html#ae082b94b98258fd4ffa6317f9d5da5ff">More...</a><br /></td></tr>
<tr class="separator:ae082b94b98258fd4ffa6317f9d5da5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42176c40aca0500c8035997abbcaba40"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a42176c40aca0500c8035997abbcaba40">t_w2k2</a></td></tr>
<tr class="memdesc:a42176c40aca0500c8035997abbcaba40"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 2 for k2  <a href="namespacem__xnldata.html#a42176c40aca0500c8035997abbcaba40">More...</a><br /></td></tr>
<tr class="separator:a42176c40aca0500c8035997abbcaba40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5772bfb43d901c038e487cb6ad4a3d7"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa5772bfb43d901c038e487cb6ad4a3d7">t_w3k2</a></td></tr>
<tr class="memdesc:aa5772bfb43d901c038e487cb6ad4a3d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 3 for k2  <a href="namespacem__xnldata.html#aa5772bfb43d901c038e487cb6ad4a3d7">More...</a><br /></td></tr>
<tr class="separator:aa5772bfb43d901c038e487cb6ad4a3d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e0df23b7ac6c7476b081baf7e7081e"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af5e0df23b7ac6c7476b081baf7e7081e">t_w4k2</a></td></tr>
<tr class="memdesc:af5e0df23b7ac6c7476b081baf7e7081e"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 4 for k2  <a href="namespacem__xnldata.html#af5e0df23b7ac6c7476b081baf7e7081e">More...</a><br /></td></tr>
<tr class="separator:af5e0df23b7ac6c7476b081baf7e7081e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65fa739a64416bcd661c22daaa8b9020"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a65fa739a64416bcd661c22daaa8b9020">t_w1k4</a></td></tr>
<tr class="memdesc:a65fa739a64416bcd661c22daaa8b9020"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 1 for k4  <a href="namespacem__xnldata.html#a65fa739a64416bcd661c22daaa8b9020">More...</a><br /></td></tr>
<tr class="separator:a65fa739a64416bcd661c22daaa8b9020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1627978fb71ce27b204f93291f20cdef"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1627978fb71ce27b204f93291f20cdef">t_w2k4</a></td></tr>
<tr class="memdesc:a1627978fb71ce27b204f93291f20cdef"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 2 for k4  <a href="namespacem__xnldata.html#a1627978fb71ce27b204f93291f20cdef">More...</a><br /></td></tr>
<tr class="separator:a1627978fb71ce27b204f93291f20cdef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6dfc229c0b3551323b70768d17753e8"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae6dfc229c0b3551323b70768d17753e8">t_w3k4</a></td></tr>
<tr class="memdesc:ae6dfc229c0b3551323b70768d17753e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 3 for k4  <a href="namespacem__xnldata.html#ae6dfc229c0b3551323b70768d17753e8">More...</a><br /></td></tr>
<tr class="separator:ae6dfc229c0b3551323b70768d17753e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44af2d4292342b12290fbc4810825645"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a44af2d4292342b12290fbc4810825645">t_w4k4</a></td></tr>
<tr class="memdesc:a44af2d4292342b12290fbc4810825645"><td class="mdescLeft">&#160;</td><td class="mdescRight">transformed weight 4 for k4  <a href="namespacem__xnldata.html#a44af2d4292342b12290fbc4810825645">More...</a><br /></td></tr>
<tr class="separator:a44af2d4292342b12290fbc4810825645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac15b3919ba7c54299e6e43af50c92de5"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac15b3919ba7c54299e6e43af50c92de5">t_zz</a></td></tr>
<tr class="memdesc:ac15b3919ba7c54299e6e43af50c92de5"><td class="mdescLeft">&#160;</td><td class="mdescRight">product term  <a href="namespacem__xnldata.html#ac15b3919ba7c54299e6e43af50c92de5">More...</a><br /></td></tr>
<tr class="separator:ac15b3919ba7c54299e6e43af50c92de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0bb7bb63744bab937276c9f28443cba"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af0bb7bb63744bab937276c9f28443cba">r_ik2</a></td></tr>
<tr class="memdesc:af0bb7bb63744bab937276c9f28443cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations r_ik2  <a href="namespacem__xnldata.html#af0bb7bb63744bab937276c9f28443cba">More...</a><br /></td></tr>
<tr class="separator:af0bb7bb63744bab937276c9f28443cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b9ec4d3421fe077239cf3ba0b5519d"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad3b9ec4d3421fe077239cf3ba0b5519d">r_ia2</a></td></tr>
<tr class="memdesc:ad3b9ec4d3421fe077239cf3ba0b5519d"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations r_ia2  <a href="namespacem__xnldata.html#ad3b9ec4d3421fe077239cf3ba0b5519d">More...</a><br /></td></tr>
<tr class="separator:ad3b9ec4d3421fe077239cf3ba0b5519d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7c952df577ab7a27a370c1891212f8"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7d7c952df577ab7a27a370c1891212f8">r_ik4</a></td></tr>
<tr class="memdesc:a7d7c952df577ab7a27a370c1891212f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations r_ik4  <a href="namespacem__xnldata.html#a7d7c952df577ab7a27a370c1891212f8">More...</a><br /></td></tr>
<tr class="separator:a7d7c952df577ab7a27a370c1891212f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a54e45373dd174328179afe0a86bee9"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1a54e45373dd174328179afe0a86bee9">r_ia4</a></td></tr>
<tr class="memdesc:a1a54e45373dd174328179afe0a86bee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations r_ia4  <a href="namespacem__xnldata.html#a1a54e45373dd174328179afe0a86bee9">More...</a><br /></td></tr>
<tr class="separator:a1a54e45373dd174328179afe0a86bee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a810696946388b8d6ee6f69dc8241fe1f"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a810696946388b8d6ee6f69dc8241fe1f">r_w1k2</a></td></tr>
<tr class="separator:a810696946388b8d6ee6f69dc8241fe1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ec83c7e9e0d5d04de5aa2e7b16b484"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa5ec83c7e9e0d5d04de5aa2e7b16b484">r_w2k2</a></td></tr>
<tr class="separator:aa5ec83c7e9e0d5d04de5aa2e7b16b484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18ed49e84ad6ffb58889b3f615fb2fc5"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a18ed49e84ad6ffb58889b3f615fb2fc5">r_w3k2</a></td></tr>
<tr class="separator:a18ed49e84ad6ffb58889b3f615fb2fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e492dbe1fc0ea98bdc589f56d843e7c"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a6e492dbe1fc0ea98bdc589f56d843e7c">r_w4k2</a></td></tr>
<tr class="memdesc:a6e492dbe1fc0ea98bdc589f56d843e7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations  <a href="namespacem__xnldata.html#a6e492dbe1fc0ea98bdc589f56d843e7c">More...</a><br /></td></tr>
<tr class="separator:a6e492dbe1fc0ea98bdc589f56d843e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a14d74e431ca4cf58ac070a18d9ef3"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af9a14d74e431ca4cf58ac070a18d9ef3">r_w1k4</a></td></tr>
<tr class="separator:af9a14d74e431ca4cf58ac070a18d9ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5a99f15afb500fb01392c488f21edfa"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ad5a99f15afb500fb01392c488f21edfa">r_w2k4</a></td></tr>
<tr class="separator:ad5a99f15afb500fb01392c488f21edfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18677f8f464fd7aa2acc7cbd67b46a4d"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a18677f8f464fd7aa2acc7cbd67b46a4d">r_w3k4</a></td></tr>
<tr class="separator:a18677f8f464fd7aa2acc7cbd67b46a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29dc29f5c35959cd670a3f7a66784daf"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a29dc29f5c35959cd670a3f7a66784daf">r_w4k4</a></td></tr>
<tr class="memdesc:a29dc29f5c35959cd670a3f7a66784daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations  <a href="namespacem__xnldata.html#a29dc29f5c35959cd670a3f7a66784daf">More...</a><br /></td></tr>
<tr class="separator:a29dc29f5c35959cd670a3f7a66784daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a768115b8a8b53d1a8e74e51ab2e8d262"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a768115b8a8b53d1a8e74e51ab2e8d262">r_zz</a></td></tr>
<tr class="separator:a768115b8a8b53d1a8e74e51ab2e8d262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ea35f1c9bc93e8f0dabb3b19ee2f2e"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a92ea35f1c9bc93e8f0dabb3b19ee2f2e">r_jac</a></td></tr>
<tr class="separator:a92ea35f1c9bc93e8f0dabb3b19ee2f2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a627b455acc37e84e82960dc5dc5ef5b3"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a627b455acc37e84e82960dc5dc5ef5b3">r_cple</a></td></tr>
<tr class="separator:a627b455acc37e84e82960dc5dc5ef5b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0609f7b29b16c5aa51409e3e5e5ffd3"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae0609f7b29b16c5aa51409e3e5e5ffd3">r_sym</a></td></tr>
<tr class="separator:ae0609f7b29b16c5aa51409e3e5e5ffd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae51be316b2d8580c8bd39a6833886fff"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae51be316b2d8580c8bd39a6833886fff">r_ws</a></td></tr>
<tr class="memdesc:ae51be316b2d8580c8bd39a6833886fff"><td class="mdescLeft">&#160;</td><td class="mdescRight">corresponding declarations  <a href="namespacem__xnldata.html#ae51be316b2d8580c8bd39a6833886fff">More...</a><br /></td></tr>
<tr class="separator:ae51be316b2d8580c8bd39a6833886fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91b00f217b6a60bb8eb32481764817ed"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a91b00f217b6a60bb8eb32481764817ed">dt13</a></td></tr>
<tr class="memdesc:a91b00f217b6a60bb8eb32481764817ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">increment along locus  <a href="namespacem__xnldata.html#a91b00f217b6a60bb8eb32481764817ed">More...</a><br /></td></tr>
<tr class="separator:a91b00f217b6a60bb8eb32481764817ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f8772f7c0033bba0e79076c6541743"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a17f8772f7c0033bba0e79076c6541743">q_xk</a></td></tr>
<tr class="memdesc:a17f8772f7c0033bba0e79076c6541743"><td class="mdescLeft">&#160;</td><td class="mdescRight">extended wave number array starting at index 0  <a href="namespacem__xnldata.html#a17f8772f7c0033bba0e79076c6541743">More...</a><br /></td></tr>
<tr class="separator:a17f8772f7c0033bba0e79076c6541743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60c0c64434dfd93e596fe73e8150e2d3"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a60c0c64434dfd93e596fe73e8150e2d3">q_sk</a></td></tr>
<tr class="memdesc:a60c0c64434dfd93e596fe73e8150e2d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">step size of extended wave number array  <a href="namespacem__xnldata.html#a60c0c64434dfd93e596fe73e8150e2d3">More...</a><br /></td></tr>
<tr class="separator:a60c0c64434dfd93e596fe73e8150e2d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a002c7a391c4be043a2f7a568eafcf75f"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a002c7a391c4be043a2f7a568eafcf75f">sk_max</a></td></tr>
<tr class="memdesc:a002c7a391c4be043a2f7a568eafcf75f"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum wave number in extended array  <a href="namespacem__xnldata.html#a002c7a391c4be043a2f7a568eafcf75f">More...</a><br /></td></tr>
<tr class="separator:a002c7a391c4be043a2f7a568eafcf75f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f4b5c29c04a2fa6684c716e9a40e1e"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a77f4b5c29c04a2fa6684c716e9a40e1e">q_k</a></td></tr>
<tr class="memdesc:a77f4b5c29c04a2fa6684c716e9a40e1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">wave number grid [1/m]  <a href="namespacem__xnldata.html#a77f4b5c29c04a2fa6684c716e9a40e1e">More...</a><br /></td></tr>
<tr class="separator:a77f4b5c29c04a2fa6684c716e9a40e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9aaf0fdbaa8517c8520c12a6b77dd7"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3b9aaf0fdbaa8517c8520c12a6b77dd7">q_dk</a></td></tr>
<tr class="memdesc:a3b9aaf0fdbaa8517c8520c12a6b77dd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">width of wave number bins [1/m]  <a href="namespacem__xnldata.html#a3b9aaf0fdbaa8517c8520c12a6b77dd7">More...</a><br /></td></tr>
<tr class="separator:a3b9aaf0fdbaa8517c8520c12a6b77dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0fced0b6c23a202efa4db529f2c638b"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac0fced0b6c23a202efa4db529f2c638b">q_kpow</a></td></tr>
<tr class="memdesc:ac0fced0b6c23a202efa4db529f2c638b"><td class="mdescLeft">&#160;</td><td class="mdescRight">wave number to a certain power, used in filtering  <a href="namespacem__xnldata.html#ac0fced0b6c23a202efa4db529f2c638b">More...</a><br /></td></tr>
<tr class="separator:ac0fced0b6c23a202efa4db529f2c638b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84de770c868645f09f95e5497f3c2013"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a84de770c868645f09f95e5497f3c2013">q_f</a></td></tr>
<tr class="memdesc:a84de770c868645f09f95e5497f3c2013"><td class="mdescLeft">&#160;</td><td class="mdescRight">frequencies accociated to wave number/depth  <a href="namespacem__xnldata.html#a84de770c868645f09f95e5497f3c2013">More...</a><br /></td></tr>
<tr class="separator:a84de770c868645f09f95e5497f3c2013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29197d52e87f26bc58b886d74568da1"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac29197d52e87f26bc58b886d74568da1">q_df</a></td></tr>
<tr class="memdesc:ac29197d52e87f26bc58b886d74568da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">step size of frequency grid  <a href="namespacem__xnldata.html#ac29197d52e87f26bc58b886d74568da1">More...</a><br /></td></tr>
<tr class="separator:ac29197d52e87f26bc58b886d74568da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae892eba6d5dc89be9bc96cf8388ea396"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae892eba6d5dc89be9bc96cf8388ea396">q_sig</a></td></tr>
<tr class="memdesc:ae892eba6d5dc89be9bc96cf8388ea396"><td class="mdescLeft">&#160;</td><td class="mdescRight">radian frequencies associated to wave number/depth  <a href="namespacem__xnldata.html#ae892eba6d5dc89be9bc96cf8388ea396">More...</a><br /></td></tr>
<tr class="separator:ae892eba6d5dc89be9bc96cf8388ea396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93634c09dd4ffed3aba8274949dc2e1"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aa93634c09dd4ffed3aba8274949dc2e1">q_dsig</a></td></tr>
<tr class="memdesc:aa93634c09dd4ffed3aba8274949dc2e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">step size of radian frequency grid  <a href="namespacem__xnldata.html#aa93634c09dd4ffed3aba8274949dc2e1">More...</a><br /></td></tr>
<tr class="separator:aa93634c09dd4ffed3aba8274949dc2e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c30e6edbbfe7ca97b92abec94548fb"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a20c30e6edbbfe7ca97b92abec94548fb">q_cg</a></td></tr>
<tr class="memdesc:a20c30e6edbbfe7ca97b92abec94548fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">group velocity (m/s)  <a href="namespacem__xnldata.html#a20c30e6edbbfe7ca97b92abec94548fb">More...</a><br /></td></tr>
<tr class="separator:a20c30e6edbbfe7ca97b92abec94548fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c66c0c23b2ec5e398398b2c859d9eb"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ab4c66c0c23b2ec5e398398b2c859d9eb">q_a</a></td></tr>
<tr class="memdesc:ab4c66c0c23b2ec5e398398b2c859d9eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">directions of quadruplet grid in radians  <a href="namespacem__xnldata.html#ab4c66c0c23b2ec5e398398b2c859d9eb">More...</a><br /></td></tr>
<tr class="separator:ab4c66c0c23b2ec5e398398b2c859d9eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea8cf76fc832adb65c102b7ce50d8ef5"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aea8cf76fc832adb65c102b7ce50d8ef5">q_ad</a></td></tr>
<tr class="memdesc:aea8cf76fc832adb65c102b7ce50d8ef5"><td class="mdescLeft">&#160;</td><td class="mdescRight">directions of quadruplet grid in degrees  <a href="namespacem__xnldata.html#aea8cf76fc832adb65c102b7ce50d8ef5">More...</a><br /></td></tr>
<tr class="separator:aea8cf76fc832adb65c102b7ce50d8ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae750e6e7413e1f16c6a2a7c49a9d7351"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae750e6e7413e1f16c6a2a7c49a9d7351">a</a></td></tr>
<tr class="memdesc:ae750e6e7413e1f16c6a2a7c49a9d7351"><td class="mdescLeft">&#160;</td><td class="mdescRight">Action density on wave number grid A(sigma,theta)  <a href="namespacem__xnldata.html#ae750e6e7413e1f16c6a2a7c49a9d7351">More...</a><br /></td></tr>
<tr class="separator:ae750e6e7413e1f16c6a2a7c49a9d7351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac542cbbb015e7c01438ff76f47331b7d"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac542cbbb015e7c01438ff76f47331b7d">nspec</a></td></tr>
<tr class="memdesc:ac542cbbb015e7c01438ff76f47331b7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Action density on wave number grid N(kx,ky)  <a href="namespacem__xnldata.html#ac542cbbb015e7c01438ff76f47331b7d">More...</a><br /></td></tr>
<tr class="separator:ac542cbbb015e7c01438ff76f47331b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9ce8583107604b5ba49b2df0c4296a"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#add9ce8583107604b5ba49b2df0c4296a">nk1d</a></td></tr>
<tr class="memdesc:add9ce8583107604b5ba49b2df0c4296a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal 1d action density spectrum N(k)  <a href="namespacem__xnldata.html#add9ce8583107604b5ba49b2df0c4296a">More...</a><br /></td></tr>
<tr class="separator:add9ce8583107604b5ba49b2df0c4296a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae615498c9d1217d8d7a32e52d4f1dfc0"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ae615498c9d1217d8d7a32e52d4f1dfc0">qnl</a></td></tr>
<tr class="memdesc:ae615498c9d1217d8d7a32e52d4f1dfc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nonlinear energy transfer Snl(k,theta)  <a href="namespacem__xnldata.html#ae615498c9d1217d8d7a32e52d4f1dfc0">More...</a><br /></td></tr>
<tr class="separator:ae615498c9d1217d8d7a32e52d4f1dfc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530544b6c0402771b60058bde0bbb24a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a530544b6c0402771b60058bde0bbb24a">id_facmax</a></td></tr>
<tr class="memdesc:a530544b6c0402771b60058bde0bbb24a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factor for determining range of depth search (Q_SEARCHGRID)  <a href="namespacem__xnldata.html#a530544b6c0402771b60058bde0bbb24a">More...</a><br /></td></tr>
<tr class="separator:a530544b6c0402771b60058bde0bbb24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c17545ef90fd5f0593cc0597ff090c4"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a0c17545ef90fd5f0593cc0597ff090c4">q_dird1</a></td></tr>
<tr class="separator:a0c17545ef90fd5f0593cc0597ff090c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bce339b695868b533e5edd433e6289b"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8bce339b695868b533e5edd433e6289b">q_dird2</a></td></tr>
<tr class="memdesc:a8bce339b695868b533e5edd433e6289b"><td class="mdescLeft">&#160;</td><td class="mdescRight">first and last direction of host model (via XNL_INIT) degrees  <a href="namespacem__xnldata.html#a8bce339b695868b533e5edd433e6289b">More...</a><br /></td></tr>
<tr class="separator:a8bce339b695868b533e5edd433e6289b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f96f689a5f42f67909ec89f8dbb57f"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a48f96f689a5f42f67909ec89f8dbb57f">q_depth</a></td></tr>
<tr class="memdesc:a48f96f689a5f42f67909ec89f8dbb57f"><td class="mdescLeft">&#160;</td><td class="mdescRight">local water depth in m  <a href="namespacem__xnldata.html#a48f96f689a5f42f67909ec89f8dbb57f">More...</a><br /></td></tr>
<tr class="separator:a48f96f689a5f42f67909ec89f8dbb57f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9199c625e11bd438cd857b89e8b35ca9"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9199c625e11bd438cd857b89e8b35ca9">q_maxdepth</a></td></tr>
<tr class="memdesc:a9199c625e11bd438cd857b89e8b35ca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum water depth, set in XNL_INIT, used in Q_CTRGRID  <a href="namespacem__xnldata.html#a9199c625e11bd438cd857b89e8b35ca9">More...</a><br /></td></tr>
<tr class="separator:a9199c625e11bd438cd857b89e8b35ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1755f26af2d9ff9e3753a7df57693ac9"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1755f26af2d9ff9e3753a7df57693ac9">q_mindepth</a></td></tr>
<tr class="memdesc:a1755f26af2d9ff9e3753a7df57693ac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">minimum water depth, set in XNL_INIT, used in Q_CTRGRID  <a href="namespacem__xnldata.html#a1755f26af2d9ff9e3753a7df57693ac9">More...</a><br /></td></tr>
<tr class="separator:a1755f26af2d9ff9e3753a7df57693ac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d6b9532b9a0a0dd775d6ac3035756d"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac4d6b9532b9a0a0dd775d6ac3035756d">q_lambda</a></td></tr>
<tr class="memdesc:ac4d6b9532b9a0a0dd775d6ac3035756d"><td class="mdescLeft">&#160;</td><td class="mdescRight">geometric scaling factor for 'deep' water loci  <a href="namespacem__xnldata.html#ac4d6b9532b9a0a0dd775d6ac3035756d">More...</a><br /></td></tr>
<tr class="separator:ac4d6b9532b9a0a0dd775d6ac3035756d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b03b60bbb7125cc36a223f3ebc2c945"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a8b03b60bbb7125cc36a223f3ebc2c945">q_scale</a></td></tr>
<tr class="memdesc:a8b03b60bbb7125cc36a223f3ebc2c945"><td class="mdescLeft">&#160;</td><td class="mdescRight">additional scale factor resulting from SEARCH for neasrest grid  <a href="namespacem__xnldata.html#a8b03b60bbb7125cc36a223f3ebc2c945">More...</a><br /></td></tr>
<tr class="separator:a8b03b60bbb7125cc36a223f3ebc2c945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a96f0188f21cb639bd6548be5b90d64"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a1a96f0188f21cb639bd6548be5b90d64">eps_q</a></td></tr>
<tr class="memdesc:a1a96f0188f21cb639bd6548be5b90d64"><td class="mdescLeft">&#160;</td><td class="mdescRight">absolute accuracy for check of Q  <a href="namespacem__xnldata.html#a1a96f0188f21cb639bd6548be5b90d64">More...</a><br /></td></tr>
<tr class="separator:a1a96f0188f21cb639bd6548be5b90d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310eab9aa8cec8f93a6fadc3ffd0d4d3"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a310eab9aa8cec8f93a6fadc3ffd0d4d3">eps_k</a></td></tr>
<tr class="memdesc:a310eab9aa8cec8f93a6fadc3ffd0d4d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">absolute accuracy for equality check of k  <a href="namespacem__xnldata.html#a310eab9aa8cec8f93a6fadc3ffd0d4d3">More...</a><br /></td></tr>
<tr class="separator:a310eab9aa8cec8f93a6fadc3ffd0d4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b764a43ea3e56d0488868baba0bc13"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a20b764a43ea3e56d0488868baba0bc13">rel_k</a></td></tr>
<tr class="memdesc:a20b764a43ea3e56d0488868baba0bc13"><td class="mdescLeft">&#160;</td><td class="mdescRight">relative accuracy for equality check of k  <a href="namespacem__xnldata.html#a20b764a43ea3e56d0488868baba0bc13">More...</a><br /></td></tr>
<tr class="separator:a20b764a43ea3e56d0488868baba0bc13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a7e684ddf07b56f2fbe88aa538f050f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2a7e684ddf07b56f2fbe88aa538f050f">iq_stack</a></td></tr>
<tr class="memdesc:a2a7e684ddf07b56f2fbe88aa538f050f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sequence number of stack with subroutine calls.  <a href="namespacem__xnldata.html#a2a7e684ddf07b56f2fbe88aa538f050f">More...</a><br /></td></tr>
<tr class="separator:a2a7e684ddf07b56f2fbe88aa538f050f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311e1e5c74386776ac7fab100cd454e8"><td class="memItemLeft" align="right" valign="top">character(len=21), dimension(<a class="el" href="namespacem__xnldata.html#a59e28829b99a12aa264b615a27367c90">mq_stack</a>)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a311e1e5c74386776ac7fab100cd454e8">cstack</a></td></tr>
<tr class="memdesc:a311e1e5c74386776ac7fab100cd454e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack with module names.  <a href="namespacem__xnldata.html#a311e1e5c74386776ac7fab100cd454e8">More...</a><br /></td></tr>
<tr class="separator:a311e1e5c74386776ac7fab100cd454e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc93f6aa39b2e7ee2f02eaa8a4cbcf76"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#acc93f6aa39b2e7ee2f02eaa8a4cbcf76">crf1</a></td></tr>
<tr class="memdesc:acc93f6aa39b2e7ee2f02eaa8a4cbcf76"><td class="mdescLeft">&#160;</td><td class="mdescRight">estimated circumference of locus  <a href="namespacem__xnldata.html#acc93f6aa39b2e7ee2f02eaa8a4cbcf76">More...</a><br /></td></tr>
<tr class="separator:acc93f6aa39b2e7ee2f02eaa8a4cbcf76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf780386b9ddf029dbaaed4fc96a33e"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9bf780386b9ddf029dbaaed4fc96a33e">iaref</a></td></tr>
<tr class="memdesc:a9bf780386b9ddf029dbaaed4fc96a33e"><td class="mdescLeft">&#160;</td><td class="mdescRight">index of first angle of reference wave numbers  <a href="namespacem__xnldata.html#a9bf780386b9ddf029dbaaed4fc96a33e">More...</a><br /></td></tr>
<tr class="separator:a9bf780386b9ddf029dbaaed4fc96a33e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f90c06ec8b09c9a5171d021d606360a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3f90c06ec8b09c9a5171d021d606360a">iamax</a></td></tr>
<tr class="memdesc:a3f90c06ec8b09c9a5171d021d606360a"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum difference in indices for sector grids  <a href="namespacem__xnldata.html#a3f90c06ec8b09c9a5171d021d606360a">More...</a><br /></td></tr>
<tr class="separator:a3f90c06ec8b09c9a5171d021d606360a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a236cc28e8172e98f42e3cd2ce397e6ac"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a236cc28e8172e98f42e3cd2ce397e6ac">iaq1</a></td></tr>
<tr class="separator:a236cc28e8172e98f42e3cd2ce397e6ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b6306a71c695a63c109dc0152a8aefc"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a3b6306a71c695a63c109dc0152a8aefc">iaq2</a></td></tr>
<tr class="memdesc:a3b6306a71c695a63c109dc0152a8aefc"><td class="mdescLeft">&#160;</td><td class="mdescRight">indices of do-loop for directions  <a href="namespacem__xnldata.html#a3b6306a71c695a63c109dc0152a8aefc">More...</a><br /></td></tr>
<tr class="separator:a3b6306a71c695a63c109dc0152a8aefc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad0b4b1bf1724c27d7d624d73e7c887c"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aad0b4b1bf1724c27d7d624d73e7c887c">iag1</a></td></tr>
<tr class="separator:aad0b4b1bf1724c27d7d624d73e7c887c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c0158a31209d57e861f11750890c7a"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a17c0158a31209d57e861f11750890c7a">iag2</a></td></tr>
<tr class="memdesc:a17c0158a31209d57e861f11750890c7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">range of directions for precomputed interaction grid  <a href="namespacem__xnldata.html#a17c0158a31209d57e861f11750890c7a">More...</a><br /></td></tr>
<tr class="separator:a17c0158a31209d57e861f11750890c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a24ce3e5718c2586c6a4401cb177b9"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a78a24ce3e5718c2586c6a4401cb177b9">q_ang1</a></td></tr>
<tr class="separator:a78a24ce3e5718c2586c6a4401cb177b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c5854c10849ea9caebe520a6bf2b05a"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a9c5854c10849ea9caebe520a6bf2b05a">q_ang2</a></td></tr>
<tr class="memdesc:a9c5854c10849ea9caebe520a6bf2b05a"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower and upper angle of grid in degrees  <a href="namespacem__xnldata.html#a9c5854c10849ea9caebe520a6bf2b05a">More...</a><br /></td></tr>
<tr class="separator:a9c5854c10849ea9caebe520a6bf2b05a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee89bd69c57844dc31d608d6b2d9edd8"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#aee89bd69c57844dc31d608d6b2d9edd8">q_delta</a></td></tr>
<tr class="memdesc:aee89bd69c57844dc31d608d6b2d9edd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">directional spacing of angular grid in radians  <a href="namespacem__xnldata.html#aee89bd69c57844dc31d608d6b2d9edd8">More...</a><br /></td></tr>
<tr class="separator:aee89bd69c57844dc31d608d6b2d9edd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66d65228d91a1d376045db84a2157da"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#ac66d65228d91a1d376045db84a2157da">q_deltad</a></td></tr>
<tr class="memdesc:ac66d65228d91a1d376045db84a2157da"><td class="mdescLeft">&#160;</td><td class="mdescRight">directional spacing of angular grid in degrees  <a href="namespacem__xnldata.html#ac66d65228d91a1d376045db84a2157da">More...</a><br /></td></tr>
<tr class="separator:ac66d65228d91a1d376045db84a2157da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7719382ccbfa3dff7b5c6610ba5da474"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a7719382ccbfa3dff7b5c6610ba5da474">q_ffac</a></td></tr>
<tr class="memdesc:a7719382ccbfa3dff7b5c6610ba5da474"><td class="mdescLeft">&#160;</td><td class="mdescRight">geometric factor between subsequent frequencies  <a href="namespacem__xnldata.html#a7719382ccbfa3dff7b5c6610ba5da474">More...</a><br /></td></tr>
<tr class="separator:a7719382ccbfa3dff7b5c6610ba5da474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690a5866e28f3a514e5b818da0d13a88"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a690a5866e28f3a514e5b818da0d13a88">q_kfac</a></td></tr>
<tr class="memdesc:a690a5866e28f3a514e5b818da0d13a88"><td class="mdescLeft">&#160;</td><td class="mdescRight">geometric factor between subsequent wave numbers (only valid for IQ_IDISP==1)  <a href="namespacem__xnldata.html#a690a5866e28f3a514e5b818da0d13a88">More...</a><br /></td></tr>
<tr class="separator:a690a5866e28f3a514e5b818da0d13a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e648f3d54323e0bc65fd19b3d7ec496"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a6e648f3d54323e0bc65fd19b3d7ec496">qk_tail</a></td></tr>
<tr class="memdesc:a6e648f3d54323e0bc65fd19b3d7ec496"><td class="mdescLeft">&#160;</td><td class="mdescRight">power of spectral tail of N(k), computed from qf_tail  <a href="namespacem__xnldata.html#a6e648f3d54323e0bc65fd19b3d7ec496">More...</a><br /></td></tr>
<tr class="separator:a6e648f3d54323e0bc65fd19b3d7ec496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e618ab1280298dd1149e5093f7c3c1"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a30e618ab1280298dd1149e5093f7c3c1">iq_type</a></td></tr>
<tr class="memdesc:a30e618ab1280298dd1149e5093f7c3c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">method for computing the nonlinear interactions depending on the value of iq_type a number of settings for other processes or schematizations are set in Q_COMPU iq_type==1: deep water, symmetric spectrum, Webb coupling coefficient 2: deep water computation with WAM depth scaling based on Herterich and Hasselmann (1980) 3: finite depth transfer  <a href="namespacem__xnldata.html#a30e618ab1280298dd1149e5093f7c3c1">More...</a><br /></td></tr>
<tr class="separator:a30e618ab1280298dd1149e5093f7c3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b06065a1ecf68a469b2cc4402cd27c"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#af4b06065a1ecf68a469b2cc4402cd27c">iq_err</a></td></tr>
<tr class="memdesc:af4b06065a1ecf68a469b2cc4402cd27c"><td class="mdescLeft">&#160;</td><td class="mdescRight">counts the number of errors if no error occurred, IQ_ERR = 0 for each occuring error, iq_err is incremented errors are always terminating routine Q_ERROR handles the reporting on the error  <a href="namespacem__xnldata.html#af4b06065a1ecf68a469b2cc4402cd27c">More...</a><br /></td></tr>
<tr class="separator:af4b06065a1ecf68a469b2cc4402cd27c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d4ba4f63b1f15233f5539c40549ff16"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacem__xnldata.html#a2d4ba4f63b1f15233f5539c40549ff16">iq_warn</a></td></tr>
<tr class="memdesc:a2d4ba4f63b1f15233f5539c40549ff16"><td class="mdescLeft">&#160;</td><td class="mdescRight">counts the number of warnings  <a href="namespacem__xnldata.html#a2d4ba4f63b1f15233f5539c40549ff16">More...</a><br /></td></tr>
<tr class="separator:a2d4ba4f63b1f15233f5539c40549ff16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module for computing the quadruplet interaction. </p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Sep-2003 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a3157ab62f07552878f496e4ebca8daa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3157ab62f07552878f496e4ebca8daa7">&#9670;&nbsp;</a></span>cosz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::cosz </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>N/A. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>cosz</dd></dl>
<dl class="section author"><dt>Author</dt><dd>N/A </dd></dl>
<dl class="section date"><dt>Date</dt><dd>N/A </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07827">7827</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;<span class="keywordtype">      real</span> x</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;      <span class="keywordflow">if</span> (x.gt.20.) x=25.</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;      cosz=cosh(x)</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>.</p>

</div>
</div>
<a id="a06f36ef6a0e5d4fc4a984ec29bd922a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06f36ef6a0e5d4fc4a984ec29bd922a0">&#9670;&nbsp;</a></span>q_allocate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_allocate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check configuration for non-linear transfer. </p>
<p>Allocate data arrays.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8-Aug-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">1012</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">!   |   | +---+  Last update: 8 August 2003</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">!     05/10/1999  initial version</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">!     25/11/1999  logging output added</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">!     10/01/2001  Inconsistency fixed</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">!     01/10/2001  Array&#39;s for k4-locus added</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">!     08/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">!     20/08/2002  Internal action density spectrum added A</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">!     11/09/2002  q_kpow added</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">!     25/04/2003  Name modified from q_alloc -&gt; q_allocate</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">!                 Triplet array added</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">!     02/05/2003  Bug fixed in allocate of triplet arrays</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">!     11/06/2003  Array SYM_LOC added</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">!                 Parameter KLOCUS introduced for actual maximum size of locus</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">!     16/06/2003  Loci information included, moved from Q_XNL4V4</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">!     08/08/2003  Value of MLOCUS modified, now 1.3*NLOCUS0, was 1.2</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">!     Check configuration for non-linear transfer</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">!     Allocate data arrays</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">!  3. Parameters used</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">!  4. Error messaged</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">!     XNL_INIT</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">!  8. Stucture</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">!     /S  Subroutine tracing</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">!  Local variables</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="keywordtype">integer</span> maq</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="keywordtype">integer</span> mkq</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_allocate&#39;</span>)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">if</span>(iq_geom==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  mkq = nkq*(nkq+1)/2</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  mkq = nkq</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;maq    = naq/2+1</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;mlocus = 1.3*nlocus0</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="keywordflow">if</span>(iq_log &gt;=1) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,4i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;&amp;  <span class="stringliteral">&#39;Q_ALLOCATE:  mkq maq mlocus klocus:&#39;</span>,mkq,maq,mlocus,klocus</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (q_xk)) <span class="keyword">deallocate</span> (q_xk)  ; <span class="keyword">allocate</span>(q_xk(0:nkq))</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (q_sk)) <span class="keyword">deallocate</span> (q_sk)  ; <span class="keyword">allocate</span>(q_sk(0:nkq))</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_nloc)) <span class="keyword">deallocate</span> (quad_nloc) ;  <span class="keyword">allocate</span> (quad_nloc(mkq,maq))</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_ik2))  <span class="keyword">deallocate</span> (quad_ik2)  ;  <span class="keyword">allocate</span> (quad_ik2(mkq,maq,klocus))</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_ia2))  <span class="keyword">deallocate</span> (quad_ia2)  ;  <span class="keyword">allocate</span> (quad_ia2(mkq,maq,klocus))</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_ik4))  <span class="keyword">deallocate</span> (quad_ik4)  ;  <span class="keyword">allocate</span> (quad_ik4(mkq,maq,klocus))</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_ia4))  <span class="keyword">deallocate</span> (quad_ia4)  ;  <span class="keyword">allocate</span> (quad_ia4(mkq,maq,klocus))</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w1k2)) <span class="keyword">deallocate</span> (quad_w1k2) ;  <span class="keyword">allocate</span> (quad_w1k2(mkq,maq,klocus))</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w2k2)) <span class="keyword">deallocate</span> (quad_w2k2) ;  <span class="keyword">allocate</span> (quad_w2k2(mkq,maq,klocus))</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w3k2)) <span class="keyword">deallocate</span> (quad_w3k2) ;  <span class="keyword">allocate</span> (quad_w3k2(mkq,maq,klocus))</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w4k2)) <span class="keyword">deallocate</span> (quad_w4k2) ;  <span class="keyword">allocate</span> (quad_w4k2(mkq,maq,klocus))</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w1k4)) <span class="keyword">deallocate</span> (quad_w1k4) ;  <span class="keyword">allocate</span> (quad_w1k4(mkq,maq,klocus))</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w2k4)) <span class="keyword">deallocate</span> (quad_w2k4) ;  <span class="keyword">allocate</span> (quad_w2k4(mkq,maq,klocus))</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w3k4)) <span class="keyword">deallocate</span> (quad_w3k4) ;  <span class="keyword">allocate</span> (quad_w3k4(mkq,maq,klocus))</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_w4k4)) <span class="keyword">deallocate</span> (quad_w4k4) ;  <span class="keyword">allocate</span> (quad_w4k4(mkq,maq,klocus))</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span> (quad_zz))   <span class="keyword">deallocate</span> (quad_zz)   ;  <span class="keyword">allocate</span> (quad_zz(mkq,maq,klocus))</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x2_loc))   <span class="keyword">deallocate</span>(x2_loc)     ;  <span class="keyword">allocate</span> (x2_loc(mlocus))</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y2_loc))   <span class="keyword">deallocate</span>(y2_loc)     ;  <span class="keyword">allocate</span> (y2_loc(mlocus))</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x4_loc))   <span class="keyword">deallocate</span>(x4_loc)     ;  <span class="keyword">allocate</span> (x4_loc(mlocus))</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y4_loc))   <span class="keyword">deallocate</span>(y4_loc)     ;  <span class="keyword">allocate</span> (y4_loc(mlocus))</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(z_loc))    <span class="keyword">deallocate</span>(z_loc)      ;  <span class="keyword">allocate</span> (z_loc(mlocus))</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(s_loc))    <span class="keyword">deallocate</span>(s_loc)      ;  <span class="keyword">allocate</span> (s_loc(mlocus))</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(ds_loc))   <span class="keyword">deallocate</span>(ds_loc)     ;  <span class="keyword">allocate</span> (ds_loc(mlocus))</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(jac_loc))  <span class="keyword">deallocate</span>(jac_loc)    ;  <span class="keyword">allocate</span> (jac_loc(mlocus))</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cple_loc)) <span class="keyword">deallocate</span>(cple_loc)   ;  <span class="keyword">allocate</span> (cple_loc(mlocus))</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(a_pol))    <span class="keyword">deallocate</span>(a_pol)      ;  <span class="keyword">allocate</span> (a_pol(mlocus))</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(c_pol))    <span class="keyword">deallocate</span>(c_pol)      ;  <span class="keyword">allocate</span> (c_pol(mlocus))</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(k_pol))    <span class="keyword">deallocate</span>(k_pol)      ;  <span class="keyword">allocate</span> (k_pol(mlocus))</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(sym_loc))  <span class="keyword">deallocate</span> (sym_loc)   ;  <span class="keyword">allocate</span> (sym_loc(mlocus))</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x2_mod))   <span class="keyword">deallocate</span> (x2_mod)    ;  <span class="keyword">allocate</span> (x2_mod(mlocus))</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y2_mod))   <span class="keyword">deallocate</span> (y2_mod)    ;  <span class="keyword">allocate</span> (y2_mod(mlocus))</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(x4_mod))   <span class="keyword">deallocate</span> (x4_mod)    ;  <span class="keyword">allocate</span> (x4_mod(mlocus))</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(y4_mod))   <span class="keyword">deallocate</span> (y4_mod)    ;  <span class="keyword">allocate</span> (y4_mod(mlocus))</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(z_mod))    <span class="keyword">deallocate</span> (z_mod)     ;  <span class="keyword">allocate</span> (z_mod(mlocus))</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(s_mod))    <span class="keyword">deallocate</span> (s_mod)     ;  <span class="keyword">allocate</span> (s_mod(mlocus))</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(ds_mod))   <span class="keyword">deallocate</span> (ds_mod)    ;  <span class="keyword">allocate</span> (ds_mod(mlocus))</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(jac_mod))  <span class="keyword">deallocate</span> (jac_mod)   ;  <span class="keyword">allocate</span> (jac_mod(mlocus))</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(cple_mod)) <span class="keyword">deallocate</span> (cple_mod)  ;  <span class="keyword">allocate</span> (cple_mod(mlocus))</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(sym_mod))  <span class="keyword">deallocate</span> (sym_mod)   ;  <span class="keyword">allocate</span> (sym_mod(mlocus))</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(k2m_mod)) <span class="keyword">deallocate</span> (k2m_mod)   ;  <span class="keyword">allocate</span> (k2m_mod(mlocus))</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(k2a_mod)) <span class="keyword">deallocate</span> (k2a_mod)   ;  <span class="keyword">allocate</span> (k2a_mod(mlocus))</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(k4m_mod)) <span class="keyword">deallocate</span> (k4m_mod)   ;  <span class="keyword">allocate</span> (k4m_mod(mlocus))</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(k4a_mod)) <span class="keyword">deallocate</span> (k4a_mod)   ;  <span class="keyword">allocate</span> (k4a_mod(mlocus))</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(wk_k2)) <span class="keyword">deallocate</span>(wk_k2)   ;     <span class="keyword">allocate</span> (wk_k2(mlocus))</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(wa_k2)) <span class="keyword">deallocate</span>(wa_k2)   ;     <span class="keyword">allocate</span> (wa_k2(mlocus))</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(wt_k2)) <span class="keyword">deallocate</span>(wt_k2)   ;     <span class="keyword">allocate</span> (wt_k2(mlocus))</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(wk_k4)) <span class="keyword">deallocate</span>(wk_k4)   ;     <span class="keyword">allocate</span> (wk_k4(mlocus))</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(wa_k4)) <span class="keyword">deallocate</span>(wa_k4)   ;     <span class="keyword">allocate</span> (wa_k4(mlocus))</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(wt_k4)) <span class="keyword">deallocate</span>(wt_k4)   ;     <span class="keyword">allocate</span> (wt_k4(mlocus))</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">!if (allocated(t_wk2))  deallocate (t_wk2) ;     allocate (t_wk2(mlocus))</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">!if (allocated(t_wa2))  deallocate (t_wa2) ;     allocate (t_wa2(mlocus))</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">!if (allocated(t_wt2))  deallocate (t_wt2) ;     allocate (t_wt2(mlocus))</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">!if (allocated(t_wk4))  deallocate (t_wk4) ;     allocate (t_wk4(mlocus))</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">!if (allocated(t_wa4))  deallocate (t_wa4) ;     allocate (t_wa4(mlocus))</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">!if (allocated(t_wt4))  deallocate (t_wt4) ;     allocate (t_wt4(mlocus))</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">!if (allocated(t_sym))  deallocate (t_sym) ;     allocate (t_sym(mlocus))</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">!if (allocated(t_grad)) deallocate (t_grad);     allocate (t_grad(mlocus))</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">!if (allocated(t_cple)) deallocate (t_cple);     allocate (t_cple(mlocus))</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">!if (allocated(t_s))    deallocate (t_s)   ;     allocate (t_s(mlocus))</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">!if (allocated(t_ds))   deallocate (t_ds)  ;     allocate (t_ds(mlocus))</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">!  allocate data arrays for transformation of locus information</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">!  and integration along locus</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_ik2))  <span class="keyword">deallocate</span> (r_ik2)  ;   <span class="keyword">allocate</span> (r_ik2(klocus))</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_ia2))  <span class="keyword">deallocate</span> (r_ia2)  ;   <span class="keyword">allocate</span> (r_ia2(klocus))</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_ik4))  <span class="keyword">deallocate</span> (r_ik4)  ;   <span class="keyword">allocate</span> (r_ik4(klocus))</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_ia4))  <span class="keyword">deallocate</span> (r_ia4)  ;   <span class="keyword">allocate</span> (r_ia4(klocus))</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w1k2)) <span class="keyword">deallocate</span> (r_w1k2) ;   <span class="keyword">allocate</span> (r_w1k2(klocus))</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w2k2)) <span class="keyword">deallocate</span> (r_w2k2) ;   <span class="keyword">allocate</span> (r_w2k2(klocus))</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w3k2)) <span class="keyword">deallocate</span> (r_w3k2) ;   <span class="keyword">allocate</span> (r_w3k2(klocus))</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w4k2)) <span class="keyword">deallocate</span> (r_w4k2) ;   <span class="keyword">allocate</span> (r_w4k2(klocus))</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w1k4)) <span class="keyword">deallocate</span> (r_w1k4) ;   <span class="keyword">allocate</span> (r_w1k4(klocus))</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w2k4)) <span class="keyword">deallocate</span> (r_w2k4) ;   <span class="keyword">allocate</span> (r_w2k4(klocus))</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w3k4)) <span class="keyword">deallocate</span> (r_w3k4) ;   <span class="keyword">allocate</span> (r_w3k4(klocus))</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_w4k4)) <span class="keyword">deallocate</span> (r_w4k4) ;   <span class="keyword">allocate</span> (r_w4k4(klocus))</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(r_zz))   <span class="keyword">deallocate</span> (r_zz)   ;   <span class="keyword">allocate</span> (r_zz(klocus))</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_ik2))  <span class="keyword">deallocate</span> (t_ik2)  ;   <span class="keyword">allocate</span> (t_ik2(klocus))</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_ia2))  <span class="keyword">deallocate</span> (t_ia2)  ;   <span class="keyword">allocate</span> (t_ia2(klocus))</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_ik4))  <span class="keyword">deallocate</span> (t_ik4)  ;   <span class="keyword">allocate</span> (t_ik4(klocus))</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_ia4))  <span class="keyword">deallocate</span> (t_ia4)  ;   <span class="keyword">allocate</span> (t_ia4(klocus))</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w1k2)) <span class="keyword">deallocate</span> (t_w1k2) ;   <span class="keyword">allocate</span> (t_w1k2(klocus))</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w2k2)) <span class="keyword">deallocate</span> (t_w2k2) ;   <span class="keyword">allocate</span> (t_w2k2(klocus))</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w3k2)) <span class="keyword">deallocate</span> (t_w3k2) ;   <span class="keyword">allocate</span> (t_w3k2(klocus))</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w4k2)) <span class="keyword">deallocate</span> (t_w4k2) ;   <span class="keyword">allocate</span> (t_w4k2(klocus))</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w1k4)) <span class="keyword">deallocate</span> (t_w1k4) ;   <span class="keyword">allocate</span> (t_w1k4(klocus))</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w2k4)) <span class="keyword">deallocate</span> (t_w2k4) ;   <span class="keyword">allocate</span> (t_w2k4(klocus))</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w3k4)) <span class="keyword">deallocate</span> (t_w3k4) ;   <span class="keyword">allocate</span> (t_w3k4(klocus))</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_w4k4)) <span class="keyword">deallocate</span> (t_w4k4) ;   <span class="keyword">allocate</span> (t_w4k4(klocus))</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(t_zz))   <span class="keyword">deallocate</span> (t_zz)   ;   <span class="keyword">allocate</span> (t_zz(klocus))</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(dt13)) <span class="keyword">deallocate</span> (dt13) ; <span class="keyword">allocate</span>(dt13(klocus))</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">!-------------------  spectral grid data ------------------------</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_k))    <span class="keyword">deallocate</span> (q_k)   ;     <span class="keyword">allocate</span> (q_k(nkq))</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_dk))   <span class="keyword">deallocate</span> (q_dk)  ;     <span class="keyword">allocate</span> (q_dk(nkq))</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_kpow)) <span class="keyword">deallocate</span> (q_kpow);     <span class="keyword">allocate</span> (q_kpow(nkq))</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_f))    <span class="keyword">deallocate</span> (q_f)   ;     <span class="keyword">allocate</span> (q_f(nkq))</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_df))   <span class="keyword">deallocate</span> (q_df)  ;     <span class="keyword">allocate</span> (q_df(nkq))</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_sig))  <span class="keyword">deallocate</span> (q_sig) ;     <span class="keyword">allocate</span> (q_sig(nkq))</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_dsig)) <span class="keyword">deallocate</span> (q_dsig);     <span class="keyword">allocate</span> (q_dsig(nkq))</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_cg))   <span class="keyword">deallocate</span> (q_cg);       <span class="keyword">allocate</span> (q_cg(nkq))</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_a))    <span class="keyword">deallocate</span> (q_a)   ;     <span class="keyword">allocate</span> (q_a(naq))</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(q_ad))   <span class="keyword">deallocate</span> (q_ad)  ;     <span class="keyword">allocate</span> (q_ad(naq))</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(nspec)) <span class="keyword">deallocate</span> (nspec)  ;     <span class="keyword">allocate</span> (nspec(nkq,naq))</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(a)) <span class="keyword">deallocate</span> (a)          ;     <span class="keyword">allocate</span> (a(nkq,naq))</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(nk1d))  <span class="keyword">deallocate</span> (nk1d)   ;     <span class="keyword">allocate</span> (nk1d(nkq))</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">!! if (allocated(qnl))   deallocate (qnl)    ;     allocate (qnl(nkq,naq))</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="keywordflow">if</span>(iq_log &gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a)&#39;</span>)    <span class="stringliteral">&#39;Q_ALLOCATE: size of arrays&#39;</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_ALLOCATE: mkq  :&#39;</span>,mkq</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_ALLOCATE: maq  :&#39;</span>,maq</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_ALLOCATE: nkq  :&#39;</span>,nkq</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_ALLOCATE: naq  :&#39;</span>,naq</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_ALLOCATE: mlocus:&#39;</span>,mlocus</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_ALLOCATE: klocus:&#39;</span>,klocus</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_allocate&#39;</span>)</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00358">a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00289">a_pol</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00288">c_pol</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00284">cple_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00301">cple_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00282">ds_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00299">ds_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00342">dt13</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00283">jac_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00300">jac_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00305">k2a_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00304">k2m_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00307">k4a_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00306">k4m_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00287">k_pol</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00216">klocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00213">mlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00360">nk1d</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00359">nspec</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00356">q_a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">q_ad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00355">q_cg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00352">q_df</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00349">q_dk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00354">q_dsig</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00351">q_f</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">q_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00350">q_kpow</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">q_sig</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00345">q_sk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00344">q_xk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00261">quad_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00263">quad_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00260">quad_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00262">quad_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00259">quad_nloc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00264">quad_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00268">quad_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00265">quad_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00269">quad_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00266">quad_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00270">quad_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00267">quad_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00271">quad_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00272">quad_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00335">r_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00337">r_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00334">r_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00336">r_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">r_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00279">s_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00298">s_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00285">sym_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00302">sym_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00319">t_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00321">t_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00318">t_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00320">t_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00322">t_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00326">t_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00323">t_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00327">t_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00324">t_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00328">t_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00325">t_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00329">t_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00330">t_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00313">wa_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00314">wa_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00311">wk_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00312">wk_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00315">wt_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00316">wt_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00276">x2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00293">x2_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00280">x4_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00295">x4_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00277">y2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00294">y2_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00281">y4_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00296">y4_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00278">z_loc</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00297">z_mod</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="ae91009035b1a175f20a05ad476c40efc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91009035b1a175f20a05ad476c40efc">&#9670;&nbsp;</a></span>q_chkconfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_chkconfig</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check configuration for computation of non-linear transfer. </p>
<p>Check each parameter setting.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>12-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">1237</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">!   |   | +---+  Last update: 12 June 2003</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">!     28/12/1999  Initial version</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">!     05/10/1999  Test for iq_filt included</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">!     01/11/1999  Implicit none introduced</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">!     12/11/1999  Update of tests</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">!     22/11/1999  Update of tests</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">!     28/12/1999  Check of IQ_LOCUS added</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">!     02/01/2000  IQ_START removed</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">!     05/01/2000  IQ_INT added</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">!     08/08/2002  Upgrade to release 4</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">!     22/08/2002  Extra checks included</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">!     04/06/2003  parameter IQ_INT renamed IQ_INTEG</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">!                 Switches IQ_GAULEG, IQ_LUMP added</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">!     11/06/2003  Name changed from Q_CHKCFG to Q_CHKCONFIG</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">!                 Parameter iq_space removed</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">!     12/06/2003  Extra check on IMOD, KLOCUS and NLOCUS0</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">!     16/06/2003  Switch IQ_SYM added</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">!     Check configuration for computation of non-linear transfer</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">!     Check of each parameter setting</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">!  3. Parameters used</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">!     XNL_INIT</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">!  6. Subroutines used:</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">!     Q_ERROR</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">!  7. Remarkds</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">!     /S  enable subroutine tracing</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+Q_CHKCONFIG&#39;</span>)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">if</span>(qf_tail &gt; -1.) <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect power of spectral: qf_tail&#39;</span>)</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="keywordflow">if</span>(iq_cple &lt; 1 .or. iq_cple &gt; 3) &amp;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Invalid option for coupling coefficient iq_cple&#39;</span>)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="keywordflow">if</span>(iq_compact &lt; 0 .or. iq_compact &gt; 1) &amp;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;iq_compact /= 0,1&#39;</span>)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="keywordflow">if</span>(iq_filt &lt; 0 .or. iq_filt &gt; 1) &amp;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;iq_filt /= 0,1&#39;</span>)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keywordflow">if</span>(iq_gauleg &lt; 0) &amp;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;iq_gauleg &lt;0&#39;</span>)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="keywordflow">if</span>(iq_geom &lt; 0 .or. iq_geom &gt; 1) &amp;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;iq_geom /= 0,1&#39;</span>)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="keywordflow">if</span>(iq_interp &lt; 1 .or. iq_interp &gt; 2) &amp;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;iq_interp /= 1,2&#39;</span>)</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keywordflow">if</span>(iq_disp &gt; 1 .and. iq_geom ==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Invalid combination of iq_disp &amp; iq_geom&#39;</span>)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(1x,a,2i4)&#39;</span>) <span class="stringliteral">&#39;iq_disp iq_geom:&#39;</span>,iq_disp,iq_geom</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="keywordflow">if</span>(iq_lump&gt;0 .and. iq_gauleg&gt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Lumping and Gauss-Legendre interpolation not together&#39;</span>)</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(1x,a,2i4)&#39;</span>) <span class="stringliteral">&#39;iq_lump iq_gauleg:&#39;</span>,iq_lump,iq_gauleg</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="keywordflow">if</span>(iq_dscale &lt; 0 .or. iq_dscale &gt; 1) &amp;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_DSCALE, (0,1)&#39;</span>)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="keywordflow">if</span>(iq_disp &lt; 1 .or. iq_disp &gt;2 ) &amp;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_DISP [DISP],(1,2) &#39;</span>)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="keywordflow">if</span>(iq_grid &lt;1 .or. iq_grid &gt; 3) &amp;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_GRID, (1,2,3)&#39;</span>)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="keywordflow">if</span>(iq_integ &lt; 0 .or. iq_make &gt; 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Invalid value for iq_integ&#39;</span>)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(1x,a,2i4)&#39;</span>) <span class="stringliteral">&#39;iq_integ:&#39;</span>,iq_integ</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="keywordflow">if</span>(iq_log &lt; 0) &amp;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_LOG, (&gt;=0) &#39;</span>)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="keywordflow">if</span>(iq_locus &lt; 0 .or. iq_locus &gt; 3) &amp;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect specifier for locus method&#39;</span>)</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="keywordflow">if</span>(iq_lump&lt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Invalid value for iq_lump&#39;</span>)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(1x,a,2i4)&#39;</span>) <span class="stringliteral">&#39;iq_lump:&#39;</span>,iq_lump</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="keywordflow">if</span>(iq_make &lt; 1 .or. iq_make &gt; 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Invalid value for iq_make&#39;</span>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(1x,a,2i4)&#39;</span>) <span class="stringliteral">&#39;iq_make:&#39;</span>,iq_make</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="keywordflow">if</span>(iq_mod &lt; 0 .or. iq_mod &gt; 1) &amp;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_MOD [MOD] (0,1)&#39;</span>)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="keywordflow">if</span>(iq_mod==0 .and. klocus&lt;nlocus0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;klocus &lt; nlocus0&#39;</span>)</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Lumping or Gauss-Integration enabled when IMOD=0&#39;</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="keywordflow">if</span>(iq_prt &lt; 0) &amp;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_PRT, (&gt;=0) &#39;</span>)</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">!!if(iq_search==1 .and. iq_type/=3) &amp;</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">!!&amp;  call q_error(&#39;w&#39;,&#39;CONFIG&#39;,&#39;search option only active when IQUAD=3&#39;)</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="keywordflow">if</span>(iq_sym &lt;0 .or. iq_sym &gt; 1) &amp;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value of IQ_SYM /=[0,1]&#39;</span>)</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="keywordflow">if</span>(iq_test &lt; 0) &amp;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_TEST, (&gt;=0) &#39;</span>)</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keywordflow">if</span>(iq_trf &lt; 0 .or. iq_trf &gt; 3) &amp;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_TRF &#39;</span>)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">!  parameter settings ------------------------------------------------</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="keywordflow">if</span>(fqmin &lt; 0) &amp;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for FQMIN&#39;</span>)</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="keywordflow">if</span>(fqmax &lt; 0) &amp;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Incorrect value for FQMAX&#39;</span>)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keywordflow">if</span>(fqmax &lt;= fqmin) &amp;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;fmax &lt;= fmin&#39;</span>)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="keywordflow">if</span>(nkq &lt; 1) &amp;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Number of wave numbers NKQ &lt; 0&#39;</span>)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="keywordflow">if</span>(naq &lt; 1) &amp;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Number of directions NKQ &lt; 0&#39;</span>)</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="keywordflow">if</span>(nlocus0 &lt; 6) &amp;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;&amp; <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Preferred number of points on locus NLOCUS0 &lt; 6&#39;</span>)</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="keywordflow">if</span>(q_sector &lt; 40. .or. q_sector &gt; 180.) &amp;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;&amp;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;CONFIG&#39;</span>,<span class="stringliteral">&#39;Sector too small (&lt;40) or too large (&gt;180)&#39;</span>)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-Q_CHKCONFIG&#39;</span>)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00207">fqmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00206">fqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00078">iq_compact</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">iq_cple</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00094">iq_dscale</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00099">iq_filt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00103">iq_gauleg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00117">iq_integ</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00123">iq_interp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00127">iq_locus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00136">iq_lump</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00140">iq_make</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00145">iq_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00161">iq_sym</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00175">iq_trf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00216">klocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00208">q_sector</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00067">qf_tail</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a85a2f67b2aa494b0cf93af1c893ed5c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85a2f67b2aa494b0cf93af1c893ed5c9">&#9670;&nbsp;</a></span>q_chkcons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_chkcons </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nk,ndir), intent(in)&#160;</td>
          <td class="paramname"><em>xnl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_mx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_my</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check conservation laws of non-linear transfer. </p>
<p>The following conservation laws should be fulfilled: </p><pre class="fragment">     Wave Energy        SUME=0
     Wave Action        SUMA=0
     Momentum vector    SUMMX,SUMMY=0</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xnl</td><td>Transfer rate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nk</td><td>Number of wave numbers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndir</td><td>Number of directions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sum_e</td><td>Sum of wave energy. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sum_a</td><td>Sum of wave action. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sum_mx</td><td>Sum of momentum in x-direction. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sum_my</td><td>Sum of momentum in y-direction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">1435</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">!   |   | +---+  Last Update:  13 Aug. 2002</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">!     29/07/1999 Initial version</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment">!     01/11/1999 Implicit none introduced</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment">!     08/12/1999 Bug fixed in definition os momentum sum</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">!     13/08/2002 Upgrade to release 4.0</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">!     Check conservation laws of non-linear transfer</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">!     The following conservation laws should be fulfilled:</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">!     Wave Energy        SUME=0</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">!     Wave Action        SUMA=0</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">!     Momentum vector    SUMMX,SUMMY=0</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment">!Type   I/O          Name     Description</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nk         <span class="comment">! number of wave numbers</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ndir       <span class="comment">! number of directions</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  :: xnl(nk,ndir) <span class="comment">! transfer rate</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: sum_e        <span class="comment">! sum of wave energy</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: sum_a        <span class="comment">! sum of wave action</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: sum_mx       <span class="comment">! sum of momentum in x-direction</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: sum_my       <span class="comment">! sum of momentum in y-direction</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">!     XNL_MAIN</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="keywordtype">real</span> aa    <span class="comment">! action density</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="keywordtype">real</span> ee    <span class="comment">! energy density</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="keywordtype">real</span> kk    <span class="comment">! wave number</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="keywordtype">real</span> momx  <span class="comment">! momentum in x-direction</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="keywordtype">real</span> momy  <span class="comment">! momentum in y-direction</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="keywordtype">real</span> qq    <span class="comment">! bin size</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="keywordtype">integer</span> ia <span class="comment">! counter over directions</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="keywordtype">integer</span> ik <span class="comment">! counter over wave numbers</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_chklaw&#39;</span>)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">!  initialize summations</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;sum_a  = 0.</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;sum_e  = 0.</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;sum_mx = 0.</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;sum_my = 0.</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="keywordflow">do</span> ik=1,nkq</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  qq = q_delta*q_dk(ik)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  kk = q_k(ik)</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordflow">do</span> ia = 1,naq</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    aa = xnl(ik,ia)</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    ee = aa*q_sig(ik)</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    momx = aa*kk*cos(q_a(ia))</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    momy = aa*kk*sin(q_a(ia))</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    sum_a  = sum_a  + aa*qq</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    sum_e  = sum_e  + ee*qq</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    sum_mx = sum_mx + momx*qq</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    sum_my = sum_my + momy*qq</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_chklaw&#39;</span>)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00356">q_a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00390">q_delta</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00349">q_dk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">q_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">q_sig</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a3724a72fa0e8f60147e9a1ab2c48b0de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3724a72fa0e8f60147e9a1ab2c48b0de">&#9670;&nbsp;</a></span>q_chkres()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_chkres </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k4x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k4y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_kx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_ky</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>sum_w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check resonance conditions of 4 interacting wave numbers for a given water depth and dispersion relation. </p>
<p>The sum of wave number vectors and associated radian frequencies are computed:</p>
<pre class="fragment">     k1 + k2 - (k3 + k4)
     w1 + w2 - (w3 + w4)

     in which w_i = g k_i tanh(k_i d)</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k1x</td><td>X-component of wave number vector k1 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k1y</td><td>Y-component of wave number vector k1 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k2x</td><td>X-component of wave number vector k2 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k2y</td><td>Y-component of wave number vector k2 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k3x</td><td>X-component of wave number vector k3 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k3y</td><td>Y-component of wave number vector k3 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k4x</td><td>X-component of wave number vector k4 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k4y</td><td>Y-component of wave number vector k4 </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dep</td><td>Depth in m </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sum_kx</td><td>Sum of x-components of quadruplet </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sum_ky</td><td>Sum of y-components of quadruplet </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sum_w</td><td>Sum of radian frequencies</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant Van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l01574">1574</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 Aug. 2002</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment">!     16/02/2001  Initial version</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">!     01/11/2001  Implicit none introduced</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">!     09/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">!     Check resonance conditions of 4 interacting wave numbers</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">!     for a given water depth and dispersion relation</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">!     The sum of wave number vectors and associated radian frequencies</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">!     are computed:</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">!     k1 + k2 - (k3 + k4)</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">!     w1 + w2 - (w3 + w4)</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment">!     in which w_i = g k_i tanh(k_i d)</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">! Type    I/O          Name       Description</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">!----------------------------------------------------------------------</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k1x     <span class="comment">!  x-component of wave number vector k1</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k1y     <span class="comment">!  y-component of wave number vector k1</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k2x     <span class="comment">!  x-component of wave number vector k2</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k2y     <span class="comment">!  y-component of wave number vector k2</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k3x     <span class="comment">!  x-component of wave number vector k3</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k3y     <span class="comment">!  y-component of wave number vector k3</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k4x     <span class="comment">!  x-component of wave number vector k4</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   k4y     <span class="comment">!  y-component of wave number vector k4</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>  ::   dep     <span class="comment">!  depth in m</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> ::   sum_kx  <span class="comment">!  sum of x-components of quadruplet</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> ::   sum_ky  <span class="comment">!  sum of y-components of quadruplet</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> ::   sum_w   <span class="comment">!  sum of radian frequencies</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">!  5. Subroutines used</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">!     X_DISPER</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="comment">!  6. Called by:</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="comment">!     Q_MAKEGRID</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="keywordtype">real</span> w1,w2,w3,w4            <span class="comment">! radian frequecies of wave numbers</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">!!real x_disper               ! dispersion relation</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;sum_kx = (k1x + k2x) - (k3x + k4x)</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;sum_ky = (k1y + k2y) - (k3y + k4y)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">!  compute radian frequency on the basis of current dispersion relation</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;w1 = x_disper(sqrt(k1x**2 + k1y**2),dep)</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;w2 = x_disper(sqrt(k2x**2 + k2y**2),dep)</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;w3 = x_disper(sqrt(k3x**2 + k3y**2),dep)</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;w4 = x_disper(sqrt(k4x**2 + k4y**2),dep)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;sum_w = w1 + w2 - (w3 + w4)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>.</p>

</div>
</div>
<a id="a82e4e67a61b220180d75a66edaefa86f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e4e67a61b220180d75a66edaefa86f">&#9670;&nbsp;</a></span>q_cmplocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_cmplocus </td>
          <td>(</td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>ka</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>kw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>loclen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute locus function used for the determination of the resonnance condition. </p>
<p>See ALKYON, 1999.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ka</td><td>Lowest wave number magnitude of k2-locus. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kb</td><td>Highest wave number magnitude of k2-locus. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">km</td><td>Wave number magnitude at mid point. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kw</td><td>Half width of locus. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">loclen</td><td>Estimated length of locus.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8-Aug-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">1677</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">!   |   | +---+  Last update: 8 August 2003</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">!     Date        Description</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">!     18/11/1999  Initial version</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">!     08/12/1999  Tracing of locus updated and Q_TRACE included</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">!     22/12/1999  Option Q_POLAR included</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment">!     05/01/2000  LOCLEN added in interface</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment">!     09/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">!     10/09/2002  g added to interface with X_CPLE</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment">!                 test output modified</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">!     12/06/2003  Call to Z_POYAREA added to check POLAR2</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">!     08/08/2003  Check on areas only for loci with k3m/k1m &lt; 100</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">!                 Otherwise machine accuracy plays a role</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">!     Compute locus function used for the determination of the</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">!     resonnance condition</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">!     See ALKYON, 1999</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">!Type   I/O          Name          Description</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">!----------!----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: ka,kb       <span class="comment">! lowest and highest wave number magnitude of k2-locus</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: km          <span class="comment">! wave number magnitude at mid point</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: kw          <span class="comment">! half width of locus</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span> :: loclen      <span class="comment">! estimated length of locus</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">!    Q_MAKEGRID</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">!     z_zero1</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="keywordtype">real</span> k1m          <span class="comment">! magnitude of wave number k1</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="keywordtype">real</span> k3m          <span class="comment">! magnitude of wave number k3</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="keywordtype">real</span> pcos,psin    <span class="comment">! cosine and sine of normalize angle of P</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="keywordtype">real</span> klen         <span class="comment">! total length of line locus for case w1=w3</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="keywordtype">real</span> kx_beg       <span class="comment">! x-component at start point</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="keywordtype">real</span> ky_beg       <span class="comment">! y-component at start point</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="keywordtype">real</span> kx_end       <span class="comment">! x-component at end point</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="keywordtype">real</span> ky_end       <span class="comment">! y-component at end point</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="keywordtype">real</span> dsp,dsm      <span class="comment">! distances in plus and minus direction</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="keywordtype">real</span> sum          <span class="comment">! total length of locus</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="keywordtype">real</span> w1,w3        <span class="comment">! radian frequencies of wave numbers k1 and k3</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="keywordtype">real</span> eps          <span class="comment">! local accuracy for determination of roots</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="keywordtype">real</span> area1        <span class="comment">! area of locus as computed</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="keywordtype">real</span> area2        <span class="comment">! area of locus as based on LOCPOS and ellipse</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="keywordtype">real</span> ratio        <span class="comment">! maximum ratio between area1 and area2</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="keywordtype">integer</span> ierr      <span class="comment">! local error level</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="keywordtype">integer</span> iloc,jloc <span class="comment">! counters along locus</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="keywordtype">integer</span> itest     <span class="comment">! local test level for test output to unit luqtst</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keywordtype">integer</span> ip1       <span class="comment">! index +1</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keywordtype">integer</span> im1       <span class="comment">! index -1</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keywordtype">integer</span> jj        <span class="comment">! counter</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">!  function declarations</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">!!real x_disper                 ! dispersion relation</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">!!real x_cple                   ! coupling coefficient</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">!!real x_jacobian               ! Jacobian term</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_cmplocus&#39;</span>)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">!  set initial values</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;eps     = 10.*epsilon(1.)     <span class="comment">! set accuracy 10 times machine accuracy</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;itest   = iq_test             <span class="comment">! assign test level from overall setting</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">!! itest   = 1                ! (re)set local test level</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">! compute characteristics of configuration</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;px   = k1x - k3x</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;py   = k1y - k3y</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;pmag = sqrt(px**2 + py**2)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;xang = atan2(-px,py)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;pang = atan2(py,px)</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;k1m  = sqrt(k1x**2 + k1y**2)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;k3m  = sqrt(k3x**2 + k3y**2)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;w1   = x_disper(k1m,q_depth)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;w3   = x_disper(k3m,q_depth)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;q    = w1-w3</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">!  compute cosine and sine of direction of P-vector</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">!  reverse direction for the case q&lt;0</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="keywordflow">if</span>(q &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  sang = pang+<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  pcos = cos(pang+<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  psin = sin(pang+<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>)</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  sang = pang</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  pcos = cos(pang)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  psin = sin(pang)</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">!  first solution along locus: k2 = k3</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">!  check for special case if q = 0</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="keywordflow">if</span> (abs(q) &lt; eps_q) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keyword">call </span>q_loc_w1w3(k1x,k1y,k3x,k3y,nlocus0,x2_loc,y2_loc,x4_loc,y4_loc,s_loc)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  nlocus1 = nlocus0</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  ds_loc  = s_loc(2)-s_loc(1)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  klen    = s_loc(nlocus0)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  ka      = 0.</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  kb      = 0.</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  km      = 0.</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  kw      = 0.</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  sang    = xang</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment">!  compute characteristics of locus, such as its position in</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment">!  wave number space</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="keyword">call </span>q_locpos(ka,kb,km,kw,loclen)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="keywordflow">if</span>(iq_err/=0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">!  compute position of start and end point for tracing</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">!  the locus</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  kx_beg = ka*pcos</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  ky_beg = ka*psin</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  kx_end = kb*pcos</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  ky_end = kb*psin</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">!  compute position of locus using polar method</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">!  see Van Vledder (2000)</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">!%  call q_polar(ka,kb,kx_beg,ky_beg,kx_end,ky_end,loclen,ierr)</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="keyword">call </span>q_polar2(ka,kb,kx_beg,ky_beg,kx_end,ky_end,loclen,ierr)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment">! check area of locus by a simple test  (added 12 June 2003)</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a9c78903c08fc6c501113690a1e33b203">z_polyarea</a>(x2_loc,y2_loc,nlocus1,area1)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  area2 = <a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>*(kb-ka)*0.5*kw</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  ratio = max(area1/area2,area2/area1)</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">if</span>(ratio&gt;1.5 .and. k3m/k1m &lt; 100.) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;LOCUS&#39;</span>,<span class="stringliteral">&#39;Severe problem in POLAR2&#39;</span>)</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CMPLOCUS: ratio &gt; 1.5&#39;</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">!  01/10/2001</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">!  compute position of k4 locus by a simple translation</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  <span class="keywordflow">do</span> iloc=1,nlocus1</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    x4_loc(iloc) = x2_loc(iloc) + px</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    y4_loc(iloc) = y2_loc(iloc) + py</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="keywordflow">if</span> (iq_test &gt;=2) <span class="keyword">write</span>(luq_tst,<span class="stringliteral">&#39;(1x,a,4f12.5,i4)&#39;</span>)&amp;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;&amp;   <span class="stringliteral">&#39;Q_CMPLOCUS: k1x/y k3x/y nlocus:&#39;</span>,k1x,k1y,k3x,k3y,nlocus1</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment">! compute characteristics around locus</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;s_loc(1) = 0.</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;sum      = 0</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="keywordflow">do</span> iloc=1,nlocus1</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment">!  compute step sizes</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keywordflow">if</span> (abs(q) &lt; eps_q) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment">!  for this case the sum of ds_loc is unequal to s_loc(nlocus1)</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    sum = s_loc(nlocus1)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">!   compute indices of previous and next index on locus</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    ip1 = iloc+1</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">if</span> (ip1 &gt; nlocus1) ip1 = 1</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    im1 = iloc-1</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">if</span> (im1 &lt; 1) im1 = nlocus1</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    dsp = sqrt((x2_loc(iloc)-x2_loc(ip1))**2 + (y2_loc(iloc)-y2_loc(ip1))**2)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    dsm = sqrt((x2_loc(iloc)-x2_loc(im1))**2 + (y2_loc(iloc)-y2_loc(im1))**2)</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">if</span>(iloc &lt; nlocus1) s_loc(iloc + 1) = s_loc(iloc) + dsp</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    ds_loc(iloc) = 0.5*(dsp + dsm)</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    sum = sum+ds_loc(iloc)</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">!  compute gradient/Jacobian terms along locus</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;   jac_loc(iloc) = x_jacobian(x2_loc(iloc),y2_loc(iloc),x4_loc(iloc),y4_loc(iloc))</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">!  compute coupling coefficients along locus</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  k2x = x2_loc(iloc)</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  k2y = y2_loc(iloc)</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  k4x = x4_loc(iloc)</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  k4y = y4_loc(iloc)</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  cple_loc(iloc) = x_cple(k1x,k1y,k2x,k2y,k3x,k3y,k4x,k4y,iq_cple,q_depth,q_grav)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_cmplocus&#39;</span>)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00284">cple_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00282">ds_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00371">eps_q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">iq_cple</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00283">jac_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00060">luq_tst</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00215">nlocus1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00234">pang</a>, <a class="el" href="mod__constants_8f90_source.html#l00029">m_constants::pi</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00233">pmag</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">px</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">py</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06221">q_loc_w1w3()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00279">s_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00235">sang</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00276">x2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00280">x4_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07073">x_jacobian()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00236">xang</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00277">y2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00281">y4_loc</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00291">serv_xnl4v5::z_polyarea()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="ad9b2fd71e69508b41d04a3806be2f01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b2fd71e69508b41d04a3806be2f01e">&#9670;&nbsp;</a></span>q_ctrgrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_ctrgrid </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>igrid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control of interaction grid administration. </p>
<pre class="fragment">  The generation of the database file depend on the control varaible of IQ_MAKE
    if IQ_MAKE==1, make a grid when needed
                2, always make grid
                3, make a grid and stop, useful for test purposes

    The maximum number of points on the locus, as stored in the BQF file
    is read from the header and stored in the variable NLOCUS.

  Input parameter values:

    itask - task to perform by Q_CTRGRID
                ==1: read and check header block
                ==2: read and write grid file, according to setting of IQ_MAKE

    igrid - status of grid checking 
                ==0: a proper grid exists
                ==1: grid file does not exist
                ==2: grid file exists, but it is incorrect
                ==3: read error in accessing grid information</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">itask</td><td>Task to perform by Q_CTRGRID. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">igrid</td><td>Status of grid checking.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Sep-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">1968</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">!   |   | +---+  Last update: 13 Sept. 2003</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.03</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">!     Version  Date    Modification</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">!     29/07/1999  Initial version</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">!     11/10/1999  Error messages via module</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment">!     12/10/1999  File I/O of interaction grid files added, and consistency check</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">!     25/10/1999  Contents of q_header extended with iq_grid &amp; iq_start &amp; nlocus0</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">!     27/10/1999  Close statement after reading BQF file</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">!     01/11/1999  Close statments after call of Q_GRID</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">!     03/11/1999  Parameter IQ_MAKE included</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment">!     22/11/1999  Use of z_fileio modified, use parameter IUERR if an attempt</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment">!                 to open a non-existing file was made</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">!     30/11/1999  Extra messages to logging file when file are closed</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">!     03/01/2000  IQ_START replaced by IQ_LOCUS</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">!     12/01/2001  Output parameter IGRID added</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">!                 igrid=0: a proper grid exists or has been made, and will be read</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">!                      =1: grid file does not exist</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment">!                      =2: grid file exists, but it is incorrect</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">!      8/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">!     15/08/2002  Bug fixed ininitialisation of igrid</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">!     19/08/2002  header extended with parameter IQ_INTERP</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment">!     20/08/2002  wave number array replaced by sigma array in grid file</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">!     22/08/2002  Extra i/o check when reading BQF file</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">!     23/08/2002  retrieve number of point on locus from BQF file</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">!     09/09/2002  aqfile and bqfile 5 units for depth</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">!     10/09/2002  new algorithm for coding depth</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">!                 Test added to avoid rereading of last read/generated BQF file</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">!     08/10/2002  Output to test file made conditional</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment">!     05/09/2003  Water depth for creating and testing BQF file DSTEP dependend</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">!     09/09/2003  Bug fixed in assigning IGRID=0 when BQF still in memory</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">!     13/09/2003  When BFQ incorrupt, it is deleted and a new one is created</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment">!                 Bug fixed in setting of s_depth  when iq_disp==1</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">!     Control of interaction grid administration</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">!  3. Parameters used</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  :: itask</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: igrid</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">!     XNL_INIT</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">!     Q_SEARCHGRID</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">!     Q_ERROR</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">!     Q_MAKEGRID</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">!     The generation of the database file depend on the control varaible of IQ_MAKE</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">!     if IQ_MAKE==1, make a grid when needed</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">!                 2, always make grid</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">!                 3, make a grid and stop, useful for test purposes</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">!     The maximum number of points on the locus, as stored in the BQF file</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">!     is read from the header and stored in the variable NLOCUS</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">!     Make header of grid file</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">!     Construct name of grid file</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">!     Check existence of grid file</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">!     if grid file exists</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">!       read header</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">!       check header</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">!       read first data block</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">!       check first data block</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">!       - directions</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">!       - wave numbers</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">!       - depth</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">!       set status of grid file</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">!     else</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">!       set status of grid file</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">!     end if</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">!     set status of generating/reading grid file</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">!     if make new grid</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">!       compute grid parameters</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">!       write grid parameters to file</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">!     else</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">!       read grid parameters from file</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">!     end if</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="keywordtype">integer</span> iaz,ikz,jaz,jkz                <span class="comment">! counters for checking header of BQF file</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="keywordtype">integer</span> iz_geom,iz_disp,iz_cple        <span class="comment">! values as read in BQF file</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="keywordtype">integer</span> naz                            <span class="comment">! number of directions in BQF file</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="keywordtype">integer</span> nkz                            <span class="comment">! number of wave numbers in BQF file</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="keywordtype">integer</span> idep,jdep                      <span class="comment">! coding for depth in BQF file</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="keywordtype">logical</span> lbqf                           <span class="comment">! flag for existence of BQF file</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="keywordtype">real</span> s_depth                           <span class="comment">! (stepped) depth</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="keywordtype">real</span> q_depth_saved                     <span class="comment">! save input water depth, needed after call to Q_MAKEGRID</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="keywordtype">real</span> z_depth                           <span class="comment">! water depth in BQF file</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: z_ad(:),z_sig(:)  <span class="comment">! directions and radian frequencies of grid in BQF file</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="keywordtype">integer</span> ierr,iuerr                     <span class="comment">! error variables</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_ctrgrid&#39;</span>)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">!  echo input arguments</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;q_depth_saved = q_depth</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">!  generate header of BQF file</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;q_header = <span class="stringliteral">&#39;000000000000000000000&#39;</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">!           123456789012345678901</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">!                    1         2</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keyword">write</span>(q_header,<span class="stringliteral">&#39;(3i3.3,6i2.2)&#39;</span>) naq,nkq,nlocus0,&amp;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;&amp;  iq_grid,iq_geom,iq_disp,iq_cple,iq_locus,iq_interp</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>)    <span class="stringliteral">&#39;Q_CTRGRID: header info:&#39;</span>,trim(q_header)</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,3i5)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: naq nkq nlocus0:&#39;</span>,naq,nkq,nlocus0</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,3i3)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: iq_grid,iq_geom,iq_disp:&#39;</span>,iq_grid,iq_geom,iq_disp</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,3i3)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: iq_cple,iq_locus,iq_interp:&#39;</span>,iq_cple,iq_locus,iq_interp</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">! construct name of grid file</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="keywordflow">if</span>(iq_disp==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  bqname = <span class="stringliteral">&#39;quad99999.bqf&#39;</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  s_depth = q_maxdepth</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="keywordflow">elseif</span>(iq_disp==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">! generate code for actual depth</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  idep = int(q_depth/q_dstep+0.5)</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;  jdep = idep*int(10.*q_dstep)</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  jdep = max(1,jdep)</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  jdep = min(99999,jdep)</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  s_depth = real(idep)*q_dstep</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  bqname = <span class="stringliteral">&#39;quad00000.bqf&#39;</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  <span class="keyword">write</span>(bqname(5:9),<span class="stringliteral">&#39;(i5.5)&#39;</span>) min(int(q_maxdepth*10),jdep)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;DISPER&#39;</span>,<span class="stringliteral">&#39;Incorrect value for IQ_DISP&#39;</span>)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;IQ_DISP=&#39;</span>,iq_disp</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment">!  Compare LASTQUADFILE with bqname</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">!  if equal skip reading of BQF file, including checks of header</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keywordflow">if</span>(lastquadfile==bqname) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">if</span>(iq_screen&gt;0) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(2a)&#39;</span>)   <span class="stringliteral">&#39;Q_CTRGRID: Rereading of bqfile skipped: &#39;</span>,lastquadfile</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  igrid = 0</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Header line of grid file:&#39;</span>,trim(q_header)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Name of BINARY grid file:&#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">!  check if binary data file exists</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(bqname,<span class="stringliteral">&#39;OU&#39;</span>,iufind,luq_bqf,iuerr)   <span class="comment">! binary quadruplet file</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a,2x,2i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;&amp; <span class="stringliteral">&#39;Q_CTRGRID:  bqname:&#39;</span>,trim(bqname),luq_bqf,iuerr</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="keywordflow">if</span>(itask==2 .and. iq_make==2) luq_bqf=-1</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">!  if the file exists,</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">!     read header information</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">!     check header of file</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">!  end</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">!  If header is incorrect, set flag IQ_GRID to TRUE for generating new grid</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="keywordflow">if</span>(luq_bqf &gt; 0 .and. iuerr ==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>)   <span class="stringliteral">&#39;Q_CTRGRID: Binary grid file detected: &#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Connected to unit:&#39;</span>,luq_bqf</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">! grid file exists, unless proven otherwise</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  lq_grid = .false.</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  igrid   = 0</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="keyword">read</span>(luq_bqf,iostat=ierr) r_header</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="keywordflow">if</span>(ierr/=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;w&#39;</span>,<span class="stringliteral">&#39;READBQF&#39;</span>,<span class="stringliteral">&#39;Read error for header in BQF file&#39;</span>)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;BQF file deleted&#39;</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(bqname,<span class="stringliteral">&#39;DU&#39;</span>,iufind,luq_bqf,iuerr)   <span class="comment">! binary quadruplet file</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    igrid = 3</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    lq_grid = .true.</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keyword">read</span>(r_header,<span class="stringliteral">&#39;(6x,i3)&#39;</span>) nlocus</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">!   check header of grid file</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="keywordflow">if</span>(trim(r_header)/=trim(q_header).and. .not.lq_grid) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    lq_grid = .true.</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    igrid   = 2</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">if</span>(iq_prt &gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;&amp;     <span class="stringliteral">&#39;Q_CTRGRID: Header in binary quad file         :&#39;</span>,trim(r_header)</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,1x,a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;&amp;     <span class="stringliteral">&#39;Q_CTRGRID: Expected header of binary quad file:&#39;</span>,trim(q_header)</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: The file headers disagree&#39;</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: A new grid will be generated&#39;</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">!  check other parts of binary grid file</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="keywordflow">if</span>(.not.lq_grid) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keyword">read</span>(luq_bqf) naz,nkz</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keyword">allocate</span> (z_sig(nkz),z_ad(naz))</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="keyword">read</span>(luq_bqf) z_sig</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keyword">read</span>(luq_bqf) z_ad</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keyword">read</span>(luq_bqf) iz_geom,iz_disp,iz_cple</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keyword">read</span>(luq_bqf) z_depth</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;    <span class="keywordflow">if</span>(iq_prt &gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>)    <span class="stringliteral">&#39;Q_CTRGRID: Contents of BQF file&#39;</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>)   <span class="stringliteral">&#39;Q_CTRGRID: Header:&#39;</span>,trim(r_header)</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: NK:&#39;</span>,nkz</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: NA:&#39;</span>,naz</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">! check spectral interaction grid and depth for consistency</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordflow">if</span>(.not. lq_grid) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;az: <span class="keywordflow">do</span> iaz = 1,naz</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="keywordflow">if</span>(abs(q_ad(iaz)-z_ad(iaz)) &gt; 0.01) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Directions do not agree&#39;</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        <span class="keywordflow">do</span> jaz=1,naz</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;          <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(1x,a,i4,2f10.3)&#39;</span>) <span class="stringliteral">&#39;iaz q_ad z_ad:&#39;</span>,jaz,q_ad(jaz),z_ad(jaz)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        lq_grid = .true.</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        igrid = 2</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        <span class="keywordflow">exit</span> az</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="keywordflow">    end do</span> az</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="keywordflow">if</span>(.not. lq_grid) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;ak: <span class="keywordflow">do</span> ikz = 1,nkz</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <span class="keywordflow">if</span>(abs(q_sig(ikz)-z_sig(ikz)) &gt; 0.01) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Wave numbers do not agree&#39;</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">do</span> jkz=1,nkz</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;          <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(1x,a,i4,2f10.3)&#39;</span>) <span class="stringliteral">&#39;ikz q_k z_sig:&#39;</span>,jkz,q_sig(jkz),z_sig(jkz)</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        lq_grid = .true.</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        igrid = 2</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="keywordflow">exit</span> ak</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="keywordflow">    end do</span> ak</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">!  compare water depths</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <span class="keywordflow">if</span>(abs(z_depth-s_depth) &gt; 0.09 .and. iq_disp &gt; 1 .and. .not. lq_grid) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Water depths do not agree&#39;</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2f16.2)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: q_depth z_depth:&#39;</span>,q_depth,z_depth</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    lq_grid = .true.</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    igrid = 2</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <span class="keywordflow">if</span>(lq_grid) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keyword">close</span>(luq_bqf)</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Existing BQF-file invalid, it will be closed&#39;</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  lq_grid = .true.</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  igrid = 1</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="keywordflow">if</span>(itask==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keywordflow">if</span>(luq_bqf&gt;0) <span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a89fd09a962d92c04118de21b23e588d5">z_fclose</a>(luq_bqf)</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">!  if lq_grid==true  a new grid has to be generated</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment">!                    if not, read the grid information into memory</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment">!  or iq_make==2     always make an interaction grid</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment">!  or iq_make==3     as 2, plus stop after making grid</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="keywordflow">if</span>(lq_grid .or. iq_make==2 .or. iq_make==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <span class="keywordflow">if</span>(luq_bqf&gt;0) <span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a89fd09a962d92c04118de21b23e588d5">z_fclose</a>(luq_bqf)</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(bqname,<span class="stringliteral">&#39;UU&#39;</span>,iufind,luq_bqf,iuerr)   <span class="comment">! binary quadruplet file</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;    <span class="keyword">write</span>(luq_log,*)</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: New grid will be generated&#39;</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Name of BQF file:&#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: &#39;</span>//trim(bqname)//<span class="stringliteral">&#39; connected to :&#39;</span>,luq_bqf</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  <span class="keywordflow">if</span>(iq_screen &gt;= 1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(2a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;&amp; <span class="stringliteral">&#39;Q_CTRGRID: Generating wave number grid for quadruplet interactions: &#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  q_depth = s_depth</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="keyword">call </span>q_makegrid</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  q_depth = q_depth_saved</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  <span class="keywordflow">if</span>(iq_err /=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;     lastquadfile = <span class="stringliteral">&#39;quad_err_.bqf&#39;</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;     <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  igrid = 0</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  <span class="keyword">close</span>(luq_bqf)</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: &#39;</span>//trim(bqname)//<span class="stringliteral">&#39; disconnected from:&#39;</span>,luq_bqf</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <span class="keywordflow">if</span>(iq_screen &gt;=1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Grid generation completed succesfully&#39;</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">!  check of header and spectral grid succesfull</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">!  such that data can be read from BQF file</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">if</span>(iq_screen &gt;= 1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;Q_CTRGRID: Reading existing grid: &#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  <span class="keywordflow">if</span>(iq_prt &gt;= 1)    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>)  <span class="stringliteral">&#39;Q_CTRGRID: Existing grid will be read:&#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt;= 1)    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(2a)&#39;</span>)  <span class="stringliteral">&#39;Q_CTRGRID: Existing grid will be read:&#39;</span>,trim(bqname)</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_nloc</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_ik2</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_ia2</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_ik4</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_ia4</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w1k2</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w2k2</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w3k2</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w4k2</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w1k4</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w2k4</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w3k4</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_w4k4</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <span class="keyword">read</span>(luq_bqf) quad_zz</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  lastquadfile = bqname</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <span class="keyword">close</span>(luq_bqf)</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="keywordflow">if</span> (<span class="keyword">allocated</span>(z_ad)) <span class="keyword">deallocate</span>(z_ad,z_sig)</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_ctrgrid&#39;</span>)</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00193">bqname</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">iq_cple</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00123">iq_interp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00127">iq_locus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00140">iq_make</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00045">iufind</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00194">lastquadfile</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00197">lq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00050">luq_bqf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00219">nlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">q_ad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00209">q_dstep</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00195">q_header</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00366">q_maxdepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">q_sig</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00261">quad_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00263">quad_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00260">quad_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00262">quad_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00259">quad_nloc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00264">quad_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00268">quad_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00265">quad_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00269">quad_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00266">quad_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00270">quad_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00267">quad_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00271">quad_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00272">quad_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00196">r_header</a>, <a class="el" href="mod__fileio_8f90_source.html#l00364">m_fileio::z_fclose()</a>, and <a class="el" href="mod__fileio_8f90_source.html#l00084">m_fileio::z_fileio()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a382336cfa41778cc7d72807f017225d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a382336cfa41778cc7d72807f017225d8">&#9670;&nbsp;</a></span>q_dscale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_dscale </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nsig,nang), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nang), intent(in)&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>grav</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>q_dfac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute scaling factor for nonlinear transfer in finite depth. </p>
<p>Compute mean wave number km.</p>
<p>Compute scale factor based on parameterized function of (km*d) according to Herterich and Hasselmann and parameterisation from WAM model.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of sigma-values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>Number of directions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>N(nsig,nang) Action density. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsig</td><td>Sigma values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nang</td><td>Directions in (radians). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>Depth (m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grav</td><td>Gravitational acceleration. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q_dfac</td><td>Scale factor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>23-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l02397">2397</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">!   |   | +---+  Last update: 23 Aug. 2002</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">!      Date        Modification</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">!      25/02/1999  Initial version</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">!       2/12/1999  Result modified if total energy &lt;= 0</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">!                  Cosmetic changes</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">!      13/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">!      23/09/2002  Mean wave number multiplied by 0.75</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">!     Compute scaling factor for nonlinear transfer in finite depth</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">!     Compute mean wave number km</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">!     Compute scale factor based on parameterized function of (km*d)</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">!     according to Herterich and Hasselmann</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">!     and parameterisation from WAM model</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">!  3. Interface parameter list:</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">! Type          I/O     Name           Description</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">!-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent (in)</span> :: nsig          <span class="comment">! Number of sigma-values</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent (in)</span> :: nang          <span class="comment">! Number of directions</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     :: n(nsig,nang)  <span class="comment">! N(nsig,nang) Action density</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     :: sigma(nsig)   <span class="comment">! sigma values</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     :: angle(nang)   <span class="comment">! directions in (radians)</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     :: depth         <span class="comment">! Depth (m)</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     :: grav          <span class="comment">! Gravitational acceleration</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>    :: q_dfac        <span class="comment">! scale factor</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">!     XNL_MAIN</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">!     x_wnumb</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">!     z_steps</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">!     q_stack</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">!     local variables</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="keywordtype">real</span> w          <span class="comment">! radian frequency</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="keywordtype">real</span> kk         <span class="comment">! local wave number</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="keywordtype">real</span> sqkk       <span class="comment">! square root of local wave number</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="keywordtype">real</span> dnn        <span class="comment">! summation quantity</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="keywordtype">real</span> kms        <span class="comment">! mean wave number</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="keywordtype">real</span> kd         <span class="comment">! depth*mean wave number product</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="keywordtype">real</span> sum0       <span class="comment">! summation variable for total energy</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="keywordtype">real</span> sumk       <span class="comment">! summation variable for wave number</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="keywordtype">real</span> delta      <span class="comment">! directional step, in radians</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="keywordtype">integer</span> isig    <span class="comment">! counter over sigma loop</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="keywordtype">integer</span> iang    <span class="comment">! counter over direction loop</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">! functions</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="comment">!!!real z_wnumb    ! function to compute wave number</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">! temporary data</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="keywordtype">real</span> dsigma(nsig) <span class="comment">! step size of sigma array, used for integration</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_dscale&#39;</span>)</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#ad49245e4b8a78e66fc937277fba59c38">z_steps</a>(sigma,dsigma,nsig)   <span class="comment">!  compute step size of sigma&#39;s</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<a class="code" href="namespacew3sic3md.html#ac6e3d9c70c5bb2588d272cc8fbc480c0">delta</a> = angle(2)-angle(1)         <span class="comment">!  compute directional step (radians)</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;sum0 = 0.</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;sumk = 0.</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">!  compute sums for total energy andwave number</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="keywordflow">do</span> isig = 1,nsig</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  w    = sigma(isig)</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  kk   = <a class="code" href="namespaceserv__xnl4v5.html#a27c4512ce2548f874dc79799d81e0e47">z_wnumb</a>(w,depth,<a class="code" href="namespacem__constants.html#aa591a9f7dab0aa8ab034b2b539cb2465">grav</a>)   <span class="comment">! compute wave number for given sigma,depth</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  sqkk = sqrt(kk)</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  <span class="keywordflow">do</span> iang=1,<a class="code" href="namespacew3snl4md.html#ac51053a8a6beac5a86d41cddbd02ad2c">nang</a></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    dnn  = n(isig,iang)*dsigma(isig)*<a class="code" href="namespacew3sic3md.html#ac6e3d9c70c5bb2588d272cc8fbc480c0">delta</a></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    sum0 = sum0 + dnn</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    sumk = sumk + 1./sqkk*dnn</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">!  compute mean wave number and scale factor based</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">!  on the WAM approximation</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="keywordflow">if</span>(sum0 &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  kms = (sum0/sumk)**2</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  kd = max(0.5,0.75*kms*depth)</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  q_dfac = 1+5.5/kd*(1.-5./6.*kd)*exp(-5./4.*kd)</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">!  pause</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  kms = 0.</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  kd  = 0.</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  q_dfac = 1.</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_dscale&#39;</span>)</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="serv__xnl4v5_8f90_source.html#l00382">serv_xnl4v5::z_steps()</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00680">serv_xnl4v5::z_wnumb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a691fa6613a708672ce408f94a4c2cd9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691fa6613a708672ce408f94a4c2cd9e">&#9670;&nbsp;</a></span>q_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_error </td>
          <td>(</td>
          <td class="paramtype">character(len=1), intent(in)&#160;</td>
          <td class="paramname"><em>err_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>err_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>err_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error handling routine. </p>
<p>Produces a warning to an error that has occured prints the error message and print module stack to trace the origin of the error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">err_type</td><td>Type of error. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">err_name</td><td>Reference to error message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">err_msg</td><td>Optional additional error message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">2544</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">!   |   | +---+  Last update 8 Aug. 2002</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">!     0.01  22/06/1999   Initial version</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">!     0.02  20/07/1999   Error message included</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">!     0.03  24/09/1999   Full message read from file Q_ERROR.TXT</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">!                        input argument ERR_NAME added</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment">!     0.04  13/10/1999   Reading of multiple lines in Q_ERROR.TXT file</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment">!     0.05  26/11/1999   Layout modified</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment">!     0.06  30/11/1999   Extra output added, also to screen</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment">!     4.01  08/08/2002   Upgrade to release 4</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="comment">!     Error handling routine, produces a warning to an error</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="comment">!     that has occured prints the error message and print</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="comment">!     module stack to trace the origin of the error/</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment">!Type         I/O            Name           Description</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="keywordtype">character(len=1)</span>, <span class="keywordtype">intent(in)</span>   :: err_type   <span class="comment">! type of error</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">!                                              w or W: Warning or non-terminating error</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">!                                              e or E: terminating error</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: err_name     <span class="comment">!  reference to error message</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: err_msg      <span class="comment">!  Optional additional error message</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment">!     All q_** subroutines</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment">!     The reference to an error message is stored in the</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment">!     string ERR_NAME. For each error number an associated</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment">!     error is given.</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment">!     No call is made to subroutine q_trace to avoid</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment">!     infinite recursion</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="keywordtype">character(len=80)</span> qline <span class="comment">! Input line from file with error messges</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="keywordtype">integer</span> ntext           <span class="comment">! number of text line</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="keywordtype">integer</span> iend            <span class="comment">! indicator for end of line</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="keywordtype">integer</span> iutxt           <span class="comment">! unit number for text file</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="keywordtype">integer</span> iuerr           <span class="comment">! indicator for error</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="keywordtype">integer</span> j_stack         <span class="comment">! counter in printing stack</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="keywordtype">integer</span> ispace          <span class="comment">! indicates that first character of line is space</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(trim(qbase)//<span class="stringliteral">&#39;.err&#39;</span>,<span class="stringliteral">&#39;UF&#39;</span>,iufind,luq_err,iuerr)   <span class="comment">! error messages</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="comment">! logging of unit number</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;&amp; <span class="stringliteral">&#39;Q_ERROR: &#39;</span>//trim(qbase)//<span class="stringliteral">&#39;.ERR connected to unit:&#39;</span>,luq_err</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">!  write general information, when the first error or</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="keywordflow">if</span>(iq_warn ==0 .and. iq_err==0)  <span class="keywordflow">then</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) q_version</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>)<span class="stringliteral">&#39;--------------------------------------------------&#39;</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="comment">!  check type of error</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="keywordflow">if</span>(index(<span class="stringliteral">&#39;wW&#39;</span>,err_type) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  iq_warn = iq_warn + 1</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Warning or non-terminating error:&#39;</span>,iq_warn</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,a)&#39;</span>)  <span class="stringliteral">&#39;Name of error:&#39;</span>,trim(err_name)</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="keywordflow">elseif</span>(index(<span class="stringliteral">&#39;eE&#39;</span>,err_type) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  iq_err = iq_err + 1</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Terminating error:&#39;</span>,iq_err</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,a)&#39;</span>)  <span class="stringliteral">&#39;Name of error:&#39;</span>,trim(err_name)</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(1x,a,i4)&#39;</span>) <span class="stringliteral">&#39;Terminating error:&#39;</span>,iq_err</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  <span class="keyword">write</span>(*,<span class="stringliteral">&#39;(1x,a,a)&#39;</span>)  <span class="stringliteral">&#39;Name of error:&#39;</span>,trim(err_name)</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">!  search explanation of error message in the file</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">!  QF_ERROR, set in XNL_INIT</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;ntext = len_trim(err_name)</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="keywordflow">if</span>(ntext &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(qf_error,<span class="stringliteral">&#39;OF&#39;</span>,iufind,luq_txt,iutxt)</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  <span class="keywordflow">if</span>(iutxt &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="keywordflow">if</span>(iq_log &gt; 0) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(3a)&#39;</span>) &amp;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;&amp;   <span class="stringliteral">&#39;Q_ERROR: File &#39;</span>,trim(qf_error),<span class="stringliteral">&#39; does not exist in current directory&#39;</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;&amp;   <span class="stringliteral">&#39;Q_ERROR: File Q_ERROR.TXT connected to unit:&#39;</span>,luq_txt</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    iend=0</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="comment">!   scan all lines in the text file with error messages</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (iend==0)</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      <span class="keyword">read</span>(luq_txt,<span class="stringliteral">&#39;(a)&#39;</span>,iostat=iend) qline</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="keywordflow">if</span>(iend==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment">!  check code word exists in text file</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        <span class="keywordflow">if</span>(qline(1:ntext) == err_name(1:ntext)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;          <span class="keyword">write</span>(luq_err,*)</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;          <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Explanation of error, and recommended action&#39;</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;          <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;--------------------------------------------&#39;</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;          <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) trim(qline)</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment">!  read following lines until end of file or a non-space in column 1</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;          ispace = 1</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;          <span class="keywordflow">do</span> <span class="keywordflow">while</span> (ispace ==1)</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;            <span class="keyword">read</span>(luq_txt,<span class="stringliteral">&#39;(a)&#39;</span>,iostat=iend) qline</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="comment">!  check conditions</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            <span class="keywordflow">if</span>(iend==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;              <span class="keywordflow">if</span>(qline(1:1) == <span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) trim(qline)</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                ispace = 0</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;              ispace = 0</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="comment">!  close text file with error messages</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <span class="keyword">close</span>(luq_txt)</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;    <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(3a,i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;&amp;   <span class="stringliteral">&#39;Q_ERROR: File &#39;</span>,trim(qf_error),<span class="stringliteral">&#39;  disconnected from unit:&#39;</span>,luq_txt</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="keywordflow">if</span>(len_trim(err_msg) &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;  <span class="keyword">write</span>(luq_err,*)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Additional message from point of occurrence:&#39;</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) trim(err_msg)</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;  <span class="keyword">write</span>(luq_err,*)</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="comment">!  print stack of subroutines to trace the location where the</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="comment">!  error occurred</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Trace of error&#39;</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;--------------&#39;</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="keywordflow">do</span> j_stack=1,iq_stack</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(1x,i4,2x,a)&#39;</span>) j_stack,trim(cstack(j_stack))</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="keyword">write</span>(luq_err,*)</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="keywordflow">if</span>(iq_warn &gt; 10) stop <span class="stringliteral">&#39;Too many warnings&#39;</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00376">cstack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00375">iq_stack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00428">iq_warn</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00045">iufind</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00061">luq_txt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00039">q_version</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00042">qbase</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00043">qf_error</a>, and <a class="el" href="mod__fileio_8f90_source.html#l00084">m_fileio::z_fileio()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="abb5cdf4a9ea9f7d9101d1c4d26f7d7b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5cdf4a9ea9f7d9101d1c4d26f7d7b2">&#9670;&nbsp;</a></span>q_getlocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_getlocus </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ik1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ia1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ik3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ia3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ifnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve locus from basic locus as stored in the database. </p>
<p>In the case of geometric scaling, k-scaling is used using scale laws described by Tracy.</p>
<p>Directional transformation using linear transformations, shifting and mirror imaging.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ik1</td><td>K-index of wave number k1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia1</td><td>Theta-index of wave number k1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ik3</td><td>K-index of wave number k3. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia3</td><td>Theta-index of wave number k3. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ifnd</td><td>Indicator if reference locus exists in database.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>27-Aug-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">2742</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">!   |   | +---+  Last update: 27 August 2003</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="comment">!    25/02/1999  Initial version</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="comment">!    15/04/1999  Extra parameter IFND to indicate if a</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">!                reference locus exists in the data base</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">!    19/07/1999  Restructured and some bugs removed</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">!    20/07/1999  Option added to compute locus directly, no database</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">!                or scaling involved. IFND &lt; 0</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">!    15/10/1999  Information to transformation file updated</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">!    16/10/1999  Equation for computing address for storage updated</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">!    25/10/1999  Transformations updated</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="comment">!    28/10/1999  Local variables ia1 and ia3 may not be changed, temp. variables</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="comment">!                it1 and it3 included</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="comment">!    29/10/1999  Use of IQ_TRF modified</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="comment">!                EPSK introduced to check equality of loci</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment">!    28/12/1999  A_CMPLOC renamed to Q_CMPLOC</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="comment">!    03/01/2000  IQ_START replaced by IQ_LOCUS</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment">!    05/01/2000  Interface with Q_CMPLOC modified</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="comment">!    08/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment">!    13/08/2002  Indexing in terms of integers and real weights</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment">!                upgrade to release 4.0</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment">!    19/08/2002  Bug fixed in transforming CASE 6</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="comment">!                Interpolation option added</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment">!    12/06/2003  Parameter t_ws set equal to r_ws</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="comment">!    13/06/2003  Parameter t_cple, t_jac and t_sym assigned</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment">!                Bug fixed in nearest bin approach, symmetry regained</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment">!    27/08/2003  Short-cut when number of points on locus is ZERO</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment">!     Retrieve locus from basic locus as stored in the database</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment">!     In the case of geometric scaling, k-scaling is used using scale laws</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment">!     described by Tracy</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment">!     Directional transformation using linear transformations, shifting and mirror</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="comment">!     imaging.</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment">!Type      I/O           name       Description</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  ik1    <span class="comment">!  k-index of wave number k1</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  ia1    <span class="comment">!  theta-index of wave number k1</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  ik3    <span class="comment">!  k-index of wave number k3</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  ia3    <span class="comment">!  theta-index of wave number k3</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: ifnd    <span class="comment">!  indicator if reference locus exists in database</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment">!  5. Called by</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment">!     Q_T13V4</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="keywordtype">integer</span> it1,it3           <span class="comment">! work indices for directions, copy of ia1 and ia3</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="keywordtype">integer</span> idir              <span class="comment">! switch to indicate if locus should be inverted</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="keywordtype">integer</span> itrans            <span class="comment">! type of transformation</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="keywordtype">integer</span> iloc,jloc         <span class="comment">! counters along locus</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="keywordtype">integer</span> iadif,ikdif       <span class="comment">! difference in angular and k-index</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="keywordtype">integer</span> ja1r,ja3r</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="keywordtype">integer</span> imirror           <span class="comment">! extra step when locus is mirrorred</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="keywordtype">integer</span> ibeta,kdif</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="keywordtype">integer</span> nloc             <span class="comment">! number of points on locus</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="keywordtype">integer</span> ierr</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="keywordtype">integer</span> kmem                 <span class="comment">! index for storing 2-d matrix in 1-d array</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="keywordtype">integer</span> amem                 <span class="comment">! index for storing direction of reference wave number k3</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="keywordtype">real</span> lambda                  <span class="comment">! geometric scale factor</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="keywordtype">real</span> j_lambda                <span class="comment">! scale factor for Jacobian term</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="keywordtype">real</span> c_lambda                <span class="comment">! scale factor for coupling coefficient</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="keywordtype">real</span> zz_lambda               <span class="comment">! combined scale factor</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;<span class="keywordtype">real</span> xt2(nlocus),yt2(nlocus) <span class="comment">! xy-components of test k2-locus</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="keywordtype">real</span> xt4(nlocus),yt4(nlocus) <span class="comment">! xy-components of test k4-locus</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;<span class="keywordtype">real</span> wk,wa,vk,va</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;<span class="comment">!! \A</span></div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;<span class="comment">!! real x_kfunc                 ! real function to compute wave number</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;<span class="comment">!! \Z</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="keywordtype">integer</span> ikmin,ja1,ja3,jk1,jk3,itmin</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="keywordtype">integer</span> ibdif,nhalf</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="keywordtype">integer</span> iaq,ikq              <span class="comment">! counters for loop over direction and wave numbers</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">!! data i_getloc /0/  ! Initialise counter</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_getlocus&#39;</span>)</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="comment">! initialisations</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;it1 = ia1</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;it3 = ia3</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;imirror = 1</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;ikmin = min(ik1,ik3)    <span class="comment">! compute minimum of wave number index</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;ikdif = abs(ik1-ik3)    <span class="comment">! compute difference between wave number indices</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="keywordflow">if</span> (iq_geom ==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  jk1 = min(ik1,ik3)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  jk3 = max(ik1,ik3)</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  jk1 = 1</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  jk3 = ikdif + 1       <span class="comment">! compute k-index of wave number k3 relative to reference wave number</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;itmin = min(it1,it3)    <span class="comment">! compute minimum angle of k1 and k3</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;iadif = abs(it1-it3)    <span class="comment">! difference index</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;ja1   = 1               <span class="comment">! index of direction of reference wave number k1</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;ja3   = iadif+iaref     <span class="comment">! compute theta-index of direction of wave number k3</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment">!  circle grid, modify ranges and transformation variables</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="keywordflow">if</span> (iq_grid==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  nhalf = naq/2</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  <span class="keywordflow">if</span> (iadif &gt; nhalf) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <span class="keywordflow">if</span>(it1 &gt; nhalf) it1 = it1 - naq</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="keywordflow">if</span>(it3 &gt; nhalf) it3 = it3 - naq</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  itmin = min(it1,it3)</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  ibdif = (naq - abs(naq-2*abs(it1-it3)))/2   <span class="comment">! compute shortest difference in indices</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                                              <span class="comment">! while taking care of periodicity</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  ja3   = ibdif + 1</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  iadif = ibdif</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;ja1r = 1</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;ja3r = iadif + 1</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;amem = iadif + 1   <span class="comment">! compute index of reference wave number k3 in interaction grid</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="comment">! obtain k-index of reference wave number</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="keywordflow">if</span>(iq_geom==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  kmem = (jk3-jk1+1) - (jk1-2*nkq-2)*(jk1-1)/2</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  kmem = ikdif+1</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment">!  check memory indexing</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="keywordflow">if</span> (amem &gt; iamax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  ifnd = 0</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;MEMORY&#39;</span>,<span class="stringliteral">&#39;Incorrect addres&#39;</span>)</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="comment">! retrieve info from reference locus in</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment">! get actual number of valid points along locus (NLOCUSZ)</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="comment">! depending on value of switch IQ_COMPACT</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;nloc    = quad_nloc(kmem,amem)</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;nlocusx = nloc</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment">!  short-cut when number of NON-ZERO points on locus is ZERO [27/8/2003]</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="keywordflow">if</span>(nlocusx==0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;r_ik2(1:nloc)  = quad_ik2(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;r_ia2(1:nloc)  = quad_ia2(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;r_ik4(1:nloc)  = quad_ik4(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;r_ia4(1:nloc)  = quad_ia4(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;r_w1k2(1:nloc) = quad_w1k2(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;r_w2k2(1:nloc) = quad_w2k2(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;r_w3k2(1:nloc) = quad_w3k2(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;r_w4k2(1:nloc) = quad_w4k2(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;r_w1k4(1:nloc) = quad_w1k4(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;r_w2k4(1:nloc) = quad_w2k4(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;r_w3k4(1:nloc) = quad_w3k4(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;r_w4k4(1:nloc) = quad_w4k4(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;r_zz(1:nloc)   = quad_zz(kmem,amem,1:nloc)</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;kdif = ikmin - 1</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="keywordflow">if</span>(iq_geom==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  lambda = 1.</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  kdif  = 0.</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  lambda = q_kfac**(ikmin-1.)</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;j_lambda = 1./sqrt(lambda)</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;c_lambda = lambda**6</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="comment">!  compute combined scale factor</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;zz_lambda = lambda*c_lambda/j_lambda</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;<span class="comment">! select case to transform reference locus</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="comment">! Transform of weigths reduces to an addition or subtraction</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment">! because of log-spacing of wave numbers in the case of deep water</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="keywordflow">if</span>(ik3 &gt; ik1 .and. it3 &gt;= it1) <span class="keywordflow">then</span>      <span class="comment">! Case 1</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;  itrans = 1</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;  t_ik2(1:nloc)  = kdif + r_ik2(1:nloc)</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;  t_ik4(1:nloc)  = kdif + r_ik4(1:nloc)</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;  ibeta          = itmin-iaref</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;  t_ia2(1:nloc)  = r_ia2(1:nloc) + ibeta</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;  t_ia4(1:nloc)  = r_ia4(1:nloc) + ibeta</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  idir   = 1</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  t_w1k2(1:nloc)  = r_w1k2(1:nloc)</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;  t_w2k2(1:nloc)  = r_w2k2(1:nloc)</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;  t_w3k2(1:nloc)  = r_w3k2(1:nloc)</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;  t_w4k2(1:nloc)  = r_w4k2(1:nloc)</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;  t_w1k4(1:nloc)  = r_w1k4(1:nloc)</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  t_w2k4(1:nloc)  = r_w2k4(1:nloc)</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  t_w3k4(1:nloc)  = r_w3k4(1:nloc)</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;  t_w4k4(1:nloc)  = r_w4k4(1:nloc)</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="keywordflow">elseif</span>(ik3 &gt; ik1 .and. it3 &lt; it1)  <span class="keywordflow">then</span>  <span class="comment">! Case 2</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  itrans = 2</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;  t_ik2(1:nloc)  = kdif + r_ik2(1:nloc)</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;  t_ik4(1:nloc)  = kdif + r_ik4(1:nloc)</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;  ibeta          = int(q_ad(ia1)/q_deltad+0.01)</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;  t_ia2(1:nloc)  = ibeta + 2.*iaref - r_ia2(1:nloc) -imirror</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;  t_ia4(1:nloc)  = ibeta + 2.*iaref - r_ia4(1:nloc) -imirror</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;  t_w1k2(1:nloc)  = r_w3k2(1:nloc)</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  t_w2k2(1:nloc)  = r_w4k2(1:nloc)</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  t_w3k2(1:nloc)  = r_w1k2(1:nloc)</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  t_w4k2(1:nloc)  = r_w2k2(1:nloc)</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  t_w1k4(1:nloc)  = r_w3k4(1:nloc)</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  t_w2k4(1:nloc)  = r_w4k4(1:nloc)</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  t_w3k4(1:nloc)  = r_w1k4(1:nloc)</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  t_w4k4(1:nloc)  = r_w2k4(1:nloc)</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  idir   = -1   <span class="comment">! according to theory</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">!  idir   = 1    ! as it should be to get symmetry</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;<span class="keywordflow">elseif</span>(ik1 &gt; ik3 .and. it3 &gt;= it1) <span class="keywordflow">then</span>      <span class="comment">! Case 3</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  itrans = 3</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  t_ik2(1:nloc)  = kdif + r_ik4(1:nloc)</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;  t_ik4(1:nloc)  = kdif + r_ik2(1:nloc)</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  ibeta          = int(q_ad(ia3)/q_deltad+0.01)</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  t_ia2(1:nloc)  = ibeta + 2.*iaref - r_ia4(1:nloc) -imirror</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  t_ia4(1:nloc)  = ibeta + 2.*iaref - r_ia2(1:nloc) -imirror</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  t_w1k2(1:nloc)  = r_w3k2(1:nloc)</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  t_w2k2(1:nloc)  = r_w4k2(1:nloc)</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;  t_w3k2(1:nloc)  = r_w1k2(1:nloc)</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;  t_w4k2(1:nloc)  = r_w2k2(1:nloc)</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  t_w1k4(1:nloc)  = r_w3k4(1:nloc)</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;  t_w2k4(1:nloc)  = r_w4k4(1:nloc)</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  t_w3k4(1:nloc)  = r_w1k4(1:nloc)</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;  t_w4k4(1:nloc)  = r_w2k4(1:nloc)</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;  idir   = 1</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="keywordflow">elseif</span>(ik1 &gt; ik3 .and. it1 &gt; it3) <span class="keywordflow">then</span>   <span class="comment">! Case 4</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;  itrans = 4</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;  t_ik2(1:nloc)  = kdif + r_ik4(1:nloc)</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;  t_ik4(1:nloc)  = kdif + r_ik2(1:nloc)</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;  ibeta          = itmin-iaref</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  t_ia2(1:nloc)  = ibeta + r_ia4(1:nloc)</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;  t_ia4(1:nloc)  = ibeta + r_ia2(1:nloc)</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;  idir   = -1</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;  t_w1k2(1:nloc)  = r_w1k2(1:nloc)</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;  t_w2k2(1:nloc)  = r_w2k2(1:nloc)</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;  t_w3k2(1:nloc)  = r_w3k2(1:nloc)</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;  t_w4k2(1:nloc)  = r_w4k2(1:nloc)</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;  t_w1k4(1:nloc)  = r_w1k4(1:nloc)</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  t_w2k4(1:nloc)  = r_w2k4(1:nloc)</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  t_w3k4(1:nloc)  = r_w3k4(1:nloc)</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  t_w4k4(1:nloc)  = r_w4k4(1:nloc)</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="keywordflow">elseif</span>(ik1==ik3 .and. it3 &gt; it1) <span class="keywordflow">then</span>  <span class="comment">! Case 5</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;  itrans = 5</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;  t_ik2(1:nloc)  = kdif + r_ik2(1:nloc)</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  t_ik4(1:nloc)  = kdif + r_ik4(1:nloc)</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  ibeta          = itmin-iaref</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  t_ia2(1:nloc)  = r_ia2(1:nloc) + ibeta</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  t_ia4(1:nloc)  = r_ia4(1:nloc) + ibeta</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  idir   = 1</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  t_w1k2(1:nloc)  = r_w1k2(1:nloc)</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  t_w2k2(1:nloc)  = r_w2k2(1:nloc)</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;  t_w3k2(1:nloc)  = r_w3k2(1:nloc)</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  t_w4k2(1:nloc)  = r_w4k2(1:nloc)</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;  t_w1k4(1:nloc)  = r_w1k4(1:nloc)</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;  t_w2k4(1:nloc)  = r_w2k4(1:nloc)</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;  t_w3k4(1:nloc)  = r_w3k4(1:nloc)</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  t_w4k4(1:nloc)  = r_w4k4(1:nloc)</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="keywordflow">elseif</span>(ik1==ik3 .and. it1 &gt; it3) <span class="keywordflow">then</span>  <span class="comment">! Case 6</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  itrans = 6</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;  t_ik2(1:nloc)  = kdif + r_ik4(1:nloc)</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;  t_ik4(1:nloc)  = kdif + r_ik2(1:nloc)</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  ibeta          = int(q_ad(ia1)/q_deltad+0.01)</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;  t_ia2(1:nloc)  = ibeta + 2.*iaref - r_ia2(1:nloc) -imirror</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;  t_ia4(1:nloc)  = ibeta + 2.*iaref - r_ia4(1:nloc) -imirror</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">!!  ibeta          = itmin-iaref</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">!!  t_ia2(1:nloc)  = r_ia4(1:nloc) + ibeta</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment">!!  t_ia4(1:nloc)  = r_ia2(1:nloc) + ibeta</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  idir   = -1</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  t_w1k2(1:nloc)  = r_w3k2(1:nloc)</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  t_w2k2(1:nloc)  = r_w4k2(1:nloc)</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  t_w3k2(1:nloc)  = r_w1k2(1:nloc)</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  t_w4k2(1:nloc)  = r_w2k2(1:nloc)</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  t_w1k4(1:nloc)  = r_w3k4(1:nloc)</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  t_w2k4(1:nloc)  = r_w4k4(1:nloc)</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  t_w3k4(1:nloc)  = r_w1k4(1:nloc)</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  t_w4k4(1:nloc)  = r_w2k4(1:nloc)</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;t_zz(1:nloc)   = lambda*c_lambda/j_lambda * r_zz(1:nloc)</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;ifnd = 1</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_getlocus&#39;</span>)</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00386">iamax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00385">iaref</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00220">nlocusx</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">q_ad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00391">q_deltad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00394">q_kfac</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00261">quad_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00263">quad_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00260">quad_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00262">quad_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00259">quad_nloc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00264">quad_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00268">quad_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00265">quad_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00269">quad_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00266">quad_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00270">quad_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00267">quad_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00271">quad_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00272">quad_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00335">r_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00337">r_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00334">r_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00336">r_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">r_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">r_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">r_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00319">t_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00321">t_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00318">t_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00320">t_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00322">t_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00326">t_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00323">t_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00327">t_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00324">t_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00328">t_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00325">t_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00329">t_w4k4</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00330">t_zz</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a7634ad07c1f7c2fa732f432aecbd4203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7634ad07c1f7c2fa732f432aecbd4203">&#9670;&nbsp;</a></span>q_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_init</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializing module for quadruplets and setting default settings. </p>
<p>Conversion of power of spectral tail from E(f) to N(k) using the following relations:</p>
<pre class="fragment">       E(f) ~ f^qf_tail

       N(k) ~ k^qk_tail

       qk_tail = qf_tail/2 -1

    See also Note 13 of G.Ph. van Vledder</pre><dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>25-Sep-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">3121</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="comment">!   |   | +---+  Last update: 25 Sep. 2002</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="comment">!     25/02/1999 Initial version</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;<span class="comment">!     13/10/1999 Error handling improved</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="comment">!     18/10/1999 Test output to MATCHK.GRD added</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="comment">!     21/10/1999 Extra output to MATCHK.GRD, iaref=1 for circle grids</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="comment">!     01/11/1999 Allocatable arrays Q_XK and Q_SK added</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="comment">!     14/02/2001 Version ready for WAVEWATCH III</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="comment">!      8/08/2002 Release 4.</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<span class="comment">!     16/08/2002 Group velocity computed</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="comment">!     22/08/2002 First and last used defined direction accounted for</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;<span class="comment">!     11/09/2002 Call of Q_ALOC moved to higher level, viz. XNL_INIT</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="comment">!                q_kpow initialized</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">!     25/09/2002 User defined directions used in the case of a sector grid</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="comment">!     Initializing module for quadruplets</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="comment">!     and setting default settings</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">!     Conversion of power of spectral tail from E(f) to N(k) using the following</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">!     relations:</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment">!       E(f) ~ f^qf_tail</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="comment">!       N(k) ~ k^qk_tail</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">!       qk_tail = qf_tail/2 -1</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment">!     See also Note 13 of G.Ph. van Vledder</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="comment">!     Name    I/O  Type  Description</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">!  4. error meassage</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">!  5. Called by</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">!     XNL_INIT</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">!     Z_CMPCG</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="comment">!     Z_STEPS</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="comment">!     Z_WNUMB</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">!     /S Enable subroutine tracing</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment">!------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="keywordtype">integer</span> iaq,ikq    <span class="comment">! counters for loops over directions and wave numbers</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="keywordtype">real</span> ff            <span class="comment">! frequency</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment">!!!real z_wnumb       ! service function to compute wave number</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_init&#39;</span>)</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment">! set general settings</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment">! convert power of E(f) f^qf_tail to power of N(k) k^qk_tail</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment">! See Note 13 of G.Ph. van Vledder</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;qk_tail = (qf_tail-2.)/2. <span class="comment">! power of spectral tail, of N(k)</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f6.1)&#39;</span>) <span class="stringliteral">&#39;Q_INIT:  E(f)_tail: &#39;</span>,qf_tail</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f6.1)&#39;</span>) <span class="stringliteral">&#39;Q_INIT:  N(k)_tail: &#39;</span>,qk_tail</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment">! set absolute and relative accuracies</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;eps_q   = 0.001           <span class="comment">! absolute accuracy for check of q==0</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;eps_k   = 1.e-5           <span class="comment">! absolute accuracy for equality check of k</span></div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;rel_k   = 0.001           <span class="comment">! relative accuracy for equality check of k</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;sk_max = 50.              <span class="comment">! set maximum waver number</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;wk_max = real(nkq+0.9999) <span class="comment">! set maximum wave number index</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">! compute frequency and wave number grid</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment">! assume that frequencies are always geometrically spaced,</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment">! in the case of deep water this also holds for the wave numbers</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;q_ffac = (fqmax/fqmin)**real(1./(nkq-1.))         <span class="comment">! geometric spacing factor of frequencies</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;ff = fqmin                                        <span class="comment">! set minimum frequency</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Basic wave numbers, frequencies&#39;</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="keywordflow">do</span> ikq=1,nkq                                       <span class="comment">! Generate wave number dependent variables</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;  q_f(ikq)    = ff                                 <span class="comment">! Frequency</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  q_sig(ikq)  = ff*2.*<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>                           <span class="comment">! Radian frequency</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  q_k(ikq)    = <a class="code" href="namespaceserv__xnl4v5.html#a27c4512ce2548f874dc79799d81e0e47">z_wnumb</a>(q_sig(ikq),q_depth,q_grav) <span class="comment">! compute wave number</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  q_kpow(ikq) = (q_k(1)/q_k(ikq))**7.5             <span class="comment">! used in filtering</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;  ff          = ff*q_ffac                          <span class="comment">! Increase frequency</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#ac0005154c8695dc5033a829bfb1b3efe">z_cmpcg</a>(q_sig(ikq),q_depth,q_grav,q_cg(ikq))</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  <span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4,3f10.5,e12.4)&#39;</span>) <span class="stringliteral">&#39;Q_INIT: ikq f sigma k k^p:&#39;</span>, &amp;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;&amp;    ikq,q_f(ikq),q_sig(ikq),q_k(ikq),q_kpow(ikq)</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">! compute characteristics of extended k-array</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Extended wave numbers and spacing&#39;</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="keywordflow">do</span> ikq=0,nkq</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;  <span class="keywordflow">if</span>(ikq==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    q_xk(ikq) = 0.</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    q_sk(ikq) = q_k(1)</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  <span class="keywordflow">elseif</span>(ikq==nkq) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    q_xk(ikq) = q_k(ikq)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    q_sk(ikq) = sk_max</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    q_xk(ikq) = q_k(ikq)</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    q_sk(ikq) = q_k(ikq+1) - q_k(ikq)</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;kqmin = q_k(1)</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;kqmax = q_k(nkq)</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;q_kfac = (kqmax/kqmin)**real(1./(nkq-1))  <span class="comment">! this value makes only sense in the</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                                          <span class="comment">! case of deep water, IQ_DISP==1</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment">! compute step size of frequency grids and wave number grid</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#ad49245e4b8a78e66fc937277fba59c38">z_steps</a>(q_f,  q_df,  nkq)           <span class="comment">! step size of frequencies</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#ad49245e4b8a78e66fc937277fba59c38">z_steps</a>(q_sig,q_dsig,nkq)           <span class="comment">! step size of radian frequencies</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;<span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#ad49245e4b8a78e66fc937277fba59c38">z_steps</a>(q_k,  q_dk,  nkq)           <span class="comment">! step size of wave numbers</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_INIT: Additional information&#39;</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.1)&#39;</span>)  <span class="stringliteral">&#39;Q_depth (m):&#39;</span>,q_depth</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i3)&#39;</span>)    <span class="stringliteral">&#39;Number of frequencies:&#39;</span>,nkq</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.4)&#39;</span>)  <span class="stringliteral">&#39;Geometric f-spacing factor:&#39;</span>,q_ffac</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.4)&#39;</span>)  <span class="stringliteral">&#39;Geometric k-spacing factor:&#39;</span>,q_kfac</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2f8.3)&#39;</span>) <span class="stringliteral">&#39;fmin fmax (Hz):&#39;</span>,fqmin,fqmax</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2f8.3)&#39;</span>) <span class="stringliteral">&#39;kmin kmax (Hz):&#39;</span>,kqmin,kqmax</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  <span class="keyword">write</span>(luq_prt,*) <span class="stringliteral">&#39;     i      f         df       sig      dsig       k         dk         cg&#39;</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  <span class="keywordflow">do</span> ikq=1,nkq</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(1x,i4,7f10.4)&#39;</span>) &amp;</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; &amp;  ikq,q_f(ikq),q_df(ikq),q_sig(ikq),q_dsig(ikq),q_k(ikq),q_dk(ikq),q_cg(ikq)</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="comment">! =============== D I R E C T I O N S ===============================================</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;<span class="comment">! the directions in the array ANGLE are running from 1 to NAQ</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;<span class="comment">! for a sector definition the middle direction has index IAREF</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;<span class="comment">!  compute index IAREF of middle wave direction for sector grids</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="keywordflow">if</span>(iq_grid ==1 .or. iq_grid==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  iaref = (naq/2)+1</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="keywordflow">elseif</span>(iq_grid==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;  iaref = 1</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;&amp;  <span class="stringliteral">&#39;Q_INIT: Index of first direction for reference:&#39;</span>,iaref</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;<span class="comment">!  set loops indices</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="keywordflow">if</span>(iq_grid==1) <span class="keywordflow">then</span>    <span class="comment">! symmetric sector</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;  iaq1 = iaref</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;  iaq2 = naq</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;<span class="comment">! non-symmetric sector and full circle</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;<span class="keywordflow">elseif</span>(iq_grid==2 .or. iq_grid==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;  iaq1 = 1</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;  iaq2 = naq</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;&amp;  <span class="stringliteral">&#39;Q_INIT: Range of indices for loop over directions:&#39;</span>,iaq1,iaq2</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="comment">!  generate directions, given in degrees</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;q_sector = 0.5*(abs(q_dird1) + abs(q_dird2))</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="keywordflow">if</span>(iq_grid==1 .or. iq_grid==2) <span class="keywordflow">then</span>    <span class="comment">! define symmetric sector</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  q_deltad = 2.*q_sector/real(naq-1.)  <span class="comment">! delta in degrees</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  q_ang1 = -q_sector                   <span class="comment">! degrees</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  q_ang2 =  q_sector                   <span class="comment">! degrees</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="keywordflow">if</span>(iq_prt&gt;0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_INIT: take care of q_dird1 and check if sector is OK&#39;</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="keywordflow">elseif</span>(iq_grid==3) <span class="keywordflow">then</span>                <span class="comment">! full sector</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  q_deltad = 360./real(naq)            <span class="comment">! degrees</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  q_ang1 = 0                           <span class="comment">! degrees</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  q_ang2 = 360.-q_delta                <span class="comment">! degrees</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;q_delta = q_deltad*<a class="code" href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">dera</a>                <span class="comment">! directional step in radians</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;ncirc   = 2.00001*<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>/q_delta           <span class="comment">! number of directions on circle</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,3f10.3)&#39;</span>)     <span class="stringliteral">&#39;Q_INIT: d(1),d(n),dsector:&#39;</span>,q_dird1,q_dird2,q_sector</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f6.2,a)&#39;</span>)     <span class="stringliteral">&#39;Q_INIT: Angular step     :&#39;</span>,q_deltad,<span class="stringliteral">&#39; degrees&#39;</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2f8.2,i4,a)&#39;</span>) <span class="stringliteral">&#39;Q_INIT: ang1 ang2 nang   :&#39;</span>,q_ang1,q_ang2,naq,<span class="stringliteral">&#39; degrees&#39;</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>)         <span class="stringliteral">&#39;Q_INIT: #Angles on circle:&#39;</span>,ncirc</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment">!  generate directions arrays, given in degrees and radians</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="keywordflow">do</span> iaq=1,naq</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;  q_ad(iaq) = q_ang1 + q_deltad*(iaq-1.)</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;  q_a(iaq)  = q_ad(iaq)*<a class="code" href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">dera</a></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <span class="keywordflow">if</span>(iq_prt &gt;= 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4,f10.4,f10.2)&#39;</span>) <span class="stringliteral">&#39;Q_INIT: iaq q_a q_ad:&#39;</span>,iaq,q_a(iaq),q_ad(iaq)</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="keywordflow">if</span>(iaq==naq) <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="comment">!  set loop indices for generation of grid</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="comment">!  for sector grids and circle grids</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;<span class="keywordflow">if</span>(iq_grid==1 .or. iq_grid==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  iag1  = iaref</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  iag2  = naq</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment">!  circle grid</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="keywordflow">elseif</span>(iq_grid==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;  iag1 = 1</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;  iag2 = naq/2+1</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;iamax = iag2-iag1+1</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="comment">!-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_init&#39;</span>)</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__constants_8f90_source.html#l00032">m_constants::dera</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00372">eps_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00371">eps_q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00207">fqmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00206">fqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00388">iag1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00388">iag2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00386">iamax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">iaq1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">iaq2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00385">iaref</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00223">kqmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00222">kqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00201">ncirc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__constants_8f90_source.html#l00029">m_constants::pi</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00356">q_a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">q_ad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00389">q_ang1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00389">q_ang2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00355">q_cg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00390">q_delta</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00391">q_deltad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00352">q_df</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00364">q_dird1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00364">q_dird2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00349">q_dk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00354">q_dsig</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00351">q_f</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00393">q_ffac</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">q_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00394">q_kfac</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00350">q_kpow</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00208">q_sector</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">q_sig</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00345">q_sk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00344">q_xk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00067">qf_tail</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00396">qk_tail</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00373">rel_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00346">sk_max</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00224">wk_max</a>, <a class="el" href="serv__xnl4v5_8f90_source.html#l00046">serv_xnl4v5::z_cmpcg()</a>, <a class="el" href="serv__xnl4v5_8f90_source.html#l00382">serv_xnl4v5::z_steps()</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00680">serv_xnl4v5::z_wnumb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="ac3bc59bcf3d34464be37d304e2760999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3bc59bcf3d34464be37d304e2760999">&#9670;&nbsp;</a></span>q_loc_w1w3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_loc_w1w3 </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>k2x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>k2y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>k4x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>k4y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute locus for the special case w1=w3. </p>
<p>For this case, the k2-locus consists of a straight line.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k1x</td><td>X-component of wave number k1. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k1y</td><td>Y-component of wave number k1. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k3x</td><td>X-component of wave number k3. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k3y</td><td>Y-component of wave number k3. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">npts</td><td>Number of points. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k2x</td><td>X-component of wave number k2. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k2y</td><td>Y-component of wave number k2. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k4x</td><td>X-component of wave number k4. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">k4y</td><td>Y-component of wave number k4. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">s</td><td>Distance along locus.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>11-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l06221">6221</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;<span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;<span class="comment">!   |   | +---+  Last update: 11 June 2003</span></div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;<span class="comment">!     15/04/2002  Initial version</span></div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;<span class="comment">!     20/08/2002  Direction of k1 may be non-zero</span></div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;<span class="comment">!     27/08/2002  Singular solution crosses origin</span></div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;<span class="comment">!     11/06/2003  Length of locus fixed to 3</span></div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;<span class="comment">!     Compute locus for the special case w1=w3</span></div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;<span class="comment">!     For this case, the k2-locus consists of a straight line</span></div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;<span class="comment">!  3. Parameter used:</span></div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: npts      <span class="comment">! Number of points</span></div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>    :: k1x       <span class="comment">! x-component of wave number k1</span></div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>    :: k1y       <span class="comment">! y-component of wave number k1</span></div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>    :: k3x       <span class="comment">! x-component of wave number k3</span></div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>    :: k3y       <span class="comment">! y-component of wave number k3</span></div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   :: k2x(npts) <span class="comment">! x-component of wave number k2</span></div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   :: k2y(npts) <span class="comment">! y-component of wave number k2</span></div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   :: k4x(npts) <span class="comment">! x-component of wave number k4</span></div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   :: k4y(npts) <span class="comment">! y-component of wave number k4</span></div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   :: s(npts)   <span class="comment">! distance along locus</span></div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;<span class="comment">!  5. Caled by:</span></div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;<span class="comment">!     Q_CMPLOCUS</span></div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;<span class="comment">!     Routine based on modified version of routine SHLOCX of Resio and Tracy</span></div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;<span class="comment">!     On 15/4/2002 a bug fixed in computation of THR when angle of k3 is larger than 90</span></div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;<span class="comment">!     In addition, the assumption that k1y=0 and thus dir1=0 is removed</span></div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;<span class="comment">!     In bug fix of 20/8/2002 this restriction is removed.</span></div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;<span class="comment">!     Compute angle of symmetry axis</span></div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;<span class="comment">!     Compute distance between 2 lines of solution</span></div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;<span class="comment">!     compute wave numbers along locus</span></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;<span class="comment">!     rotate angles</span></div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;<span class="keywordtype">integer</span> ipt   <span class="comment">! counter of points along locus</span></div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;<span class="keywordtype">real</span> dirs     <span class="comment">! angle of symmetry axis</span></div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;<span class="keywordtype">real</span> dir1     <span class="comment">! direction of wave number k1</span></div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;<span class="keywordtype">real</span> dir3     <span class="comment">! direction of wave number k3</span></div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;<span class="keywordtype">real</span> dk0      <span class="comment">! step size along locus</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;<span class="keywordtype">real</span> xk0      <span class="comment">! x-component</span></div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;<span class="keywordtype">real</span> yk0      <span class="comment">! y-component</span></div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;<span class="keywordtype">real</span> w2       <span class="comment">! radian frequency</span></div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;<span class="keywordtype">real</span> xx2,yy2  <span class="comment">! values along k2-locus</span></div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;<span class="keywordtype">real</span> xx4,yy4  <span class="comment">! values along k4-locus</span></div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;<span class="keywordtype">real</span> k1m      <span class="comment">! magnitude of wave number k1</span></div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;<span class="comment">!    dirs is the angle of rotation from the x-axis to the &quot;bisecting&quot; angle</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;dir1 = atan2(k1y,k1x)</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;dir3 = atan2(k3y,k3x)</div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;dirs = 0.5*(180-abs(180-abs(dir3-dir1)))</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;k1m  = sqrt(k1x**2 + k1y**2)</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;<span class="comment">!     k1x is the total length of the wavenumber vector</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;<span class="comment">!     xk0 is the length of this vector in the rotated coordinate system</span></div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;xk0 = k1m * cos(dirs)</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;yk0 = k1m * sin(dirs)</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;<span class="comment">! Specify step size for solution of singular case</span></div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;<span class="comment">!! dk0 = 0.11    ! Removed on 11/6/2003, this value is used in original WRT code</span></div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;<span class="comment">!! dk0 = kqmax/real(npts-1.)             this value depends on actual grid</span></div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;dk0 = 3./real(<a class="code" href="namespacew3snl4md.html#a44e294fdfc48a42209f7a6fe12f9acfc">npts</a>-1.)                 <span class="comment">!  this is test value</span></div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;<span class="comment">!  modify rotation angle</span></div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;dirs = dirs + dir1</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;<span class="comment">!  generate sequence of parallel lines</span></div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;<span class="comment">!  rotate lines over modified angle DIRS</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;<span class="keywordflow">do</span> ipt=1,<a class="code" href="namespacew3snl4md.html#a44e294fdfc48a42209f7a6fe12f9acfc">npts</a></div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;<span class="comment">!  w2       = real(ipt-1.)*dk0         ! removed on Aug. 27 2002</span></div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;  w2       = 2.*real(ipt-<a class="code" href="namespacew3snl4md.html#a44e294fdfc48a42209f7a6fe12f9acfc">npts</a>/2)*dk0   <span class="comment">! create line on both sides of origin</span></div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;  xx2      = w2*xk0</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;  yy2      = yk0</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;  k2x(ipt) = xx2*cos(dirs) - yy2*sin(dirs)</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;  k2y(ipt) = yy2*cos(dirs) + xx2*sin(dirs)</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;  xx4      = xx2</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;  yy4      = -yy2</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;  k4x(ipt) = xx4*cos(dirs) - yy4*sin(dirs)</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;  k4y(ipt) = yy4*cos(dirs) + xx4*sin(dirs)</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;  s(ipt)   = real(ipt-1)*dk0*xk0</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="aec7d7723e90833f240a89470fade91d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec7d7723e90833f240a89470fade91d2">&#9670;&nbsp;</a></span>q_locpos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_locpos </td>
          <td>(</td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>ka</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>kw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>loclen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute characteristics of locus used to optimize its acutal computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ka</td><td>Minimum k along symmetry axis. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kb</td><td>Maximum k along symmetry axis. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">km</td><td>Wave number at midpoint. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kw</td><td>Half width of locus at midpoint. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">loclen</td><td>Estimated length of locus.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>14-Oct-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">3414</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="comment">!   |   | +---+  Last update: 14 Oct. 2002</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">z_root2</a></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="comment">!     Version Date        Description</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;<span class="comment">!     03/12/1999  Initial version</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">!     09/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="comment">!     29/08/2002  Error handling z_root2 relaxed and some write statements modified</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">!     07/10/2002  Initialisation of QSQ replaced</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="comment">!     Compute characteristics of locus used to optimize its acutal computation</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;<span class="comment">!Type    I/O          Name     Description</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent (out)</span> :: ka     <span class="comment">! minimum k along symmetry axis</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent (out)</span> :: kb     <span class="comment">! maximum k along symmetry axis</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent (out)</span> :: km     <span class="comment">! wave number at midpoint</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent (out)</span> :: kw     <span class="comment">! half width of locus at midpoint</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent (out)</span> :: loclen <span class="comment">! estimated length of locus</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;<span class="comment">!     Q_CMPLOCUS</span></div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;<span class="comment">!     z_zero2   Root finding method</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;<span class="comment">!     x_locus1  Function of locus geometry, along symmetry axis</span></div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="comment">!     x_locus2  Function of locus geometry, perpendicular to symmetry axis</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="comment">!     x_flocus  Locus function</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;<span class="comment">!     /S  enable subroutine tracing</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="comment">!     /T  enable test output</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="keywordtype">real</span> kp           <span class="comment">! wave number at peak</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="keywordtype">real</span> kpx,kpy      <span class="comment">! wave number at peak maximum</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="keywordtype">real</span> zp           <span class="comment">! value of locus function at maximum</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="keywordtype">real</span> za,zb        <span class="comment">! (test) value of locus function at kmin &amp; kmax</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="keywordtype">real</span> zz1,zz2      <span class="comment">! intermediate function values in interation process</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;<span class="keywordtype">real</span> kk1,kk2      <span class="comment">! start values for finding root of locus equation</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="keywordtype">real</span> kk1x,kk1y    <span class="comment">! wave number components at one side of root</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="keywordtype">real</span> kk2x,kk2y    <span class="comment">! wave number components at other side of root</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;<span class="keywordtype">real</span> beta1,beta2  <span class="comment">! parameters specifying cross component</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="keywordtype">real</span> betaw        <span class="comment">! parameter specifying iterated cross component</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="keywordtype">real</span> kwx,kwy      <span class="comment">! wave number at side of locus</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="keywordtype">real</span> zw           <span class="comment">! function value at (kwx,kwy)</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="keywordtype">real</span> a1,a2,b1,b2  <span class="comment">! constants in polynomial approximation of elliptic function</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="keywordtype">real</span> aa,bb,mm,mm1 <span class="comment">! semi-major exis of ellips and derived parameters</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="keywordtype">real</span> eps         <span class="comment">! local machine accuracy for determination of roots</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="keywordtype">real</span> bacc        <span class="comment">! accuracy for determination of beta</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="keywordtype">real</span> kacc        <span class="comment">! accuracy for determination of wave number roots</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="keywordtype">real</span> qs          <span class="comment">! (w1-w3)/sqrt(g)</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="keywordtype">real</span> qsq         <span class="comment">! gs^2</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment">! Function declaration</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">!real z_root2     ! root finding using Ridders method</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="keywordtype">integer</span> ierr     <span class="comment">! local error indicator, used in function Z-ZERO1</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="keywordtype">integer</span> itest    <span class="comment">! local test level for test output</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="keywordtype">integer</span> lutest   <span class="comment">! unit for test output in service routines</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="keywordtype">integer</span> iter     <span class="comment">! local iteration number</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="keywordtype">integer</span> maxiter  <span class="comment">! maximum number of iteration for determining starting points</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="comment">!  function declarations</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment">!!real, external :: x_locus2    ! locus function perpendicular to symmetry axis</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">!!real x_flocus                 ! 2-d locus function</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">!  assign test options</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;itest  = iq_test              <span class="comment">! assign test level</span></div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;lutest = 0                    <span class="comment">! assign default, no test output in service routines</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;itest  = 0                    <span class="comment">! reset local test level</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="keywordflow">if</span>(itest &gt; 0) lutest=luq_tst   <span class="comment">! assign unit for test output</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_locpos&#39;</span>)</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment">!  set initial values</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;eps     = epsilon(1.)         <span class="comment">! determine machine accurcy</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;maxiter = 20                  <span class="comment">! maximum number of iterations</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment">! compute location of maximum, located at k_2 = P</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;kpx  = -px</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;kpy  = -py</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;kp   = sqrt(kpx**2 + kpy**2)</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;zp   = x_locus1(kp)</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="comment">! find location of points A and B on locus</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="comment">! for deep water, explicit relations are available</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="keywordflow">if</span>(iq_disp==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;  qs = q/<a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;  qsq  = qs*qs</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;  <span class="keywordflow">if</span>(qs &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    ka = 0.5*(-qs+sqrt(2.0*pmag-qsq))</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    ka = ka**2</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    kb = (pmag+qsq)/(2.*qs)</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    kb = kb**2</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    za = x_locus1(ka)</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    zb = x_locus1(kb)</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    ka = 0.5*(-qs+sqrt(2.0*pmag-qsq))</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    ka = -ka**2</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;    kb = (pmag-qsq)/(2.*qs)</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    kb = kb**2</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    za = x_locus1(ka)</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    zb = x_locus1(kb)</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="comment">!  find location of points A and B on locus</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;<span class="comment">!  for water of finite depth, an iteration process is applied to</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;<span class="comment">!  determine the zero-crossings of the locus function</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  <span class="keywordflow">if</span>(q&lt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment">!   set two start points to locate position of wave number ka</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    kk1 = 0.</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    kk2 = kp</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="comment">!   search root by Ridder&#39;s method</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    kacc = 10.*max(kk1,kk2)*eps</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    ka = <a class="code" href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">z_root2</a>(x_locus1,kk1,kk2,kacc,lutest,ierr)</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;<span class="comment">!   determine start points to locate position of wave number kb</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    kk1 = kp</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    kk2 = kp</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    zz1 = zp</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    zz2 = zp</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = 0</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;<span class="comment">!  ensure that two points are found on either side of zero-crossing</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (zz1*zz2 &gt;= 0 .and. <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> &lt; maxiter)</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> + 1</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      kk2 = kk2*2</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;      zz2 = x_locus1(kk2)</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a>&gt;=maxiter) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;Start kb&#39;</span>,<span class="stringliteral">&#39;Too many iterations needed&#39;</span>)</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;      <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="comment">!   search root by Ridders method</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    kacc = 10.*max(kk1,kk2)*eps</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    kb = <a class="code" href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">z_root2</a>(x_locus1,kk1,kk2,kacc,lutest,ierr)</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;<span class="comment">!==================================================================</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;<span class="comment">!   find positions for ka and kb for the case q &gt; 0</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;<span class="comment">!   set two start points to locate position of wave number ka</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    kk1  = 0.</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    kk2  = -kp</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    zz1  = x_locus1(kk1)</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    zz2  = x_locus1(kk2)</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = 0</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">!  ensure that two points are found on either side of zero-crossing</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (zz1*zz2 &gt;= 0 .and. <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> &lt; maxiter)</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> + 1</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      kk2 = kk2*2</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      zz2 = x_locus1(kk2)</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a>&gt;=maxiter) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;Start ka&#39;</span>,<span class="stringliteral">&#39;Too many iterations needed&#39;</span>)</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;<span class="comment">!   search root by Ridder&#39;s method</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    kacc = 10.*max(abs(kk1),abs(kk2))*eps</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;    ka = <a class="code" href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">z_root2</a>(x_locus1,kk1,kk2,kacc,lutest,ierr)</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;<span class="comment">!   determine start points to locate position of wave number kb</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    kk1  = 0</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    kk2  = kp</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    zz1  = x_locus1(kk1)</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    zz2  = x_locus1(kk2)</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = 0</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;<span class="comment">!  ensure that two points are found on either side of zero-crossing</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (zz1*zz2 &gt;= 0 .and. <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> &lt; maxiter)</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;      <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> + 1</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      kk2 = kk2*2</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      zz2 = x_locus1(kk2)</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a>&gt;=maxiter) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;Start kb&#39;</span>,<span class="stringliteral">&#39;Too many iterations needed&#39;</span>)</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;<span class="comment">!   search root by Ridders method</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;    kacc = 10.*max(kk1,kk2)*eps</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    kb = <a class="code" href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">z_root2</a>(x_locus1,kk1,kk2,kacc,luq_tst,ierr)</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="comment">!   find positions for ka and kb for the case q &gt; 0</span></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;  za = x_locus1(ka)</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  zb = x_locus1(kb)</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="comment">! compute position of mid point</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;kmid = 0.5*(ka+kb)</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;km   = kmid</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="keywordflow">if</span>(q &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  kmidx = kmid*cos(pang+<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>)</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;  kmidy = kmid*sin(pang+<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>)</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;  kmidx = kmid*cos(pang)</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  kmidy = kmid*sin(pang)</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="comment">! compute width of locus near mid point of locus</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="comment">! set starting values for determination of crossing point</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;beta1 = 0.</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;kk1x  = kmidx</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;kk1y  = kmidy</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;beta2 = 0.5</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;kk2x  = kmidx - beta2*py</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;kk2y  = kmidy + beta2*px</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;zz1   = x_flocus(kk1x,kk1y)</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;zz2   = x_flocus(kk2x,kk2y)</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = 0</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;<span class="keywordflow">do</span> <span class="keywordflow">while</span> (zz1*zz2 &gt; 0 .and. <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> &lt; maxiter)</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;  <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> = <a class="code" href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">iter</a> + 1</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;  kk2x = kmidx - beta2*py</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;  kk2y = kmidy + beta2*px</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;  zz1  = x_flocus(kk1x,kk1y)</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;  zz2  = x_flocus(kk2x,kk2y)</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  beta2 = beta2*2</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="comment">! call Ridders method to locate position of zero-crossing</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;bacc = 10.*max(beta1,beta2)*eps</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;betaw = <a class="code" href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">z_root2</a>(x_locus2,beta1,beta2,bacc,lutest,ierr)</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;kwx = kmidx - betaw*py</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;kwy = kmidy + betaw*px</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;zw  = x_flocus(kwx,kwy)</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;kw  = betaw*pmag</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;<span class="comment">! estimate circumference of locus, assuming it to be an ellips</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;<span class="comment">! estimate axis, this seems to be a rather good estimate</span></div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;aa = 0.5*abs(ka-kb)</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;bb = kw</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;<span class="keywordflow">if</span> (aa &gt; bb) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  mm = 1-(bb/aa)**2</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;  mm = 1-(aa/bb)**2</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;mm1 = 1.-mm</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;a1 = 0.4630151;  a2 = 0.1077812;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;b1 = 0.2452727;  b2 = 0.0412496;</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;<span class="keywordflow">if</span> (mm1==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;  loclen = 4.*max(aa,bb)</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  loclen = 4.*max(aa,bb)*((1. + a1*mm1 + a2*mm1**2) + (b1*mm1 + b2*mm1**2)*log(1/mm1))</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_locpos&#39;</span>)</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00240">kmid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00241">kmidx</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00242">kmidy</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00060">luq_tst</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00234">pang</a>, <a class="el" href="mod__constants_8f90_source.html#l00029">m_constants::pi</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00233">pmag</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">px</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">py</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__constants_8f90_source.html#l00020">m_constants::sqrtg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">x_locus1()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00432">serv_xnl4v5::z_root2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="a7f85863836ae28cb1da43540793e8137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f85863836ae28cb1da43540793e8137">&#9670;&nbsp;</a></span>q_makegrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_makegrid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set-up grid for computation of loci. </p>
<p>Generate data file with basic loci for computation of nonlinear quadruplet interactions.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>10-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">3764</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;<span class="comment">!   |   | +---+  Last update: 10 June 2003</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;<span class="comment">!     25/02/1999  Initial version</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;<span class="comment">!     11/10/1999  Error handling improved; Bugs fixed when w1=w3</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="comment">!     12/10/1999  Storage modified and non-geometric option included</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment">!     16/10/1999  Equation for computing address of 2d array simplified</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;<span class="comment">!     21/10/1999  Range of precomputed grid added to data file</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="comment">!     22/10/1999  Renaming of some indices</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="comment">!     25/10/1999  Header with grid info extended</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;<span class="comment">!     12/11/1999  Output format modified of data to GRD file, adapted</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<span class="comment">!                 for use on UNIX systems at WES</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;<span class="comment">!     08/12/1999  Interface with A_CMPLOC extended</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;<span class="comment">!     28/12/1999  Routine A_CMPLOC renamed to Q_CMPLOC</span></div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;<span class="comment">!     03/01/2000  IQ_START replaced by IQ_LOCUS</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="comment">!     05/01/2000  Interface with Q_CMPLOC modified</span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="comment">!     08/02/2000  Output to LUQLOC made conditional</span></div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;<span class="comment">!     09/08/2002  Name changed from Q_GRIDV1 to Q_MAKEGRID</span></div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;<span class="comment">!                 Upgrade to release 4.0</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="comment">!     15/08/2002  Bug fixed in indexing bins below lowest wave number</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;<span class="comment">!     20/08/2002  Sigma written to QUAD file, instead of wave numbers</span></div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;<span class="comment">!     22/08/2002  Data along locus compacted, elimate zero&#39;s</span></div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;<span class="comment">!     10/09/2002  Upgrade to release 5</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="comment">!                 Value of LASTQUADFILE set</span></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;<span class="comment">!     10/06/2003  Output to GRD file always without compacting</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="comment">!     Set-up grid for computation of loci</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment">!     Generate data file with basic loci for computation of</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment">!     nonlinear quadruplet interactions</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;<span class="comment">!     Name    I/O  Type  Description</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;<span class="comment">!     Q_CTRGRID</span></div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;<span class="comment">!     Q_CPMLOCUS</span></div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;<span class="comment">!     Q_MODIFY</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="comment">!     Q_WEIGHT</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;<span class="comment">!     Q_CHKRES</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;<span class="comment">!     Q_NEAREST</span></div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="keywordtype">integer</span> iloc,jloc            <span class="comment">! counters</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="keywordtype">integer</span> iaq,ikq              <span class="comment">! counters</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="keywordtype">integer</span> iaq3,ikq1,ikq3,nkq1  <span class="comment">! counters</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="keywordtype">integer</span> jaq1,jaq3            <span class="comment">! counters</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="keywordtype">integer</span> amem,kmem            <span class="comment">! index of angle and wave number in grid</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<span class="keywordtype">real</span> aa1,aa3,kk1,kk3         <span class="comment">! temporary wave number variables</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;<span class="keywordtype">integer</span> nzloc                <span class="comment">! counter for non-zero contributions along locus</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;<span class="keywordtype">integer</span> nztot1,nztot2        <span class="comment">! total number of zero and non-zero points on locus</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;<span class="keywordtype">integer</span> ik2,ia2              <span class="comment">! index of wave number k2</span></div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;<span class="keywordtype">integer</span> ik4,ia4              <span class="comment">! index of wave number k4</span></div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;<span class="keywordtype">real</span> wk,wa                   <span class="comment">! weights</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;<span class="keywordtype">real</span> w1k2,w2k2,w3k2,w4k2     <span class="comment">! interpolation weights</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;<span class="keywordtype">real</span> w1k4,w2k4,w3k4,w4k4     <span class="comment">! interpolation weights</span></div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;<span class="keywordtype">real</span> ka,kb       <span class="comment">! lower and higher wave number magnitude</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;<span class="keywordtype">real</span> km          <span class="comment">! wave number at mid point</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;<span class="keywordtype">real</span> kw          <span class="comment">! half width of locus</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;<span class="keywordtype">real</span> tfac        <span class="comment">! combined tail factor</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;<span class="keywordtype">logical</span> lwrite   <span class="comment">! indicator if binary interaction grid has been written successfully</span></div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;<span class="keywordtype">real</span> smax        <span class="comment">! maximum s-value</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: xloc(:),yloc(:)</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;<span class="keywordtype">real</span> qq</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_makegrid&#39;</span>)</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;<span class="comment">! initializations</span></div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;lwrite  = .false.</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;nztot1  = 0</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;nztot2  = 0</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="comment">!%</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;quad_nloc = -1    <span class="comment">! number of points on all loci</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;<span class="comment">!%</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="keywordflow">if</span>(<span class="keyword">allocated</span>(xloc)) <span class="keyword">deallocate</span>(xloc) ; <span class="keyword">allocate</span> (xloc(mlocus))</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="keywordflow">if</span>(<span class="keyword">allocated</span>(yloc)) <span class="keyword">deallocate</span>(yloc) ; <span class="keyword">allocate</span> (yloc(mlocus))</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="comment">!  write header to grid file</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;<span class="comment">!  set range of do loops for computing interaction grid</span></div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="keywordflow">if</span>(iq_geom==0 .or. iq_disp/=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;  nkq1 = nkq           <span class="comment">! loop over all k1 wave numbers, since no geometric scaling can be used</span></div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;  nkq1 = 1             <span class="comment">! use only first wave number for k1, since geometric scaling can be used</span></div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;jaq1 = 1               <span class="comment">! index of direction of k1 in grid matrix</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<span class="comment">!  compute components of reference wave number,</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="comment">!  for setting up interaction grid</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;k1: <span class="keywordflow">do</span> ikq1=1,nkq1</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;  <span class="keywordflow">if</span>(iq_screen==2) <span class="keyword">write</span>(iscreen,*) <span class="stringliteral">&#39;k1-ring:&#39;</span>,ikq1</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;  aa1   = q_ad(iaref)</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;  kk1   = q_k(ikq1)</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;  krefx = kk1*cos(q_ad(iaref)*<a class="code" href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">dera</a>)</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;  krefy = kk1*sin(q_ad(iaref)*<a class="code" href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">dera</a>)</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;  k1x  = krefx</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;  k1y  = krefy</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160; </div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;k3: <span class="keywordflow">do</span> ikq3 = ikq1,nkq   <span class="comment">!</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;   <span class="keywordflow">if</span>(iq_screen==2) <span class="keyword">write</span>(iscreen,*) <span class="stringliteral">&#39;k1-k3 indices:&#39;</span>,ikq1,ikq3</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;    kk3 = q_k(ikq3)</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;a3: <span class="keywordflow">do</span> iaq3 = iag1,iag2</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;      <span class="keywordflow">if</span>(iaq3 == iag1 .and. ikq3 == ikq1) cycle</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      aa3 = q_ad(iaq3)</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      k3x = kk3*cos(aa3*<a class="code" href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">dera</a>)</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;      k3y = kk3*sin(aa3*<a class="code" href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">dera</a>)</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="comment">!   compute locus for a specified combination of k1 and k3</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;      ia_k1 = iaq1; ik_k1 = ikq1</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      ia_k3 = iaq3; ik_k3 = ikq3</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;      <span class="keyword">call </span>q_cmplocus(ka,kb,km,kw,crf1)</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      <span class="keywordflow">if</span>(iq_err/=0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">!     redistibute or filter data points along locus</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;      <span class="keyword">call </span>q_modify</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;      <span class="keywordflow">if</span>(iq_err &gt; 0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="comment">!     compute weights for interpolation in computational grid</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;      <span class="keyword">call </span>q_weight</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      <span class="keywordflow">if</span>(iq_err &gt; 0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="comment">!    special storing mechanism for interactions per combination of k1 and k3</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;      kmem  = (ikq3-ikq1+1) - (ikq1-2*nkq-2)*(ikq1-1)/2;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      jaq3  = iaq3-iaref+1        <span class="comment">! ensure that data stored in matrix start at index (1,1)</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      amem  = jaq3                <span class="comment">! index of direction</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="comment">!     Convert real indices to integer indexing and real weights</span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="comment">!    3-----------4 ja2p         w1 = (1-wk)*(1-wa)</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="comment">!    |    .      |              w2 = wk*(1-wa)</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="comment">!    |. . + . . .| wa2   A      w3 = (1-wk)*wa</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="comment">!    |    .      |       |      w4 = wk*wa</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;<span class="comment">!    |    .      |       wa</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;<span class="comment">!    |    .      |       |</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="comment">!    1-----------2 ja2   V</span></div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="comment">!   jk2  wk2  jk2p</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="comment">!    &lt;-wk-&gt;</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      nzloc = 0</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;loc:  <span class="keywordflow">do</span> iloc = 1,nlocus</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;        ik2  = floor(wk_k2(iloc))</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;        ia2  = floor(wa_k2(iloc))</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;        wk   = wk_k2(iloc)-real(ik2)</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;        wa   = wa_k2(iloc)-real(ia2)</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;        w1k2 = (1.-wk)*(1.-wa)</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;        w2k2 = wk*(1.-wa)</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        w3k2 = (1.-wk)*wa</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;        w4k2 = wk*wa</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;        ik4  = floor(wk_k4(iloc))</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;        ia4  = floor(wa_k4(iloc))</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        wk   = wk_k4(iloc)-real(ik4)</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;        wa   = wa_k4(iloc)-real(ia4)</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;        w1k4 = (1.-wk)*(1.-wa)</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        w2k4 = wk*(1.-wa)</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;        w3k4 = (1.-wk)*wa</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;        w4k4 = wk*wa</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="comment">!  Take care of points that lie below lowest wave number</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="comment">!  when no geometric scaling is applied, then modify weights</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment">!  such that directional position is retained</span></div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;        <span class="keywordflow">if</span>(iq_geom==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;          <span class="keywordflow">if</span>(ik2 ==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;            ik2  = 1</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;            w1k2 = w1k2 + w2k2</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;            w2k2 = 0.</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;            w3k2 = w3k2 + w4k2</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;            w4k2 = 0.</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;          <span class="keywordflow">if</span>(ik4 ==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;            ik4  = 1</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;            w1k4 = w1k4 + w2k4</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;            w2k4 = 0.</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;            w3k4 = w3k4 + w4k4</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;            w4k4 = 0.</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="comment">!  compute combined tail factor and product of coupling coefficient, step size,</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="comment">!  symmetry factor, and tail factor divided by jacobian</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        tfac = wt_k2(iloc)*wt_k4(iloc)</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;        quad_zz(kmem,amem,iloc)   = cple_mod(iloc)*ds_mod(iloc)*sym_mod(iloc)/jac_mod(iloc)*tfac</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="comment">!  compact data by elimating zero-contribution on locus</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        <span class="keywordflow">if</span>(iq_compact==1 .and. abs(quad_zz(kmem,amem,iloc)) &gt; 1.e-15) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;          nzloc = nzloc + 1</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;          jloc  = nzloc</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;          nztot1 = nztot1 + 1</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;          jloc = iloc</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        nztot2 = nztot2 + 1</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="comment">!  shift data</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        quad_zz(kmem,amem,jloc)  = quad_zz(kmem,amem,iloc)</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;        quad_ik2(kmem,amem,jloc) = ik2           <span class="comment">! lower wave number index of k2</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        quad_ia2(kmem,amem,jloc) = ia2           <span class="comment">! lower direction index of k2</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;        quad_ik4(kmem,amem,jloc) = ik4           <span class="comment">! lower wave number index of k4</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        quad_ia4(kmem,amem,jloc) = ia4           <span class="comment">! lower direction index of k4</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        quad_w1k2(kmem,amem,jloc) = w1k2         <span class="comment">! weight 1 of k2</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        quad_w2k2(kmem,amem,jloc) = w2k2         <span class="comment">! weight 2 of k2</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        quad_w3k2(kmem,amem,jloc) = w3k2         <span class="comment">! weight 3 of k2</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;        quad_w4k2(kmem,amem,jloc) = w4k2         <span class="comment">! weight 4 of k2</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        quad_w1k4(kmem,amem,jloc) = w1k4         <span class="comment">! weight 1 of k4</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;        quad_w2k4(kmem,amem,jloc) = w2k4         <span class="comment">! weight 2 of k4</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;        quad_w3k4(kmem,amem,jloc) = w3k4         <span class="comment">! weight 3 of k4</span></div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        quad_w4k4(kmem,amem,jloc) = w4k4         <span class="comment">! weight 4 of k4</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;<span class="keywordflow">      end do</span> loc</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;      <span class="keywordflow">if</span>(iq_compact==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;        quad_nloc(kmem,amem) = nzloc                <span class="comment">! store compacted number of points on locus</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;        quad_nloc(kmem,amem) = nlocus               <span class="comment">! store number of points on locus</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;        nzloc = nlocus</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;<span class="comment">!     write(luq_prt,&#39;(a,4i5)&#39;) &#39;Q_MAKEGRID kmem amem nlocus:&#39;,kmem,amem,nlocus,nzloc</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;<span class="keywordflow">    end do</span> a3</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="keywordflow">  end do</span> k3</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;<span class="keywordflow">end do</span> k1</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;<span class="comment">!  Write locus information to binary file</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;<span class="keyword">write</span>(luq_bqf) q_header</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;<span class="comment">! spectral interaction grid</span></div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;<span class="keyword">write</span>(luq_bqf) naq,nkq</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="keyword">write</span>(luq_bqf) q_sig</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="keyword">write</span>(luq_bqf) q_ad</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="keyword">write</span>(luq_bqf) iq_geom,iq_disp,iq_geom</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="keyword">write</span>(luq_bqf) q_depth</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="comment">! interaction grid</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_nloc</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_ik2</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_ia2</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_ik4</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_ia4</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w1k2</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w2k2</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w3k2</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w4k2</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w1k4</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w2k4</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w3k4</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_w4k4</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="keyword">write</span>(luq_bqf) quad_zz</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;lwrite = .true.</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;lastquadfile = bqname</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="keywordflow">if</span>(iq_screen &gt;= 1 .and. iq_test&gt;=1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;q_makegrid: LASTQUADFILE: &#39;</span>,lastquadfile</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="keywordflow">if</span>(<span class="keyword">allocated</span>(xloc)) <span class="keyword">deallocate</span>(xloc,yloc)</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;<span class="comment">! check if BQF file has been written succesfully</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;<span class="comment">! if not, deleted both the AQFILE and BQFILE</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="keywordflow">if</span>(.not. lwrite) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;  <span class="keyword">close</span>(luq_bqf,status=<span class="stringliteral">&#39;delete&#39;</span>)</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;    <span class="keyword">write</span>(luq_log,*)</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;    <span class="keyword">write</span>(luq_log,*) <span class="stringliteral">&#39;Q_MAKEGRID: Grid files &#39;</span>,trim(aqname),<span class="stringliteral">&#39; and &#39;</span>,trim(bqname),<span class="stringliteral">&#39; deleted&#39;</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;    <span class="keyword">write</span>(luq_log,*) <span class="stringliteral">&#39;Q_MAKEGRID: Since an error occurred during the generation&#39;</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;    <span class="keyword">write</span>(luq_log,*) <span class="stringliteral">&#39;Q_MAKEGRID: of the interaction grid&#39;</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="comment">!  write statistics of compacting to print file</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="keywordflow">if</span>(iq_prt &gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;  <span class="keywordflow">if</span>(iq_compact==0) nztot1 = nztot2</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i10)&#39;</span>) <span class="stringliteral">&#39;Total number of points on loci        :&#39;</span>,nztot2</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i10)&#39;</span>) <span class="stringliteral">&#39;Total number of stored points on locus:&#39;</span>,nztot1</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i10)&#39;</span>) <span class="stringliteral">&#39;Total number of zero points on locus  :&#39;</span>,nztot2-nztot1</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.2)&#39;</span>) <span class="stringliteral">&#39;Reduction factor (%):&#39;</span>,real(nztot2-nztot1)/real(nztot2)*100.</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_makegrid&#39;</span>)</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00192">aqname</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00193">bqname</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00301">cple_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00380">crf1</a>, <a class="el" href="mod__constants_8f90_source.html#l00032">m_constants::dera</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00299">ds_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00203">ia_k1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00204">ia_k3</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00388">iag1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00388">iag2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">iaq1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00385">iaref</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00203">ik_k1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00204">ik_k3</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00078">iq_compact</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00300">jac_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00227">krefx</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00227">krefy</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00194">lastquadfile</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00050">luq_bqf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00213">mlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00219">nlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">q_ad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00195">q_header</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">q_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">q_sig</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00261">quad_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00263">quad_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00260">quad_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00262">quad_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00259">quad_nloc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00264">quad_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00268">quad_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00265">quad_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00269">quad_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00266">quad_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00270">quad_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00267">quad_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00271">quad_w4k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00272">quad_zz</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00302">sym_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00313">wa_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00314">wa_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00311">wk_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00312">wk_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00315">wt_k2</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00316">wt_k4</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>.</p>

</div>
</div>
<a id="a0dc8d82ef264af5722dc4a689eff5efa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dc8d82ef264af5722dc4a689eff5efa">&#9670;&nbsp;</a></span>q_modify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_modify</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Modify points along the locus, such that they are evenly distributed only when intended, i.e. </p>
<p>when IQ_LOCUS==2.</p>
<p>Compute new spacing along locus. Redistribute points and coefficient at new spacing using linear interpolation. Output DIA configuration when also lumping active.</p>
<p>If no redistribution is needed, then copy relevant data.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>11-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">4149</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="comment">!   |   | +---+  Last update: 11 June 2003</span></div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="comment">!       9/04/1999  Initial version</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="comment">!      13/04/1999  New intermediate variables *_mod introduced</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="comment">!      11/10/1999  Check on error messages in interpolation added</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="comment">!      18/10/1999  Bug fixed in assigning new ds values to array DS_MOD</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="comment">!      27/10/1999  Checked added on allocated of SOLD</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="comment">!       8/12/1999  Test output added</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;<span class="comment">!      29/12/1999  Bug fixed in assigning DS_MOD for first and last point on locus</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="comment">!       1/10/2001  Components of k4-locus added</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment">!                  No interpolation and modification if q==0</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment">!       9/08/2002  Upgrade to version 4.0</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="comment">!      15/08/2002  Step sizing improved</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="comment">!       4/06/2003  Bug fixed in computing slen (length of locus)</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;<span class="comment">!                  Locus closed to enable interpolation to finer resolution</span></div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;<span class="comment">!       6/06/2003  Activate output to XDIA configuration file</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<span class="comment">!      10/06/2003  Conversion to new indexing and lumping debugged</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;<span class="comment">!      11/06/2003  Call to subroutine Q_SYMMETRY added</span></div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;<span class="comment">!     Modify points along the locus, such that they are evenly distributed</span></div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;<span class="comment">!     Only when intented, i.e. when IQ_LOCUS==2</span></div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="comment">!     Compute new spacing along locus</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="comment">!     Redistribute points and coefficient at new spacing using linear interpolation</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="comment">!     Output DIA configuration when also lumping active</span></div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;<span class="comment">!     If no redistribution is needed, then copy relevant data</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="comment">!     Name    I/O  Type  Description</span></div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;<span class="comment">!     Q_CMPLOCUS</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;<span class="comment">!     Q_SYMMETRY</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;<span class="comment">!     Z_INTP1</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;<span class="comment">!  8. structure</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="comment">!     Local parameters</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;<span class="keywordtype">integer</span> ierr,jerr    <span class="comment">! error indicators</span></div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;<span class="keywordtype">integer</span> nold,nnew    <span class="comment">! old and new number of points on locus</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="keywordtype">integer</span> iold,inew    <span class="comment">! counter for loop along points</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="keywordtype">integer</span> iloc         <span class="comment">! counter for loop along locus</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="keywordtype">integer</span> jloc         <span class="comment">! counter for loop over lumped locus</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;<span class="keywordtype">integer</span> itest        <span class="comment">! local test level, by default equal to IQ_TEST</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;<span class="keywordtype">real</span> k2a,k2m         <span class="comment">! angle (deg) and wave number magnitude of wave number k2</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;<span class="keywordtype">real</span> k4a,k4m         <span class="comment">! angle (deg) and wave number magnitude of wave number k4</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;<span class="keywordtype">real</span> w2,w4           <span class="comment">! radian frequencies of wave numbers</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;<span class="keywordtype">real</span> dk13,dk14       <span class="comment">! difference wave number</span></div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;<span class="keywordtype">real</span> dsnew,slen      <span class="comment">! new step size and length of locus</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;<span class="keywordtype">real</span> zero            <span class="comment">! 0</span></div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="keywordtype">real</span> q_eps           <span class="comment">! accuracy to distinguish special case, with q=0</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;<span class="keywordtype">real</span> diold           <span class="comment">! &#39;real&#39; old number of indices between succeeding lumped bins</span></div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;<span class="keywordtype">real</span> dinew           <span class="comment">! &#39;real&#39; new number of indices between succeeding lumped bins</span></div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;<span class="comment">!!real x_disper        ! evaluate dispersion relation</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: sold(:)     <span class="comment">! old coordinate along locus</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: snew(:)     <span class="comment">! new coordinate along locus</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;<span class="comment">!--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_modify&#39;</span>)</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;<span class="comment">!  initialisations</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;zero  = 0.</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;q_eps = 1.e-5</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;itest = iq_test</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;<span class="comment">! itest = 1   ! set local test level for test purposes</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;<span class="keywordflow">if</span>(itest&gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;  <span class="keyword">write</span>(luq_tst,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_MODIFY: iq_mod   :&#39;</span>,iq_mod</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;  <span class="keyword">write</span>(luq_tst,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_MODIFY: iq_xdia  :&#39;</span>,iq_xdia</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;  <span class="keyword">write</span>(luq_tst,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_MODIFY: iq_lump  :&#39;</span>,iq_lump</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <span class="keyword">write</span>(luq_tst,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_MODIFY: iq_gauleg:&#39;</span>,iq_gauleg</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;<span class="comment">!  do not modify data when IQ_MOD==0</span></div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;<span class="keywordflow">if</span>(iq_mod==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;  nlocus   = nlocus1</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;  x2_mod   = x2_loc</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  y2_mod   = y2_loc</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;  x4_mod   = x4_loc</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;  y4_mod   = y4_loc</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;  s_mod    = s_loc</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;  ds_mod   = ds_loc</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;  jac_mod  = jac_loc</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;  cple_mod = cple_loc</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;  <span class="keyword">call </span>q_symmetry(k1x,k1y,k3x,k3y,x4_mod,y4_mod,sym_mod,nlocus)</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;<span class="comment">! Modify spacing along locus</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;  nold = nlocus1</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="comment">! close locus by adding one point, equal to first point</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">! only for normal locus</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;  <span class="keywordflow">if</span>(abs(q)&gt;q_eps) nold  = nold+1</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="comment">! Determine new number of points along locus</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;  <span class="keywordflow">if</span>(iq_gauleg &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    nnew = iq_gauleg</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;  <span class="keywordflow">elseif</span>(iq_lump &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;    nnew = iq_lump</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;    nnew  = nlocus0</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;  <span class="keyword">allocate</span> (sold(nold),snew(nnew))</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;<span class="comment">!  Compute circumference of locus, distinguish 2 case, open or closed</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;  <span class="keywordflow">if</span>(abs(q)&lt;q_eps) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    slen = s_loc(nold)</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    sold = s_loc</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    slen = 0</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    <span class="keywordflow">do</span> iold=1,nold-1               <span class="comment">! loop length minus one, since locus is closed</span></div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;      sold(iold) = s_loc(iold)</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      slen = slen + ds_loc(iold)</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;<span class="comment">!  close locus by copying first value in last value</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;    sold(nold)     = slen</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;    x2_loc(nold)   = x2_loc(1)</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;    y2_loc(nold)   = y2_loc(1)</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;    x4_loc(nold)   = x4_loc(1)</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;    y4_loc(nold)   = y4_loc(1)</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    jac_loc(nold)  = jac_loc(1)</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    cple_loc(nold) = cple_loc(1)</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">! compute new spacing along loci and coordinates along locus</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="comment">! Gauss-Legendre integration</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;  <span class="keywordflow">if</span>(iq_gauleg &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    <span class="keywordflow">if</span>(iq_gauleg &gt; nnew) stop <span class="stringliteral">&#39;Q_MODIFY: iq_gauleg &gt; nlocus0&#39;</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    nnew = iq_gauleg</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a735671d103348a800db8fc8e54265a84">y_gauleg</a>(zero,slen,snew,ds_mod,nnew)</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    <span class="keywordflow">if</span>(abs(q)&gt;q_eps) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      dsnew  = slen/real(nnew)</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      <span class="keywordflow">do</span> inew=1,nnew</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;        snew(inew) = (inew-1.)*dsnew</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      dsnew  = slen/real(nnew-1.)</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      <span class="keywordflow">do</span> inew=1,nnew</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;        snew(inew) = (inew-1)*dsnew</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    ds_mod = dsnew</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;  jerr = 0</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;<span class="comment">! Compute characteristics of locus for special case q=0</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;  <span class="keywordflow">if</span>(abs(q)&lt;1.e-5) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,x2_loc,snew,x2_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,y2_loc,snew,y2_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160; <span class="comment">!</span></div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,x4_loc,snew,x4_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,y4_loc,snew,y4_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,s_loc,snew,s_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;    <span class="keyword">call </span>q_symmetry(k1x,k1y,k3x,k3y,x4_mod,y4_mod,sym_mod,nnew)</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="comment">! ---  lumping along locus --------------------------------------------</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <span class="keywordflow">if</span>(iq_lump&gt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;      diold  = slen/real(nold)</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      dinew  = slen/real(nnew)</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;      ds_mod = 0.</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;      <span class="keyword">call </span>q_symmetry(k1x,k1y,k3x,k3y,x4_loc,y4_loc,sym_loc,nold)</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;      <span class="keywordflow">do</span> iloc=1,nlocus1</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;        jloc = floor((iloc-1.)*diold/dinew)+1</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;        ds_mod(jloc)   = ds_mod(jloc) + cple_loc(iloc)*ds_loc(iloc)/jac_loc(iloc)*sym_loc(iloc)</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;        jac_mod(jloc)  = 1.</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;        cple_mod(jloc) = 1.</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      sym_mod = 1          <span class="comment">! symmetry already taken account in lumping proces</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;<span class="comment">! --- No lumping -------------------------------------------------------------</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,jac_loc,snew,jac_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;      <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 jac_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;      jerr = jerr + ierr</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,cple_loc,snew,cple_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 cp_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;      jerr = jerr + ierr</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;<span class="comment">!------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;<span class="comment">!  compute characteristics for closed locus</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;<span class="comment">!------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,x2_loc,snew,x2_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,y2_loc,snew,y2_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 y_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,x4_loc,snew,x4_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 x_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,y4_loc,snew,y4_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 y_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,s_loc,snew,s_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 s_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;    jerr = jerr + ierr</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;    <span class="keyword">call </span>q_symmetry(k1x,k1y,k3x,k3y,x4_mod,y4_mod,sym_mod,nnew)</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="comment">!  ----- Lumping along locus -----------------------------------</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    <span class="keywordflow">if</span>(iq_lump&gt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;      diold  = slen/real(nold-1)</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;      dinew  = slen/real(nnew)</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;      ds_mod = 0.</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;      <span class="keyword">call </span>q_symmetry(k1x,k1y,k3x,k3y,x4_loc,y4_loc,sym_loc,nold)</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;      <span class="keywordflow">do</span> iloc=1,nold-1</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;        jloc = floor((iloc-1.)*diold/dinew + 1.49999)</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;        jloc = mod(jloc-1+nnew,nnew)+1</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;        ds_mod(jloc)   = ds_mod(jloc) + cple_loc(iloc)*ds_loc(iloc)/jac_loc(iloc)*sym_loc(iloc)</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;        jac_mod(jloc)  = 1.</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;        cple_mod(jloc) = 1.</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      sym_mod = 1          <span class="comment">! symmetry already taken account in lumping proces</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="comment">!------------  No lumping along locus  --------------------------------</span></div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,jac_loc,snew,jac_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 jac_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;      jerr = jerr + ierr</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">z_intp1</a>(sold,cple_loc,snew,cple_mod,nold,nnew,ierr)</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;      <span class="keywordflow">if</span>(ierr &gt; 0) <span class="keyword">write</span>(luq_err,*) <span class="stringliteral">&#39;Z_INTP1 cp_loc, ierr=&#39;</span>,ierr</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      jerr = jerr + ierr</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;    <span class="keywordflow">if</span>(jerr &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;      iq_err = iq_err + 1</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;      <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;INTER&#39;</span>,<span class="stringliteral">&#39;Problem in interpolation process&#39;</span>)</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;      <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  nlocus = nnew</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;<span class="comment">!!  compute symmetry factor for reducing computational load</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;<span class="comment">!!call q_symmetry(k1x,k1y,k3x,k3y,x4_mod,y4_mod,sym,nnew)</span></div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;<span class="keywordflow">do</span> iloc=1,nlocus</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;  k2x = x2_mod(iloc)</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  k2y = y2_mod(iloc)</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  k4x = x4_mod(iloc)</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;  k4y = y4_mod(iloc)</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;  k2m = sqrt(k2x**2 + k2y**2)</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;  k4m = sqrt(k4x**2 + k4y**2)</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;  k2a = atan2(k2y,k2x)*<a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a></div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;  k4a = atan2(k4y,k4x)*<a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;  k2m_mod(iloc) = k2m</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;  k4m_mod(iloc) = k4m</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  k2a_mod(iloc) = k2a</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;  k4a_mod(iloc) = k4a</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;<span class="keywordflow">if</span>(<span class="keyword">allocated</span>(sold)) <span class="keyword">deallocate</span>(sold,snew)</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_modify&#39;</span>)</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00284">cple_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00301">cple_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00282">ds_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00299">ds_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00103">iq_gauleg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00136">iq_lump</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00145">iq_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00183">iq_xdia</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00283">jac_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00300">jac_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00305">k2a_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00304">k2m_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00307">k4a_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00306">k4m_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00060">luq_tst</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00219">nlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00215">nlocus1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05649">q_symmetry()</a>, <a class="el" href="mod__constants_8f90_source.html#l00033">m_constants::rade</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00279">s_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00298">s_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00285">sym_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00302">sym_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00276">x2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00293">x2_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00280">x4_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00295">x4_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00277">y2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00294">y2_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00281">y4_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00296">y4_mod</a>, <a class="el" href="serv__xnl4v5_8f90_source.html#l00004">serv_xnl4v5::y_gauleg()</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00102">serv_xnl4v5::z_intp1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="aff990bf181e455939b126f6129d8b172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff990bf181e455939b126f6129d8b172">&#9670;&nbsp;</a></span>q_polar2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_polar2 </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>kmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>kmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>kx_beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ky_beg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>kx_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ky_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>loclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute position of locus for given k1-k3 vector. </p>
<p>Explicit polar method, see Van Vledder 2000, Monterey paper. Optionally using a fixed k-step, geometric k-step or adaptive stepping.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">kmin</td><td>Minimum wave number on locus. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kmax</td><td>Maximum wave number on locus. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx_beg</td><td>X-coordinate of begin point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky_beg</td><td>Y-coordinate of begin point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx_end</td><td>X-coordinate of end point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky_end</td><td>Y-coordinate of end point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">loclen</td><td>Estimated length of locus. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error condition.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8-Aug-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">4535</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;<span class="comment">!   |   | +---+  Last update: 8 Aug. 2003</span></div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceserv__xnl4v5.html#a27c4512ce2548f874dc79799d81e0e47">z_wnumb</a></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;<span class="comment">!     Date        Description</span></div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;<span class="comment">!     03/12/1999  Initial version</span></div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;<span class="comment">!     09/08/2002  Geometric spacing of k added</span></div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;<span class="comment">!                 Upgrade to release 4.0</span></div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;<span class="comment">!     13/08/2002  reorganisation of loops generating points on locus</span></div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<span class="comment">!     08/08/2003  Check included for maximum number of IPOL by using MPOL</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;<span class="comment">!                    MPOL=MLOCUS/2+1-1  (-1 added regarding IPOL=IPOL+1 in Q_MODIFY)</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;<span class="comment">!                 Check included on ARG=0 for IQ_LOCUS=2 and parameter dke added</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;<span class="comment">!     Compute position of locus for given k1-k3 vector</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;<span class="comment">!     Explicit polar method, see Van Vledder 2000, Monterey paper</span></div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;<span class="comment">!     Optionally using a fixed k-step, geometric k-step or adaptive stepping</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;<span class="comment">!  3. Parameters used:</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;<span class="comment">!Type    I/O        Name             Description</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: kmin           <span class="comment">! minimum wave number on locus</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: kmax           <span class="comment">! maximum wave number on locus</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: kx_beg         <span class="comment">! x-coordinate of begin point</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: ky_beg         <span class="comment">! y-coordinate of begin point</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: kx_end         <span class="comment">! x-coordinate of end point</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: ky_end         <span class="comment">! y-coordinate of end point</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: loclen         <span class="comment">! estimated length of locus</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent (out)</span>  :: ierr     <span class="comment">! error condition</span></div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;<span class="comment">!     Parameters with module</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;<span class="comment">!     nlocus0   Preferred number of points on locus</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;<span class="comment">!     q         w1-w3, difference of radian frequencies</span></div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;<span class="comment">!     pmag      |k1-k3| (vector form)</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;<span class="comment">!     pdir      direction of difference vector k1-k3</span></div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;<span class="comment">!     Q_CPMLOCUS</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;<span class="comment">!  6. Subroutines used:</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="comment">!     X_COSK</span></div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;<span class="comment">!     The type of locus computation is controlled by the parameter IQ_LOCUS</span></div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;<span class="comment">!     Set in Q_SETCFG</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;<span class="comment">!     /S  enable subroutine tracing</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;<span class="comment">!     /T  enable test output</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;<span class="comment">!     Local variabels</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;<span class="keywordtype">integer</span> ipol      <span class="comment">! counter</span></div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;<span class="keywordtype">integer</span> jpol      <span class="comment">! counter</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="keywordtype">integer</span> iend      <span class="comment">! indicates end of locus computation</span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;<span class="keywordtype">integer</span> ipass     <span class="comment">! counter for passes</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;<span class="keywordtype">integer</span> npol      <span class="comment">! number of points on locus</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;<span class="keywordtype">integer</span> npass     <span class="comment">! number of passes in iteration process</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;<span class="keywordtype">integer</span> mpol      <span class="comment">! maximum number of points on locus, related to MLOCUS</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="keywordtype">real</span> kold         <span class="comment">! temporary wave number</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="keywordtype">real</span> knew         <span class="comment">! temporary wave number</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;<span class="keywordtype">real</span> cosold       <span class="comment">! &#39;old&#39; cosine of angle</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="keywordtype">real</span> cosnew       <span class="comment">! &#39;new&#39; cosine of angle</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;<span class="keywordtype">real</span> dkpol        <span class="comment">! step in wave number</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;<span class="keywordtype">real</span> dkold        <span class="comment">! &#39;old&#39; step in wave number</span></div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;<span class="keywordtype">real</span> ang1         <span class="comment">! &#39;old&#39; angle</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;<span class="keywordtype">real</span> ang2         <span class="comment">! &#39;new&#39; angle</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="keywordtype">real</span> kk1          <span class="comment">! &#39;old&#39; wave number</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="keywordtype">real</span> kk2          <span class="comment">! &#39;new&#39; wave number</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;<span class="keywordtype">real</span> kratio       <span class="comment">! ratio between succesive k-values when IQ_LOCUS=3</span></div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;<span class="keywordtype">real</span> arg          <span class="comment">! argument</span></div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;<span class="keywordtype">real</span> dk           <span class="comment">! step in wave number</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;<span class="keywordtype">real</span> dke          <span class="comment">! estimate of new dk</span></div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;<span class="keywordtype">real</span> dsnew        <span class="comment">! new step size along locus</span></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;<span class="keywordtype">real</span> dsz          <span class="comment">! estimated step size along locus</span></div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;<span class="keywordtype">integer</span> itest    <span class="comment">! local test level</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="keywordtype">integer</span> lutest   <span class="comment">! unit number for test output in service routine</span></div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;<span class="comment">!  function declarations</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;<span class="comment">!!!real    z_wnumb  ! compute wave number, via module SERV_XNL4V4</span></div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;<span class="comment">!!real    x_disper ! dispersion relation</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;<span class="comment">! initialisations</span></div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_polar2&#39;</span>)</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;ierr = 0                      <span class="comment">! set error code to zero</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;npol = (nlocus0+1)/2+1        <span class="comment">! first estimate of number k-values along symmetry axis</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;mpol = mlocus/2               <span class="comment">! set maximum number of points along locus axis</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="keywordflow">select case</span>(iq_locus)</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="comment">! CASE = 1: Linear spacing of wave numbers along symmetry axis</span></div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keywordflow">case</span>(1)</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;  dk = (kmax-kmin)/real(npol-1)</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;  <span class="keywordflow">do</span> ipol=1,npol</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;    k_pol(ipol) = kmin + (ipol-1)*dk</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;    c_pol(ipol) = x_cosk(k_pol(ipol))</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;<span class="comment">!  Case = 2: Variable k-stepping along symmetry axis,</span></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;<span class="comment">!            such that step along locus is more or less constant</span></div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;  <span class="keywordflow">case</span>(2)</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;<span class="comment">! set first point on locus</span></div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;  ipol        = 1</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;  k_pol(ipol) = kmin</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;  c_pol(ipol) = -1.</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;  kold        = kmin</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;  cosold      = -1.</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;<span class="comment">! compute initial step size of polar wave number</span></div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;  dk0   = (kmax - kmin)/real(npol)      <span class="comment">! estimate of step size of equidistant radii</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;  dsz   = loclen/real(nlocus0)          <span class="comment">! estimate of step size along locus</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;  npass = 3                             <span class="comment">! set number of passes in iteration</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;  dk0   = dk0/2                         <span class="comment">! reduce initial step</span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;  dk    = dk0</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;  iend  = 0</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (k_pol(ipol) &lt; kmax .and. iend==0 .and. ipol &lt; mpol)</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;    <span class="keywordflow">do</span> <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a>=1,npass</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      knew  = min(kmax,k_pol(ipol)+dk)</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;      dkold = knew - k_pol(ipol)</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;      cosnew = x_cosk(knew)</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;      ang1  = pang + acos(cosold)</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;      ang2  = pang + acos(cosnew)</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      kk1   = kold</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      kk2   = knew</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      arg   = kk1**2 + kk2**2 -2.*kk1*kk2*cos(ang1-ang2)</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      dsnew = sqrt(abs(arg))</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      <span class="keywordflow">if</span>(dsnew&gt;0) dke   = dk*dsz/dsnew</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      dk    = dke</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;<span class="comment">!  assign new estimate and check value of IPOL</span></div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="comment">!----------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;    ipol        = ipol + 1</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;    k_pol(ipol) = k_pol(ipol-1) + dkold</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;    c_pol(ipol) = cosnew</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;    kold        = knew</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;    cosold      = cosnew</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;    <span class="keywordflow">if</span> (abs(dkold) &lt; 0.0005*(kmax-kmin)) iend=1</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;<span class="comment">! fill last bin with coordinates of end point</span></div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;  <span class="keywordflow">if</span>(k_pol(ipol) &lt; kmax .and. ipol &lt;  mpol) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    ipol = ipol + 1</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;    c_pol(ipol) = -1.</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    k_pol(ipol) = kmax</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;<span class="comment">!  update the number of k-points on symmetry axis</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;  npol = ipol</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;<span class="comment">!  Case 3: Geometric spacing of wave numbers along symmetry axis</span></div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;  <span class="keywordflow">case</span>(3)</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;  kratio = (kmax/kmin)**(1./(npol-1.))</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;  <span class="keywordflow">do</span> ipol=1,npol</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    k_pol(ipol) = kmin*kratio**(ipol-1.)</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;    c_pol(ipol) = x_cosk(k_pol(ipol))</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="keywordflow">end select</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;<span class="comment">!  compute actual number of points on locus</span></div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;<span class="comment">!  this will always be an even number</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;<span class="comment">!  mirror image the second half of the locus</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;nlocus1 = 2*npol-2</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;a_pol(1) = pang + acos(c_pol(1))</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;c_pol(1) = cos(a_pol(1))</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;<span class="keywordflow">do</span> ipol=2,npol</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  jpol = 2*npol-ipol</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;  a_pol(ipol) = pang + acos(c_pol(ipol))</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;  a_pol(jpol) = pang - acos(c_pol(ipol))</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;  c_pol(jpol) = cos(a_pol(jpol))</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;  k_pol(jpol) = k_pol(ipol)</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;<span class="comment">! compute x- and y-position along locus</span></div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;<span class="keywordflow">do</span> ipol=1,nlocus1</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;  x2_loc(ipol) = k_pol(ipol)*cos(a_pol(ipol))</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;  y2_loc(ipol) = k_pol(ipol)*sin(a_pol(ipol))</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_polar2&#39;</span>)</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00289">a_pol</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00288">c_pol</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00226">dk0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00127">iq_locus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00287">k_pol</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00213">mlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00215">nlocus1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00234">pang</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00276">x2_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00277">y2_loc</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00680">serv_xnl4v5::z_wnumb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="aa9999672d3743c70f70d63179d3daa0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9999672d3743c70f70d63179d3daa0f">&#9670;&nbsp;</a></span>q_searchgrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_searchgrid </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>igrid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search nearest valid grid, read grid file and scale factor. </p>
<p>Using the actual water depth all possible interaction grids are checked in upward and downward direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>Depth for which grid file must be found. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">igrid</td><td>Status of grid checking.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Sep-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">5051</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 September 2003</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.03</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="comment">!     Version  Date    Modification</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="comment">!     20/08/2002  Initial version</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="comment">!     29/08/2002  Write statements made conditionsl</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;<span class="comment">!      5/09/2003  Search algorithm improved</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;<span class="comment">!     09/09/2003  factor ID_FACMAX introduced and extra test output created</span></div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;<span class="comment">!                 Input water depth saved for output</span></div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;<span class="comment">!     Search nearest valid grid, read grid file and scale factor</span></div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;<span class="comment">!     Using the actual water depth</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;<span class="comment">!     all possible interaction grids are checked</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;<span class="comment">!     in upward and downward direction</span></div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;<span class="comment">!  3. Parameters used</span></div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     :: depth  <span class="comment">!  depth for which grid file must be found</span></div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: igrid  <span class="comment">!  status of grid checking</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;<span class="comment">!                                 ==0: a proper grid exists</span></div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;<span class="comment">!                                 ==1: grid file does not exist</span></div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;<span class="comment">!                                 ==2: grid file exists, but it is incorrect</span></div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;<span class="comment">!                                 ==3: read error in accessing grid information</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;<span class="comment">!     Q_XNL4V4</span></div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;<span class="comment">!     Q_CTRGRID</span></div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;<span class="comment">!---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;<span class="keywordtype">integer</span> id        <span class="comment">! counter</span></div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;<span class="keywordtype">integer</span> idepth    <span class="comment">! integer depth</span></div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;<span class="keywordtype">integer</span> id_upper  <span class="comment">! upper limit of search</span></div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;<span class="keywordtype">integer</span> id_lower  <span class="comment">! lower limit of depth search</span></div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;<span class="keywordtype">real</span> d_lower      <span class="comment">! lower valid depth</span></div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;<span class="keywordtype">real</span> d_upper      <span class="comment">! upper valid depth</span></div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;<span class="keywordtype">real</span> r_lower      <span class="comment">! ratio with lower valid depth</span></div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;<span class="keywordtype">real</span> r_upper      <span class="comment">! ratio with upper valid depth</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;<span class="keywordtype">real</span> s_depth      <span class="comment">! target depth in m, saved in this variable</span></div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;<span class="keywordtype">real</span> dfac1,dfac2  <span class="comment">! depth scale factors</span></div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;<span class="keywordtype">real</span> eps          <span class="comment">! accuracy</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_searchgrid&#39;</span>)</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;eps = 0.0001</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;<span class="comment">!  check if a depth exists for current grid</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;q_depth = depth + eps</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160; </div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;<span class="keyword">call </span>q_ctrgrid(1,igrid)</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;<span class="keywordflow">if</span>(igrid==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;  <span class="keywordflow">if</span>(iq_screen&gt;=1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_SEARCHGRID: grid accepted, read whole database&#39;</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;  <span class="keyword">call </span>q_ctrgrid(2,igrid)</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;<span class="comment">! save depth for which nearest grid file is to be found</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;s_depth  = depth</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;idepth   = int(s_depth*10+eps)</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;id_lower = int(q_mindepth*10+eps)</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;id_upper = int(q_maxdepth*10+eps)</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;id_upper = min(id_facmax*idepth,id_upper)</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;<span class="comment">!  set &#39;not found&#39; condition</span></div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;d_lower = -1.</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;d_upper = -1.</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;<span class="comment">! search downwards until a valid grid is found</span></div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="keywordflow">do</span> id = idepth-1,id_lower,-1</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;  q_depth = real(id)/10.+eps</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160; </div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;  <span class="keyword">call </span>q_ctrgrid(1,igrid)</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160; </div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160; </div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;  <span class="keywordflow">if</span>(igrid==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    d_lower = q_depth</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    <span class="keywordflow">exit</span></div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;<span class="comment">!  seach upwards until a valid grid is found</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;<span class="keywordflow">do</span> id = idepth+1,id_upper</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;  q_depth = real(id)/10.+eps</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160; </div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160; </div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;  <span class="keyword">call </span>q_ctrgrid(1,igrid)</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160; </div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160; </div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;  <span class="keywordflow">if</span>(igrid==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;    d_upper = q_depth</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    <span class="keywordflow">exit</span></div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=1) <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;<span class="comment">!  determine nearest grid</span></div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;<span class="keywordflow">if</span>(d_lower &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;  r_lower = s_depth/d_lower</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;  r_lower = -1.</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;<span class="keywordflow">if</span>(d_upper &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;  r_upper = d_upper/s_depth</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;  r_upper = -1.</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,3f8.2)&#39;</span>) <span class="stringliteral">&#39;Q_SEARCHGRID: d_lower d_target d_upper      :&#39;</span>,d_lower,s_depth,d_upper</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2f8.2)&#39;</span>) <span class="stringliteral">&#39;Q_SEARCHGRID: r_lower r_upper               :&#39;</span>,r_lower,r_upper</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;<span class="comment">!  select nearest valid grid</span></div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;<span class="keywordflow">if</span>(r_lower&gt;0 .and. r_upper&gt;0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;  <span class="keywordflow">if</span>(r_lower &lt; r_upper) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    q_depth = d_lower</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    q_depth = d_upper</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;<span class="keywordflow">elseif</span>(r_lower &gt; 0 .and. r_upper &lt;0 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;  q_depth = d_lower</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;<span class="keywordflow">elseif</span>(r_lower &lt; 0 .and. r_upper &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;  q_depth = d_upper</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;SEARCHGRID&#39;</span>,<span class="stringliteral">&#39;No valid nearest grid could be found&#39;</span>)</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;<span class="comment">!-----------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;<span class="comment">! compute depth scaling factors</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;<span class="keyword">call </span>q_dscale(a,q_sig,q_a,nkq,naq,s_depth,q_grav,dfac1)</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="keyword">call </span>q_dscale(a,q_sig,q_a,nkq,naq,q_depth,q_grav,dfac2)</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;q_scale = dfac1/dfac2</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,2f8.4)&#39;</span>) <span class="stringliteral">&#39;Q_SEARCHGRID: target and nearest scale factors:&#39;</span>,dfac1,dfac2</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.4)&#39;</span>)  <span class="stringliteral">&#39;Q_SEARCHGRID: compound scale factor           :&#39;</span>,q_scale</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;<span class="comment">!  Read BQF for nearest valid water depth</span></div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;<span class="keyword">call </span>q_ctrgrid(2,igrid)</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f12.2)&#39;</span>) <span class="stringliteral">&#39;Q_SEARCHGRID: Q_CTRGRID called with depth:&#39;</span>,q_depth</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_SEARCHGRID: igrid of nearest grid operation:&#39;</span>,igrid</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;<span class="comment">!  restore water depth</span></div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;q_depth = s_depth</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_searchgrid&#39;</span>)</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00358">a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00363">id_facmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00356">q_a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02397">q_dscale()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00366">q_maxdepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00367">q_mindepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00369">q_scale</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">q_sig</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="aabdea20d05eb0859761876ad2cbaa00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabdea20d05eb0859761876ad2cbaa00e">&#9670;&nbsp;</a></span>q_setconfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_setconfig </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iquad</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set settings for computing the nonlinear interactions. </p>
<p>Set optimal basic settings. Set some settings based on the value of IQUAD.</p>
<p>Based on the value of IQUAD a number of settings are preset. In the case the file [qbase].CFG exists, this file is analyzed and possibly some settings are reset.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iquad</td><td>Indicator for a specific choice of settings for computing the nonlinear interactions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">4795</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="comment">!   |   | +---+  Last update: 16 June 2003</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160; </div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;<span class="comment">!     20/07/1999  Initial version</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;<span class="comment">!     11/10/1999  Option iq_geom added, consistency checks added</span></div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="comment">!     15/10/1999  Option iq_trf added, keyword TRANSF</span></div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;<span class="comment">!     02/11/1999  Close(LUQCFG) added, implicit none added</span></div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;<span class="comment">!     08/12/1999  Option IQ_MOD added</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;<span class="comment">!     24/12/1999  Extra output when *.cfg does not exist, and IQ_PRT=1</span></div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;<span class="comment">!     08/02/2000  Error message included for IQUAD</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;<span class="comment">!     12/05/2002  Triplet settings added</span></div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;<span class="comment">!     08/08/2002  Upgrade to release 4</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;<span class="comment">!     19/08/2002  Inclusion of various test option and interpolation</span></div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;<span class="comment">!     22/08/2002  Switch to compact data included</span></div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;<span class="comment">!     09/09/2002  Parameter q_dstep added</span></div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;<span class="comment">!     11/09/2002  Parameter qf_frac added</span></div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;<span class="comment">!     26/05/2003  Parameter iq_lump added</span></div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;<span class="comment">!     04/06/2003  Parameter IQ_INT renamed IQ_INTEG</span></div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;<span class="comment">!                 Switch IQ_GAULEG added</span></div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;<span class="comment">!     11/06/2003  name changed from Q_SETCFG to Q_SETCONFIG</span></div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;<span class="comment">!                 Parameter IQ_SPACE removed</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;<span class="comment">!     13/06/2003  Set test output, from XNL_INIT</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;<span class="comment">!     16/06/2003  Switch IQ_SYM added</span></div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;<span class="comment">!     09/09/2003  Variable ID_FACMAX added</span></div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;<span class="comment">!     Set settings for computing the nonlinear interactions</span></div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;<span class="comment">!     set optimal basic settings</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;<span class="comment">!     Set some settings based on the value of IQUAD</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;<span class="comment">!     Based on the value of IQUAD a number of settings are preset</span></div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;<span class="comment">!     In the case the file [qbase].CFG exists, this file</span></div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;<span class="comment">!     is analyzed and possibly some settings are reset</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;<span class="comment">!Type, I/O               Name      Description</span></div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;<span class="comment">!--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::   iquad   <span class="comment">! Indicator for a specific choice of</span></div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;<span class="comment">!                                  settings for computing the nonlinear</span></div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;<span class="comment">!                                  interactions</span></div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;<span class="comment">!     XNL_INIT</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;<span class="comment">!     IF no valid value for iquad is given, a default choice is</span></div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;<span class="comment">!     specified</span></div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;<span class="comment">!     The various options of the setting are specified in the general quads module</span></div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;<span class="comment">!     /S Enable subroutine tracing</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;<span class="comment">! Local variables</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;<span class="keywordtype">integer</span> iend               <span class="comment">! indicator for end of file</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;<span class="keywordtype">integer</span> iuerr              <span class="comment">! error status of file io</span></div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;<span class="keywordtype">character(len=10)</span> cpar     <span class="comment">! character parameter</span></div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;<span class="keywordtype">real</span> rpar                  <span class="comment">! real parameter</span></div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_setconfig&#39;</span>)</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;<span class="comment">! default settings, which always work</span></div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;nlocus0    = 30           <span class="comment">! Preferred number of points along locus</span></div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;id_facmax  = 2            <span class="comment">! Factor for depth search in Q_SEARCHGRID</span></div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;iq_filt    = 1            <span class="comment">! switch filtering on</span></div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;iq_gauleg  = 0            <span class="comment">! No Gauss-Legendre interpolation</span></div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;iq_locus   = 2            <span class="comment">! polar method, constant step with adaptive stepping</span></div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;iq_lump    = 0            <span class="comment">! lumping disabled</span></div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;iq_make    = 1            <span class="comment">! make grid at each new run</span></div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;iq_mod     = 1            <span class="comment">! Modify spacing to equidistant spacing of points along locus</span></div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;iq_compact = 1            <span class="comment">! Do not (yet) compact data along locus</span></div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;iq_interp  = 1            <span class="comment">! bi-linear interpolation</span></div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;iq_lump    = 0            <span class="comment">! no lumping of coefficient along locus</span></div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;iq_search  = 0            <span class="comment">! No search is carried out for nearest quad grid</span></div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;iq_sym     = 1            <span class="comment">! Activate symmetry reduction</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<span class="comment">!  set settings for special or test purposes</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;iq_trf     = 0            <span class="comment">! No output of transformed loci</span></div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;iq_t13     = 0            <span class="comment">! No test output of T13 integration</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;<span class="comment">! set filtering values for retricting integration space</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;qf_krat = 2.5             <span class="comment">! maximum ratio between wave numbers k1 and k3</span></div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;qf_dmax = 75.0            <span class="comment">! difference in degrees between k1 and k3</span></div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;qf_frac = 0.1             <span class="comment">! fraction of maximum energy density</span></div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;q_sector = 120.           <span class="comment">! set size of half-plane direction sector (120)</span></div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;<span class="comment">! Set specific parameter depending on IQUAD</span></div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="comment">! deep water test version</span></div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;<span class="keywordflow">if</span>(iquad==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;  iq_geom   = 0            <span class="comment">! apply geometric scaling (Geometric scaling is disabled)</span></div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;  iq_dscale = 0            <span class="comment">! no depth scaling</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;  iq_disp   = 1            <span class="comment">! deep water</span></div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;  iq_cple   = 1            <span class="comment">! Webb&#39;s coupling coefficient</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;<span class="comment">! &#39;deep&#39; water computation and HH/WAM depth scaling</span></div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;<span class="keywordflow">elseif</span>(iquad==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;  iq_geom   = 0            <span class="comment">! apply geometric scaling</span></div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;  iq_dscale = 1            <span class="comment">! put depth scaling on</span></div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;  iq_disp   = 1            <span class="comment">! deep water</span></div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;  iq_cple   = 1            <span class="comment">! Webb&#39;s coupling coefficient</span></div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;<span class="comment">!  full finite depth computation of interactions</span></div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;<span class="keywordflow">elseif</span>(iquad==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;  iq_dscale = 0            <span class="comment">! no depth scaling</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;  iq_disp   = 2            <span class="comment">! finite depth dispersion relation</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;  iq_geom   = 0            <span class="comment">! no geometric scaling</span></div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;  iq_cple   = 2            <span class="comment">! finite depth coupling coefficient of H&amp;H</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;  <span class="keywordflow">if</span>(iq_screen&gt;0) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: iquad=&#39;</span>,iquad</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;IQUAD&#39;</span>,<span class="stringliteral">&#39;No valid value of iquad has been given, default settings&#39;</span>)</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;  <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: Value of IQUAD:&#39;</span>,iquad</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;<span class="comment">! check if the configuration exists,</span></div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;<span class="comment">! and if so, override the settings</span></div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(trim(qbase)//<span class="stringliteral">&#39;.cfg&#39;</span>,<span class="stringliteral">&#39;OF&#39;</span>,iufind,luq_cfg,iuerr)</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;<span class="keywordflow">if</span>(luq_cfg &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;    <span class="keyword">write</span>(luq_log,*)</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: Configuration file &#39;</span>//trim(qbase)//<span class="stringliteral">&#39;.cfg has been found&#39;</span></div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: &#39;</span>//trim(qbase)//<span class="stringliteral">&#39;.cfg connected to :&#39;</span>,luq_cfg</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;  iend = 0</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;  <span class="keywordflow">do</span> <span class="keywordflow">while</span> (iend==0)</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;    <span class="keyword">read</span>(luq_cfg,*,iostat=iend) cpar,rpar</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#a5222a0092e2c5a15f06a76b4c68279c3">z_upper</a>(cpar) <span class="comment">! Convert string to upper case</span></div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    <span class="keywordflow">if</span>(iend==0) <span class="keywordflow">then</span>   <span class="comment">! process the command</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;DEPTH&#39;</span>)    q_depth  = rpar</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;DSTEP&#39;</span>)    q_dstep    = rpar</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;F_DMAX&#39;</span>)   qf_dmax  = rpar</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;F_KRAT&#39;</span>)   qf_krat  = rpar</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;F_FRAC&#39;</span>)   qf_frac  = rpar</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;FMIN&#39;</span>)     fqmin    = rpar</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;FMAX&#39;</span>)     fqmax    = rpar</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;NLOCUS&#39;</span>)   nlocus0    = int(rpar)</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;SECTOR&#39;</span>)   q_sector   = rpar</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;GEOM&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;        iq_geom  = int(rpar)</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;        <span class="keywordflow">if</span>(iq_geom==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;          iq_geom=0</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;          <span class="keywordflow">if</span>(iq_screen&gt;0) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: geometric scaling disabled&#39;</span></div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;          <span class="keywordflow">if</span>(iq_prt&gt;=1)   <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: geometric scaling disabled&#39;</span></div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;COMPACT&#39;</span>)  iq_compact = int(rpar)</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;COUPLING&#39;</span>) iq_cple    = int(rpar)</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;DISPER&#39;</span>)   iq_disp    = int(rpar)</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;FILT&#39;</span>)     iq_filt    = int(rpar)</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;GAULEG&#39;</span>)   iq_gauleg  = int(rpar)</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;GRID&#39;</span>)     iq_grid    = int(rpar)</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;INTEG&#39;</span>)    iq_integ   = int(rpar)</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;INTERP&#39;</span>)   iq_interp  = int(rpar)</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;LOCUS&#39;</span>)    iq_locus   = int(rpar)</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;LOGGING&#39;</span>)  iq_log     = int(rpar)</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;LUMPING&#39;</span>)  iq_lump    = int(rpar)</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;MAKE&#39;</span>)     iq_make    = int(rpar)</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;MODIFY&#39;</span>)   iq_mod     = int(rpar)</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;PRINT&#39;</span>)    iq_prt     = int(rpar)</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;PRINT&#39;</span>)    iq_prt     = int(rpar)</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;SCREEN&#39;</span>)   iq_screen  = int(rpar)</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;SEARCH&#39;</span>)   iq_search  = int(rpar)</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;SYM&#39;</span>)      iq_sym     = int(rpar)</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;T13&#39;</span>)      iq_t13     = int(rpar)</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;TEST&#39;</span>)     iq_test    = int(rpar)</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;TRACE&#39;</span>)    iq_trace   = int(rpar)</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;TRANSF&#39;</span>)   iq_trf     = int(rpar)</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      <span class="keywordflow">if</span>(trim(cpar)==<span class="stringliteral">&#39;XDIA&#39;</span>)     iq_xdia    = int(rpar)</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;  <span class="keyword">close</span>(luq_cfg)</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) &amp;</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;&amp; <span class="stringliteral">&#39;Q_SETCONFIG: &#39;</span>//trim(qbase)//<span class="stringliteral">&#39;.cfg disconnected from :&#39;</span>,luq_cfg</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;<span class="comment">!  iq_prt = 1</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;  <span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;    <span class="keyword">write</span>(luq_log,*)</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;    <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_SETCONFIG: Configuration file &#39;</span>//trim(qbase)//<span class="stringliteral">&#39;.CFG has not been found&#39;</span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_setconfig&#39;</span>)</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00207">fqmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00206">fqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00363">id_facmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00078">iq_compact</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">iq_cple</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00094">iq_dscale</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00099">iq_filt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00103">iq_gauleg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00117">iq_integ</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00123">iq_interp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00127">iq_locus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00136">iq_lump</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00140">iq_make</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00145">iq_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00153">iq_search</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00161">iq_sym</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00179">iq_t13</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00170">iq_trace</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00175">iq_trf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00183">iq_xdia</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00045">iufind</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00051">luq_cfg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00209">q_dstep</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00208">q_sector</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00042">qbase</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00073">qf_dmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00074">qf_frac</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00072">qf_krat</a>, <a class="el" href="mod__fileio_8f90_source.html#l00084">m_fileio::z_fileio()</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00630">serv_xnl4v5::z_upper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a934cecc39521f8b4d683b755e8150d5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a934cecc39521f8b4d683b755e8150d5e">&#9670;&nbsp;</a></span>q_setversion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_setversion</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine has automatically been written by MODULE5. </p>
<p>Source code options:S. Do not use <a class="el" href="namespacem__xnldata.html" title="Module for computing the quadruplet interaction.">m_xnldata</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>15-Sep-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05279">5279</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;<span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;<span class="comment">!-----------------------------------------------------------------</span></div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;<span class="comment">! This subroutine has automatically been written by MODULE5</span></div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;<span class="comment">! Author: Gerbrant van Vledder</span></div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;q_version =<span class="stringliteral">&#39;GurboQuad  Version: 5.03 Build: 59 Date: 2003/09/15 [S]&#39;</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;<span class="comment">! Source code options:S</span></div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00039">q_version</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a20913fbb96d0c75d9f04d7c5ebd9b5e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20913fbb96d0c75d9f04d7c5ebd9b5e1">&#9670;&nbsp;</a></span>q_stack()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_stack </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>mod_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add or remove mod_name name from module stack. </p>
<p>Mod_name must be preceeded by a '+' , '-'.</p>
<p>The module name is pushed to the stack when preceeded by '+' and removed if mname starts with '-'.</p>
<p>In case an error is active,the module name is not removed from the stack if mname starts with a '-'. The module is always removed from the stack if mname starts with '!'.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mod_name</td><td>Module name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>11-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">5310</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;<span class="comment">!   |   | +---+  Last update: 11 June 2003</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;<span class="comment">!   +---+ |   |  Release: 5</span></div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;<span class="comment">!     20/07/1999  Initial version</span></div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;<span class="comment">!     13/10/1999  Error handling improved</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="comment">!     08/08/2002  Upgrade to release 4</span></div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;<span class="comment">!     11/06/2003  Extra check on output to print or test file</span></div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;<span class="comment">!     Add or remove mod_name name from module stack</span></div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;<span class="comment">!     mod_name must be preceeded by a &#39;+&#39; , &#39;-&#39;</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;<span class="comment">!     The module name is pushed to the stack when preceeded by &#39;+&#39;</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="comment">!     and removed if mname starts with &#39;-&#39;.</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="comment">!     In case an error is active,the module name is not removed</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;<span class="comment">!     from the stack if mname starts with a &#39;-&#39;.The module is</span></div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;<span class="comment">!     always removed from the stack if mname starts with &#39;!&#39;.</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;<span class="comment">!Type           I/O          name          description</span></div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;<span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;<span class="keywordtype">character(len=*)</span>, <span class="keywordtype">intent(in)</span> :: mod_name    <span class="comment">! module name</span></div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;<span class="comment">!  5. Called by</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;<span class="comment">!     All q_** routines</span></div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;<span class="comment">!     q_error</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;<span class="comment">!-------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;<span class="keywordtype">character(len=1)</span> mod_task       <span class="comment">! task to do</span></div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;<span class="keywordtype">integer</span> mod_len                 <span class="comment">! length of mod_name</span></div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;<span class="comment">!!\A</span></div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;<span class="keywordflow">if</span>(iq_trace &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;  <span class="keywordflow">if</span>(iq_prt&gt;0)  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;TRACE -&gt; &#39;</span>,trim(mod_name)</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;  <span class="keywordflow">if</span>(iq_test&gt;0) <span class="keyword">write</span>(luq_tst,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;TRACE -&gt; &#39;</span>,trim(mod_name)</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;  <span class="keywordflow">if</span>(iq_screen &gt;= 2) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(2a)&#39;</span>) <span class="stringliteral">&#39;TRACE -&gt; &#39;</span>,trim(mod_name)</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;<span class="comment">!  split MOD_NAME in two parts</span></div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;<span class="comment">!        MOD_TASK &#39;+&#39;,&#39;-&#39;</span></div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;mod_len  = len_trim(mod_name)</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;mod_task = mod_name(1:1)</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;sub_name = mod_name(2:mod_len)</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;<span class="keywordflow">if</span>(mod_task(1:1) == <span class="stringliteral">&#39;+&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;  iq_stack = iq_stack + 1</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;  <span class="keywordflow">if</span>(iq_stack &gt; mq_stack) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;STACKMAX&#39;</span>,<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;    cstack(iq_stack) = mod_name(2:mod_len)</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;<span class="comment">!------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;<span class="comment">!  remove name from stack</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;<span class="comment">!------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;<span class="keywordflow">elseif</span>(mod_task(1:1) == <span class="stringliteral">&#39;-&#39;</span>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;  <span class="keywordflow">if</span>(mod_name(2:mod_len) == cstack(iq_stack)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;    iq_stack = iq_stack - 1</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;    <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Module name:&#39;</span>,mod_name</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;STACKNAME&#39;</span>,<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;STACKCALL&#39;</span>,<span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;<span class="comment">!!\Z</span></div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00376">cstack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00375">iq_stack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00170">iq_trace</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00060">luq_tst</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00211">mq_stack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00041">sub_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02397">q_dscale()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05649">q_symmetry()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a6519a369a2938e895309f48a534cc555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6519a369a2938e895309f48a534cc555">&#9670;&nbsp;</a></span>q_summary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_summary</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write summary of GurboQuad settings to print file. </p>
<p>Based on the value of IQUAD a number of settings are preset. In the case the file [qbase].CFG exists, this file is analyzed and possibly some settings are reset.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">5431</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;<span class="comment">!   |   | +---+  Last update: 16 June 2003</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160; </div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;<span class="comment">!     11/06/2003  Initial version</span></div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;<span class="comment">!                 Parameter iq_space removed</span></div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;<span class="comment">!     16/06/2003  Switch IQ_SYM added</span></div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;<span class="comment">!     Write summary of GurboQuad settings to print file</span></div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;<span class="comment">!     Based on the value of IQUAD a number of settings are preset</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;<span class="comment">!     In the case the file [qbase].CFG exists, this file</span></div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;<span class="comment">!     is analyzed and possibly some settings are reset</span></div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="comment">!Type, I/O               Name      Description</span></div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;<span class="comment">!--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;<span class="comment">!     XNL_INIT</span></div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;<span class="comment">!     /S Enable subroutine tracing</span></div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;<span class="comment">! Local variables</span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_summary&#39;</span>)</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;<span class="comment">!-----------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;<span class="comment">!  write summary of settings for computation of quadruplets</span></div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;<span class="comment">!  to print file</span></div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;<span class="keywordflow">if</span> (iq_prt &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Summary of settings for QUAD computation&#39;</span></div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;------------------------------------------------&#39;</span></div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>)     <span class="stringliteral">&#39;Number of wave numbers          :&#39;</span>,nkq</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>)     <span class="stringliteral">&#39;Number of directions            :&#39;</span>,naq</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f10.5)&#39;</span>)  <span class="stringliteral">&#39;Minimum frequency (Hz)          :&#39;</span>,fqmin</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f10.5)&#39;</span>)  <span class="stringliteral">&#39;Maximum frequency (Hz)          :&#39;</span>,fqmax</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f10.2)&#39;</span>)  <span class="stringliteral">&#39;Water depth (m)                 :&#39;</span>,q_depth</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>)     <span class="stringliteral">&#39;Preferred number of locus points:&#39;</span>,nlocus0</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f10.3)&#39;</span>) <span class="stringliteral">&#39;Gravitational acceleration:&#39;</span>,q_grav</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;<span class="comment">!  write(luq_prt,&#39;(a,f10.3)&#39;) &#39;Density of water          :&#39;,q_rhow</span></div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="comment">!  write(luq_prt,&#39;(a,f10.2)&#39;) &#39;Power spectral tail E(f)  :&#39;,qf_tail</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;<span class="comment">!  write(luq_prt,&#39;(a,f10.2)&#39;) &#39;Power spectral tail N(k)  :&#39;,qk_tail</span></div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;  <span class="keywordflow">if</span>(iq_type==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;IQUAD = 1: Deep water&#39;</span></div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;  <span class="keywordflow">if</span>(iq_type==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;IQUAD = 2: Deep water &amp; WAM depth scaling&#39;</span></div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;  <span class="keywordflow">if</span>(iq_type==3) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;IQUAD = 3: Direct finite depth calculation&#39;</span></div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f5.2)&#39;</span>) <span class="stringliteral">&#39;Step size in m of BQF coding:&#39;</span>,q_dstep</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;  <span class="keywordflow">if</span>(iq_grid==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Symmetric sector grid&#39;</span></div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  <span class="keywordflow">if</span>(iq_grid==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Non-symmetric sector grid&#39;</span></div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;  <span class="keywordflow">if</span>(iq_grid==3) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Non-symmetric full circle grid&#39;</span></div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;  <span class="keywordflow">if</span>(iq_compact==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;No compacting of data along locus&#39;</span></div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  <span class="keywordflow">if</span>(iq_compact==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Compact data along locus by eliminating zero contributions&#39;</span></div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;  <span class="keywordflow">if</span>(iq_dscale==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;No WAM depth scaling&#39;</span></div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;  <span class="keywordflow">if</span>(iq_dscale==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;WAM depth scaling of transfer&#39;</span></div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;  <span class="keywordflow">if</span>(iq_screen==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;No output to screen&#39;</span></div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;  <span class="keywordflow">if</span>(iq_screen&gt;=1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Intermediate output to screen&#39;</span></div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <span class="keywordflow">if</span>(iq_screen&gt;=2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Intermediate output to screen + subroutine tracing&#39;</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;  <span class="keywordflow">if</span>(iq_search==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;No search is carried out for nearest QUAD grid&#39;</span></div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <span class="keywordflow">if</span>(iq_search==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;A search is carried out for nearest QUAD grid&#39;</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="keywordflow">if</span>(iq_gauleg==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>)    <span class="stringliteral">&#39;Rectangular integration&#39;</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;  <span class="keywordflow">if</span>(iq_gauleg&gt;0)  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Gauss-Legendre integration with N=&#39;</span>,iq_gauleg</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;  <span class="keywordflow">if</span>(iq_cple==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Deep water coupling coefficient of Webb&#39;</span></div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;  <span class="keywordflow">if</span>(iq_cple==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Finite depth coupling coefficient of H&amp;H&#39;</span></div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;  <span class="keywordflow">if</span>(iq_cple==3) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Finite depth coupling coefficient of Gorman&#39;</span></div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;  <span class="keywordflow">if</span>(iq_cple==4) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Deep water coefficient of Zakharov&#39;</span></div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;  <span class="keywordflow">if</span>(iq_cple==5) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Finite depth coefficient of Zakharov&#39;</span></div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;  <span class="keywordflow">if</span>(iq_disp==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Deep water dispersion relation&#39;</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;  <span class="keywordflow">if</span>(iq_disp==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Finite depth linear dispersion relation&#39;</span></div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;  <span class="keywordflow">if</span>(iq_disp==3) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Non linear finite depth dispersion&#39;</span></div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;  <span class="keywordflow">if</span>(iq_filt==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Filtering of quadruplets off&#39;</span></div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;  <span class="keywordflow">if</span>(iq_filt==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;     <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Filtering of quadruplets on&#39;</span></div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;     <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;     <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.2)&#39;</span>)  <span class="stringliteral">&#39;Maximum ratio of k1 and k3        :&#39;</span>,qf_krat</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;     <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f8.2)&#39;</span>)  <span class="stringliteral">&#39;Maximum directional difference    :&#39;</span>,qf_dmax</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;     <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,e12.3)&#39;</span>) <span class="stringliteral">&#39;Fraction of maximum energy density:&#39;</span>,qf_frac</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;<span class="comment">!  write(luq_prt,*)</span></div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;<span class="comment">!  if(iq_geom==0) write(luq_prt,&#39;(a)&#39;) &#39;Only directional scaling of loci&#39;</span></div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;<span class="comment">!  if(iq_geom==1) write(luq_prt,&#39;(a)&#39;) &#39;Geometric scaling of loci using R-T method&#39;</span></div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;  <span class="keywordflow">if</span>(iq_locus==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Compute locus with polar method with fixed k-step&#39;</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;  <span class="keywordflow">if</span>(iq_locus==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Compute locus with polar method using adaptive k-step&#39;</span></div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;  <span class="keywordflow">if</span>(iq_locus==3) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Compute locus with polar method using geometric k-step&#39;</span></div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;  <span class="keywordflow">if</span>(iq_sym==0)  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Handling of symmetries disabled&#39;</span></div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;  <span class="keywordflow">if</span>(iq_sym==1)  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Handling of symmetries enabled&#39;</span></div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;  <span class="keywordflow">if</span>(iq_make==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Make quadruplet grid when necessary&#39;</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;  <span class="keywordflow">if</span>(iq_make==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Always make quadruplet grid&#39;</span></div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;  <span class="keywordflow">if</span>(iq_make==3) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Stop after generation of quadruplet grid&#39;</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;  <span class="keywordflow">if</span>(iq_interp==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Apply bi-linear interpotion to retrieve action density&#39;</span></div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;  <span class="keywordflow">if</span>(iq_interp==2) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Take nearest bin to retrieve action density&#39;</span></div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;  <span class="keywordflow">if</span>(iq_lump==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Lumping of coefficients along locus disabled&#39;</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;  <span class="keywordflow">if</span>(iq_lump&gt;0)  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Lumping of coefficients along locus enabled&#39;</span></div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;  <span class="keywordflow">if</span>(iq_mod==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;?X? Spacing of point along locus as initially computed&#39;</span></div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;  <span class="keywordflow">if</span>(iq_mod==1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Equidistant spacing of points along locus&#39;</span></div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;  <span class="keywordflow">if</span>(iq_trace==0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Subroutine tracing disabled&#39;</span></div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;  <span class="keywordflow">if</span>(iq_trace&gt;0)  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Subroutine tracing enabled&#39;</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;<span class="comment">!  if(iq_disp==1 .and. iq_start==2) then</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;<span class="comment">!    write(luqprt,&#39;(a)&#39;) &#39;Start point for locus according to Resio&amp;Tracy&#39;</span></div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;<span class="comment">!  else</span></div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;<span class="comment">!    write(luqprt,&#39;(a)&#39;) &#39;Start point for locus equal to k3&#39;</span></div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;<span class="comment">!  end if</span></div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Level of printed output        :&#39;</span>,iq_prt</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Level of logging output        :&#39;</span>,iq_log</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Level of test output           :&#39;</span>,iq_test</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Level of trace output          :&#39;</span>,iq_trace</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;Level of transformation output :&#39;</span>,iq_trf</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>)   <span class="stringliteral">&#39;----------------------------------------------&#39;</span></div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_summary&#39;</span>)</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00207">fqmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00206">fqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00078">iq_compact</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">iq_cple</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00094">iq_dscale</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00099">iq_filt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00103">iq_gauleg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00123">iq_interp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00127">iq_locus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00136">iq_lump</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00140">iq_make</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00145">iq_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00153">iq_search</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00161">iq_sym</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00170">iq_trace</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00175">iq_trf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00414">iq_type</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00209">q_dstep</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00073">qf_dmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00074">qf_frac</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00072">qf_krat</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a3e8e77ddc1e4c7c8946c0e8b83d34ba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e8e77ddc1e4c7c8946c0e8b83d34ba4">&#9670;&nbsp;</a></span>q_symmetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_symmetry </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nloc), intent(in)&#160;</td>
          <td class="paramname"><em>k4x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nloc), intent(in)&#160;</td>
          <td class="paramname"><em>k4y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nloc), intent(out)&#160;</td>
          <td class="paramname"><em>symfac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute symmetry factor to reduce integration. </p>
<p>Compute distance between k1 and k3, and between k4 and k1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">k1x</td><td>X-component of wave number k1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1y</td><td>Y-component of wave number k1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k3x</td><td>X-component of wave number k3. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k3y</td><td>Y-component of wave number k3. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k4x</td><td>X-components of wave number k4. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k4y</td><td>Y-components of wave number k4. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">symfac</td><td>Symmetry factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nloc</td><td>Number of points in array with wave number.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05649">5649</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;<span class="comment">!   |   | +---+  Last update: 16 June 2003</span></div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;<span class="comment">!     10/06/2003  Initial version</span></div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;<span class="comment">!     16/06/2003  Switch iq_sym added</span></div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;<span class="comment">!     Compute symmetry factor to reduce integration</span></div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;<span class="comment">!     Compute distance between k1 and k3, and between k4 and k1</span></div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;<span class="comment">! Type   i/o             Name           Description</span></div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>   :: nloc         <span class="comment">! number of points in array with wave number</span></div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>      :: k1x          <span class="comment">! x-component  of wave number k1</span></div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>      :: k1y          <span class="comment">! y-component  of wave number k1</span></div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>      :: k3x          <span class="comment">! x-component  of wave number k3</span></div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>      :: k3y          <span class="comment">! y-component  of wave number k3</span></div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>      :: k4x(nloc)    <span class="comment">! x-components of wave number k4</span></div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>      :: k4y(nloc)    <span class="comment">! y-components of wave number k4</span></div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>     :: symfac(nloc) <span class="comment">! symmetry factor</span></div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;<span class="comment">!     Q_MODIFY</span></div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;<span class="comment">!  8. structure</span></div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;<span class="keywordtype">integer</span> iloc      <span class="comment">! counter</span></div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;<span class="keywordtype">real</span> dk13         <span class="comment">! distance between k1 and k3</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;<span class="keywordtype">real</span> dk14         <span class="comment">! distance between k1 and k4</span></div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_symmetry&#39;</span>)</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;<span class="comment">! evaluate criterion |k3-k1| &lt; |k4-k1|</span></div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;<span class="comment">! if true then symfac=1</span></div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;symfac = 1.</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="keywordflow">if</span>(iq_sym==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;  dk13 = (k1x-k3x)**2 + (k1y-k3y)**2</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;  <span class="keywordflow">do</span> iloc=1,nloc</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;    dk14 = (k1x-k4x(iloc))**2 + (k1y-k4y(iloc))**2</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;    <span class="keywordflow">if</span> (dk13 &gt;= dk14) symfac(iloc) = 0.</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_symmetry&#39;</span>)</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00161">iq_sym</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a865a6607dfe4d669645c8e55d7276b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a865a6607dfe4d669645c8e55d7276b07">&#9670;&nbsp;</a></span>q_t13v4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_t13v4 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ik1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ia1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ik3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ia3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>t13</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>diagk1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>diagk3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the function T13, defined as a line integral around a locus. </p>
<p>See Tracy and Resio (1982) and Van Vledder (1999).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ik1</td><td>Index of k-component of wave number k1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia1</td><td>Index of a-component of wave number k1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ik3</td><td>Index of k-component of wave number k3. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ia3</td><td>Index of a-component of wave number k3. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">t13</td><td>Value of line integral over a specific locus. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diagk1</td><td>Contribution to diagonal term of k1. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diagk3</td><td>Contribution to diagonal term of k3.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>5-Sep-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">5746</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;<span class="comment">!   |   | +---+  Last update: 5 September 2003</span></div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;<span class="comment">!     25/02/1999  Initial version</span></div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;<span class="comment">!     14/04/1999  Extra check in GET_LOC if locus exists in internal database</span></div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;<span class="comment">!     12/10/1999  Error handling improved</span></div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;<span class="comment">!     15/01/2001  Interface extended with diagonal term</span></div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;<span class="comment">!     06/05/2002  Criterion f34_mod added to computational procedure</span></div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;<span class="comment">!     14/08/2002  Integration simplified</span></div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;<span class="comment">!     22/08/2002  Integration modified depending on actual number of non-zero points</span></div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;<span class="comment">!     26/09/2002  Boundary check for sector grid activated</span></div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;<span class="comment">!     15/04/2003  Bug fixed in handling of periodicity</span></div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;<span class="comment">!                 Nearest bin integration enabled, including diagonal term</span></div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;<span class="comment">!     25/04/2003  Output to triplet arrays for nearest bin</span></div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;<span class="comment">!     03/05/2003  Output of triplets for bi-linear interpolation enabled</span></div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;<span class="comment">!     04/06/2003  Parameter IQ_INT renamed IQ_INTEG</span></div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;<span class="comment">!     13/06/2003  Test of integration for case of nearest bin interpolation</span></div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;<span class="comment">!     25/06/2003  Bug fixed in computation of partial derivatives for contribution to</span></div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;<span class="comment">!                 diagonal term</span></div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;<span class="comment">!     27/08/2003  Short-cut when number of non-zero points on locus is ZERO</span></div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;<span class="comment">!     05/09/2003  Switches for test output in nearest bin approach modified</span></div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;<span class="comment">!     Compute the function T13, defined as a line integral around a locus</span></div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;<span class="comment">!     See Tracy and Resio (1982) and Van Vledder (1999)</span></div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;<span class="comment">! Type    I/O          Name             Description</span></div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::  ik1     <span class="comment">!    Index of k-component of wave number k1</span></div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::  ia1     <span class="comment">!    Index of a-component of wave number k1</span></div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::  ik3     <span class="comment">!    Index of k-component of wave number k3</span></div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::  ia3     <span class="comment">!    Index of a-component of wave number k3</span></div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   ::  t13     <span class="comment">!    Value of line integral over a specific locus</span></div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   ::  diagk1  <span class="comment">!    Contribution to diagonal term of k1</span></div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>   ::  diagk3  <span class="comment">!    Contribution to diagonal term of k3</span></div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;<span class="comment">!     Q_XNL4V4</span></div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;<span class="comment">!     Q_GETLOCUS</span></div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;<span class="comment">!     Q_PUT_BTRIPLETS</span></div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;<span class="comment">!     Q_PUT_NTRIPLETS</span></div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;<span class="comment">!     The action density product term is given by:</span></div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;<span class="comment">!     P = n1.n2.(n3+n4)-(n1+n2).n3.n4</span></div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;<span class="comment">!     This term is rewritten as:</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;<span class="comment">!     P = n1.n2.n3 + n1.n2.n4 - n1.n3.n4 - n2.n3.n4</span></div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;<span class="comment">!       = n1.n3.(n2-n4) + n2.n4.(n1-n3)</span></div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160; </div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;<span class="comment">!     /S  enable subroutine tracing</span></div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;<span class="comment">!     /T  enable test output</span></div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;<span class="comment">!     /N  enable interpolation using nearest point</span></div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;<span class="keywordtype">integer</span> iloc          <span class="comment">! counter along locus</span></div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;<span class="keywordtype">integer</span> ifnd           <span class="comment">! indicator if correct locus is found</span></div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;<span class="keywordtype">integer</span> ja2,ja2p      <span class="comment">! direction indices for interpolation of k2</span></div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;<span class="keywordtype">integer</span> jk2,jk2p      <span class="comment">! wave number indices for interpolation of k2</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;<span class="keywordtype">integer</span> ja4,ja4p      <span class="comment">! direction indices for interpolation of k4</span></div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;<span class="keywordtype">integer</span> jk4,jk4p      <span class="comment">! wave number indices for interpolation of k4</span></div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;<span class="keywordtype">integer</span> ikq,iaq       <span class="comment">! counters</span></div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;<span class="keywordtype">real</span> sumt13           <span class="comment">! sum along locus</span></div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;<span class="keywordtype">real</span> qn1,qn2,qn3,qn4  <span class="comment">! action densities at wave numbers k1, k2, k3 and k4</span></div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;<span class="keywordtype">real</span> nprod            <span class="comment">! wave number product</span></div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;<span class="keywordtype">real</span> t2,t4            <span class="comment">! tail factors for k2 and k4</span></div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;<span class="keywordtype">real</span> qd1,qd3          <span class="comment">! contribution to diagonal term</span></div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;<span class="keywordtype">real</span> rterm            <span class="comment">! product term along locus</span></div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;<span class="keywordtype">real</span> qn13p            <span class="comment">! product of N1 and N3</span></div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;<span class="keywordtype">real</span> qn13d            <span class="comment">! difference of N1 and N3</span></div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_t13v4&#39;</span>)</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;t13    = 0.</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;diagk1 = 0.</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;diagk3 = 0.</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;<span class="keywordflow">if</span>(ik1==ik3 .and. ia1==ia3) <span class="keywordflow">goto</span> 9999  <span class="comment">! skip routine if k1=k3</span></div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;<span class="comment">!  obtain information requested locus based on a information</span></div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;<span class="comment">!  about a precomputed locus, as stored in the database file</span></div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;<span class="keyword">call </span>q_getlocus(ik1,ia1,ik3,ia3,ifnd)</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;<span class="keywordflow">if</span>(ifnd==0 .or. nlocusx==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;  t13 = 0.</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;qn1 = nspec(ik1,ia1)</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;qn3 = nspec(ik3,ia3)</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;qn13p = qn1*qn3      <span class="comment">! compute product</span></div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;qn13d = qn3-qn1      <span class="comment">! compute difference</span></div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;sumt13 = 0</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;<span class="comment">!    3-----------4 ja2p         w1 = (1-wk)*(1-wa)</span></div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;<span class="comment">!    |    .      |              w2 = wk*(1-wa)</span></div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;<span class="comment">!    |. . + . . .| wa2   A      w3 = (1-wk)*wa</span></div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;<span class="comment">!    |    .      |       |      w4 = wk*wa</span></div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;<span class="comment">!    |    .      |       wa</span></div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;<span class="comment">!    |    .      |       |</span></div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;<span class="comment">!    1-----------2 ja2   V</span></div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;<span class="comment">!   jk2  wk2  jk2p</span></div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;<span class="comment">!    &lt;-wk-&gt;</span></div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;t2 = 1.</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;t4 = 1.</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;<span class="comment">!-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;<span class="comment">!  Main loop over the locus</span></div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;<span class="keywordflow">do</span> iloc=1,nlocusx</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;  jk2  = t_ik2(iloc)</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;  jk2p = min(jk2+1,nkq)</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;  ja2  = mod(t_ia2(iloc)-1+naq,naq)+1</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;  ja2p = mod(t_ia2(iloc)+naq,naq)+1</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;<span class="comment">! compute tail parameters</span></div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;<span class="comment">!!  if(iq_geom==1) then</span></div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;<span class="comment">!!    jk2 = max(1,jk2)</span></div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;<span class="comment">!!    jk4 = max(1,jk4)</span></div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;<span class="comment">!!    t2 = max(1.,q_kfac**real(t_ik2(iloc)-nkq))</span></div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;<span class="comment">!!    t2 = t2**qk_tail</span></div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;<span class="comment">!!    t4 = max(1.,q_kfac**real(t_ik4(iloc)-nkq))</span></div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;<span class="comment">!!    t4 = t4**qk_tail</span></div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;<span class="comment">!!  end if</span></div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;<span class="comment">!  check boundaries of sector grid</span></div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;  <span class="keywordflow">if</span>(iq_grid &lt; 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;    ja2  = max(ja2,1)</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;    ja2  = min(ja2,naq)</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;    ja2p = max(ja2p,1)</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;    ja2p = min(ja2p,naq)</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;  qn2  = (t_w1k2(iloc)*nspec(jk2,ja2)  + t_w2k2(iloc)*nspec(jk2p,ja2) + &amp;</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;&amp;         t_w3k2(iloc)*nspec(jk2,ja2p) + t_w4k2(iloc)*nspec(jk2p,ja2p))*t2</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;  jk4  = t_ik4(iloc)</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;  jk4p = min(jk4+1,nkq)</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;  ja4  = mod(t_ia4(iloc)-1+naq,naq)+1</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;  ja4p = mod(t_ia4(iloc)+naq,naq)+1</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;<span class="comment">!  special treatment for sector grids</span></div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;<span class="comment">!  limit range of indices</span></div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;<span class="comment">!  QQQ: in fact energy density should be set to ZERO</span></div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;  <span class="keywordflow">if</span>(iq_grid &lt; 3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;    ja4  = max(ja4,1)</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;    ja4  = min(ja4,naq)</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;    ja4p = max(ja4p,1)</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;    ja4p = min(ja4p,naq)</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;  qn4  = (t_w1k4(iloc)*nspec(jk4,ja4)  + t_w2k4(iloc)*nspec(jk4p,ja4) + &amp;</div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;&amp;         t_w3k4(iloc)*nspec(jk4,ja4p) + t_w4k4(iloc)*nspec(jk4p,ja4p))*t4</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;  nprod     = qn13p*(qn4-qn2) + qn2*qn4*qn13d</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;  rterm     = t_zz(iloc)</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;  t13        = t13 + rterm*nprod</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;<span class="comment">! output to triplets</span></div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;<span class="comment">!  add diagonal terms</span></div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;<span class="comment">!!  qd1    = qn3*(qn4-qn2) + qn2*qn4*qn3</span></div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;<span class="comment">!!  qd3    = qn1*(qn4-qn2) - qn2*qn4*qn1</span></div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;  qd1    = qn3*(qn4-qn2) - qn2*qn4</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;  qd3    = qn1*(qn4-qn2) + qn2*qn4</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;  diagk1 = diagk1 + qd1*rterm</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;  diagk3 = diagk3 + qd3*rterm</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;<span class="comment">!-----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;<span class="comment">!!/T if(iq_test&gt;=4) then</span></div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;<span class="comment">!!/T   write(luq_tst,&#39;(a)&#39;) &#39;Q_T13V4: NSPEC&#39;</span></div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;<span class="comment">!!/T  do ikq=1,nkq</span></div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;<span class="comment">!!/T    write(luq_tst,&#39;(100e12.4)&#39;) (nspec(ikq,iaq),iaq=1,naq)</span></div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;<span class="comment">!!T  end do</span></div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;<span class="comment">!!T end if</span></div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;<span class="comment">!!if(iq_integ==3) write(luq_int,&#39;(4i3,i5,1000e13.5)&#39;) ik1,ia1,ik3,ia3,nloc, &amp;</span></div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;<span class="comment">!!&amp; t_s(nloc),t13,(dt13(iloc),iloc=1,nloc)</span></div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_t13v4&#39;</span>)</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00220">nlocusx</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00359">nspec</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00319">t_ia2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00321">t_ia4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00318">t_ik2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00320">t_ik4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00322">t_w1k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00326">t_w1k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00323">t_w2k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00327">t_w2k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00324">t_w3k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00328">t_w3k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00325">t_w4k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00329">t_w4k4</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00330">t_zz</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="aaf81bd330e030f777b7d70abc2c7c446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf81bd330e030f777b7d70abc2c7c446">&#9670;&nbsp;</a></span>q_weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_weight</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute interpolation weights of locus. </p>
<p>Compute position of wave number in wave number grid. Usable for linear interpolation.</p>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>20-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">5998</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;<span class="comment">!   |   | +---+  Last update: 20 Aug. 2002</span></div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;<span class="comment">!     13/04/1999  Initial version</span></div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;<span class="comment">!     27/10/1999  Weight computed in the case that k2m &lt; k(1)</span></div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;<span class="comment">!     01/11/1999  Use of Q_XK and Q_SK added to compute weights if k &gt; kmax</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;<span class="comment">!     26/11/1999  Bug fixed when checking conversion</span></div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;<span class="comment">!      8/12/1999  Use of SK_MAX introduced to handle very large loci</span></div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;<span class="comment">!     09/08/2002  Modification of weights</span></div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;<span class="comment">!     13/08/2002  storage of log-spacing replace by linear spacing</span></div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;<span class="comment">!     20/08/2002  Bug fixed when geometric scaling is assumed</span></div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;<span class="comment">!     Compute interpolation weights of locus</span></div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;<span class="comment">!     Compute position of wave number in wave number grid</span></div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;<span class="comment">!     Usable for linear interpolation</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;<span class="comment">!     Name    I/O  Type  Description</span></div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;<span class="comment">!     Q_MAKEGRID</span></div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;<span class="comment">!     The tail factors wt_k2 and wt_k4 are valid for the decay of the action density spectrum</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;<span class="comment">!     N(kx,ky). With p (qk_tail) the power p of the tail of the N(k) spectrum, and q the power</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;<span class="comment">!     of the tail of the N(kx,ky) spectrum, we have q=p-1</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;<span class="comment">!     Since N(k) = k N(kx,ky) with k the Jacobian</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;<span class="comment">!     it follows that the tail functions are given by</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;<span class="comment">!     k^p = k k^q   =&gt;   k^p = k^(q+1) =&gt; p=q+1  =&gt; q=p-1</span></div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;<span class="comment">!     Initialisations</span></div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;<span class="comment">!     do for all points on locus</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;<span class="comment">!       compute directional index for k2 and k4</span></div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;<span class="comment">!       if geometric scaling then</span></div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;<span class="comment">!         compute wave number index directly</span></div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;<span class="comment">!         convert log-scaling to linear scaling</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="comment">!       else</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;<span class="comment">!         search position of wave number in k-array</span></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;<span class="comment">!         if k &lt; kmin then</span></div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;<span class="comment">!           k-index = 1 and factor is 0</span></div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;<span class="comment">!         elsif k &lt; kmax then</span></div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;<span class="comment">!           compute k-index for k2 and k4</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;<span class="comment">!         else</span></div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;<span class="comment">!           compute tail factor</span></div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;<span class="comment">!         end if</span></div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;<span class="comment">!       end if</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;<span class="comment">!     end do</span></div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;<span class="comment">!     /T  enable test output</span></div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;<span class="keywordtype">integer</span> iloc      <span class="comment">! counter along locus loop</span></div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;<span class="keywordtype">integer</span> jpos      <span class="comment">! index for interpolation and tracking of position in wave numebr array</span></div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;<span class="keywordtype">integer</span> itest     <span class="comment">! local test level</span></div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;<span class="keywordtype">real</span> k2a,k2m      <span class="comment">! angle (radians) and magnitude of wave number k2</span></div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;<span class="keywordtype">real</span> k4a,k4m      <span class="comment">! angle (radians) and magnitude of wave number k2</span></div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;<span class="keywordtype">real</span> dk           <span class="comment">! difference between two wave numbers</span></div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;<span class="keywordtype">real</span> xtest        <span class="comment">! test value for checking computation of weights, by inversion test</span></div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;<span class="keywordtype">real</span> ff,gg        <span class="comment">! variables in transformation of log-spacing to linear spacing</span></div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;<span class="comment">! functions used</span></div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;<span class="comment">!!real x_kfunc      ! function to invert computation of wieghts</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_weight&#39;</span>)</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;<span class="comment">! initialisations</span></div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;itest = iq_test        <span class="comment">! set local test level</span></div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;itest = itest</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;<span class="keywordflow">do</span> iloc=1,nlocus</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;  k2m = k2m_mod(iloc)</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;  k2a = k2a_mod(iloc)</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;  k4m = k4m_mod(iloc)</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;  k4a = k4a_mod(iloc)</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;  wt_k2(iloc) = 0.</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;  wt_k4(iloc) = 0.</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;<span class="comment">! compute directional weights</span></div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;  wa_k2(iloc) = (k2a-q_ang1)/q_deltad+1</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;  wa_k4(iloc) = (k4a-q_ang1)/q_deltad+1</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;<span class="comment">!  compute position of k2 in wave number grid</span></div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;<span class="comment">!  and compute weight function</span></div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;  <span class="keywordflow">if</span>(iq_disp==1.and. iq_geom==1) <span class="keywordflow">then</span>    <span class="comment">! deep water is assumed and loci have geometric scaling</span></div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;    wk_k2(iloc) = 1.+alog(k2m/kqmin)/alog(q_kfac)</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;    wt_k2(iloc) = 1.</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;    wk_k4(iloc) = 1.+alog(k4m/kqmin)/alog(q_kfac)</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;    wt_k4(iloc) = 1.</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;<span class="comment">!  Replace log-spacing by linear spacing</span></div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;    ff = wk_k2(iloc)</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;    gg = floor(ff)</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;    wk_k2(iloc) = gg+(q_kfac**(ff-gg)-1.)/(q_kfac-1.)</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;<span class="comment">!!/T    if(iq_test&gt;=3) write(luq_tst,&#39;(a,4f10.5)&#39;) &#39;Q_WEIGHT: wlog gg wlin2:&#39;, &amp;</span></div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;<span class="comment">!!/T &amp;  ff,gg,wk_k2(iloc),abs(wk_k2(iloc)-ff)/abs(ff)*100.</span></div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;    ff = wk_k4(iloc)</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;    gg = floor(ff)</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;    wk_k4(iloc) = gg+(q_kfac**(ff-gg)-1.)/(q_kfac-1.)</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;<span class="comment">!!/T    if(iq_test&gt;=3) write(luq_tst,&#39;(a,4f10.5)&#39;) &#39;Q_WEIGHT: wlog gg wlin4:&#39;, &amp;</span></div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;<span class="comment">!!/T    ff,gg,wk_k4(iloc),abs(wk_k4(iloc)-ff)/abs(ff)*100.</span></div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;<span class="comment">!  for finite depth a search is carried out to compute</span></div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;<span class="comment">!  the position of the interacting wave number in the</span></div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;<span class="comment">!  non-geometric k-grid</span></div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;    jpos = 1</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (k2m &gt; q_k(jpos))</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;      jpos = jpos + 1</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;      <span class="keywordflow">if</span>(jpos &gt; nkq) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;    <span class="keywordflow">if</span>(k2m &lt;= q_k(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;      wk_k2(iloc) = k2m/q_k(1)</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;      wt_k2(iloc) = 0.</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;    <span class="keywordflow">elseif</span>(k2m &lt; q_k(nkq) .and. k2m &gt; q_k(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;      dk          = q_k(jpos)-q_k(jpos-1)</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;      wk_k2(iloc) = real(jpos-1) + (k2m-q_k(jpos-1))/dk</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;      wt_k2(iloc) = 1.</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;    <span class="keywordflow">elseif</span>(k2m &gt;= q_k(nkq)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;      wk_k2(iloc) = min(wk_max,real(nkq) + (k2m-q_k(nkq))/q_sk(nkq))</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;      wt_k2(iloc) = (k2m/q_k(nkq))**(qk_tail-1.)</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;<span class="comment">! minus 1 to account for Jacobian from kx,ky to polar k-grid</span></div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;<span class="comment">!  compute position of k4 in wave number grid</span></div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;<span class="comment">!  and compute weight function</span></div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;    jpos = 1</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;    <span class="keywordflow">do</span> <span class="keywordflow">while</span> (k4m &gt; q_k(jpos))</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;      jpos = jpos + 1</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;      <span class="keywordflow">if</span>(jpos &gt; nkq) <span class="keywordflow">exit</span></div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;    <span class="keywordflow">if</span>(k4m &lt;= q_k(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;      wk_k4(iloc) = k4m/q_k(1)</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;      wt_k4(iloc) = 0.</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;    <span class="keywordflow">elseif</span>(k4m &lt; q_k(nkq) .and. k4m &gt; q_k(1)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;      dk   = q_k(jpos)-q_k(jpos-1)</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;      wk_k4(iloc) = real(jpos-1) + (k4m-q_k(jpos-1))/dk</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;      wt_k4(iloc) = 1.</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;    <span class="keywordflow">elseif</span>(k4m &gt;= q_k(nkq)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;      wk_k4(iloc) = min(wk_max,real(nkq) + (k4m-q_k(nkq))/q_sk(nkq))</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;      wt_k4(iloc) = (k4m/q_k(nkq))**(qk_tail-1.)</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_weight&#39;</span>)</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">iq_geom</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00305">k2a_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00304">k2m_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00307">k4a_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00306">k4m_mod</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00222">kqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00219">nlocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00389">q_ang1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00391">q_deltad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">q_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00394">q_kfac</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00345">q_sk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00396">qk_tail</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00313">wa_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00314">wa_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00311">wk_k2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00312">wk_k4</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00224">wk_max</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00315">wt_k2</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00316">wt_k4</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="ad49a87dce1650e20728b0f0e97057b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad49a87dce1650e20728b0f0e97057b2e">&#9670;&nbsp;</a></span>q_xnl4v4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::q_xnl4v4 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nsig,nang), intent(in)&#160;</td>
          <td class="paramname"><em>aspec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nang), intent(in)&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig,nang), intent(out)&#160;</td>
          <td class="paramname"><em>xnl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig,nang), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute nonlinear transfer for a given action density spectrum on a given wave number and direction grid. </p>
<p>Compute nonlinear transfer in a surface gravity wave spectrum due to resonant four wave-wave interactions.</p>
<p>Methods: Webb/Resio/Tracy/VanVledder.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aspec</td><td>Action density spectrum as a function of (sigma,theta). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>Radian frequencies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>Directions in radians (sector or full circle). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsig</td><td>Number of radian frequencies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nang</td><td>Number of directions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>Water depth in m. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xnl</td><td>Nonlinear quadruplet interaction computed with a certain exact method (k,theta). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diag</td><td>Diagonal term for WAM based implicit integration scheme. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error indicator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>25-Jun-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">6373</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;<span class="comment">!   |   | +---+  Last update: 25 June 2003</span></div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="comment">!     08/01/2000 Initial version</span></div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;<span class="comment">!     12/01/2001 Updated interface</span></div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;<span class="comment">!     13/01/2001 Inclusion of diagonal term</span></div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;<span class="comment">!     14/02/2002 Upgrade to release 4.0, depth added to input</span></div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;<span class="comment">!     20/08/2002 quad depth adapted in the case of WAM-depth scaling</span></div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;<span class="comment">!                then deep water is assumed for conversion of A(sig,theta) -&gt; N(kx,ky)</span></div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;<span class="comment">!                Search option for nearest grid included</span></div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;<span class="comment">!     23/08/2002 Allocation of work arrays set to fixed size</span></div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;<span class="comment">!     11/09/2002 Filtering of energy densities introduced and restructure</span></div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;<span class="comment">!     14/04/2003 Format of test write statement corrected</span></div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;<span class="comment">!     03/05/2003 Computation and output of triplets enabled</span></div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;<span class="comment">!     12/06/2003 Export spectral grid in case of Q_INTEG&gt;1</span></div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;<span class="comment">!     16/06/2003 Switch IQ_SYM included</span></div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;<span class="comment">!                Allocation of dynamic data array&#39;s moved to Q_ALLOCATE</span></div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;<span class="comment">!     24/06/2003 Range of loop for IK3 made dependent on value of IQ_SYM</span></div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;<span class="comment">!     25/06/2003 Bug fixed in assigment of contribution of diagonal term</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;<span class="comment">!     Compute nonlinear transfer for a given action density spectrum</span></div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;<span class="comment">!     on a given wave number and direction grid</span></div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;<span class="comment">!     Compute nonlinear transfer in a surface gravity wave spectrum</span></div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;<span class="comment">!     due to resonant four wave-wave interactions</span></div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;<span class="comment">!     Methods: Webb/Resio/Tracy/VanVledder</span></div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;<span class="comment">! Type    I/O          Name               Description</span></div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span>  :: nsig             <span class="comment">! number of radian frequencies</span></div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span>  :: nang             <span class="comment">! number of directions</span></div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: aspec(nsig,nang) <span class="comment">! Action density spectrum as a function of (sigma,theta)</span></div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: sigma(nsig)      <span class="comment">! radian frequencies</span></div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: angle(nang)      <span class="comment">! directions in radians (sector or full circle)</span></div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: depth            <span class="comment">! water depth in m</span></div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(out)</span> :: xnl(nsig,nang)   <span class="comment">! nonlinear quadruplet interaction computed with</span></div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;<span class="comment">!                                         a certain exact method (k,theta)</span></div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(out)</span> :: diag(nsig,nang)  <span class="comment">! Diagonal term for WAM based implicit integration scheme</span></div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: ierr          <span class="comment">! error indicator</span></div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;<span class="comment">!     XNL_MAIN</span></div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;<span class="comment">!     Q_STACK</span></div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;<span class="comment">!     Q_INIT</span></div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;<span class="comment">!     Q_CTRGRID</span></div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;<span class="comment">!     Q_T13V4</span></div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;<span class="comment">!     Q_SEARCHGRID</span></div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;<span class="comment">!     The external action density spectrum is given as N(sigma,dir)</span></div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;<span class="comment">!     The internal action density spectrum is given as N(kx,ky)</span></div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;<span class="comment">!     These 2 spectra are conected via the Jacobian transformation</span></div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;<span class="comment">!                cg</span></div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;<span class="comment">!     N(kx,ky) = -- N(sig,theta)</span></div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;<span class="comment">!                 k</span></div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;<span class="comment">! local variables</span></div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;<span class="keywordtype">integer</span> iaq      <span class="comment">! counter for directions</span></div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;<span class="keywordtype">integer</span> jaq      <span class="comment">! counter for directions</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;<span class="keywordtype">integer</span> ikq      <span class="comment">! counter for wave numbers</span></div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;<span class="keywordtype">integer</span> iang     <span class="comment">! counter for directions</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;<span class="keywordtype">integer</span> ia       <span class="comment">! counter for directions</span></div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;<span class="keywordtype">integer</span> ik       <span class="comment">! counter for wave numbers</span></div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;<span class="keywordtype">integer</span> idir1    <span class="comment">! direction in degrees of k1 (for integration test)</span></div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;<span class="keywordtype">integer</span> idir3    <span class="comment">! direction in degrees of k3 (for integration test)</span></div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;<span class="keywordtype">real</span> period      <span class="comment">! periodicity for direction, used in conversion of 2-spectra</span></div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;<span class="keywordtype">real</span> diagk1      <span class="comment">! diagonal term for k1</span></div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;<span class="keywordtype">real</span> diagk3      <span class="comment">! diagonal term for k3</span></div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;<span class="keywordtype">real</span> qn_max      <span class="comment">! maximum action density</span></div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;<span class="keywordtype">real</span> qn_min      <span class="comment">! minimum action density</span></div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;<span class="keywordtype">real</span> cg(nsig)         <span class="comment">! group velocity for conversion of spectrum and transfer</span></div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;<span class="keywordtype">integer</span> ia1,ia3,ja3   <span class="comment">! limits for directional loops</span></div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;<span class="keywordtype">integer</span> jk3           <span class="comment">! start of k3 loop</span></div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;<span class="keywordtype">integer</span> ik1,ik3       <span class="comment">! counters for wave number loop</span></div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;<span class="keywordtype">integer</span> nloc          <span class="comment">! number of points on locus</span></div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;<span class="keywordtype">integer</span> igrid         <span class="comment">! status of grid file</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;<span class="keywordtype">real</span> t13              <span class="comment">! value of sub-integral</span></div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;<span class="keywordtype">real</span> k_rat            <span class="comment">! local ratio of wave numbers</span></div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;<span class="keywordtype">real</span> a_dif            <span class="comment">! directional difference</span></div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;<span class="keywordtype">real</span> jacobian         <span class="comment">! Jacobian</span></div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;<span class="keywordtype">real</span> qn1,qn3          <span class="comment">! action densities in k1 and k3</span></div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;<span class="comment">!  testing of diagonal term on a low level</span></div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;<span class="keywordtype">real</span> diagk1_0         <span class="comment">! saved value of diagk1</span></div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;<span class="keywordtype">real</span> diagk3_0         <span class="comment">! saved value of diagk3</span></div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="keywordtype">real</span> dq1              <span class="comment">! small change in action density of n1</span></div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;<span class="keywordtype">real</span> dq3              <span class="comment">! small change in action density of n3</span></div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;<span class="keywordtype">real</span> t13_0            <span class="comment">! Original estimated of diagonal term</span></div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;<span class="keywordtype">real</span> t13_1,t13_3      <span class="comment">! perturbed estimated of diagonal term</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;<span class="keywordtype">integer</span> ifil_dir      <span class="comment">! indicator for filtering of directional criterion</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;<span class="keywordtype">integer</span> ifil_krat     <span class="comment">! indicator for filtering of wave number ratio criterion</span></div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;<span class="keywordtype">integer</span> ifil_dens     <span class="comment">! indicator for filtering of action density criterion</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;<span class="keywordtype">integer</span> ifil_tot      <span class="comment">! indicator for filtering due to any criterion</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;<span class="keywordtype">integer</span> nfil_dir      <span class="comment">! counter to indicate filtering of directional criterion</span></div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;<span class="keywordtype">integer</span> nfil_krat     <span class="comment">! counter to indicate filtering of wave number criterion</span></div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;<span class="keywordtype">integer</span> nfil_dens     <span class="comment">! counter to indicate filtering of action density criterion</span></div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;<span class="keywordtype">integer</span> ntot_conf     <span class="comment">! total number of configurations</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;<span class="keywordtype">integer</span> ntot_filt     <span class="comment">! total number of filtered configurations</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+q_xnl4v4&#39;</span>)</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;<span class="comment">! initialisations</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;ierr = 0              <span class="comment">! error status</span></div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;<a class="code" href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">diag</a> = 0                <span class="comment">! initialize output diagonal term</span></div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;<span class="keywordflow">if</span>(iq_type==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;  q_depth = depth         <span class="comment">! water depth to be used in computation</span></div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;  q_depth = q_maxdepth</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;<span class="comment">!--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;<span class="comment">!  generate basic grid of loci and store loci in memory and to datafile</span></div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;<span class="comment">!--------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;<span class="keywordflow">if</span>(iq_screen &gt;= 1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_XNL4V4: Checking interaction grid &#39;</span></div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;<span class="keywordflow">if</span>(iq_search==0 .or. iq_type/=3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;  <span class="keyword">call </span>q_init</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;  <span class="keyword">call </span>q_ctrgrid(2,igrid)</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;  <span class="keywordflow">if</span>(iq_err /= 0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;  <span class="keywordflow">if</span>(igrid/=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;NOGRID&#39;</span>,<span class="stringliteral">&#39;No proper grid exists&#39;</span>)</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;  <span class="keywordflow">if</span>(iq_make ==3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;MAKEGRID&#39;</span>,<span class="stringliteral">&#39;Only computation of grid&#39;</span>)</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;<span class="comment">!  set overall scale factor resulting from optional SEARCH for nearest grid</span></div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;  q_scale = 1.</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;<span class="comment">!------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;<span class="comment">!  search nearest valid grid and compute additional WAM scale factor</span></div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;<span class="comment">!  only active when IQ_SEARCH==1 .AND. IQ_TYPE==3</span></div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;  <span class="keyword">call </span>q_searchgrid(depth,igrid)</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160; </div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160; </div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;  <span class="keywordflow">if</span>(igrid/=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;NOGRID&#39;</span>,<span class="stringliteral">&#39;No proper grid exists&#39;</span>)</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;  <span class="keywordflow">if</span>(iq_err /=0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;<span class="comment">!  convert input action density spectrum from A(sigma,theta) -&gt; N(kx,ky)</span></div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;<span class="keywordflow">do</span> ikq=1,nkq</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;  <span class="keyword">call </span><a class="code" href="namespaceserv__xnl4v5.html#ac0005154c8695dc5033a829bfb1b3efe">z_cmpcg</a>(sigma(ikq),q_depth,q_grav,<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(ikq))</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;  <span class="keywordflow">do</span> iaq=1,naq</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;    nspec(ikq,iaq) = aspec(ikq,iaq)/q_k(ikq)*<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(ikq)</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;<span class="comment">!--------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;<span class="comment">!  integration over all possible configurations</span></div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;<span class="comment">!--------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;xnl = 0.</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;qn_max = maxval(nspec)</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;<span class="comment">!--------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;<span class="keywordflow">do</span> ik1 = 1,nkq</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;  <span class="keywordflow">if</span>(iq_screen &gt;= 1) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a,2i4,e12.3)&#39;</span>) <span class="stringliteral">&#39;Q_XNL4V4: k1 nk d:&#39;</span>,ik1,nkq,q_depth</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;  jk3 = ik1</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;  <span class="keywordflow">if</span>(iq_sym==0) jk3 = 1</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;  <span class="keywordflow">do</span> ia1 = iaq1,iaq2          <span class="comment">! loop over selected part of grid, set in q_init</span></div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;    qn1 = nspec(ik1,ia1)</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;    <span class="keywordflow">do</span> ik3 = jk3,nkq           <span class="comment">! compute only half-plane</span></div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;      <span class="keywordflow">do</span> ia3 = 1,naq           <span class="comment">! loop over all possible wave directions</span></div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;        qn3 = nspec(ik3,ia3)</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;        <span class="keywordflow">if</span>(iq_screen&gt;=3) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a,4i4)&#39;</span>) <span class="stringliteral">&#39;Q_XNL4V4: ik1 ia1 ik3 ia3:&#39;</span>,ik1,ia1,ik3,ia3</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;<span class="comment">!  computes distances in wave number space</span></div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;        a_dif = 180. - abs(180. - abs(q_ad(ia1) - q_ad(ia3)))</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;        k_rat = max(q_k(ik1)/q_k(ik3), q_k(ik3)/q_k(ik1))</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;        qn_min = qf_frac*qn_max/(q_k(ik3)/q_k(1))**7.5</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;        qn_min = qf_frac*qn_max*q_kpow(ik3)</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;        ifil_dir  = 0</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;        ifil_krat = 0</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;        ifil_dens = 0</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;        ifil_tot  = 0</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;<span class="comment">!  perform filtering</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;<span class="comment">!  directional difference</span></div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;        <span class="keywordflow">if</span>(a_dif &gt; qf_dmax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;          ifil_dir = 1</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;<span class="comment">!  wave number ratio</span></div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;        <span class="keywordflow">if</span>(k_rat &gt; qf_krat) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;          ifil_krat = 1</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;<span class="comment">!  energy density filtering</span></div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;        <span class="keywordflow">if</span>(qn1 &lt; qn_min .and. qn3 &lt; qn_min) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;          ifil_dens = 1</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;        <span class="keywordflow">if</span>(ifil_dir==0 .and. ifil_krat==0 .and. ifil_dens==0 .or. iq_filt==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;<span class="comment">!?        if(a_dif &lt; qf_dmax .and. k_rat &lt; qf_krat .or. iq_filt==0) then</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;<span class="comment">!  perform integration along locus</span></div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;          <span class="keyword">call </span>q_t13v4(ik1,ia1,ik3,ia3,t13,diagk1,diagk3)</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;          <span class="keywordflow">if</span>(iq_err /= 0) <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;<span class="comment">!  check contribution T13 with the computed with triplet method</span></div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;<span class="comment">!!/R           qt13 = 0.</span></div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;<span class="comment">!!/R           do iqtr = 1,ktriplets</span></div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;<span class="comment">!!/R             qt13 = qt13 + w_qtr(iqtr)*nspec(i_qtr(iqtr,1),i_qtr(iqtr,2))* &amp;</span></div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;<span class="comment">!!/R &amp;                   nspec(i_qtr(iqtr,3),i_qtr(iqtr,4))*nspec(i_qtr(iqtr,5),i_qtr(iqtr,6))</span></div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;<span class="comment">!!/R           end do</span></div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;<span class="comment">!!/R           write(iscreen,*) &#39;CHECK T13 QT13:&#39;,t13,qt13</span></div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;<span class="comment">!  take care of additional scale factor aring from search of nearest grid</span></div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;          t13    = t13*q_scale</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;          diagk1 = diagk1*q_scale</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;          diagk3 = diagk3*q_scale</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;<span class="comment">!  take care of symmetric storing of interactions</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;<span class="comment">!  and factor 2 due to symmetry (if activated)</span></div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;          <span class="keywordflow">if</span>(iq_sym==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;            t13 = 2.*t13</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;            diagk1 = 2.*diagk1</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;            diagk3 = 2.*diagk3</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;          ja3 = ia3</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;          <span class="keywordflow">if</span>(iq_grid==1 .and. ia3 &lt; iaref) ja3 = naq-ia1+1</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;          xnl(ik1,ia1)  = xnl(ik1,ia1) + t13*q_k(ik3)*q_delta*q_dk(ik3)</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;          <span class="keywordflow">if</span>(iq_sym==1) xnl(ik3,ja3)  = xnl(ik3,ja3) - t13*q_k(ik1)*q_delta*q_dk(ik1)</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;<span class="comment">!  add diagonal term</span></div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;          <a class="code" href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">diag</a>(ik1,ia1) = <a class="code" href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">diag</a>(ik1,ia1) + diagk1*q_k(ik3)*q_delta*q_dk(ik3)</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;          <span class="keywordflow">if</span>(iq_sym==1) <a class="code" href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">diag</a>(ik3,ia3) = <a class="code" href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">diag</a>(ik3,ia3) - diagk3*q_k(ik1)*q_delta*q_dk(ik1)</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;<span class="comment">!!/F         write(luq_fil,&#39;(a,4i3,3e11.3,2f7.2,4i2)&#39;) &amp;</span></div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;<span class="comment">!!/F &amp;      &#39;ik1 ia1 ik3 ia3 n1 n3 t13 adif krat fil1/2/3:&#39;, &amp;</span></div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;<span class="comment">!!/F &amp;       ik1,ia1,ik3,ia3,qn1,qn3,t13,a_dif,k_rat,&amp;</span></div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;<span class="comment">!!/F &amp;       ifil_dir,ifil_krat,ifil_dens,ifil_tot</span></div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;<span class="comment">! write number of triplets that have been written</span></div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;<span class="comment">! in the case of a symmetric sector, copy results to other part</span></div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;<span class="comment">! Examples: naq=5, iaref=3: 1,2,3,4,5 -&gt;   Q(1)=Q(5)</span></div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;<span class="comment">!                                          Q(2)=Q(4)</span></div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="comment">!                                          Q(3)=Q(3)</span></div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;<span class="comment">!                                                     iaq+jaq=naq+1</span></div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;<span class="comment">!           naq=6, iaref=4: 1,2,3,4,5,6 -&gt; Q(1)=Q(6)</span></div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;<span class="comment">!                                          Q(2)=Q(5)</span></div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;<span class="comment">!                                          Q(3)=Q(4)</span></div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;<span class="keywordflow">if</span>(iq_grid==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;  <span class="keywordflow">do</span> ikq = 1,nkq</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;    <span class="keywordflow">do</span> iaq=iaref,naq</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;      jaq = naq+1-iaq</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;      xnl(ikq,jaq) = xnl(ikq,iaq)</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;<span class="keywordflow">if</span>(iq_screen&gt;=2) <span class="keyword">write</span>(iscreen,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Q_XNL4V4: Main computation ended&#39;</span></div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;<span class="comment">!  Convert transfer from (kx,ky) grid to (sigma,theta) grid</span></div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;<span class="keywordflow">do</span> ikq=1,nkq</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;  jacobian = q_k(ikq)/<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(ikq)</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;  <span class="keywordflow">do</span> iaq=1,naq</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;    xnl(ikq,iaq) = xnl(ikq,iaq)*jacobian</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;<span class="comment">!                                                   !</span></div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-q_xnl4v4&#39;</span>)</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">iaq1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">iaq2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00385">iaref</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00099">iq_filt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00140">iq_make</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00153">iq_search</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00161">iq_sym</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00414">iq_type</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00359">nspec</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">q_ad</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00390">q_delta</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00349">q_dk</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">q_k</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00350">q_kpow</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00366">q_maxdepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00369">q_scale</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00073">qf_dmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00074">qf_frac</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00072">qf_krat</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00046">serv_xnl4v5::z_cmpcg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ae5db0ad5a1fc354fc0d9cdb8ce2f2d">&#9670;&nbsp;</a></span>tanz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::tanz </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>N/A. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>tanz</dd></dl>
<dl class="section author"><dt>Author</dt><dd>N/A </dd></dl>
<dl class="section date"><dt>Date</dt><dd>N/A </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07809">7809</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;<span class="keywordtype">      real</span> x</div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;<span class="comment">!      print *,&#39;inside tanz &#39;</span></div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;      <span class="keywordflow">if</span> (x.gt.20.) x=25.</div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;      tanz=tanh(x)</div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;<span class="comment">!      print *,&#39;after def of tanz&#39;</span></div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;      <span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>.</p>

</div>
</div>
<a id="a654fb0a4a323900296af94bd7af057fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654fb0a4a323900296af94bd7af057fd">&#9670;&nbsp;</a></span>x_cosk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_cosk </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute cosine of points on locus for given wave number k. </p>
<p>Explicit polar method, see Van Vledder 2000, Monterey paper. Optionally using a fixed k-step, geometric k-step or adaptive stepping.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Wave number along symmetry axis of locus. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_cosk</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">6753</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;<span class="comment">!   |   | +---+  Last update: 13 Aug. 2002</span></div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceserv__xnl4v5.html#a27c4512ce2548f874dc79799d81e0e47">z_wnumb</a></div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;<span class="comment">!     Date        Description</span></div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;<span class="comment">!     13/08/2002  Initial version</span></div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;<span class="comment">!     Compute cosine of points on locus for given wave number k</span></div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;<span class="comment">!     Explicit polar method, see Van Vledder 2000, Monterey paper</span></div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;<span class="comment">!     Optionally using a fixed k-step, geometric k-step or adaptive stepping</span></div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;<span class="comment">!  3. Parameters used:</span></div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: k  <span class="comment">! wave number along symmetry axis of locus</span></div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;<span class="comment">!     Q_POLAR</span></div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;<span class="comment">!  6. Subroutines used:</span></div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;<span class="comment">!     Z_WNUMB   computation of wave number</span></div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;<span class="comment">!     The variables q, pmag and q_depth are accessed from module m_xnldata</span></div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;<span class="comment">!     The variable q_grav is accessed from module m_constants</span></div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;<span class="keywordtype">real</span> qq    <span class="comment">! constant in direct polar method qq=q/sqrt(g)</span></div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;<span class="keywordtype">real</span> wk    <span class="comment">! intemediate radian frequency</span></div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;<span class="keywordtype">real</span> kz    <span class="comment">! intermediate wave number</span></div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;<span class="keywordflow">select case</span>(iq_disp)</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;<span class="keywordflow">case</span>(1)   <span class="comment">! deep water</span></div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;  qq = q/sqrt(q_grav)</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;  x_cosk = ((qq+sqrt(k))**4 - k**2 - pmag**2)/(2.*k*pmag)</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;<span class="keywordflow">case</span>(2)   <span class="comment">!  finite depth</span></div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;  wk = q + x_disper(k,q_depth)</div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;  kz = <a class="code" href="namespaceserv__xnl4v5.html#a27c4512ce2548f874dc79799d81e0e47">z_wnumb</a>(wk,q_depth,q_grav)</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;  x_cosk = (kz**2-k**2 - pmag**2)/(2.*k*pmag)</div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;<span class="keywordflow">end select</span></div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;x_cosk = max(-1.,x_cosk)</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;x_cosk = min( 1.,x_cosk)</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;<span class="comment">!</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00233">pmag</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>, and <a class="el" href="serv__xnl4v5_8f90_source.html#l00680">serv_xnl4v5::z_wnumb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="aa1dc4bf29edc9de63dd9305afa474b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1dc4bf29edc9de63dd9305afa474b20">&#9670;&nbsp;</a></span>x_cple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_cple </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k4x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k4y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iq_cple</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>grav</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute coupling coefficient between a quadruplet of interacting wave numbers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k1x</td><td>X-component of wave number k1. </td></tr>
    <tr><td class="paramname">k1y</td><td>Y-component of wave number k1. </td></tr>
    <tr><td class="paramname">k2x</td><td>X-component of wave number k2. </td></tr>
    <tr><td class="paramname">k2y</td><td>Y-component of wave number k2. </td></tr>
    <tr><td class="paramname">k3x</td><td>X-component of wave number k3. </td></tr>
    <tr><td class="paramname">k3y</td><td>Y-component of wave number k3. </td></tr>
    <tr><td class="paramname">k4x</td><td>X-component of wave number k4. </td></tr>
    <tr><td class="paramname">k4y</td><td>Y-component of wave number k4. </td></tr>
    <tr><td class="paramname">iq_cple</td><td>Type of coupling coefficient. </td></tr>
    <tr><td class="paramname">depth</td><td>Water depth in meters. </td></tr>
    <tr><td class="paramname">grav</td><td>Gravitational acceleration. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_cple <br  />
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>10-Sep-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">6855</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;<span class="comment">!   |   | +---+  Last update: 10 Sept. 2002</span></div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;<span class="comment">!     25/02/1999  Initial version</span></div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;<span class="comment">!     25/10/1999  Names of some variables modified</span></div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;<span class="comment">!                 type and depth via interface</span></div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;<span class="comment">!     09/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;<span class="comment">!     10/09/2002  g included in interface</span></div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;<span class="comment">!     Compute coupling coefficient between a quadruplet of</span></div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;<span class="comment">!     interacting wave numbers</span></div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;<span class="comment">!     Name    I/O  Type  Description</span></div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;<span class="comment">!Type    I/O              Name      Description</span></div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k1x     <span class="comment">!  x-component of wave number k1</span></div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k1y     <span class="comment">!  y-component of wave number k1</span></div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k2x     <span class="comment">!  x-component of wave number k2</span></div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k2y     <span class="comment">!  y-component of wave number k2</span></div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k3x     <span class="comment">!  x-component of wave number k3</span></div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k3y     <span class="comment">!  y-component of wave number k3</span></div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k4x     <span class="comment">!  x-component of wave number k4</span></div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       k4y     <span class="comment">!  y-component of wave number k4</span></div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> ::    iq_cple <span class="comment">!  Type of coupling coefficient</span></div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       depth   <span class="comment">!  Water depth in meters</span></div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::       grav    <span class="comment">!  Gravitational acceleration</span></div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;<span class="comment">!     Q_CMPLOCUS</span></div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;<span class="comment">!     X_WEBB</span></div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;<span class="comment">!     X_HH</span></div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;<span class="comment">!                        ! real functions to compute coupling coefficient</span></div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;<span class="comment">!!real xc_webb             ! Webb, deep water</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;<span class="comment">!!real xc_hh               ! Herterich and Hasselmann, finite depth</span></div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;<span class="keywordflow">if</span> (iq_cple &lt; 1 .or. iq_cple &gt; 4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;  x_cple = 0.</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;<span class="keywordflow">select case</span>(iq_cple)</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;<span class="comment">!  1) Deep water coupling coefficient of Webb</span></div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;<span class="keywordflow">case</span>(1)</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;  x_cple = xc_webb(k1x,k1y,k2x,k2y,k3x,k3y,k4x,k4y,<a class="code" href="namespacem__constants.html#aa591a9f7dab0aa8ab034b2b539cb2465">grav</a>)</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;<span class="comment">!  2) finite depth coupling coefficient of Herterich and Hasselmann</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;<span class="comment">!     as implemented in the Resio-Tracy program SB5</span></div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;<span class="keywordflow">case</span>(2)</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;  x_cple = xc_hh(k4x,k4y,k3x,k3y,k2x,k2y,k1x,k1y,depth)</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;<span class="comment">! x_cple = xc_hh2(k1x,k1y,k2x,k2y,k3x,k3y,depth,grav)</span></div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;<span class="keywordflow">end select</span></div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">iq_cple</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="aef1fac66b5fff77cec64e90162e00f6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef1fac66b5fff77cec64e90162e00f6a">&#9670;&nbsp;</a></span>x_disper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_disper </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute radian frequency for a given wave number and water depth. </p>
<pre class="fragment">  Depending on the value of the parameter iq_disp the radian
  wave number is computed as:
    1) deep water
    2) finite depth linear dispersion relation
    3) finited depth non-linear dispersion relation (NOT YET implemented)</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Wave number. </td></tr>
    <tr><td class="paramname">d</td><td>Water depth in m. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_disper</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">7191</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 Aug. 2002</span></div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;<span class="comment">!     16/02/1999  Initial version</span></div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;<span class="comment">!     25/02/1999  Short cut if kd &gt; 10</span></div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;<span class="comment">!     09/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;<span class="comment">!     Compute radian frequency for a given wave number and water depth</span></div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;<span class="comment">!     Depending on the value of the parameter iq_disp the radian</span></div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;<span class="comment">!     wave number is computed as:</span></div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;<span class="comment">!     1) deep water</span></div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;<span class="comment">!     2) finite depth linear dispersion relation</span></div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;<span class="comment">!     3) finited depth non-linear dispersion relation (NOT YET implemented)</span></div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;<span class="comment">! Type    I/O          Name       Description</span></div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;<span class="comment">!----------------------------------------------------------------------</span></div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>   ::   k   <span class="comment">!   wave number</span></div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>   ::   d   <span class="comment">!   water depth in m</span></div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;<span class="comment">!     if iq_type not valid, then q_disper = -1</span></div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;<span class="comment">!     Q_CHKRES</span></div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;<span class="comment">!     Type of dispersion relation is determined by the parameter IQ_DISP:</span></div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;<span class="comment">!     IQ_DISP==1  deep water linear disperion relation is used</span></div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;<span class="comment">!              2  finite depth linear dispersion relation is used</span></div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;<span class="keywordtype">integer</span> id   <span class="comment">! copy of iq_type</span></div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;<span class="keywordtype">real</span> kd      <span class="comment">! k*d</span></div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;kd = k * d</div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;id = iq_disp</div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;<span class="keywordflow">if</span> (kd &gt; 20.) id = 1</div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;<span class="keywordflow">select case</span>(id)</div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;  <span class="keywordflow">case</span> (1)                           <span class="comment">! deep water w^2=g k</span></div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;    x_disper = sqrt(q_grav*k)</div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;  <span class="keywordflow">case</span> (2)                           <span class="comment">! finite depth w^2 = g k tanh(k d)</span></div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;    x_disper = sqrt(q_grav*k*tanh(k*d))</div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;<span class="keywordflow">  case default</span></div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;    x_disper = -1.</div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;<span class="keywordflow">end select</span></div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01574">q_chkres()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">x_locus1()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="aca7ec991e56d49470958f6c9328f032f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7ec991e56d49470958f6c9328f032f">&#9670;&nbsp;</a></span>x_flocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_flocus </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>kxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>kyy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute locus function used for the determination of the resonance condition. </p>
<p>Explicit function evaluation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kxx</td><td>X-component of wave number. </td></tr>
    <tr><td class="paramname">kyy</td><td>Y-component of wave number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_flocus <br  />
</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">6965</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 Aug. 2002</span></div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;<span class="comment">!     25/02/1999 Initial version</span></div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;<span class="comment">!     20/07/1999 Bug fixed when IDISP=2</span></div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;<span class="comment">!     09/10/1999 Values of w2 and w4 in double precision</span></div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;<span class="comment">!                to improve accuracy of computation of z</span></div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;<span class="comment">!     09/08/2002 Upgrade to release 4.0</span></div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;<span class="comment">!     Compute locus function used for the determination of the</span></div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;<span class="comment">!     resonance condition</span></div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;<span class="comment">!     Explicit function evaluation</span></div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;<span class="comment">!Type    I/O         Name       Description</span></div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;<span class="comment">!-----------------------------------------------------------</span></div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  kxx      <span class="comment">!  x-component of wave number</span></div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  kyy      <span class="comment">!  y-component of wave number</span></div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;<span class="comment">!     Q_LOCPOS</span></div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;<span class="comment">!     X_DISPER</span></div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;<span class="comment">!     if iq_disp not valid, then q_disper = -1</span></div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;<span class="comment">!-------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;<span class="keywordtype">real</span> z               <span class="comment">! diferrence</span></div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;<span class="keywordtype">real</span> k2m,k4m         <span class="comment">! wave number magnitudes</span></div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;real(kind=8) w2,w4  <span class="comment">! radian frequencies</span></div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;<span class="comment">!!real x_disper</span></div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;<span class="comment">!call q_stack(&#39;+x_flocus&#39;)</span></div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;<span class="keywordflow">select case</span>(iq_disp)</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;  <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;    w2 = <a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a> * (kxx**2 + kyy**2)**(0.25)</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;    w4 = <a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a> * ((kxx+px)**2 + (kyy+py)**2)**(0.25)</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;    z = q + w2 - w4</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;  <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;    k2m = sqrt(kxx**2+kyy**2)</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;    k4m = sqrt((kxx+px)**2 + (kyy+py)**2)</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;    w2 = x_disper(k2m,q_depth)</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;    w4 = x_disper(k4m,q_depth)</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;    z  = q + w2 - w4</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;<span class="keywordflow">  case default</span></div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;    z = -1</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;<span class="keywordflow">  end select</span></div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;x_flocus = z</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;<span class="comment">!call q_stack(&#39;-x_flocus&#39;)</span></div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">px</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">py</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__constants_8f90_source.html#l00020">m_constants::sqrtg</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>.</p>

</div>
</div>
<a id="a5af8e1924217154416189d2cdd36b0e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af8e1924217154416189d2cdd36b0e5">&#9670;&nbsp;</a></span>x_jacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_jacobian </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>x4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>y4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute gradient/Jacobian term for a given point on the locus. </p>
<p>Explicit expressions for gradient term. Using expression of Rasmussen (1998). J = |cg2-cg4|.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x2</td><td>X-component of wave number k2. </td></tr>
    <tr><td class="paramname">y2</td><td>Y-component of wave number k2. </td></tr>
    <tr><td class="paramname">x4</td><td>X-component of wave number k4. </td></tr>
    <tr><td class="paramname">y4</td><td>Y-component of wave number k4. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_jacobian</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07073">7073</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 Aug. 2002</span></div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;<span class="comment">!% use serv_xnl4v5, only: z_cmpcg</span></div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;<span class="comment">!     25/02/1999 Initial version</span></div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;<span class="comment">!     12/10/1999 Overflow avoided by checking for argument k*d</span></div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;<span class="comment">!     29/10/1999 Bug fixed in computing finite depth gradient</span></div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;<span class="comment">!     27/12/1999 Factor SQRT(Grav) added</span></div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;<span class="comment">!     01/10/2001 Components of k4 wave number explicitly input</span></div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;<span class="comment">!                New version of function X_GRAD</span></div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;<span class="comment">!     09/08/2002 Computation of Jacobian replace by |cg2-cg4|</span></div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;<span class="comment">!                based on old routine X_GRAD2</span></div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;<span class="comment">!                Upgrade to release 4.0</span></div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;<span class="comment">!     Compute gradient/Jacobian term for a given point on the locus</span></div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;<span class="comment">!     Explicit expressions for gradient term</span></div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;<span class="comment">!     Using expression of Rasmussen (1998)</span></div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;<span class="comment">!     J = |cg2-cg4|</span></div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;<span class="comment">! Type    I/O        Name    Description</span></div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;<span class="comment">!--------------------------------------------------------------------</span></div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  x2   <span class="comment">!  x-component of wave number k2</span></div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  y2   <span class="comment">!  y-component of wave number k2</span></div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  x4   <span class="comment">!  x-component of wave number k4</span></div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  y4   <span class="comment">!  y-component of wave number k4</span></div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;<span class="comment">!     Q_CMPLOCUS</span></div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;<span class="comment">!  6. Subroutines used:</span></div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;<span class="comment">! local variables</span></div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;<span class="keywordtype">real</span> k2m,k4m    <span class="comment">! wave number magnitudes</span></div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;<span class="keywordtype">real</span> k2md,k4md  <span class="comment">! k*d values</span></div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;<span class="keywordtype">real</span> ang2,ang4  <span class="comment">! directions</span></div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;<span class="keywordtype">real</span> cg2,cg4    <span class="comment">! group velocities</span></div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;<span class="keywordtype">real</span> sig2,sig4  <span class="comment">! radian frequencies</span></div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;k2m = sqrt(x2**2 + y2**2)</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;k4m = sqrt(x4**2 + y4**2)</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;ang2 = atan2(x2,y2)</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;ang4 = atan2(x4,y4)</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;sig2 = sqrt(q_grav*k2m*tanh(k2m*q_depth))</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;sig4 = sqrt(q_grav*k4m*tanh(k4m*q_depth))</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;k2md = k2m*q_depth</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;k4md = k4m*q_depth</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;<span class="keywordflow">if</span>(k2md &gt; 20) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;  cg2 = 0.5*q_grav/sig2</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;  cg2 = sig2/k2m*(0.5+k2md/sinh(2*k2md))</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;<span class="keywordflow">if</span>(k4md &gt; 20) <span class="keywordflow">then</span></div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;  cg4 = 0.5*q_grav/sig4</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;  cg4 = sig4/k4m*(0.5+k4md/sinh(2*k4md))</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;x_jacobian = sqrt(cg2**2+cg4**2-2*cg2*cg4*cos(ang2-ang4))</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="ab11f2da0fc3eec799805be1f4e1add7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11f2da0fc3eec799805be1f4e1add7a">&#9670;&nbsp;</a></span>x_locus1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_locus1 </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute locus function along symmetry axis. </p>
<p>See ALKYON, 1999.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k2</td><td>Magnitude of wave number k2. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_locus1</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">7286</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 AUg. 2002</span></div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;<span class="comment">!     Date        Description</span></div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;<span class="comment">!     23/11/1999  Initial version</span></div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;<span class="comment">!      9/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;<span class="comment">!     Compute locus function along symmetry axis</span></div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;<span class="comment">!     See ALKYON, 1999</span></div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;<span class="comment">!Type   I/O         name    Description</span></div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;<span class="comment">!-------------------------------------------------------</span></div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> :: k2   <span class="comment">!  Magnitude of wave number k2</span></div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;<span class="comment">!     Q_LOCPOS</span></div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;<span class="comment">!     x_disper</span></div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;<span class="comment">!     The routine assumes that w1 &lt; w3 or q&lt;0</span></div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;<span class="comment">!     implying that the directions of k2 and P are opposite</span></div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;<span class="comment">!     Local variables</span></div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;<span class="keywordtype">real</span> k4       <span class="comment">! wave number magnitudes of k4</span></div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;<span class="keywordtype">real</span> w2,w4    <span class="comment">! radian frequencies of wave numbers k2 and k4</span></div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;<span class="keywordtype">real</span> z        <span class="comment">! function value</span></div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;<span class="comment">!!real x_disper</span></div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;<span class="keywordflow">select case</span>(iq_disp)</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;  <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;    w2 = <a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a> * sqrt(k2)</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;    w4 = <a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a> * sqrt(abs(-pmag+k2))</div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;    z  = q + w2 - w4</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;  <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;    k4 = abs(-pmag+k2)</div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;    w2 = x_disper(k2,q_depth)</div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;    w4 = x_disper(k4,q_depth)</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;    z  = q + w2 - w4</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;<span class="keywordflow">  case default</span></div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;    z = -1</div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;<span class="keywordflow">  end select</span></div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;x_locus1 = z</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00233">pmag</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__constants_8f90_source.html#l00020">m_constants::sqrtg</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>.</p>

</div>
</div>
<a id="ada00f656eb5b3155b94a1ff88440a7af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada00f656eb5b3155b94a1ff88440a7af">&#9670;&nbsp;</a></span>x_locus2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::x_locus2 </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>lambda</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute locus function perpendicluar to symmetry axis. </p>
<p>See ALKYON, 1999.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lambda</td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>x_locus2</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>9-Aug-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">7382</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;<span class="comment">!   |   | +---+  Last update: 9 Aug. 2002</span></div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;<span class="comment">!   +---+ |   |  Release: 4.0</span></div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;<span class="comment">!     Date        Description</span></div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;<span class="comment">!     23/11/1999  Initial version</span></div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;<span class="comment">!     09/08/2002  Upgrade to release 4.0</span></div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;<span class="comment">!     Compute locus function perpendicluar to symmetry axis</span></div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;<span class="comment">!     See ALKYON, 1999</span></div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;<span class="comment">!     Name    I/O  Type  Description</span></div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  lambda</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;<span class="comment">!     Q_LOCPOS</span></div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;<span class="comment">!     x_disper</span></div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;<span class="comment">!     The routine assumes that w1 &lt; w3 or q&lt;0</span></div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;<span class="comment">!     implying that the directions of k2 and P are opposite</span></div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;<span class="comment">!     local variables</span></div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;<span class="keywordtype">real</span> kk2x,kk2y,kk2m  <span class="comment">! wave number components and magnitude for k2</span></div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;<span class="keywordtype">real</span> kk4x,kk4y,kk4m  <span class="comment">! wave number components and magnitude for k4</span></div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;<span class="keywordtype">real</span> w2,w4           <span class="comment">! radian frequencies of wave numbers k2 and k4</span></div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;<span class="keywordtype">real</span> z               <span class="comment">! function value</span></div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;<span class="comment">!!real x_disper</span></div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;kk2x = kmidx - lambda*py</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;kk2y = kmidy + lambda*px</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;kk2m = sqrt(kk2x**2 + kk2y**2)</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;kk4x = kk2x + px</div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;kk4y = kk2y + py</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;kk4m = sqrt(kk4x**2 + kk4y**2)</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;<span class="keywordflow">select case</span>(iq_disp)</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;  <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;    w2 = <a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a> * sqrt(kk2m)</div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;    w4 = <a class="code" href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">sqrtg</a> * sqrt(kk4m)</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;    z  = q + w2 - w4</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;  <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;    w2 = x_disper(kk2m,q_depth)</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;    w4 = x_disper(kk4m,q_depth)</div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;    z  = q + w2 - w4</div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;<span class="keywordflow">  case default</span></div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;    z = -1</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;<span class="keywordflow">  end select</span></div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;x_locus2 = z</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">iq_disp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00241">kmidx</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00242">kmidy</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">px</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">py</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">q</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__constants_8f90_source.html#l00020">m_constants::sqrtg</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>.</p>

</div>
</div>
<a id="a1f34c165b6e8ab48f315cdcbf3d8f58a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f34c165b6e8ab48f315cdcbf3d8f58a">&#9670;&nbsp;</a></span>xc_hh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::xc_hh </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>w1x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>w1y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>w2x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>w2y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>w3x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>w3y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>z4x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>z4y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>N/A. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w1x0</td><td></td></tr>
    <tr><td class="paramname">w1y0</td><td></td></tr>
    <tr><td class="paramname">w2x0</td><td></td></tr>
    <tr><td class="paramname">w2y0</td><td></td></tr>
    <tr><td class="paramname">w3x0</td><td></td></tr>
    <tr><td class="paramname">w3y0</td><td></td></tr>
    <tr><td class="paramname">z4x</td><td></td></tr>
    <tr><td class="paramname">z4y</td><td></td></tr>
    <tr><td class="paramname">h</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>xc_hh</dd></dl>
<dl class="section author"><dt>Author</dt><dd>N/A </dd></dl>
<dl class="section date"><dt>Date</dt><dd>N/A </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">7491</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;<span class="comment">!  factor EPS included</span></div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;<span class="keywordtype">real</span> z4x,z4y  <span class="comment">! dummy arguments</span></div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;<span class="keywordtype">real</span> w1x0,w1y0,w2x0,w2y0,w3x0,w3y0,h,dsq</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;<span class="keywordtype">real</span> om1,om2,om3,om4,scpl1,scpl2,scpl3,stot</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;<span class="keywordtype">real</span> t1,t2,t3,t4,t5,tot1,tot2,tot3,tot4,tot5</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;<span class="keywordtype">real</span> som1,som2,som3</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;<span class="keywordtype">real</span> s1,s2,s3,z1,z2,z3,z4,z5</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;<span class="keywordtype">real</span> p1,p2,p3,p4,di,tnz1,tnz2,tnz3,tnz23</div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;<span class="keywordtype">real</span> csz1,csz2,csz3,csz23</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;<span class="keywordtype">real</span> e,g,gsq,omsq23,pi4</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;<span class="keywordtype">real</span> dot123,dot23</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;<span class="comment">!!real cosz,tanz</span></div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;<span class="keywordtype">real</span> eps</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160; </div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;<span class="comment">!     calculates coupling coefficient in shallow water given k1,k2,k3</span></div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;<span class="keywordtype">      real</span> k1,k2,k3,k1x,k2x,k3x,k1y,k2y,k3y,k23x,k23y,k23,k1x0,k1y0,   &amp;</div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;     &amp;     k2x0,k2y0,k3x0,k3y0,k1zx,k1zy</div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;      data pi4/0.785398163/</div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;eps = 1.e-20</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;g = 9.81</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;z4x = z4x</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;z4y = z4y</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;<span class="comment">!      print *,&#39;entering cplesh depth = &#39;,h</span></div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;      k1x0=w1x0</div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;      k1y0=w1y0</div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;      k2x0=w2x0</div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;      k2y0=w2y0</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;      k3x0=w3x0</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;      k3y0=w3y0</div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160; </div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;      tot1=0.</div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;      tot2=0.</div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;      tot3=0.</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;      tot4=0.</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;      tot5=0.</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;      z1=0.</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;      z2=0.</div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;      z3=0.</div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;      z4=0.</div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;      z5=0.</div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;      g=9.81</div>
<div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;      <a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>=g*g</div>
<div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160; </div>
<div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;      s1=1.</div>
<div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;      s2=1.</div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;      s3=-1.</div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160; </div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160; </div>
<div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;      k1x=s1*k1x0</div>
<div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;      k1y=s1*k1y0</div>
<div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;      k2x=s2*k2x0</div>
<div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;      k2y=s2*k2y0</div>
<div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;      k3x=s3*k3x0</div>
<div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;      k3y=s3*k3y0</div>
<div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160; </div>
<div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;      k1=sqrt(k1x**2+k1y**2)</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;      k2=sqrt(k2x**2+k2y**2)</div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;      k3=sqrt(k3x**2+k3y**2)</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160; </div>
<div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;       tnz1=tanz(k1*h)</div>
<div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;       tnz2=tanz(k2*h)</div>
<div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;       tnz3=tanz(k3*h)</div>
<div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;       csz1=cosz(k1*h)</div>
<div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;       csz2=cosz(k2*h)</div>
<div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;       csz3=cosz(k3*h)</div>
<div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;      om1=sqrt(g*k1*tnz1)</div>
<div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;      om2=sqrt(g*k2*tnz2)</div>
<div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;      om3=sqrt(g*k3*tnz3)</div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160; </div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;      som1=s1*om1</div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;      som2=s2*om2</div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;      som3=s3*om3</div>
<div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;      dot23=k2x*k3x+k2y*k3y</div>
<div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160; </div>
<div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;      k23x=k2x+k3x</div>
<div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;      k23y=k2y+k3y</div>
<div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;      k23=sqrt(k23x**2+k23y**2)</div>
<div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;      tnz23=tanz(k23*h)</div>
<div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;      csz23=cosz(k23*h)</div>
<div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160; </div>
<div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;      omsq23=g*k23*tnz23</div>
<div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;      dot123=k1x*k23x+k1y*k23y</div>
<div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160; </div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;<span class="comment">!     note the &quot;i**2&quot; factor is included in this term</span></div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;      di=-(som2+som3)*(k2*k3*tnz2*tnz3-dot23)  &amp;</div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;     &amp; +0.5*(som2*k3**2/(csz3)**2+som3*k2**2/(csz2)**2)</div>
<div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160; </div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;      e=0.5/g *(dot23-som2*som3/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(om2**2+om3**2+som2*som3))</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160; </div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;      p1=2.*(som1+som2+som3)*(om1**2.*omsq23/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>-dot123)</div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160; </div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;      p2=-som1*(k23)**2/(csz23)**2</div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160; </div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;      p3=-(som2+som3)*k1**2/(csz1)**2</div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160; </div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;      z1=z1+di</div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;      z2=z2+omsq23-(som2+som3)**2</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;      z3=z3+p1</div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;      z4=z4+p2</div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;      z5=z5+p3</div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;      t1=di/(omsq23-(som2+som3)**2 + eps ) * (p1+p2+p3)</div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160; </div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;      t2=-di*som1/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a> *(om1**2+omsq23)</div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160; </div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;      p4=g*k1**2/(csz1)**2</div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160; </div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;      t3=e*(som1**3*(som2+som3)/g - g*dot123 - p4)</div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160; </div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;      t4=0.5*som1/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*dot23*((som1+som2+som3)*(om2**2+om3**2)  &amp;</div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;     &amp;                           +som2*som3*(som2+som3))</div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160; </div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;      t5=-0.5*som1*om2**2*k3**2/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(som1+som2+2.*som3)  &amp;</div>
<div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;     &amp;   -0.5*som1*om3**2*k2**2/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(som1+2.*som2+som3)</div>
<div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160; </div>
<div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;      scpl1=t1+t2+t3+t4+t5</div>
<div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;      tot1=tot1+t1</div>
<div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;      tot2=tot2+t2</div>
<div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;      tot3=tot3+t3</div>
<div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;      tot4=tot4+t4</div>
<div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;      tot5=tot5+t5</div>
<div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160; </div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;      s1=1.</div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;      s2=-1.</div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;      s3=1.</div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;      k1zx=k1x0</div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;      k1zy=k1y0</div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;      k1x0=k2x0</div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;      k1y0=k2y0</div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;      k2x0=k3x0</div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;      k2y0=k3y0</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;      k3x0=k1zx</div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;      k3y0=k1zy</div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160; </div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160; </div>
<div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;      k1x=s1*k1x0</div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;      k1y=s1*k1y0</div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;      k2x=s2*k2x0</div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;      k2y=s2*k2y0</div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;      k3x=s3*k3x0</div>
<div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;      k3y=s3*k3y0</div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160; </div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;      k1=sqrt(k1x**2+k1y**2)</div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;      k2=sqrt(k2x**2+k2y**2)</div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;      k3=sqrt(k3x**2+k3y**2)</div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;      tnz1=tanz(k1*h)</div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;      tnz2=tanz(k2*h)</div>
<div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;      tnz3=tanz(k3*h)</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;       csz1=cosz(k1*h)</div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;       csz2=cosz(k2*h)</div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;       csz3=cosz(k3*h)</div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;      om1=sqrt(g*k1*tnz1)</div>
<div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;      om2=sqrt(g*k2*tnz2)</div>
<div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;      om3=sqrt(g*k3*tnz3)</div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;      som1=s1*om1</div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;      som2=s2*om2</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;      som3=s3*om3</div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;      dot23=k2x*k3x+k2y*k3y</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;      k23x=k2x+k3x</div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;      k23y=k2y+k3y</div>
<div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;      k23=sqrt(k23x**2+k23y**2)</div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;      tnz23=tanz(k23*h)</div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;      csz23=cosz(k23*h)</div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;      omsq23=g*k23*tnz23</div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;      dot123=k1x*k23x+k1y*k23y</div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160; </div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;<span class="comment">!     note the &quot;i**2&quot; factor is included in this term</span></div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;      di=-(som2+som3)*(k2*k3*tnz2*tnz3-dot23)  &amp;</div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;     &amp; +0.5*(som2*k3**2/(csz3)**2+som3*k2**2/(csz2)**2)</div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160; </div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;      e=0.5/g *(dot23-som2*som3/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a> *(om2**2+om3**2+som2*som3))</div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160; </div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;      p1=2.*(som1+som2+som3)*(om1**2.*omsq23/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>-dot123)</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160; </div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;      p2=-som1*(k23)**2/(csz23)**2</div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160; </div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;      p3=-(som2+som3)*k1**2/(csz1)**2</div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;      z1=z1+di</div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;      z2=z2+omsq23-(som2+som3)**2</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;      z3=z3+p1</div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;      z4=z4+p2</div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;      z5=z5+p3</div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160; </div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;      t1=di/(omsq23-(som2+som3)**2) * (p1+p2+p3)</div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160; </div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;      t2=-di*som1/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a> *(om1**2+omsq23)</div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160; </div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;      p4=g*k1**2/(csz1)**2</div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160; </div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;      t3=e*(som1**3*(som2+som3)/g - g*dot123 - p4)</div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160; </div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;      t4=0.5*som1/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*dot23*((som1+som2+som3)*(om2**2+om3**2) &amp;</div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;     &amp;                           +som2*som3*(som2+som3))</div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160; </div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;      t5=-0.5*som1*om2**2*k3**2/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(som1+som2+2.*som3)  &amp;</div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;     &amp;   -0.5*som1*om3**2*k2**2/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(som1+2.*som2+som3)</div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160; </div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;      scpl2=t1+t2+t3+t4+t5</div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;      tot1=tot1+t1</div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;      tot2=tot2+t2</div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;      tot3=tot3+t3</div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;      tot4=tot4+t4</div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;      tot5=tot5+t5</div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160; </div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;      s1=-1.</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;      s2=1.</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;      s3=1.</div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;      k1zx=k1x0</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;      k1zy=k1y0</div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;      k1x0=k2x0</div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;      k1y0=k2y0</div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;      k2x0=k3x0</div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;      k2y0=k3y0</div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;      k3x0=k1zx</div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;      k3y0=k1zy</div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160; </div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160; </div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;      k1x=s1*k1x0</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;      k1y=s1*k1y0</div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;      k2x=s2*k2x0</div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;      k2y=s2*k2y0</div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;      k3x=s3*k3x0</div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;      k3y=s3*k3y0</div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160; </div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;      k1=sqrt(k1x**2+k1y**2)</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;      k2=sqrt(k2x**2+k2y**2)</div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;      k3=sqrt(k3x**2+k3y**2)</div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;      tnz1=tanz(k1*h)</div>
<div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;      tnz2=tanz(k2*h)</div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;      tnz3=tanz(k3*h)</div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;      csz1=cosz(k1*h)</div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;      csz2=cosz(k2*h)</div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;      csz3=cosz(k3*h)</div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;      om1=sqrt(g*k1*tnz1)</div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;      om2=sqrt(g*k2*tnz2)</div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;      om3=sqrt(g*k3*tnz3)</div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;      som1=s1*om1</div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;      som2=s2*om2</div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;      som3=s3*om3</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;      dot23=k2x*k3x+k2y*k3y</div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;      k23x=k2x+k3x</div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;      k23y=k2y+k3y</div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;      k23=sqrt(k23x**2+k23y**2)</div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;      tnz23=tanz(k23*h)</div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;       csz23=cosz(k23*h)</div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;      omsq23=g*k23*tnz23</div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;      dot123=k1x*k23x+k1y*k23y</div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160; </div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;<span class="comment">!     note the &quot;i**2&quot; factor is included in this term</span></div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;      di=-(som2+som3)*(k2*k3*tnz2*tnz3-dot23) &amp;</div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;     &amp; +0.5*(som2*k3**2/(csz3)**2+som3*k2**2/(csz2)**2)</div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160; </div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;      e=0.5/g *(dot23-som2*som3/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a> *(om2**2+om3**2+som2*som3))</div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160; </div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;      p1=2.*(som1+som2+som3)*(om1**2.*omsq23/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>-dot123)</div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160; </div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;      p2=-som1*(k23)**2/(csz23)**2</div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160; </div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;      p3=-(som2+som3)*k1**2/(csz1)**2</div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;      z1=z1+di</div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;      z2=z2+omsq23-(som2+som3)**2</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;      z3=z3+p1</div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;      z4=z4+p2</div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;      z5=z5+p3</div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160; </div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;      t1=di/(omsq23-(som2+som3)**2) * (p1+p2+p3)</div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160; </div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;      t2=-di*som1/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(om1**2+omsq23)</div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160; </div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;      p4=g*k1**2/(cosz(k1*h))**2</div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160; </div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;      t3=e*(som1**3*(som2+som3)/g - g*dot123 - p4)</div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160; </div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;      t4=0.5*som1/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*dot23*((som1+som2+som3)*(om2**2+om3**2) &amp;</div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;     &amp;                           +som2*som3*(som2+som3))</div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160; </div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;      t5=-0.5*som1*om2**2*k3**2/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(som1+som2+2.*som3) &amp;</div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;     &amp;   -0.5*som1*om3**2*k2**2/<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>*(som1+2.*som2+som3)</div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160; </div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;      scpl3=t1+t2+t3+t4+t5</div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;      tot1=tot1+t1</div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;      tot2=tot2+t2</div>
<div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;      tot3=tot3+t3</div>
<div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;      tot4=tot4+t4</div>
<div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;      tot5=tot5+t5</div>
<div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160; </div>
<div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;      stot=(scpl1+scpl2+scpl3)</div>
<div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;      om4=om2+om3-om1</div>
<div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;      dsq=stot*stot*pi4*<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a>/(om1*om2*om3*om4+eps) <span class="comment">! eps by GVV</span></div>
<div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;      xc_hh = dsq</div>
<div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;<span class="comment">!  possible bug fixed</span></div>
<div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;      xc_hh = xc_hh*<a class="code" href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">gsq</a></div>
<div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;      <span class="keywordflow">RETURN</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l07827">cosz()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3y</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07809">tanz()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>.</p>

</div>
</div>
<a id="a6950f90ceb2167a9b4ffdd4eaf2bc16e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6950f90ceb2167a9b4ffdd4eaf2bc16e">&#9670;&nbsp;</a></span>xc_webb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function m_xnldata::xc_webb </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k1y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k2y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k3y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k4x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>k4y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>grav</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute deep water coupling coefficient for non-linear quadruplet interactions. </p>
<p>Webb (1978) and modified and corrected by Dungey and Hui (1979).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k1x</td><td>X-component of wave number k1. </td></tr>
    <tr><td class="paramname">k1y</td><td>Y-component of wave number k1. </td></tr>
    <tr><td class="paramname">k2x</td><td>X-component of wave number k2. </td></tr>
    <tr><td class="paramname">k2y</td><td>Y-component of wave number k2. </td></tr>
    <tr><td class="paramname">k3x</td><td>X-component of wave number k3. </td></tr>
    <tr><td class="paramname">k3y</td><td>Y-component of wave number k3. </td></tr>
    <tr><td class="paramname">k4x</td><td>X-component of wave number k4. </td></tr>
    <tr><td class="paramname">k4y</td><td>Y-component of wave number k4. </td></tr>
    <tr><td class="paramname">grav</td><td>gravitational acceleration m/s^2. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>xc_webb</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>10-Sep-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">7856</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;<span class="comment">!   |   | +---+  Last update: 10  Sep. 2002</span></div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;<span class="comment">!     25/02/1999 Initial version</span></div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;<span class="comment">!     10/09/2002 Upgrade of documention and interface</span></div>
<div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;<span class="comment">!     Compute deep water coupling coefficient for</span></div>
<div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;<span class="comment">!     non-linear quadruplet interactions</span></div>
<div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;<span class="comment">!     Webb (1978) and modified and corrected by Dungey and Hui (1979)</span></div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;<span class="comment">! Type    I/O        Name    Description</span></div>
<div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;<span class="comment">!--------------------------------------------------------------------</span></div>
<div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k1x   <span class="comment">!  x-component of wave number k1</span></div>
<div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k1y   <span class="comment">!  y-component of wave number k1</span></div>
<div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k2x   <span class="comment">!  x-component of wave number k2</span></div>
<div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k2y   <span class="comment">!  y-component of wave number k2</span></div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k3x   <span class="comment">!  x-component of wave number k3</span></div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k3y   <span class="comment">!  y-component of wave number k3</span></div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k4x   <span class="comment">!  x-component of wave number k4</span></div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  k4y   <span class="comment">!  y-component of wave number k4</span></div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span> ::  grav  <span class="comment">!  gravitational acceleration m/s^2</span></div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;<span class="comment">!     X_CPLE</span></div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;<span class="comment">!  6. Subroutines used:</span></div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;<span class="comment">! local variables</span></div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;<span class="keywordtype">double precision</span> wsqp12         <span class="comment">! derived variable</span></div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;<span class="keywordtype">double precision</span> wsqm13         <span class="comment">! derived variable</span></div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;<span class="keywordtype">double precision</span> wsq13          <span class="comment">! derived variable</span></div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;<span class="keywordtype">double precision</span> wsqm14         <span class="comment">! derived variable</span></div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;<span class="keywordtype">double precision</span> wsq14          <span class="comment">! derived variable</span></div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;<span class="keywordtype">double precision</span> wsq12          <span class="comment">! derived variable</span></div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;<span class="keywordtype">real</span> z,z12,z13,z14              <span class="comment">! derived variables</span></div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;<span class="keywordtype">real</span> dwebb                      <span class="comment">! final coefficient</span></div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;<span class="keywordtype">real</span> p1,p2,p3,p4,p5,p6,p7,p8,p9 <span class="comment">! partial summations</span></div>
<div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;<span class="keywordtype">real</span> w1,w2,w3,w4                <span class="comment">! radian frequencies</span></div>
<div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;<span class="keywordtype">real</span> k1,k2,k3,k4                <span class="comment">! wave number magnitudes</span></div>
<div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;<span class="keywordtype">real</span> dot12                      <span class="comment">! k1*k2</span></div>
<div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;<span class="keywordtype">real</span> dot13                      <span class="comment">! k1*k3</span></div>
<div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;<span class="keywordtype">real</span> dot14                      <span class="comment">! k1*k4</span></div>
<div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;<span class="keywordtype">real</span> dot23                      <span class="comment">! k2*k3</span></div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;<span class="keywordtype">real</span> dot24                      <span class="comment">! k2*k4</span></div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;<span class="keywordtype">real</span> dot34                      <span class="comment">! k3*k4</span></div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;<span class="keywordtype">real</span> pi                         <span class="comment">! pi</span></div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;<span class="keywordtype">real</span> pi4                        <span class="comment">! pi/4</span></div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;<span class="keywordtype">real</span> eps                        <span class="comment">! internal accuracy</span></div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;<span class="comment">!---------------------------------------------------------------------</span></div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;<span class="comment">! initialisations</span></div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;<span class="comment">!---------------------------------------------------------------------</span></div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>  = 4.*atan(1.)</div>
<div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;pi4 = 0.25*<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a></div>
<div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;eps = 1.0e-30</div>
<div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;k1 = sqrt(k1x*k1x + k1y*k1y)</div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;k2 = sqrt(k2x*k2x + k2y*k2y)</div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;k3 = sqrt(k3x*k3x + k3y*k3y)</div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;k4 = sqrt(k4x*k4x + k4y*k4y)</div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;w1 = sqrt(k1)</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;w2 = sqrt(k2)</div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;w3 = sqrt(k3)</div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;w4 = sqrt(k4)</div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;dot12 = k1x*k2x + k1y*k2y</div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;dot13 = k1x*k3x + k1y*k3y</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;dot14 = k1x*k4x + k1y*k4y</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;dot23 = k2x*k3x + k2y*k3y</div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;dot24 = k2x*k4x + k2y*k4y</div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;dot34 = k3x*k4x + k3y*k4y</div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;wsqp12= sqrt((k1x+k2x)*(k1x+k2x)+(k1y+k2y)*(k1y+k2y))</div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;wsq12 = (w1+w2)*(w1+w2)</div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;wsqm13= sqrt((k1x-k3x)*(k1x-k3x)+(k1y-k3y)*(k1y-k3y))</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;wsq13 = (w1-w3)*(w1-w3)</div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;wsqm14= sqrt((k1x-k4x)*(k1x-k4x)+(k1y-k4y)*(k1y-k4y))</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;wsq14 = (w1-w4)*(w1-w4)</div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;z12   = wsqp12-wsq12</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;z13   = wsqm13-wsq13</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;z14   = wsqm14-wsq14</div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;z     = 2.*wsq12*(k1*k2-dot12)*(k3*k4-dot34)</div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;p1    = z/(z12+eps)</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;z     = 2.*wsq13*(k1*k3+dot13)*(k2*k4+dot24)</div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;p2    = z/(z13+eps)</div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;z     = 2.*wsq14*(k1*k4+dot14)*(k2*k3+dot23)</div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;p3    = z/(z14+eps)</div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;p4    =  0.5 *(dot12*dot34 + dot13*dot24 + dot14*dot23)</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;p5    =  0.25*(dot13+dot24) * wsq13 * wsq13</div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;p6    = -0.25*(dot12+dot34) * wsq12 * wsq12</div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;p7    =  0.25*(dot14+dot23) * wsq14 * wsq14</div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;p8    =  2.5*k1*k2*k3*k4</div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;p9    = wsq12*wsq13*wsq14* (k1 + k2 + k3 + k4)</div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;dwebb  = p1 + p2 + p3 + p4 + p5 + p6 + p7 + p8 + p9</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;xc_webb = <a class="code" href="namespacem__constants.html#aa591a9f7dab0aa8ab034b2b539cb2465">grav</a>**2*pi4*dwebb*dwebb/(w1*w2*w3*w4+eps)</div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">k1y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">k2y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3x</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">k3y</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4x</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">k4y</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>.</p>

</div>
</div>
<a id="ab3cc0fe53cb7dc164d90dbb9f0745c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3cc0fe53cb7dc164d90dbb9f0745c36">&#9670;&nbsp;</a></span>xnl_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::xnl_init </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nsigma), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ndir), intent(in)&#160;</td>
          <td class="paramname"><em>dird</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pftail</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>x_grav</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ndepth), intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iquad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iqgrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize coefficients, integration space, file i/o for computation nonlinear quadruplet wave-wave interaction. </p>
<p>Set version number. Set unit unit numbers. Open quad related files. Optionally reset configuration by a back door option. Compute integration spaces for given water depths.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>Radian frequencies </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dird</td><td>Directions (degrees) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsigma</td><td>Number of sigma values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndir</td><td>Number of directions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pftail</td><td>power of spectral tail, e.g. -4 or -5 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_grav</td><td>gravitational acceleration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>depths for which integration space must be computed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndepth</td><td>Number of water depths </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iquad</td><td>Type of method for computing nonlinear interactions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iqgrid</td><td>Type of grid for computing nonlinear interactions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iproc</td><td>Processor number, controls output file for MPI </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error indicator. If no errors are detected IERR=0</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>4-Sep-2003 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">465</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">!   |       |    Gerbrant van Vledder</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">!   |   | +---+  Last update: 4 September 2003</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.03</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__fileio.html">m_fileio</a></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacem__constants.html">m_constants</a></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">!     10/01/2001   Initial version</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">!     14/02/2001   Release 3</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">!     06/11/2001   Depth forced to 1000 when iquad ==1,2</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">!     08/08/2002   Upgrade to version 4</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">!     19/08/2002   Extra test output</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">!     22/08/2002   User defined directions stored in Quad-system</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">!     26/08/2002   Minimum water depth in variable q_mindepth</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">!     09/09/2002   Initialized LASTQUADFILE</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">!     10/09/2002   Initialisation of Q_DSTEP</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">!     11/09/2002   Called of Q_ALLOC moved to location after Q_SETCFG</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">!                  Output unit luq_fil added</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">!     16/09/2002   Parameter IPROC added to take are of MPI</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">!     25/09/2002   Check added for directions of sector grid</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">!     25/04/2003   name q_alloc changed to q_allocate</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">!     04/06/2003   variable IQ_INT renamed IQ_INTEG</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">!     11/06/2003   Call to Q_SETCFG changed into Q_SETCONFIG</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">!                  Call to Q_CHKCFG changed into Q_CHKCONFIG</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">!                  Call to subroutine Q_SUMMARY added</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">!                  Compute size of points on locus, stored in KLOCUS</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">!     13/06/2003   Test parameters moved to Q_SETCONFIG</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">!     04/09/2003   Routine Q_SETVERSION added</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">!     Initialize coefficients, integration space, file i/o for computation</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">!     nonlinear quadruplet wave-wave interaction</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">!     Set version number</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">!     Set unit unit numbers</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">!     Open quad related files</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">!     Optionally reset configuration by a back door option</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">!     Compute integration spaces for given water depths</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">!Type   I/O              Name          Description</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  nsigma        <span class="comment">! Number of sigma values</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  ndir          <span class="comment">! Number of directions</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  ndepth        <span class="comment">! Number of water depths</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     ::  sigma(nsigma) <span class="comment">! Radian frequencies</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     ::  dird(ndir)    <span class="comment">! Directions (degrees)</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     ::  pftail        <span class="comment">! power of spectral tail, e.g. -4 or -5</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     ::  depth(ndepth) <span class="comment">! depths for which integration space must be computed</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>     ::  x_grav        <span class="comment">! gravitational acceleration</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  iquad         <span class="comment">! Type of method for computing nonlinear interactions</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  iqgrid        <span class="comment">! Type of grid for computing nonlinear interactions</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span>  ::  iproc         <span class="comment">! Processor number, controls output file for MPI</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> ::  ierr          <span class="comment">! Error indicator. If no errors are detected IERR=0</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">!     An error message is produced within the QUAD system.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">!     If no errors are detected IERROR=0</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">!     otherwise IERROR &gt; 0</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">!     ierr    Description of error</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">!     -------------------------------</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">!     1       Invalid value of iquad</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">!     2       Invalid value of iq_grid</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">!     3       Incompatability between iq_grid and input directions</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">!     4       Error in deleting *.ERR file</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">!     5       Error generated by Q_SETCONFIG</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">!     6       Error generated by Q_CHKCFG</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">!     7       Error generated by Q_CTRGRID</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">!     host program, e.g. SWANQUAD4</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">!  6. Subroutines used:</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">!     Q_SETVERSION</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">!     Q_SETCONFIG</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">!     Q_CHKCFG</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">!     Q_SUMMARY</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">!     Q_ALLOCATE</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">!     Q_CTRGRID</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">!     Q_INIT</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">! 10. Source code</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">! Local parameters</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="keywordtype">integer</span> iuerr</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordtype">integer</span> idepth</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keywordtype">integer</span> igrid</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keywordtype">integer</span> ia,ik</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordtype">real</span> depmin</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="keywordtype">real</span> dstep</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordtype">real</span> dgap</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keyword">call </span>q_setversion <span class="comment">! set version number</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">! user defined settings</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;q_mindepth = 0.1               <span class="comment">! Set minimum water depth</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;q_maxdepth = 2000              <span class="comment">! Set maximum water depth</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;q_dstep    = 0.1               <span class="comment">! Set minimum step for coding depth files</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;iscreen    = 6                 <span class="comment">! Identifier for screen output (UNIX=0, WINDOWS=6)</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;iufind     = 1                 <span class="comment">! search for unit numbers automatically</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">!----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">! Initialisations</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;ierr     = 0                 <span class="comment">! set error condition</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;iq_stack   = 0                 <span class="comment">! initialize stack for tracing subroutines</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;qbase      = <span class="stringliteral">&#39;xnl4v5&#39;</span>          <span class="comment">! Base name for quadruplet files</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;qf_error   = <span class="stringliteral">&#39;xnl5_errors.txt&#39;</span> <span class="comment">! Text file with error messages</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;lastquadfile = <span class="stringliteral">&#39;quad?????.bqf&#39;</span> <span class="comment">! Initialize name of last retrieved quad file</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">!  set values of physical quantities</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">!  and store them in quad data area</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;q_grav    = x_grav        <span class="comment">! gravitational acceleration</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;qf_tail   = pftail        <span class="comment">! Power of parametric spectral tail</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;iq_type   = iquad         <span class="comment">! Type of method to compute transfer</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;iq_interp = 1             <span class="comment">! apply bi-linear interpolation</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;iq_prt    = 0             <span class="comment">! Print output on, to file /qbase/.prt</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;iq_test   = 0             <span class="comment">! test level</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;iq_trace  = 0             <span class="comment">! level of subroutine trace</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;iq_log    = 0             <span class="comment">! Set logging of q_routines off</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;iq_grid   = iqgrid        <span class="comment">! Grid type for computation of nonlinear transfer</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;iq_screen = 0             <span class="comment">! enable output to screen</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">! Check input</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">if</span>(iq_type&lt;1 .or. iq_type&gt;3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  ierr = 1</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keywordflow">if</span>(iq_grid&lt;1 .or. iq_grid&gt;3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  ierr = 2</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">!  Retrieve size of spectral grid from input</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;fqmin = sigma(1)/(2.*<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>)       <span class="comment">! minimum frequency in Hz</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;fqmax = sigma(nsigma)/(2.*<a class="code" href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">pi</a>)  <span class="comment">! maximum frequency in Hz</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;nkq   = nsigma                 <span class="comment">! number of frequencies/wave numbers</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;naq   = ndir                   <span class="comment">! number of directions</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">!  check if directions are given on full circle or in a symmetric sector</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">!----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">!  1: compute directional step</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">!  2: compute gap between first and last</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">!  3: compare gap with step</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;dstep = dird(2)-dird(1)                          <span class="comment">! directional step</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;dgap = 180.- abs(180.- abs(dird(1)-dird(ndir)))  <span class="comment">! directional gap</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">!----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordflow">if</span>(iq_grid==1 .or. iq_grid==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">!  check if gap equal to step in the case of full circle</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">if</span>(abs(dstep-dgap) &lt; 0.001) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    ierr = 31</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">!  check if sector is symmetric around zero in the case of sector grid</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keywordflow">if</span>(abs(dird(1)+dird(ndir)) &gt; 0.01) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    ierr = 32</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;q_dird1 = dird(1)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;q_dird2 = dird(ndir)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">! assign unit numbers for QUAD related files</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">! If IUFIND=0, fixed prespecified unit numbers must be given</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">!    IUFIND=1, the numbers are searched automatically</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordflow">if</span>(iufind==0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  luq_err = 103</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  luq_tst = 104</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  luq_int = 105</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  luq_log = 106</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  luq_prt = 107</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  luq_cfg = 108</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  luq_bqf = 109</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  luq_grd = 110</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  luq_txt = 111</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  luq_loc = 112</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  luq_trf = 113</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  luq_t13 = 114</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  luq_fil = 117</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">! delete old Error file, if it exists</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(trim(qbase)//<span class="stringliteral">&#39;.err&#39;</span>,<span class="stringliteral">&#39;DF&#39;</span>,iufind,luq_err,iuerr)</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="keywordflow">if</span>(iuerr/=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;FILEIO&#39;</span>,<span class="stringliteral">&#39;Problem in deleting error file *.ERR&#39;</span>)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  ierr = 4</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">! create new files, first create logging file</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(trim(qbase)//<span class="stringliteral">&#39;.log&#39;</span>,<span class="stringliteral">&#39;UF&#39;</span>,iufind,luq_log,iuerr) <span class="comment">! logging</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(trim(qbase)//<span class="stringliteral">&#39;.prt&#39;</span>,<span class="stringliteral">&#39;UF&#39;</span>,iufind,luq_prt,iuerr) <span class="comment">! general print file</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keyword">call </span><a class="code" href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">z_fileio</a>(trim(qbase)//<span class="stringliteral">&#39;.tst&#39;</span>,<span class="stringliteral">&#39;UF&#39;</span>,iufind,luq_tst,iuerr) <span class="comment">! test output</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(2a,i4)&#39;</span>) <span class="stringliteral">&#39;XNL_INIT: &#39;</span>,trim(qbase)//<span class="stringliteral">&#39;.log connected to :&#39;</span>,luq_log</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(2a,i4)&#39;</span>) <span class="stringliteral">&#39;XNL_INIT: &#39;</span>,trim(qbase)//<span class="stringliteral">&#39;.prt connected to :&#39;</span>,luq_prt</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(2a,i4)&#39;</span>) <span class="stringliteral">&#39;XNL_INIT: &#39;</span>,trim(qbase)//<span class="stringliteral">&#39;.tst connected to :&#39;</span>,luq_tst</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;---------------------------------------------------------------&#39;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) trim(q_version)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Solution of Boltzmann integral using Webb/Resio/Tracy method&#39;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;---------------------------------------------------------------&#39;</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;Initialisation&#39;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordflow">if</span>(iproc &gt;=0) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i5)&#39;</span>) <span class="stringliteral">&#39;(MPI) processor number:&#39;</span>,iproc</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">!   Reset configuration from file, using a backdoor</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keyword">call </span>q_setconfig(iquad)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keywordflow">if</span> (iq_err /=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  ierr = 5</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">!  check settings for inconsistencies</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keyword">call </span>q_chkconfig</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="keywordflow">if</span> (iq_err /=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  ierr = 6</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">! determine minimum size of number of points on locus as stored in database</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;klocus = nlocus0</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordflow">if</span>(iq_gauleg &gt; 0) klocus = min(iq_gauleg,klocus)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordflow">if</span>(iq_lump   &gt; 0) klocus = min(iq_lump,klocus)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">!  write summary of program settings</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">!---------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keyword">call </span>q_summary</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">!----------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">!  allocate data arrays</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">!-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keyword">call </span>q_allocate</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">!  Generate interaction grid and coefficients for each valid water depth</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">!  Q_CTRGRID  controls grid generation</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="keywordflow">do</span> idepth=1,ndepth</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  q_depth = depth(idepth)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">if</span>(iquad==1 .or. iquad==2) q_depth = q_maxdepth</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span>(q_depth &lt; q_mindepth) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;w&#39;</span>,<span class="stringliteral">&#39;DEPTH&#39;</span>,<span class="stringliteral">&#39;Invalid depth&#39;</span>)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keyword">write</span>(luq_err,<span class="stringliteral">&#39;(a,e12.5,f10.2)&#39;</span>) <span class="stringliteral">&#39;Incorrect depth &amp; minimum:&#39;</span>,q_depth,q_mindepth</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keyword">call </span>q_init</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keyword">call </span>q_ctrgrid(2,igrid)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span>(iq_err /= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      ierr = 7</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordflow">if</span>(iquad==1 .and. ndepth &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>) <span class="stringliteral">&#39;XNL_INIT: For deep water only one grid suffices&#39;</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">exit</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="keywordflow">end do</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">!  Create or open triplet output data file if iq_triq &gt; 0</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">!! if (iq_log ==0) call z_fileio(trim(qbase)//&#39;.log&#39;,&#39;DF&#39;,iufind,luq_log,iuerr)</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">!! if (iq_prt ==0) call z_fileio(trim(qbase)//&#39;.prt&#39;,&#39;DF&#39;,iufind,luq_prt,iuerr)</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00207">fqmax</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00206">fqmin</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00103">iq_gauleg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">iq_grid</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00123">iq_interp</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00136">iq_lump</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">iq_screen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00375">iq_stack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">iq_test</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00170">iq_trace</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00414">iq_type</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">iscreen</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00045">iufind</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00216">klocus</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00194">lastquadfile</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00050">luq_bqf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00051">luq_cfg</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">luq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00053">luq_fil</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00054">luq_grd</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00055">luq_int</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00056">luq_loc</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00062">luq_t13</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00059">luq_trf</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00060">luq_tst</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00061">luq_txt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">naq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">nkq</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">nlocus0</a>, <a class="el" href="mod__constants_8f90_source.html#l00029">m_constants::pi</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00364">q_dird1</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00364">q_dird2</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00209">q_dstep</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00366">q_maxdepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00367">q_mindepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05279">q_setversion()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00039">q_version</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00042">qbase</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00043">qf_error</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00067">qf_tail</a>, and <a class="el" href="mod__fileio_8f90_source.html#l00084">m_fileio::z_fileio()</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3snl2md_8F90_source.html#l00295">w3snl2md::insnl2()</a>.</p>

</div>
</div>
<a id="a2c8b37be4003a263c0334436aabd8534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8b37be4003a263c0334436aabd8534">&#9670;&nbsp;</a></span>xnl_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine m_xnldata::xnl_main </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nsig,ndir), intent(in)&#160;</td>
          <td class="paramname"><em>aspec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ndir), intent(in)&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iquad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig,ndir), intent(out)&#160;</td>
          <td class="paramname"><em>xnl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nsig,ndir), intent(out)&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute nonlinear transfer for a given action density spectrum on a given sigma and direction grid (Webb/Resio/Tracy/Van Vledder). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">aspec</td><td>Action density spectrum as a function of (sigma,theta) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>radian frequencies </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angle</td><td>directions in radians (sector or full circle) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nsig</td><td>number of frequencies (sigma) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndir</td><td>number of directions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">depth</td><td>water depth </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iquad</td><td>method of computing nonlinear quadruplet interactions </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xnl</td><td>nonlinear quadruplet interaction computed with a certain exact method (k,theta) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">diag</td><td>diagonal term for semi-implicit integration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iproc</td><td>MPI processor number </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>error indicator</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Gerbrant Ph. van Vledder </dd></dl>
<dl class="section date"><dt>Date</dt><dd>27-Sep-2002 </dd></dl>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">810</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">!-----------------------------------------------------------------------------!</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">!   +-------+    ALKYON Hydraulic Consultancy &amp; Research</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">!   |       |    Gerbrant Ph. van Vledder</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">!   |   +---+</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">!   |   | +---+  Last update: 27 Sept. 2002</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">!   +---+ |   |  Release: 5.0</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">!         +---+</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">! do not use m_xnldata</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">!  0. Update history</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">!     25/02/1999 Initial version</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">!     25/07/1999 Various restructurations</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">!     12/10/1999 Error handling improved</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">!     15/10/1999 Existing test file deleted</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">!     25/10/1999 Parameter iq_filt added</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">!     29/10/1999 iq_call renamed to i_qmain and save statement added</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">!     08/12/1999 Call to CHKLAW included</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">!     16/12/1999 Extra output and check for wave number range</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">!     27/12/1999 Expansion of k-grid now in new subroutine Q_EXPAND</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">!     06/01/2000 Deallocate of KX and NSPECX removed</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">!     08/01/2000 Recontructed, subroutine Q_WRTVV splitted off</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">!     12/01/2000 Diagonal term added to interface</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">!     26/06/2000 Name changed to XNL_MAIN</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">!     01/02/2001 Interface change, spectrum must be given as Action density(sigma,theta)</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">!     06/11/2001 Water depth forced to 1000 when IQUAD==1,2</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">!     13/08/2002 Upgrade to release 4.0</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">!     20/08/2002 Action density array copied to internal A-array</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">!     09/09/2002 Upgrade to release 5</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">!     16/09/2002 Parameter IPROC included to take care of MPI processors</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">!     27/09/2002 Description of input argument SIGMA corrected</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">!  1. Purpose:</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">!     Compute nonlinear transfer for a given action density spectrum</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">!     on a given sigma and direction grid</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">!  2. Method</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">!     Webb/Resio/Tracy/Van Vledder</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">!  3. Parameter list:</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">! Type    I/O          Name               Description</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">!---------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span>  :: nsig             <span class="comment">! number of frequencies (sigma)</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span>  :: ndir             <span class="comment">! number of directions</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span>  :: iquad            <span class="comment">! method of computing nonlinear quadruplet interactions</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: iproc            <span class="comment">! MPI processor number</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: aspec(nsig,ndir) <span class="comment">! Action density spectrum as a function of (sigma,theta)</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: sigma(nsig)      <span class="comment">! radian frequencies</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: angle(ndir)      <span class="comment">! directions in radians (sector or full circle)</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(in)</span>  :: depth            <span class="comment">! water depth</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(out)</span> :: xnl(nsig,ndir)   <span class="comment">! nonlinear quadruplet interaction computed with</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">!                                         a certain exact method (k,theta)</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="keywordtype">real</span>,   <span class="keywordtype">intent(out)</span> :: diag(nsig,ndir)  <span class="comment">! diagonal term for semi-implicit integration</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">intent(out)</span> :: ierr            <span class="comment">! error indicator</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">!  4. Error messages</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">!  5. Called by:</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">!     host program</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">!  6. Subroutines used</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">!     Q_DSCALE        WAM depth scaling</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">!     Q_XNL4V4        Xnl using Webb/Resio/Tracy/VanVledder</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">!     Q_STACK         Stack administration</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">!     Q_CHKCONS       Check conservation of energy, action and momentum</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">!  7. Remarks</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">!  8. Structure</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">!  9. Switches</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">! 10. Source code:</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">!     local variables</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">save</span> :: i_qmain</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keywordtype">integer</span> i_qlast</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordtype">integer</span> isig</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keywordtype">integer</span> idir</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="keywordtype">real</span> q_dfac</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="keywordtype">real</span> sum_e</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keywordtype">real</span> sum_a</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="keywordtype">real</span> sum_mx</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordtype">real</span> sum_my</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keyword">data</span> i_qmain /0/     </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keyword">data</span> i_qlast /0/     </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">!--------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;iq_stack =0          <span class="comment">! initialize stack order every time qmain is called</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;+xnl_main&#39;</span>)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;i_qmain = i_qmain + 1</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keywordflow">if</span>(iq_prt&gt;=1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keyword">write</span>(luq_prt,*)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,i4,f16.3,i4)&#39;</span>) <span class="stringliteral">&#39;XNL_MAIN: Input arguments: iquad depth iproc:&#39;</span>,&amp;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;&amp;  iquad,depth,iproc</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">! initialisations for error handling</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;iq_err  = 0             <span class="comment">! No errors detected at start</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;q_depth = depth         <span class="comment">! water depth to be used in computation</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keywordflow">if</span>(iquad==1 .or. iquad==2) q_depth=1000.</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">!     !</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">!  check water depth to be used in computation</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="keywordflow">if</span>(q_depth &lt; q_mindepth) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  xnl = 0.</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;w&#39;</span>,<span class="stringliteral">&#39;DEPTH&#39;</span>,<span class="stringliteral">&#39;Zero transfer returned&#39;</span>)</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">!  check if iquad has changed since last call, this is no more allowed</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">!!if (iquad /= i_qlast .and. i_qmain/=1) then</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">!!  call q_error(&#39;e&#39;,&#39;IQUAD&#39;,&#39;Value of IQUAD differs from initial value&#39;)</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">!!  ierr = 1</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">!!  goto 9999</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">!!end if</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">!-----------------------------------------------------------------------------+</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">!  main choice between various options                                        |</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">!-----------------------------------------------------------------------------+</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordflow">if</span>(iquad&gt;=1 .and. iquad &lt;=3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  a = aspec</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keyword">call </span>q_xnl4v4(aspec,sigma,angle,nsig,ndir,depth,xnl,<a class="code" href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">diag</a>,ierr)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span>(ierr/=0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keyword">call </span>q_error(<span class="stringliteral">&#39;e&#39;</span>,<span class="stringliteral">&#39;wrtvv&#39;</span>,<span class="stringliteral">&#39;Problem in Q_XNL4V4&#39;</span>)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">goto</span> 9999</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">! compute scale factor to include WAM depth scaling</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">!------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">if</span>(iq_dscale ==1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keyword">call </span>q_dscale(aspec,sigma,angle,nsig,ndir,depth,q_grav,q_dfac)</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    xnl = xnl*q_dfac</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span>(iq_prt &gt;=1) <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,f7.4)&#39;</span>) <span class="stringliteral">&#39;XNL_MAIN depth scale factor:&#39;</span>,q_dfac</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">!  check conservation laws</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="keyword">call </span>q_chkcons(xnl,nsig,ndir,sum_e,sum_a,sum_mx,sum_my)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">if</span>(iq_prt &gt;= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a)&#39;</span>)        <span class="stringliteral">&#39;XNL_MAIN: Conservation checks&#39;</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keyword">write</span>(luq_prt,<span class="stringliteral">&#39;(a,4e13.5)&#39;</span>) <span class="stringliteral">&#39;XNL_MAIN: E/A/MOMX/MOMY:&#39;</span>,sum_e,sum_a,sum_mx,sum_my</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="keywordflow">  end if</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;9999 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;ierr = iq_err</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="keywordflow">if</span>(iq_log &gt;= 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keyword">write</span>(luq_log,*)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;XNL_MAIN: Number of warnings:&#39;</span>,iq_warn</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keyword">write</span>(luq_log,<span class="stringliteral">&#39;(a,i4)&#39;</span>) <span class="stringliteral">&#39;XNL_MAIN: Number of errors  :&#39;</span>,iq_err</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="keywordflow">end if</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">!!i_qlast = iquad</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="keyword">call </span>q_stack(<span class="stringliteral">&#39;-xnl_main&#39;</span>)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordflow">return</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mod__xnl4v5_8f90_source.html#l00358">a</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00094">iq_dscale</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">iq_err</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">iq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">iq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00375">iq_stack</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00428">iq_warn</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">luq_log</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">luq_prt</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">q_depth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02397">q_dscale()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">q_grav</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00367">q_mindepth</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3snl2md_8F90_source.html#l00096">w3snl2md::w3snl2()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae750e6e7413e1f16c6a2a7c49a9d7351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae750e6e7413e1f16c6a2a7c49a9d7351">&#9670;&nbsp;</a></span>a</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:), allocatable m_xnldata::a</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Action density on wave number grid A(sigma,theta) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00358">358</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: a(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a29b0bbc3782a7bd0a73086fdca431b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29b0bbc3782a7bd0a73086fdca431b05">&#9670;&nbsp;</a></span>a_pol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::a_pol</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>angles of polar locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00289">289</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: a_pol(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a208db23596f1f54ac998e0089dc1dde0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208db23596f1f54ac998e0089dc1dde0">&#9670;&nbsp;</a></span>aqname</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=13) m_xnldata::aqname</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>name of ASCII grid file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00192">192</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keywordtype">character(len=13)</span> aqname</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a07d6dd55b735613145f97a2bbf6f134e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d6dd55b735613145f97a2bbf6f134e">&#9670;&nbsp;</a></span>bqname</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=13) m_xnldata::bqname</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>name of binary quadruplet grid file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00193">193</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keywordtype">character(len=13)</span> bqname</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a0177eed73a279a705ee0f8b2260d5e46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0177eed73a279a705ee0f8b2260d5e46">&#9670;&nbsp;</a></span>c_pol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::c_pol</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cosines during polar generation of locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00288">288</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: c_pol(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a91f3d81edbb8c7205673c78c986a1428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91f3d81edbb8c7205673c78c986a1428">&#9670;&nbsp;</a></span>cple_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::cple_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>coupling coefficient around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00284">284</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: cple_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="ac23f396086712d7c8c5defe8cd240bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23f396086712d7c8c5defe8cd240bb7">&#9670;&nbsp;</a></span>cple_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::cple_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>coupling coefficient around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00301">301</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: cple_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="acc93f6aa39b2e7ee2f02eaa8a4cbcf76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc93f6aa39b2e7ee2f02eaa8a4cbcf76">&#9670;&nbsp;</a></span>crf1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::crf1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>estimated circumference of locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00380">380</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordtype">real</span> crf1</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a311e1e5c74386776ac7fab100cd454e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311e1e5c74386776ac7fab100cd454e8">&#9670;&nbsp;</a></span>cstack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=21), dimension(<a class="el" href="namespacem__xnldata.html#a59e28829b99a12aa264b615a27367c90">mq_stack</a>) m_xnldata::cstack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stack with module names. </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00376">376</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordtype">character(len=21)</span> cstack(mq_stack)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>.</p>

</div>
</div>
<a id="a0911bce8e3812ac7c74e5de1f63fa7c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0911bce8e3812ac7c74e5de1f63fa7c4">&#9670;&nbsp;</a></span>dk0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::dk0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of initial wave number of locus, </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00226">226</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="ad872c37e7886dcd19fd8953cc3b17645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad872c37e7886dcd19fd8953cc3b17645">&#9670;&nbsp;</a></span>ds_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::ds_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>step size around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00282">282</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: ds_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="aa9fbf9cf6916bf4fd5c520749dc8dfdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9fbf9cf6916bf4fd5c520749dc8dfdc">&#9670;&nbsp;</a></span>ds_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::ds_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>step size around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00299">299</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: ds_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a91b00f217b6a60bb8eb32481764817ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91b00f217b6a60bb8eb32481764817ed">&#9670;&nbsp;</a></span>dt13</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::dt13</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>increment along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00342">342</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: dt13(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>.</p>

</div>
</div>
<a id="a310eab9aa8cec8f93a6fadc3ffd0d4d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a310eab9aa8cec8f93a6fadc3ffd0d4d3">&#9670;&nbsp;</a></span>eps_k</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::eps_k</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>absolute accuracy for equality check of k </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00372">372</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordtype">real</span> eps_k</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a1a96f0188f21cb639bd6548be5b90d64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a96f0188f21cb639bd6548be5b90d64">&#9670;&nbsp;</a></span>eps_q</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::eps_q</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>absolute accuracy for check of Q </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00371">371</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordtype">real</span> eps_q</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a6e456df1bcd0a78e0c5a091e4803620b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e456df1bcd0a78e0c5a091e4803620b">&#9670;&nbsp;</a></span>fqmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::fqmax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>highest frequency in Hz </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00207">207</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">real</span> fqmax</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a08a2f20cdabbc8461b0f0c1fa2c8a85c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a2f20cdabbc8461b0f0c1fa2c8a85c">&#9670;&nbsp;</a></span>fqmin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::fqmin</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lowest frequency in Hz </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00206">206</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordtype">real</span> fqmin</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a9d95f61b9aa30b6b59b4f81559583fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d95f61b9aa30b6b59b4f81559583fae">&#9670;&nbsp;</a></span>ia_k1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::ia_k1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00203">203</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordtype">integer</span> ia_k1,ik_k1</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a187d24cac99e72ac6164a44954ed1a2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a187d24cac99e72ac6164a44954ed1a2e">&#9670;&nbsp;</a></span>ia_k3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::ia_k3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00204">204</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="keywordtype">integer</span> ia_k3,ik_k3</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="aad0b4b1bf1724c27d7d624d73e7c887c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad0b4b1bf1724c27d7d624d73e7c887c">&#9670;&nbsp;</a></span>iag1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iag1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00388">388</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordtype">integer</span> iag1,iag2</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a17c0158a31209d57e861f11750890c7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c0158a31209d57e861f11750890c7a">&#9670;&nbsp;</a></span>iag2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iag2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>range of directions for precomputed interaction grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00388">388</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a3f90c06ec8b09c9a5171d021d606360a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f90c06ec8b09c9a5171d021d606360a">&#9670;&nbsp;</a></span>iamax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iamax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum difference in indices for sector grids </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00386">386</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordtype">integer</span> iamax</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a236cc28e8172e98f42e3cd2ce397e6ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a236cc28e8172e98f42e3cd2ce397e6ac">&#9670;&nbsp;</a></span>iaq1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iaq1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">387</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordtype">integer</span> iaq1,iaq2</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a3b6306a71c695a63c109dc0152a8aefc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b6306a71c695a63c109dc0152a8aefc">&#9670;&nbsp;</a></span>iaq2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iaq2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>indices of do-loop for directions </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00387">387</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a9bf780386b9ddf029dbaaed4fc96a33e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bf780386b9ddf029dbaaed4fc96a33e">&#9670;&nbsp;</a></span>iaref</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iaref</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>index of first angle of reference wave numbers </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00385">385</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordtype">integer</span> iaref</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a530544b6c0402771b60058bde0bbb24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530544b6c0402771b60058bde0bbb24a">&#9670;&nbsp;</a></span>id_facmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::id_facmax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Factor for determining range of depth search (Q_SEARCHGRID) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00363">363</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keywordtype">integer</span> id_facmax</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>.</p>

</div>
</div>
<a id="a29a58de9fb76932127349a1cd74d69a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29a58de9fb76932127349a1cd74d69a7">&#9670;&nbsp;</a></span>ik_k1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::ik_k1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>indices of main loop variables </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00203">203</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="aef32702236c90408ad3ce954dc923979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef32702236c90408ad3ce954dc923979">&#9670;&nbsp;</a></span>ik_k3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::ik_k3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>indices of main loop variables </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00204">204</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="ac5ef35cb3c4c3f59f9cd2526d51a4015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5ef35cb3c4c3f59f9cd2526d51a4015">&#9670;&nbsp;</a></span>iq_compact</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_compact</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to compact data == 0, do not compact == 1, compact data by elimiting zero contribution along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00078">78</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">integer</span> iq_compact</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>.</p>

</div>
</div>
<a id="a67d944a61847c21805cd528b7ed4e0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d944a61847c21805cd528b7ed4e0a4">&#9670;&nbsp;</a></span>iq_cple</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_cple</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>type of coupling coefficient == 1, deep water coefficient of Webb == 2, deep water coefficient of Zakharov == 3, finite depth coefficient of Hasselmann &amp; Herterich == 4, finite depth coefficient of Zakharov == 5, finite depth coefficient of Lin &amp; Perrie </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00082">82</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keywordtype">integer</span> iq_cple</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>.</p>

</div>
</div>
<a id="a97aa90a6e3636d0cf087fa71bcd3ecf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97aa90a6e3636d0cf087fa71bcd3ecf7">&#9670;&nbsp;</a></span>iq_disp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_disp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>type of dispersion relation, viz. </p>
<p>depth dependency == 1, deep water, possibly with geometric scaling == 2, linear dispersion relation, w^2 = g.k.tanh(kd) == 3, nonlinear dispersion relation </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00089">89</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">integer</span> iq_disp</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">x_locus1()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="ad5abca5ce688ed9ed858f221127f9aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5abca5ce688ed9ed858f221127f9aad">&#9670;&nbsp;</a></span>iq_dscale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_dscale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate depth scaling according to Herterich and Hasselmann == 0, No depth scaling == 1, depth scaling activated </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00094">94</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">integer</span> iq_dscale</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="af4b06065a1ecf68a469b2cc4402cd27c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b06065a1ecf68a469b2cc4402cd27c">&#9670;&nbsp;</a></span>iq_err</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_err</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counts the number of errors if no error occurred, IQ_ERR = 0 for each occuring error, iq_err is incremented errors are always terminating routine Q_ERROR handles the reporting on the error </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00422">422</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordtype">integer</span> iq_err</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="af1488327ff947517df554b614e71f087"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1488327ff947517df554b614e71f087">&#9670;&nbsp;</a></span>iq_filt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_filt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate filtering in wave number space ==0, no filtering ==1, filtering activated </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00099">99</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">integer</span> iq_filt</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a07a19e31070fd12506b069cf5705884f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07a19e31070fd12506b069cf5705884f">&#9670;&nbsp;</a></span>iq_gauleg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_gauleg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch for Gauss-Legendre interpolation == 0, No Gauss-Legendre, default </p><blockquote class="doxtable">
<p>0 Gauss-Legendre, iq_gauleg is number of points </p>
</blockquote>
</p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00103">103</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">integer</span> iq_gauleg</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="aa53c4732528d3821d8b0048bc9e5d37a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa53c4732528d3821d8b0048bc9e5d37a">&#9670;&nbsp;</a></span>iq_geom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_geom</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>type of scaling == 0, no geometric scaling, only directional scaling of loci == 1, geometric scaling using Resio/Tracy method only possible in the case IQ_DISP=1 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00107">107</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">integer</span> iq_geom</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="aef3658e1cbc6870ef53e061cc72036c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef3658e1cbc6870ef53e061cc72036c8">&#9670;&nbsp;</a></span>iq_grid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_grid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>type of spectral grid == 1, sector &amp; symmetric around zero == 2, sector &amp; symmetric around zero &amp; non-symmetric == 3, full circle &amp; non-symmetric </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00112">112</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordtype">integer</span> iq_grid</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a963143023740f28785564d46ed2fbcd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a963143023740f28785564d46ed2fbcd5">&#9670;&nbsp;</a></span>iq_integ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_integ</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>option to output integration results ==0 no output of integration ==1 only sum per locus ==2 also information per point on locus ==3 only basic line integrals </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00117">117</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keywordtype">integer</span> iq_integ</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>.</p>

</div>
</div>
<a id="aed682103bd094932e26dfa253bdb4b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed682103bd094932e26dfa253bdb4b17">&#9670;&nbsp;</a></span>iq_interp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_interp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>type of interpolation to retrieve action density == 1, bi-linear interpolation in discrete spectrum (default) == 2, take nearest bins, on the basis of maximum weight </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00123">123</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keywordtype">integer</span> iq_interp</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a02eb3cd3792091fbecb91aa0ba4f377f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02eb3cd3792091fbecb91aa0ba4f377f">&#9670;&nbsp;</a></span>iq_locus</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_locus</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Option for computation of locus ==1, explicit polar method with fixed k-step ==2, explicit polar method with adpative k-stepping ==3, explicit polar method with geometric k-spacing. </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00127">127</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="keywordtype">integer</span> iq_locus</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>.</p>

</div>
</div>
<a id="a26b22f0d60d8da52d1ac23e994ffb933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26b22f0d60d8da52d1ac23e994ffb933">&#9670;&nbsp;</a></span>iq_log</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_log</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate logging to file QBASE//.LOG == 0, No print output == 1, print output </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00132">132</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keywordtype">integer</span> iq_log</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a06c7d003be1fb5c2aa2fca658ff2cc25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c7d003be1fb5c2aa2fca658ff2cc25">&#9670;&nbsp;</a></span>iq_lump</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_lump</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate lumping on locus == 0, No lumping == 1, Lumping along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00136">136</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keywordtype">integer</span> iq_lump</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="ad6f7f4edb872ea6752263882485507d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6f7f4edb872ea6752263882485507d5">&#9670;&nbsp;</a></span>iq_make</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_make</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>option to make quadruplet grid == 1, make when needed (default) == 2, always make quadruplet grid == 3, only make grid file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00140">140</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">integer</span> iq_make</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="aab9ea4aacc4d0b48d749a5405e14b908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9ea4aacc4d0b48d749a5405e14b908">&#9670;&nbsp;</a></span>iq_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>option to redistribute points on locus == 0, Points will be used as computed by tracing algortihm == 1, Equi-distant spacing on points along locus (NLOC1) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00145">145</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keywordtype">integer</span> iq_mod</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>.</p>

</div>
</div>
<a id="a0d202f34d86298cd2963b740974bee7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d202f34d86298cd2963b740974bee7f">&#9670;&nbsp;</a></span>iq_prt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_prt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate print output, to file QBASE//.PRT == 0, No print output == 1, print output </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00149">149</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keywordtype">integer</span> iq_prt</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a50f40339e2bb037c73f2997ebae6008b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50f40339e2bb037c73f2997ebae6008b">&#9670;&nbsp;</a></span>iq_screen</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_screen</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>option to send output to the screen == 0, no output is send to screen == 1, output is send to screen </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00157">157</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordtype">integer</span> iq_screen</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="afa99286d05e9868b1eaa97f90a9e18e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa99286d05e9868b1eaa97f90a9e18e1">&#9670;&nbsp;</a></span>iq_search</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_search</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to determine search for a proper grid == 0, no search is carried out == 1, search nearest (relative) interaction grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00153">153</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">integer</span> iq_search</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a2a7e684ddf07b56f2fbe88aa538f050f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a7e684ddf07b56f2fbe88aa538f050f">&#9670;&nbsp;</a></span>iq_stack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_stack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sequence number of stack with subroutine calls. </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00375">375</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordtype">integer</span> iq_stack</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="aade281f03901b3f16bd2c1498c0138f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aade281f03901b3f16bd2c1498c0138f7">&#9670;&nbsp;</a></span>iq_sym</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_sym</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate use of symmetry reduction == 0, no symmetries are used == 1, symmetry activated (default) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00161">161</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keywordtype">integer</span> iq_sym</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05649">q_symmetry()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a2c38e70a1d9d4e22f79a1cd0bcc0094b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c38e70a1d9d4e22f79a1cd0bcc0094b">&#9670;&nbsp;</a></span>iq_t13</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_t13</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>option to output T13 integration ==0, no output ==1, test output of T13 per locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00179">179</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">integer</span> iq_t13</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>.</p>

</div>
</div>
<a id="aff335314701f2a997cf281b8ef24333e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff335314701f2a997cf281b8ef24333e">&#9670;&nbsp;</a></span>iq_test</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_test</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>test level, output is directed to unit luqtst == 0, no test output == 1, output of basic I/O == 2, extensive test output </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00165">165</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordtype">integer</span> iq_test</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="ab2ea24b2a8c955c8cde114315c77f181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2ea24b2a8c955c8cde114315c77f181">&#9670;&nbsp;</a></span>iq_trace</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_trace</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>trace option == 0, no trace of subroutine calls </p><blockquote class="doxtable">
<p>0, maximum number of traces per subroutine </p>
</blockquote>
<p>&lt; 0, as for &gt;0 but now output is send to the screen </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00170">170</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">integer</span> iq_trace</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="abb85d5631ab20957d133ecf6557af63f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb85d5631ab20957d133ecf6557af63f">&#9670;&nbsp;</a></span>iq_trf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_trf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>option to print transformed loci to special output file == 0, no output to data file unit luqtrf == 1, test output from routine Q_GETLOCUS </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00175">175</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keywordtype">integer</span> iq_trf</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>.</p>

</div>
</div>
<a id="a30e618ab1280298dd1149e5093f7c3c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e618ab1280298dd1149e5093f7c3c1">&#9670;&nbsp;</a></span>iq_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_type</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>method for computing the nonlinear interactions depending on the value of iq_type a number of settings for other processes or schematizations are set in Q_COMPU iq_type==1: deep water, symmetric spectrum, Webb coupling coefficient 2: deep water computation with WAM depth scaling based on Herterich and Hasselmann (1980) 3: finite depth transfer </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00414">414</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">integer</span> iq_type</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a2d4ba4f63b1f15233f5539c40549ff16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d4ba4f63b1f15233f5539c40549ff16">&#9670;&nbsp;</a></span>iq_warn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_warn</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counts the number of warnings </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00428">428</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordtype">integer</span> iq_warn</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a3ee14fd57aa10dee1011d596d345b5b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ee14fd57aa10dee1011d596d345b5b3">&#9670;&nbsp;</a></span>iq_xdia</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iq_xdia</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>switch to activate output to extended DIA data file == 0, no output </p><blockquote class="doxtable">
<p>0, output to data file, but only when lumping is also </p>
</blockquote>
<p>activated </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00183">183</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">integer</span> iq_xdia</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>.</p>

</div>
</div>
<a id="acca2bd5d5e6eafbeb66a65072acb065d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca2bd5d5e6eafbeb66a65072acb065d">&#9670;&nbsp;</a></span>iscreen</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iscreen</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>identifier for screen, set in XNL_INIT </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00046">46</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">integer</span> iscreen</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a1d24e90b920b4e71c3da78825c60a13c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d24e90b920b4e71c3da78825c60a13c">&#9670;&nbsp;</a></span>iufind</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::iufind</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specifies handling of unit numbers, see Z_FILEIO. </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00045">45</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keywordtype">integer</span> iufind</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a6c393865efe624bc27bfc6f068ee74a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c393865efe624bc27bfc6f068ee74a1">&#9670;&nbsp;</a></span>jac_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::jac_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>jacobian term around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00283">283</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: jac_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a0caa2f24a4e16719a0cc6c11f683d349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0caa2f24a4e16719a0cc6c11f683d349">&#9670;&nbsp;</a></span>jac_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::jac_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>jacobian term around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00300">300</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: jac_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="aab6d1a00ffe8a6c91896110c640ff402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab6d1a00ffe8a6c91896110c640ff402">&#9670;&nbsp;</a></span>k0x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k0x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00226">226</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordtype">real</span> k0x,k0y,dk0</div>
</div><!-- fragment -->
</div>
</div>
<a id="a041751cc824cafdaf24624ff5af0fb69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a041751cc824cafdaf24624ff5af0fb69">&#9670;&nbsp;</a></span>k0y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k0y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00226">226</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

</div>
</div>
<a id="a3acca3377ede458f0ba14e51d44b4847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acca3377ede458f0ba14e51d44b4847">&#9670;&nbsp;</a></span>k1x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k1x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">228</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordtype">real</span> k1x,k1y</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="ae2558671eeb48c3f059553bf7e16e792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2558671eeb48c3f059553bf7e16e792">&#9670;&nbsp;</a></span>k1y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k1y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of k1 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00228">228</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="a5f8de263206e38bc42973c764421b61d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f8de263206e38bc42973c764421b61d">&#9670;&nbsp;</a></span>k2a_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::k2a_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k2 angle around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00305">305</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: k2a_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="af8ca8b3d951a528df659173a6e9e152e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8ca8b3d951a528df659173a6e9e152e">&#9670;&nbsp;</a></span>k2m_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::k2m_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k2 magnitude around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00304">304</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: k2m_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="ae3691085cb58f456402d0f7cfe461f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3691085cb58f456402d0f7cfe461f81">&#9670;&nbsp;</a></span>k2x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k2x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">229</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">real</span> k2x,k2y</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="a673397afc565764bdfff44ecc3086116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673397afc565764bdfff44ecc3086116">&#9670;&nbsp;</a></span>k2y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k2y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of k2 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00229">229</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="a8df856343867fb5a121c86f605d6d53e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8df856343867fb5a121c86f605d6d53e">&#9670;&nbsp;</a></span>k3x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k3x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">230</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">real</span> k3x,k3y</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="a9e85dbc26336ce6fe32b37724c157f9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e85dbc26336ce6fe32b37724c157f9c">&#9670;&nbsp;</a></span>k3y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k3y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of k3 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00230">230</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07491">xc_hh()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="ad632e990f940408ace63600467f6b3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad632e990f940408ace63600467f6b3ec">&#9670;&nbsp;</a></span>k4a_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::k4a_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k4 angle around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00307">307</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: k4a_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="ab2af97dc5f43404ffcbeb2b5b461f084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2af97dc5f43404ffcbeb2b5b461f084">&#9670;&nbsp;</a></span>k4m_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::k4m_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k4 magnitude around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00306">306</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: k4m_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a8616e7db84d163c9549bb3c9dd31b791"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8616e7db84d163c9549bb3c9dd31b791">&#9670;&nbsp;</a></span>k4x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k4x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">231</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keywordtype">real</span> k4x,k4y</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="a4561119545155572e7f65e06d0d4508a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4561119545155572e7f65e06d0d4508a">&#9670;&nbsp;</a></span>k4y</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::k4y</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of k4 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00231">231</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06855">x_cple()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07856">xc_webb()</a>.</p>

</div>
</div>
<a id="a46bcaf9843ef210498818ecbcd030b84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46bcaf9843ef210498818ecbcd030b84">&#9670;&nbsp;</a></span>k_pol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::k_pol</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wave numbers during polar generation of locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00287">287</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: k_pol(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a9a3f517e3a651d8c58f341c843623cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a3f517e3a651d8c58f341c843623cd9">&#9670;&nbsp;</a></span>klocus</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::klocus</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of points on locus as stored in quadruplet database based on nlocus0, iq_gauleg and iq_lump (without compacting) used in Q_ALLOCATE to define size of data arrays </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00216">216</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keywordtype">integer</span> klocus</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a8339223e9dc7b7b2b0fd4d873b9992c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8339223e9dc7b7b2b0fd4d873b9992c8">&#9670;&nbsp;</a></span>kmax_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kmax_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum wave number of locus along symmetry axis </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00239">239</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordtype">real</span> kmax_loc</div>
</div><!-- fragment -->
</div>
</div>
<a id="affd31eece3f4e587d0bf9c3e33d49306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affd31eece3f4e587d0bf9c3e33d49306">&#9670;&nbsp;</a></span>kmid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kmid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wave number at midpoint of locus along symmetry axis </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00240">240</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordtype">real</span> kmid</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>.</p>

</div>
</div>
<a id="a149291bfacd3886cd7f72f919ea1a787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a149291bfacd3886cd7f72f919ea1a787">&#9670;&nbsp;</a></span>kmidx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kmidx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>x-component of wave number at midpoint of locus along symmetry axis </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00241">241</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordtype">real</span> kmidx</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="aed5e532e6483bc2bed978b4955bf07c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed5e532e6483bc2bed978b4955bf07c3">&#9670;&nbsp;</a></span>kmidy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kmidy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>y-component of wave number at midpoint of locus along symmetry axis </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00242">242</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordtype">real</span> kmidy</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="a1c7faae7970cb9c5be136a678b53e4a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c7faae7970cb9c5be136a678b53e4a0">&#9670;&nbsp;</a></span>kmin_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kmin_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>minimum wave number of locus along symmetry axis </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00238">238</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">real</span> kmin_loc</div>
</div><!-- fragment -->
</div>
</div>
<a id="a08ff074f6a5223b539887fa77119ad14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08ff074f6a5223b539887fa77119ad14">&#9670;&nbsp;</a></span>kqmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kqmax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>highest wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00223">223</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordtype">real</span> kqmax</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="ab603fdb5c4cef293ad21277b732d1e0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab603fdb5c4cef293ad21277b732d1e0f">&#9670;&nbsp;</a></span>kqmin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::kqmin</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lowest wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00222">222</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="keywordtype">real</span> kqmin</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a95356901458fad47880a7c10d4efd04d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95356901458fad47880a7c10d4efd04d">&#9670;&nbsp;</a></span>krefx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::krefx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00227">227</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordtype">real</span> krefx,krefy</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a5d8dc502f4817710ba1ac75e73fa7fc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d8dc502f4817710ba1ac75e73fa7fc5">&#9670;&nbsp;</a></span>krefy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::krefy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of reference wave number for quad-grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00227">227</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a7eff2120543a7c553e1ba636c6659115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eff2120543a7c553e1ba636c6659115">&#9670;&nbsp;</a></span>lastquadfile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=13) m_xnldata::lastquadfile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>name of last retrieved BQF file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00194">194</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">character(len=13)</span> lastquadfile</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="af991e25b021da4285ba22b9f677c34a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af991e25b021da4285ba22b9f677c34a5">&#9670;&nbsp;</a></span>loc_area</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::loc_area</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>area of locus, measured in (kx-ky)- space </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00244">244</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordtype">real</span> loc_area</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b525effd10d546626b2ebc6628336f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b525effd10d546626b2ebc6628336f2">&#9670;&nbsp;</a></span>loc_crf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::loc_crf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>circumference of locus in (kx,ky)-space </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00243">243</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordtype">real</span> loc_crf</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c39966f160780b68a982388b3b730c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c39966f160780b68a982388b3b730c4">&#9670;&nbsp;</a></span>loc_xz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::loc_xz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>x-coordinate of center of gravity of locus in (kx,ky)-space </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00245">245</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordtype">real</span> loc_xz</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20adeb936abb79f88d17054ae4b34dc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20adeb936abb79f88d17054ae4b34dc5">&#9670;&nbsp;</a></span>loc_yz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::loc_yz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>y-coordinate of center of gravity of locus in (kx,ky)-space </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00246">246</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keywordtype">real</span> loc_yz</div>
</div><!-- fragment -->
</div>
</div>
<a id="acf0463f0d2fdbf7d9652f8a1fd28ed95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0463f0d2fdbf7d9652f8a1fd28ed95">&#9670;&nbsp;</a></span>lq_grid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical m_xnldata::lq_grid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>flag to make (new) interaction grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00197">197</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keywordtype">logical</span> lq_grid</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>.</p>

</div>
</div>
<a id="adc20f07b42814fd02171cdb4307ae2d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc20f07b42814fd02171cdb4307ae2d5">&#9670;&nbsp;</a></span>luq_bqf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_bqf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>binary file storing and retrieving precomputed loci </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00050">50</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">integer</span> luq_bqf</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a2acd9b30aca3d7e0475ec8582f23b236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2acd9b30aca3d7e0475ec8582f23b236">&#9670;&nbsp;</a></span>luq_cfg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_cfg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>user defined configuration </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00051">51</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">integer</span> luq_cfg</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="aad41073b37810f66db5ca6367a15cb7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad41073b37810f66db5ca6367a15cb7e">&#9670;&nbsp;</a></span>luq_err</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_err</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>file with error messages </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00052">52</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">integer</span> luq_err</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a21651d79bd4d62c1d07b524a62007bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21651d79bd4d62c1d07b524a62007bea">&#9670;&nbsp;</a></span>luq_fil</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_fil</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>test output for filtering </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00053">53</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keywordtype">integer</span> luq_fil</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="adf9a9f09de8a4e162e5f24e7a6bda2a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf9a9f09de8a4e162e5f24e7a6bda2a5">&#9670;&nbsp;</a></span>luq_grd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_grd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ASCII file storing and retrieving precomputed loci. </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00054">54</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keywordtype">integer</span> luq_grd</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="ad9a1e6b4cf40069be1bfe42393b374f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a1e6b4cf40069be1bfe42393b374f9">&#9670;&nbsp;</a></span>luq_int</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_int</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>test file for test output of integration </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00055">55</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordtype">integer</span> luq_int</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="aa37c58de84119f966e1bb23c61639319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa37c58de84119f966e1bb23c61639319">&#9670;&nbsp;</a></span>luq_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>statistics about computed loci </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00056">56</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">integer</span> luq_loc</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a1ec49dfc7d79d18380bdeebd1dd94852"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ec49dfc7d79d18380bdeebd1dd94852">&#9670;&nbsp;</a></span>luq_log</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_log</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>logging </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00057">57</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordtype">integer</span> luq_log</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a8ff6ed69e78c7163ddfd4899d903dff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ff6ed69e78c7163ddfd4899d903dff7">&#9670;&nbsp;</a></span>luq_prt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_prt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>general print file for quadruplets </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00058">58</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordtype">integer</span> luq_prt</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="ac8a789882ef4e35c7e29b420b598e3c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8a789882ef4e35c7e29b420b598e3c8">&#9670;&nbsp;</a></span>luq_t13</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_t13</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>test of basis integration </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00062">62</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keywordtype">integer</span> luq_t13</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="ac2301404cba01dec0bafd86109736084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2301404cba01dec0bafd86109736084">&#9670;&nbsp;</a></span>luq_trf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_trf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>testing transformation of loci </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00059">59</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">integer</span> luq_trf</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="afe947eb3c1c57d59e46ef98216f981e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe947eb3c1c57d59e46ef98216f981e1">&#9670;&nbsp;</a></span>luq_tst</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_tst</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>test file for quadruplets </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00060">60</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keywordtype">integer</span> luq_tst</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a8360cc8137e23947c0961b9c2779ed34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8360cc8137e23947c0961b9c2779ed34">&#9670;&nbsp;</a></span>luq_txt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::luq_txt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reading (error) text file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00061">61</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">integer</span> luq_txt</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="aefa3be0ccc65d9dfcc19980a7965b6d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa3be0ccc65d9dfcc19980a7965b6d9">&#9670;&nbsp;</a></span>mlocus</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::mlocus</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum number of points on locus for defining arrays </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00213">213</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordtype">integer</span> mlocus</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a59e28829b99a12aa264b615a27367c90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e28829b99a12aa264b615a27367c90">&#9670;&nbsp;</a></span>mq_stack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter m_xnldata::mq_stack =10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum number of elements in stack </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00211">211</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: mq_stack=10</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>.</p>

</div>
</div>
<a id="a892097baba649c18e166ba6ca3790627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a892097baba649c18e166ba6ca3790627">&#9670;&nbsp;</a></span>naq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::naq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of angles of quad-grad </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00200">200</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">integer</span> naq</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a594939a0849f6bdbacb759322e2c6f3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594939a0849f6bdbacb759322e2c6f3a">&#9670;&nbsp;</a></span>ncirc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::ncirc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of angles on a full circle </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00201">201</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">integer</span> ncirc</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="add9ce8583107604b5ba49b2df0c4296a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9ce8583107604b5ba49b2df0c4296a">&#9670;&nbsp;</a></span>nk1d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::nk1d</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Internal 1d action density spectrum N(k) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00360">360</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: nk1d(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>.</p>

</div>
</div>
<a id="ac2d8e58f049a74249c26e826c42ea746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d8e58f049a74249c26e826c42ea746">&#9670;&nbsp;</a></span>nkq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::nkq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of wave numbers of quad-grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00199">199</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">integer</span> nkq</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a35d60e16256ccf677d998690848893e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35d60e16256ccf677d998690848893e1">&#9670;&nbsp;</a></span>nlocus</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::nlocus</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of points on locus, equal to klocus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00219">219</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="keywordtype">integer</span> nlocus</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a25da92c2f4d1c9b2d64fc2f6180cd71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25da92c2f4d1c9b2d64fc2f6180cd71b">&#9670;&nbsp;</a></span>nlocus0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::nlocus0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>preferred number of points on locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00214">214</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordtype">integer</span> nlocus0</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a164925e899cc3811d6e67e27a6444668"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a164925e899cc3811d6e67e27a6444668">&#9670;&nbsp;</a></span>nlocus1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::nlocus1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of points on locus as computed in Q_CMPLOCUS </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00215">215</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">integer</span> nlocus1</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a5b999bfd5e20c548574dfbe58a5b6757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b999bfd5e20c548574dfbe58a5b6757">&#9670;&nbsp;</a></span>nlocusx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer m_xnldata::nlocusx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of points on locus for use in computation (nlocusx &lt;= nlocus) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00220">220</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordtype">integer</span> nlocusx</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="ac542cbbb015e7c01438ff76f47331b7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac542cbbb015e7c01438ff76f47331b7d">&#9670;&nbsp;</a></span>nspec</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:), allocatable m_xnldata::nspec</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Action density on wave number grid N(kx,ky) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00359">359</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: nspec(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a5bf9102cbc1070153da7ef11c935e680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bf9102cbc1070153da7ef11c935e680">&#9670;&nbsp;</a></span>pang</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::pang</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>angle related of P-vector, Pang = atan2(py,px), (radians) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00234">234</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordtype">real</span> pang</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a88fc0d051acac56c9ee6e7703854e487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88fc0d051acac56c9ee6e7703854e487">&#9670;&nbsp;</a></span>pmag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::pmag</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>magnitude of P-vector </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00233">233</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keywordtype">real</span> pmag</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">x_locus1()</a>.</p>

</div>
</div>
<a id="a2aeb9d65457d61b7580470a3225da822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aeb9d65457d61b7580470a3225da822">&#9670;&nbsp;</a></span>px</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::px</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">232</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordtype">real</span> px,py</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="a8e9e4a82f3786e8d671bdbf12e6dd2c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e9e4a82f3786e8d671bdbf12e6dd2c2">&#9670;&nbsp;</a></span>py</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::py</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>components of difference k1-k3 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00232">232</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="a135db6bb97ae1e726b67be80c0facc85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135db6bb97ae1e726b67be80c0facc85">&#9670;&nbsp;</a></span>q</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>difference of radian frequencies, used in Resio-Tracy method </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00237">237</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordtype">real</span> q</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03414">q_locpos()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">x_locus1()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>.</p>

</div>
</div>
<a id="ab4c66c0c23b2ec5e398398b2c859d9eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4c66c0c23b2ec5e398398b2c859d9eb">&#9670;&nbsp;</a></span>q_a</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_a</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>directions of quadruplet grid in radians </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00356">356</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_a(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>.</p>

</div>
</div>
<a id="aea8cf76fc832adb65c102b7ce50d8ef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea8cf76fc832adb65c102b7ce50d8ef5">&#9670;&nbsp;</a></span>q_ad</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_ad</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>directions of quadruplet grid in degrees </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00357">357</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_ad(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a78a24ce3e5718c2586c6a4401cb177b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78a24ce3e5718c2586c6a4401cb177b9">&#9670;&nbsp;</a></span>q_ang1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_ang1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00389">389</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="keywordtype">real</span> q_ang1,q_ang2</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a9c5854c10849ea9caebe520a6bf2b05a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c5854c10849ea9caebe520a6bf2b05a">&#9670;&nbsp;</a></span>q_ang2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_ang2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lower and upper angle of grid in degrees </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00389">389</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a20c30e6edbbfe7ca97b92abec94548fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20c30e6edbbfe7ca97b92abec94548fb">&#9670;&nbsp;</a></span>q_cg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_cg</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>group velocity (m/s) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00355">355</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_cg(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="aee89bd69c57844dc31d608d6b2d9edd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee89bd69c57844dc31d608d6b2d9edd8">&#9670;&nbsp;</a></span>q_delta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_delta</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>directional spacing of angular grid in radians </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00390">390</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordtype">real</span> q_delta</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="ac66d65228d91a1d376045db84a2157da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac66d65228d91a1d376045db84a2157da">&#9670;&nbsp;</a></span>q_deltad</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_deltad</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>directional spacing of angular grid in degrees </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00391">391</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordtype">real</span> q_deltad</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a48f96f689a5f42f67909ec89f8dbb57f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f96f689a5f42f67909ec89f8dbb57f">&#9670;&nbsp;</a></span>q_depth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_depth</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>local water depth in m </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00365">365</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordtype">real</span> q_depth</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06965">x_flocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07073">x_jacobian()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07286">x_locus1()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07382">x_locus2()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="ac29197d52e87f26bc58b886d74568da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac29197d52e87f26bc58b886d74568da1">&#9670;&nbsp;</a></span>q_df</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_df</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>step size of frequency grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00352">352</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_df(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a0c17545ef90fd5f0593cc0597ff090c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c17545ef90fd5f0593cc0597ff090c4">&#9670;&nbsp;</a></span>q_dird1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_dird1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00364">364</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordtype">real</span> q_dird1,q_dird2</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a8bce339b695868b533e5edd433e6289b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bce339b695868b533e5edd433e6289b">&#9670;&nbsp;</a></span>q_dird2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_dird2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>first and last direction of host model (via XNL_INIT) degrees </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00364">364</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a3b9aaf0fdbaa8517c8520c12a6b77dd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9aaf0fdbaa8517c8520c12a6b77dd7">&#9670;&nbsp;</a></span>q_dk</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_dk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>width of wave number bins [1/m] </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00349">349</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_dk(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="aa93634c09dd4ffed3aba8274949dc2e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93634c09dd4ffed3aba8274949dc2e1">&#9670;&nbsp;</a></span>q_dsig</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_dsig</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>step size of radian frequency grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00354">354</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_dsig(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a2dc7dbb0f9ee0c9ff2187b836a7daf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dc7dbb0f9ee0c9ff2187b836a7daf98">&#9670;&nbsp;</a></span>q_dstep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_dstep</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>step size for generating BQF files </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00209">209</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordtype">real</span> q_dstep</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a84de770c868645f09f95e5497f3c2013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84de770c868645f09f95e5497f3c2013">&#9670;&nbsp;</a></span>q_f</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>frequencies accociated to wave number/depth </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00351">351</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_f(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a7719382ccbfa3dff7b5c6610ba5da474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7719382ccbfa3dff7b5c6610ba5da474">&#9670;&nbsp;</a></span>q_ffac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_ffac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>geometric factor between subsequent frequencies </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00393">393</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">real</span> q_ffac</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a9aaf6eee0e395f218469687e95f562e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aaf6eee0e395f218469687e95f562e0">&#9670;&nbsp;</a></span>q_grav</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_grav</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gravitational acceleration (Earth = 9.81 m/s^2) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00066">66</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordtype">real</span> q_grav</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06753">x_cosk()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07191">x_disper()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l07073">x_jacobian()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a2d0ddfe44e1fba307f78c25c198a702b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d0ddfe44e1fba307f78c25c198a702b">&#9670;&nbsp;</a></span>q_header</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=21) m_xnldata::q_header</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>header of Binary Quadruplet File as intended in BQF-file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00195">195</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">character(len=21)</span> q_header</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a77f4b5c29c04a2fa6684c716e9a40e1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77f4b5c29c04a2fa6684c716e9a40e1e">&#9670;&nbsp;</a></span>q_k</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_k</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wave number grid [1/m] </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00348">348</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_k(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a690a5866e28f3a514e5b818da0d13a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a690a5866e28f3a514e5b818da0d13a88">&#9670;&nbsp;</a></span>q_kfac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_kfac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>geometric factor between subsequent wave numbers (only valid for IQ_IDISP==1) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00394">394</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordtype">real</span> q_kfac</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="ac0fced0b6c23a202efa4db529f2c638b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0fced0b6c23a202efa4db529f2c638b">&#9670;&nbsp;</a></span>q_kpow</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_kpow</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wave number to a certain power, used in filtering </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00350">350</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_kpow(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="ac4d6b9532b9a0a0dd775d6ac3035756d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4d6b9532b9a0a0dd775d6ac3035756d">&#9670;&nbsp;</a></span>q_lambda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_lambda</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>geometric scaling factor for 'deep' water loci </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00368">368</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">real</span> q_lambda</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9199c625e11bd438cd857b89e8b35ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9199c625e11bd438cd857b89e8b35ca9">&#9670;&nbsp;</a></span>q_maxdepth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_maxdepth</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum water depth, set in XNL_INIT, used in Q_CTRGRID </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00366">366</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordtype">real</span> q_maxdepth</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a1755f26af2d9ff9e3753a7df57693ac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1755f26af2d9ff9e3753a7df57693ac9">&#9670;&nbsp;</a></span>q_mindepth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_mindepth</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>minimum water depth, set in XNL_INIT, used in Q_CTRGRID </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00367">367</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordtype">real</span> q_mindepth</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00810">xnl_main()</a>.</p>

</div>
</div>
<a id="a8b03b60bbb7125cc36a223f3ebc2c945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b03b60bbb7125cc36a223f3ebc2c945">&#9670;&nbsp;</a></span>q_scale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_scale</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>additional scale factor resulting from SEARCH for neasrest grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00369">369</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keywordtype">real</span> q_scale</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a07d80238233004e27de64b1c08d14741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d80238233004e27de64b1c08d14741">&#9670;&nbsp;</a></span>q_sector</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::q_sector</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>half plane width in degrees (for iq_grid=1,2) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00208">208</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keywordtype">real</span> q_sector</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>.</p>

</div>
</div>
<a id="ae892eba6d5dc89be9bc96cf8388ea396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae892eba6d5dc89be9bc96cf8388ea396">&#9670;&nbsp;</a></span>q_sig</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_sig</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>radian frequencies associated to wave number/depth </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00353">353</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_sig(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01435">q_chkcons()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05051">q_searchgrid()</a>.</p>

</div>
</div>
<a id="a60c0c64434dfd93e596fe73e8150e2d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60c0c64434dfd93e596fe73e8150e2d3">&#9670;&nbsp;</a></span>q_sk</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_sk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>step size of extended wave number array </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00345">345</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_sk(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="af861a71e902542f5524190c427fc0c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af861a71e902542f5524190c427fc0c76">&#9670;&nbsp;</a></span>q_version</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=60) m_xnldata::q_version</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>version string </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00039">39</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keywordtype">character(len=60)</span> q_version</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05279">q_setversion()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a17f8772f7c0033bba0e79076c6541743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17f8772f7c0033bba0e79076c6541743">&#9670;&nbsp;</a></span>q_xk</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::q_xk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>extended wave number array starting at index 0 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00344">344</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: q_xk(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="afccd3d55f6be4945f4957410cc8e6013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afccd3d55f6be4945f4957410cc8e6013">&#9670;&nbsp;</a></span>qbase</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=20) m_xnldata::qbase</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>base name for I/O files </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00042">42</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">character(len=20)</span> qbase</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a9d34e8bb37044cf35eadd59e74223f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d34e8bb37044cf35eadd59e74223f21">&#9670;&nbsp;</a></span>qf_dmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::qf_dmax</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum directional difference between k1 and k3 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00073">73</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">real</span> qf_dmax</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a43500618bd9c257312f55cc1870094f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43500618bd9c257312f55cc1870094f9">&#9670;&nbsp;</a></span>qf_error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=20) m_xnldata::qf_error</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>name of file with error messages </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00043">43</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keywordtype">character(len=20)</span> qf_error</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l02544">q_error()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="af6b21684aa8aef92a21fb613083a1683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6b21684aa8aef92a21fb613083a1683">&#9670;&nbsp;</a></span>qf_frac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::qf_frac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>fraction of maximum action density to filter </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00074">74</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">real</span> qf_frac</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a49e22f19e05ef43d0328cb1e2e84360e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49e22f19e05ef43d0328cb1e2e84360e">&#9670;&nbsp;</a></span>qf_krat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::qf_krat</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum ratio of the interacting wave numbers k1 and k3 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00072">72</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordtype">real</span> qf_krat</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l04795">q_setconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l05431">q_summary()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l06373">q_xnl4v4()</a>.</p>

</div>
</div>
<a id="a545f769cfbe27f5b40b37b1ca9229f43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a545f769cfbe27f5b40b37b1ca9229f43">&#9670;&nbsp;</a></span>qf_tail</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::qf_tail</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>power of spectral tail of E(f), e.g. </p>
<p>-4,, -4.5, -5 these values must be set in the interface routine </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00067">67</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keywordtype">real</span> qf_tail</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01237">q_chkconfig()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l00465">xnl_init()</a>.</p>

</div>
</div>
<a id="a6e648f3d54323e0bc65fd19b3d7ec496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e648f3d54323e0bc65fd19b3d7ec496">&#9670;&nbsp;</a></span>qk_tail</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::qk_tail</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>power of spectral tail of N(k), computed from qf_tail </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00396">396</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordtype">real</span> qk_tail</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="ae615498c9d1217d8d7a32e52d4f1dfc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae615498c9d1217d8d7a32e52d4f1dfc0">&#9670;&nbsp;</a></span>qnl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:), allocatable m_xnldata::qnl</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nonlinear energy transfer Snl(k,theta) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00361">361</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: qnl(:,:)</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac74919ffb265b571762fc979f259d1bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac74919ffb265b571762fc979f259d1bd">&#9670;&nbsp;</a></span>quad_ia2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:,:), allocatable m_xnldata::quad_ia2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lower direction index of k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00261">261</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: quad_ia2(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="aeb30d1c8b2816175237b40558570a961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb30d1c8b2816175237b40558570a961">&#9670;&nbsp;</a></span>quad_ia4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:,:), allocatable m_xnldata::quad_ia4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lower direction index of k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00263">263</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: quad_ia4(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a3ab423cfec06bb252849d4885942eb48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab423cfec06bb252849d4885942eb48">&#9670;&nbsp;</a></span>quad_ik2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:,:), allocatable m_xnldata::quad_ik2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lower wave number index of k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00260">260</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: quad_ik2(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="aa602bfc167b9ac4f557cee27f86d60fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa602bfc167b9ac4f557cee27f86d60fd">&#9670;&nbsp;</a></span>quad_ik4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:,:), allocatable m_xnldata::quad_ik4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>lower wave number index of k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00262">262</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: quad_ik4(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a28c6570d8fa72ab30ad2a445a7486e60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c6570d8fa72ab30ad2a445a7486e60">&#9670;&nbsp;</a></span>quad_nloc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable m_xnldata::quad_nloc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of points on locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00259">259</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: quad_nloc(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="af170a30466441836902d5b264e98c368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af170a30466441836902d5b264e98c368">&#9670;&nbsp;</a></span>quad_w1k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w1k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 1 of k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00264">264</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w1k2(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a7e9543d0ea33d2ba1e00d6cbaf2669d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e9543d0ea33d2ba1e00d6cbaf2669d6">&#9670;&nbsp;</a></span>quad_w1k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w1k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 1 of k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00268">268</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w1k4(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a9a2e57572040fa7681ea211168a7f971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a2e57572040fa7681ea211168a7f971">&#9670;&nbsp;</a></span>quad_w2k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w2k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 2 of k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00265">265</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w2k2(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="aa0dd352ac7a4715f12ffecae748fa16a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0dd352ac7a4715f12ffecae748fa16a">&#9670;&nbsp;</a></span>quad_w2k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w2k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 2 of k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00269">269</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w2k4(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a446449eec8f6973b036be85737f3f68b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a446449eec8f6973b036be85737f3f68b">&#9670;&nbsp;</a></span>quad_w3k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w3k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 3 of k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00266">266</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w3k2(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a4cccb2914229cf1a10530f5b7a101090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cccb2914229cf1a10530f5b7a101090">&#9670;&nbsp;</a></span>quad_w3k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w3k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 3 of k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00270">270</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w3k4(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a969afbebcaa1d38ec5a8264837fdc014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a969afbebcaa1d38ec5a8264837fdc014">&#9670;&nbsp;</a></span>quad_w4k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w4k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 4 of k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00267">267</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w4k2(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a988994539cabf60fd92a75283f29c0af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a988994539cabf60fd92a75283f29c0af">&#9670;&nbsp;</a></span>quad_w4k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable m_xnldata::quad_w4k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight 4 of k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00271">271</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_w4k4(:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a313db439cc038063c7e44fd04b418cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a313db439cc038063c7e44fd04b418cd2">&#9670;&nbsp;</a></span>quad_zz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension  (:,:,:), allocatable m_xnldata::quad_zz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compound product of cple*ds*sym/jac </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00272">272</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: quad_zz  (:,:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>.</p>

</div>
</div>
<a id="a627b455acc37e84e82960dc5dc5ef5b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a627b455acc37e84e82960dc5dc5ef5b3">&#9670;&nbsp;</a></span>r_cple</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_cple</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">340</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

</div>
</div>
<a id="a4fdbfa6e56865892df31cc3295d9ea62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fdbfa6e56865892df31cc3295d9ea62">&#9670;&nbsp;</a></span>r_header</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=21) m_xnldata::r_header</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>header of Binary Quadruplet File as exists in BQF-file </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00196">196</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordtype">character(len=21)</span> r_header</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01968">q_ctrgrid()</a>.</p>

</div>
</div>
<a id="ad3b9ec4d3421fe077239cf3ba0b5519d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3b9ec4d3421fe077239cf3ba0b5519d">&#9670;&nbsp;</a></span>r_ia2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::r_ia2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations r_ia2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00335">335</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: r_ia2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a1a54e45373dd174328179afe0a86bee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a54e45373dd174328179afe0a86bee9">&#9670;&nbsp;</a></span>r_ia4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::r_ia4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations r_ia4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00337">337</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: r_ia4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="af0bb7bb63744bab937276c9f28443cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0bb7bb63744bab937276c9f28443cba">&#9670;&nbsp;</a></span>r_ik2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::r_ik2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations r_ik2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00334">334</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: r_ik2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a7d7c952df577ab7a27a370c1891212f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d7c952df577ab7a27a370c1891212f8">&#9670;&nbsp;</a></span>r_ik4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::r_ik4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations r_ik4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00336">336</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: r_ik4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a92ea35f1c9bc93e8f0dabb3b19ee2f2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92ea35f1c9bc93e8f0dabb3b19ee2f2e">&#9670;&nbsp;</a></span>r_jac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_jac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">340</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

</div>
</div>
<a id="ae0609f7b29b16c5aa51409e3e5e5ffd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0609f7b29b16c5aa51409e3e5e5ffd3">&#9670;&nbsp;</a></span>r_sym</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_sym</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">340</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

</div>
</div>
<a id="a810696946388b8d6ee6f69dc8241fe1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a810696946388b8d6ee6f69dc8241fe1f">&#9670;&nbsp;</a></span>r_w1k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w1k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">338</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: r_w1k2(:),r_w2k2(:),r_w3k2(:),r_w4k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="af9a14d74e431ca4cf58ac070a18d9ef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a14d74e431ca4cf58ac070a18d9ef3">&#9670;&nbsp;</a></span>r_w1k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w1k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">339</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: r_w1k4(:),r_w2k4(:),r_w3k4(:),r_w4k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="aa5ec83c7e9e0d5d04de5aa2e7b16b484"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ec83c7e9e0d5d04de5aa2e7b16b484">&#9670;&nbsp;</a></span>r_w2k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w2k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">338</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="ad5a99f15afb500fb01392c488f21edfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5a99f15afb500fb01392c488f21edfa">&#9670;&nbsp;</a></span>r_w2k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w2k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">339</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a18ed49e84ad6ffb58889b3f615fb2fc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18ed49e84ad6ffb58889b3f615fb2fc5">&#9670;&nbsp;</a></span>r_w3k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w3k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">338</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a18677f8f464fd7aa2acc7cbd67b46a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18677f8f464fd7aa2acc7cbd67b46a4d">&#9670;&nbsp;</a></span>r_w3k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w3k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">339</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a6e492dbe1fc0ea98bdc589f56d843e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e492dbe1fc0ea98bdc589f56d843e7c">&#9670;&nbsp;</a></span>r_w4k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w4k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00338">338</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a29dc29f5c35959cd670a3f7a66784daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29dc29f5c35959cd670a3f7a66784daf">&#9670;&nbsp;</a></span>r_w4k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_w4k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00339">339</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="ae51be316b2d8580c8bd39a6833886fff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae51be316b2d8580c8bd39a6833886fff">&#9670;&nbsp;</a></span>r_ws</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_ws</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>corresponding declarations </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">340</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>

</div>
</div>
<a id="a768115b8a8b53d1a8e74e51ab2e8d262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a768115b8a8b53d1a8e74e51ab2e8d262">&#9670;&nbsp;</a></span>r_zz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::r_zz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00340">340</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: r_zz(:),r_jac(:),r_cple(:),r_sym(:),r_ws(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>.</p>

</div>
</div>
<a id="a20b764a43ea3e56d0488868baba0bc13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b764a43ea3e56d0488868baba0bc13">&#9670;&nbsp;</a></span>rel_k</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::rel_k</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>relative accuracy for equality check of k </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00373">373</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keywordtype">real</span> rel_k</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a21a9a8bdc1e181d31080c3b8083d3fbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21a9a8bdc1e181d31080c3b8083d3fbc">&#9670;&nbsp;</a></span>s_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::s_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>coordinate along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00279">279</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: s_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="ae29bdbe4a2cc599c504db786e0535da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae29bdbe4a2cc599c504db786e0535da1">&#9670;&nbsp;</a></span>s_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::s_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>coordinate along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00298">298</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: s_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="af54cda4c0a294b2beab6e9d01fffd534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af54cda4c0a294b2beab6e9d01fffd534">&#9670;&nbsp;</a></span>sang</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::sang</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>angle of symmytry axis of locus, SANG = PANG +/ pi (radians) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00235">235</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keywordtype">real</span> sang</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="a002c7a391c4be043a2f7a568eafcf75f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a002c7a391c4be043a2f7a568eafcf75f">&#9670;&nbsp;</a></span>sk_max</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::sk_max</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum wave number in extended array </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00346">346</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordtype">real</span> sk_max</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>.</p>

</div>
</div>
<a id="a45eaee06940165c682e7897301a8a706"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45eaee06940165c682e7897301a8a706">&#9670;&nbsp;</a></span>sub_name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(len=20) m_xnldata::sub_name</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Name of active subroutine. </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00041">41</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keywordtype">character(len=20)</span> sub_name</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l05310">q_stack()</a>.</p>

</div>
</div>
<a id="a5b032e514d6a48698dde74aeea1d391c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b032e514d6a48698dde74aeea1d391c">&#9670;&nbsp;</a></span>sym_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::sym_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>factor for symmetry between k3 and k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00285">285</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: sym_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a1af2632155748f950599e9304f195f07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af2632155748f950599e9304f195f07">&#9670;&nbsp;</a></span>sym_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::sym_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>factor for symmetry between k3 and k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00302">302</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: sym_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a9e3926919aa0063c200f44b8684444a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e3926919aa0063c200f44b8684444a4">&#9670;&nbsp;</a></span>t_ia2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::t_ia2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed direction for k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00319">319</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: t_ia2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="accf0e00c69dc28d44aedb13a144dbc68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accf0e00c69dc28d44aedb13a144dbc68">&#9670;&nbsp;</a></span>t_ia4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::t_ia4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight for k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00321">321</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: t_ia4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a8b9e0167fd2a31137381514370bf126b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9e0167fd2a31137381514370bf126b">&#9670;&nbsp;</a></span>t_ik2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::t_ik2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight for k2-magnitude </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00318">318</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: t_ik2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a59a08463eb3268b4456e5a4ad17bf5c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a08463eb3268b4456e5a4ad17bf5c5">&#9670;&nbsp;</a></span>t_ik4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable m_xnldata::t_ik4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed tail factor for k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00320">320</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">integer</span>, <span class="keywordtype">allocatable</span> :: t_ik4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="ae082b94b98258fd4ffa6317f9d5da5ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae082b94b98258fd4ffa6317f9d5da5ff">&#9670;&nbsp;</a></span>t_w1k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w1k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 1 for k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00322">322</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w1k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a65fa739a64416bcd661c22daaa8b9020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65fa739a64416bcd661c22daaa8b9020">&#9670;&nbsp;</a></span>t_w1k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w1k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 1 for k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00326">326</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w1k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a42176c40aca0500c8035997abbcaba40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42176c40aca0500c8035997abbcaba40">&#9670;&nbsp;</a></span>t_w2k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w2k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 2 for k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00323">323</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w2k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a1627978fb71ce27b204f93291f20cdef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1627978fb71ce27b204f93291f20cdef">&#9670;&nbsp;</a></span>t_w2k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w2k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 2 for k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00327">327</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w2k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="aa5772bfb43d901c038e487cb6ad4a3d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5772bfb43d901c038e487cb6ad4a3d7">&#9670;&nbsp;</a></span>t_w3k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w3k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 3 for k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00324">324</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w3k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="ae6dfc229c0b3551323b70768d17753e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6dfc229c0b3551323b70768d17753e8">&#9670;&nbsp;</a></span>t_w3k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w3k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 3 for k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00328">328</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w3k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="af5e0df23b7ac6c7476b081baf7e7081e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e0df23b7ac6c7476b081baf7e7081e">&#9670;&nbsp;</a></span>t_w4k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w4k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 4 for k2 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00325">325</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w4k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="a44af2d4292342b12290fbc4810825645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44af2d4292342b12290fbc4810825645">&#9670;&nbsp;</a></span>t_w4k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_w4k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>transformed weight 4 for k4 </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00329">329</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_w4k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="ac15b3919ba7c54299e6e43af50c92de5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac15b3919ba7c54299e6e43af50c92de5">&#9670;&nbsp;</a></span>t_zz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::t_zz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>product term </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00330">330</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: t_zz(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l02742">q_getlocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05746">q_t13v4()</a>.</p>

</div>
</div>
<a id="ad4e1e4e9a3b31456f2958d71b38c6ca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e1e4e9a3b31456f2958d71b38c6ca0">&#9670;&nbsp;</a></span>wa_k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::wa_k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>position of k2 and k4 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00313">313</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: wa_k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="aa27a047564b8f3141b0c20c55fdf73e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa27a047564b8f3141b0c20c55fdf73e2">&#9670;&nbsp;</a></span>wa_k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::wa_k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w.r.t. </p>
<p>discrete a-grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00314">314</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: wa_k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a43978bfef04d1307631389c868cdcaba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43978bfef04d1307631389c868cdcaba">&#9670;&nbsp;</a></span>wk_k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::wk_k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>position of k2 and k4 wave number </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00311">311</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: wk_k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="af65b679dff0eea3a20bba4179510928c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af65b679dff0eea3a20bba4179510928c">&#9670;&nbsp;</a></span>wk_k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::wk_k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>w.r.t. </p>
<p>discrete k-grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00312">312</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: wk_k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a5c848f54117cbb5d484d5147a1e5e45c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c848f54117cbb5d484d5147a1e5e45c">&#9670;&nbsp;</a></span>wk_max</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::wk_max</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>maximum weight for wave number interpolation, set in Q_INIT </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00224">224</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">real</span> wk_max</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l03121">q_init()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="abc85b62ae47ee05c033b80458a39071d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc85b62ae47ee05c033b80458a39071d">&#9670;&nbsp;</a></span>wt_k2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::wt_k2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>weight factor in tail, </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00315">315</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: wt_k2(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="ad3f7fdb8eb2368cd3f449e36ce898f6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3f7fdb8eb2368cd3f449e36ce898f6b">&#9670;&nbsp;</a></span>wt_k4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::wt_k4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wt==1 for wave numbers inside k-grid </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00316">316</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: wt_k4(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l03764">q_makegrid()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l05998">q_weight()</a>.</p>

</div>
</div>
<a id="a73b8aa077cb0729373172c97f167e3a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73b8aa077cb0729373172c97f167e3a8">&#9670;&nbsp;</a></span>x2_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::x2_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k2x coordinates around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00276">276</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: x2_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="ad94cc76b6b10c7ba2b5024f56779b6b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad94cc76b6b10c7ba2b5024f56779b6b5">&#9670;&nbsp;</a></span>x2_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::x2_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k2x coordinates along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00293">293</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: x2_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="aab7b9888db6a273809757c3c6e367dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab7b9888db6a273809757c3c6e367dc8">&#9670;&nbsp;</a></span>x4_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::x4_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k4x coordinates around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00280">280</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: x4_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a18015651e3b35cd47b1ed2df0bdc7c86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18015651e3b35cd47b1ed2df0bdc7c86">&#9670;&nbsp;</a></span>x4_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::x4_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k4x coordinates along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00295">295</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: x4_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a7ce5be605e29382f48a7cf8c9184b5ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce5be605e29382f48a7cf8c9184b5ec">&#9670;&nbsp;</a></span>xang</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real m_xnldata::xang</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>angle of locus for the case that w1=w3, Xang=atan2(-px,py), (radians) </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00236">236</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keywordtype">real</span> xang</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>.</p>

</div>
</div>
<a id="acda9c4812401c8b56b5e04f22ca98785"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda9c4812401c8b56b5e04f22ca98785">&#9670;&nbsp;</a></span>y2_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::y2_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k2y coordinates around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00277">277</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: y2_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04535">q_polar2()</a>.</p>

</div>
</div>
<a id="a4df03ecbf05e49b2452dc145ade574c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df03ecbf05e49b2452dc145ade574c4">&#9670;&nbsp;</a></span>y2_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::y2_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k2y coordinates along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00294">294</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: y2_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="ae0b48f6fffce333c05365b889e43d9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0b48f6fffce333c05365b889e43d9dc">&#9670;&nbsp;</a></span>y4_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::y4_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k4y coordinates around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00281">281</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: y4_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, <a class="el" href="mod__xnl4v5_8f90_source.html#l01677">q_cmplocus()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="af99dde6b89194f24b89069dd9f0ae8b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af99dde6b89194f24b89069dd9f0ae8b9">&#9670;&nbsp;</a></span>y4_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::y4_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>k4y coordinates along locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00296">296</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: y4_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>, and <a class="el" href="mod__xnl4v5_8f90_source.html#l04149">q_modify()</a>.</p>

</div>
</div>
<a id="a2549291b6942c5223a7d019b8ac1c246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2549291b6942c5223a7d019b8ac1c246">&#9670;&nbsp;</a></span>z_loc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::z_loc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>data value around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00278">278</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: z_loc(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>.</p>

</div>
</div>
<a id="ad76093a273e70739be0c4dbcf3d94128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76093a273e70739be0c4dbcf3d94128">&#9670;&nbsp;</a></span>z_mod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable m_xnldata::z_mod</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>data value around locus </p>

<p class="definition">Definition at line <a class="el" href="mod__xnl4v5_8f90_source.html#l00297">297</a> of file <a class="el" href="mod__xnl4v5_8f90_source.html">mod_xnl4v5.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="keywordtype">real</span>, <span class="keywordtype">allocatable</span> :: z_mod(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="mod__xnl4v5_8f90_source.html#l01012">q_allocate()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespaceserv__xnl4v5_html_ac0005154c8695dc5033a829bfb1b3efe"><div class="ttname"><a href="namespaceserv__xnl4v5.html#ac0005154c8695dc5033a829bfb1b3efe">serv_xnl4v5::z_cmpcg</a></div><div class="ttdeci">subroutine z_cmpcg(sigma, depth, grav, cg)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00046">serv_xnl4v5.f90:46</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_ad49245e4b8a78e66fc937277fba59c38"><div class="ttname"><a href="namespaceserv__xnl4v5.html#ad49245e4b8a78e66fc937277fba59c38">serv_xnl4v5::z_steps</a></div><div class="ttdeci">subroutine z_steps(x, dx, nx)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00382">serv_xnl4v5.f90:382</a></div></div>
<div class="ttc" id="anamespacem__fileio_html_a89fd09a962d92c04118de21b23e588d5"><div class="ttname"><a href="namespacem__fileio.html#a89fd09a962d92c04118de21b23e588d5">m_fileio::z_fclose</a></div><div class="ttdeci">subroutine z_fclose(iunit)</div><div class="ttdoc">Close file with unit number IUNIT, and set IUNIT=-1.</div><div class="ttdef"><b>Definition:</b> <a href="mod__fileio_8f90_source.html#l00364">mod_fileio.f90:364</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_adaccc46c70348e68ea06c9e0977522e6"><div class="ttname"><a href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">w3adatmd::cg</a></div><div class="ttdeci">real, dimension(:,:), pointer cg</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00575">w3adatmd.F90:575</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_ad7dbe77d1a038ba8dde801bf55de3514"><div class="ttname"><a href="namespaceserv__xnl4v5.html#ad7dbe77d1a038ba8dde801bf55de3514">serv_xnl4v5::z_root2</a></div><div class="ttdeci">real function z_root2(func, x1, x2, xacc, iprint, ierr)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00432">serv_xnl4v5.f90:432</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a982588d9c5fbf625de3abe149df867ad"><div class="ttname"><a href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">w3adatmd::ipass</a></div><div class="ttdeci">integer, pointer ipass</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00686">w3adatmd.F90:686</a></div></div>
<div class="ttc" id="anamespacem__constants_html_a01113a85af23de66ed1b9f7b7f305280"><div class="ttname"><a href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">m_constants::rade</a></div><div class="ttdeci">real rade</div><div class="ttdoc">conversion from radians to degrees</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00033">mod_constants.f90:33</a></div></div>
<div class="ttc" id="anamespacew3snl4md_html_a44e294fdfc48a42209f7a6fe12f9acfc"><div class="ttname"><a href="namespacew3snl4md.html#a44e294fdfc48a42209f7a6fe12f9acfc">w3snl4md::npts</a></div><div class="ttdeci">integer, parameter npts</div><div class="ttdef"><b>Definition:</b> <a href="w3snl4md_8F90_source.html#l00129">w3snl4md.F90:129</a></div></div>
<div class="ttc" id="anamespacew3snl4md_html_ac51053a8a6beac5a86d41cddbd02ad2c"><div class="ttname"><a href="namespacew3snl4md.html#ac51053a8a6beac5a86d41cddbd02ad2c">w3snl4md::nang</a></div><div class="ttdeci">integer nang</div><div class="ttdef"><b>Definition:</b> <a href="w3snl4md_8F90_source.html#l00139">w3snl4md.F90:139</a></div></div>
<div class="ttc" id="anamespacem__constants_html_aa591a9f7dab0aa8ab034b2b539cb2465"><div class="ttname"><a href="namespacem__constants.html#aa591a9f7dab0aa8ab034b2b539cb2465">m_constants::grav</a></div><div class="ttdeci">real grav</div><div class="ttdoc">gravitational acceleration</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00019">mod_constants.f90:19</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_a3eafcd59a785df58085c7c302f4d6767"><div class="ttname"><a href="namespaceserv__xnl4v5.html#a3eafcd59a785df58085c7c302f4d6767">serv_xnl4v5::z_intp1</a></div><div class="ttdeci">subroutine z_intp1(x1, y1, x2, y2, n1, n2, ierr)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00102">serv_xnl4v5.f90:102</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_a5222a0092e2c5a15f06a76b4c68279c3"><div class="ttname"><a href="namespaceserv__xnl4v5.html#a5222a0092e2c5a15f06a76b4c68279c3">serv_xnl4v5::z_upper</a></div><div class="ttdeci">subroutine z_upper(str)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00630">serv_xnl4v5.f90:630</a></div></div>
<div class="ttc" id="anamespacem__constants_html_aeda97494aa03a0ed5eaad7c5e16f06cd"><div class="ttname"><a href="namespacem__constants.html#aeda97494aa03a0ed5eaad7c5e16f06cd">m_constants::sqrtg</a></div><div class="ttdeci">real sqrtg</div><div class="ttdoc">square root of grav</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00020">mod_constants.f90:20</a></div></div>
<div class="ttc" id="anamespacem__constants_html_a634aff99ec3ff3e77735ac20a50ca2f3"><div class="ttname"><a href="namespacem__constants.html#a634aff99ec3ff3e77735ac20a50ca2f3">m_constants::pi</a></div><div class="ttdeci">real pi</div><div class="ttdoc">circular constant, 3.1415...</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00029">mod_constants.f90:29</a></div></div>
<div class="ttc" id="anamespacew3snl4md_html_a8b5796b6d7a70187e7427666509ae132"><div class="ttname"><a href="namespacew3snl4md.html#a8b5796b6d7a70187e7427666509ae132">w3snl4md::diag</a></div><div class="ttdeci">real, dimension(:,:), allocatable diag</div><div class="ttdef"><b>Definition:</b> <a href="w3snl4md_8F90_source.html#l00195">w3snl4md.F90:195</a></div></div>
<div class="ttc" id="anamespacem__constants_html"><div class="ttname"><a href="namespacem__constants.html">m_constants</a></div><div class="ttdoc">Module for m_constants.</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00014">mod_constants.f90:14</a></div></div>
<div class="ttc" id="anamespacem__constants_html_ab81a7344c44704c2ba0f16d9c06435ec"><div class="ttname"><a href="namespacem__constants.html#ab81a7344c44704c2ba0f16d9c06435ec">m_constants::dera</a></div><div class="ttdeci">real dera</div><div class="ttdoc">conversion from degrees to radians</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00032">mod_constants.f90:32</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a795c1e1aacb2a4f255bb3b646998e466"><div class="ttname"><a href="namespacew3adatmd.html#a795c1e1aacb2a4f255bb3b646998e466">w3adatmd::iter</a></div><div class="ttdeci">integer, dimension(:,:), pointer iter</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00654">w3adatmd.F90:654</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_a9c78903c08fc6c501113690a1e33b203"><div class="ttname"><a href="namespaceserv__xnl4v5.html#a9c78903c08fc6c501113690a1e33b203">serv_xnl4v5::z_polyarea</a></div><div class="ttdeci">subroutine z_polyarea(xpol, ypol, npol, area)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00291">serv_xnl4v5.f90:291</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_a735671d103348a800db8fc8e54265a84"><div class="ttname"><a href="namespaceserv__xnl4v5.html#a735671d103348a800db8fc8e54265a84">serv_xnl4v5::y_gauleg</a></div><div class="ttdeci">subroutine y_gauleg(x1, x2, x, w, n)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00004">serv_xnl4v5.f90:4</a></div></div>
<div class="ttc" id="anamespacem__constants_html_a56a058520a672f3a26f29cde4d81ed70"><div class="ttname"><a href="namespacem__constants.html#a56a058520a672f3a26f29cde4d81ed70">m_constants::gsq</a></div><div class="ttdeci">real gsq</div><div class="ttdoc">square of grav</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00021">mod_constants.f90:21</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html"><div class="ttname"><a href="namespaceserv__xnl4v5.html">serv_xnl4v5</a></div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00001">serv_xnl4v5.f90:1</a></div></div>
<div class="ttc" id="anamespaceserv__xnl4v5_html_a27c4512ce2548f874dc79799d81e0e47"><div class="ttname"><a href="namespaceserv__xnl4v5.html#a27c4512ce2548f874dc79799d81e0e47">serv_xnl4v5::z_wnumb</a></div><div class="ttdeci">real function z_wnumb(w, d, grav)</div><div class="ttdef"><b>Definition:</b> <a href="serv__xnl4v5_8f90_source.html#l00680">serv_xnl4v5.f90:680</a></div></div>
<div class="ttc" id="anamespacem__fileio_html_a994a03812dcb9ccaf6e10628b9023347"><div class="ttname"><a href="namespacem__fileio.html#a994a03812dcb9ccaf6e10628b9023347">m_fileio::z_fileio</a></div><div class="ttdeci">subroutine z_fileio(filename, qual, iufind, iunit, iostat)</div><div class="ttdoc">Open file with name FILENAME and determine unit number IUNIT.</div><div class="ttdef"><b>Definition:</b> <a href="mod__fileio_8f90_source.html#l00084">mod_fileio.f90:84</a></div></div>
<div class="ttc" id="anamespacem__fileio_html"><div class="ttname"><a href="namespacem__fileio.html">m_fileio</a></div><div class="ttdoc">Module for storing file i/o related variables.</div><div class="ttdef"><b>Definition:</b> <a href="mod__fileio_8f90_source.html#l00017">mod_fileio.f90:17</a></div></div>
<div class="ttc" id="anamespacew3sic3md_html_ac6e3d9c70c5bb2588d272cc8fbc480c0"><div class="ttname"><a href="namespacew3sic3md.html#ac6e3d9c70c5bb2588d272cc8fbc480c0">w3sic3md::delta</a></div><div class="ttdeci">real function, dimension(:), allocatable delta(X)</div><div class="ttdef"><b>Definition:</b> <a href="w3sic3md_8F90_source.html#l01733">w3sic3md.F90:1733</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacem__xnldata.html">m_xnldata</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
