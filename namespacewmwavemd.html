<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: wmwavemd Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacewmwavemd.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">wmwavemd Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Running the multi-grid version of WAVEWATCH III up to a given ending time for each grid.  
<a href="namespacewmwavemd.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a00279e135de8f9d6c90eaa215d8d0a0b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewmwavemd.html#a00279e135de8f9d6c90eaa215d8d0a0b">wmwave</a> (TEND)</td></tr>
<tr class="memdesc:a00279e135de8f9d6c90eaa215d8d0a0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run multi-grid version of WAVEWATCH III.  <a href="namespacewmwavemd.html#a00279e135de8f9d6c90eaa215d8d0a0b">More...</a><br /></td></tr>
<tr class="separator:a00279e135de8f9d6c90eaa215d8d0a0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8836e39c69006e03300e96855f605670"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewmwavemd.html#a8836e39c69006e03300e96855f605670">wmprnt</a> (MDSO, NRGRD, TSYNC, GRSTAT)</td></tr>
<tr class="memdesc:a8836e39c69006e03300e96855f605670"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print out action table in the log file log. mww3.  <a href="namespacewmwavemd.html#a8836e39c69006e03300e96855f605670">More...</a><br /></td></tr>
<tr class="separator:a8836e39c69006e03300e96855f605670"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a892291374bdfb9750631e642d84ca4f2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewmwavemd.html#a892291374bdfb9750631e642d84ca4f2">wmbcst</a> (DATA, NR, IMOD, NMOD, ID)</td></tr>
<tr class="memdesc:a892291374bdfb9750631e642d84ca4f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non-blocking broadcast for integer arrays.  <a href="namespacewmwavemd.html#a892291374bdfb9750631e642d84ca4f2">More...</a><br /></td></tr>
<tr class="separator:a892291374bdfb9750631e642d84ca4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e5439129ce74e693469e87f50e8856"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewmwavemd.html#a97e5439129ce74e693469e87f50e8856">wmwout</a> (IMOD, NMOD, ID)</td></tr>
<tr class="memdesc:a97e5439129ce74e693469e87f50e8856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non-blocking broadcast using dummy parameter to have output.  <a href="namespacewmwavemd.html#a97e5439129ce74e693469e87f50e8856">More...</a><br /></td></tr>
<tr class="separator:a97e5439129ce74e693469e87f50e8856"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Running the multi-grid version of WAVEWATCH III up to a given ending time for each grid. </p>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-Mar-2021 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a892291374bdfb9750631e642d84ca4f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a892291374bdfb9750631e642d84ca4f2">&#9670;&nbsp;</a></span>wmbcst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine wmwavemd::wmbcst </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(nr), intent(inout)&#160;</td>
          <td class="paramname"><em>DATA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IMOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NMOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Non-blocking broadcast for integer arrays. </p>
<p>Non-blocking broadcast, initially for times only, but made for any integer array. Sending data from first process in the model communicator to all processes that are in the overall communicator but not in the model communicator.</p>
<p>Standard send and receives using defined communicator. Send form first processor in communicator.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">DATA</td><td>Data to be send/received. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NR</td><td>Size of array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IMOD</td><td>Model number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NMOD</td><td>Number of models. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ID</td><td>ID number, used with NMOD for ITAG. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>02-Feb-2007 </dd></dl>

<p class="definition">Definition at line <a class="el" href="wmwavemd_8F90_source.html#l01952">1952</a> of file <a class="el" href="wmwavemd_8F90_source.html">wmwavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">!/                  | Last update :         02-Feb-2007 !</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">!/    02-Feb-2007 : Origination.                        ( version 3.10 )</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">!     Non-blocking broadcast, initially for times only, but made for</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="comment">!     any integer array. Sending data from first process in the</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="comment">!     model cummunicator to all processes that are in the overall</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="comment">!     communicator but not in the model communicator.</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="comment">!     Standard send and receives using defined communicator. Send</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">!     form first processor in communicator.</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="comment">!       DATA    I.A.  I/O  Data to be send/received.</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="comment">!       NR      Int.   I   Size of array.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">!       IMOD    Int.   I   Model number.</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="comment">!       NMOD    Int.   I   Number of models.</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="comment">!       ID      Int.   I   ID number, used with NMOD for ITAG.</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="comment">!      STRACE    Sur.  W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">!      WMWAVE    Subr. WMWAVEMD Multi-grid wave model routine.</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="comment">!     !/S    Enable subroutine tracing.</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="comment">!     !/MPIT Enable test output</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacewmmdatmd.html">wmmdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmmdatmd.html#a1c3b6c120a3391849d9d49238ce13d38">mdst</a>, <a class="code" href="namespacewmmdatmd.html#a7574d0e2aa572bf92fdab3ced4e02ac0">mtagb</a>, <a class="code" href="namespacewmmdatmd.html#af9d8d2d4d2c15e2ca754f5ea2950f8cb">improc</a>, <a class="code" href="namespacewmmdatmd.html#a24416cdd0b4767f933e943e19a0578f5">nmproc</a>, <a class="code" href="namespacewmmdatmd.html#ad1cf051563c5f193649a544134f4fad1">allprc</a>,   &amp;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;         <a class="code" href="namespacewmmdatmd.html#aa1546f99a2809091a3466d2dd16d08c1">croot</a>, <a class="code" href="namespacewmmdatmd.html#a0456e8f8014e0660b9ff6250e6089ed1">mpi_comm_mwave</a></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="preprocessor"></span>    <a class="code" href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a> <span class="stringliteral">&quot;mpif.h&quot;</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: NR, IMOD, NMOD, ID</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(INOUT)</span>  :: DATA(NR)</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ITAG, IP, IERR_MPI,             &amp;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;         STATUS(MPI_STATUS_SIZE)</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;WMBCST&#39;</span>)</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="comment">! 0.  Initializations</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="preprocessor"></span>    itag   = <a class="code" href="namespacewmmdatmd.html#a7574d0e2aa572bf92fdab3ced4e02ac0">mtagb</a> + imod + id*nmod</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">! 1.  Processor to send data from</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacewmmdatmd.html#ad1cf051563c5f193649a544134f4fad1">allprc</a>(<a class="code" href="namespacewmmdatmd.html#af9d8d2d4d2c15e2ca754f5ea2950f8cb">improc</a>,imod) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <span class="keywordflow">DO</span> ip=1, <a class="code" href="namespacewmmdatmd.html#a24416cdd0b4767f933e943e19a0578f5">nmproc</a></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacewmmdatmd.html#ad1cf051563c5f193649a544134f4fad1">allprc</a>(ip,imod) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>mpi_send ( <span class="keyword">DATA</span>, nr, mpi_integer, ip-1,     &amp;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;               itag, <a class="code" href="namespacewmmdatmd.html#a0456e8f8014e0660b9ff6250e6089ed1">mpi_comm_mwave</a>, ierr_mpi )</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="comment">! 2.  Processor to receive data at</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacewmmdatmd.html#ad1cf051563c5f193649a544134f4fad1">allprc</a>(<a class="code" href="namespacewmmdatmd.html#af9d8d2d4d2c15e2ca754f5ea2950f8cb">improc</a>,imod) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span>mpi_recv ( <span class="keyword">DATA</span>, nr, mpi_integer, <a class="code" href="namespacewmmdatmd.html#aa1546f99a2809091a3466d2dd16d08c1">croot</a>-1, itag,  &amp;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;           <a class="code" href="namespacewmmdatmd.html#a0456e8f8014e0660b9ff6250e6089ed1">mpi_comm_mwave</a>, status, ierr_mpi )</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      <span class="comment">! 3.  Processor with no action</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMBCST : INPUTS :&#39;</span>,4i4)</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;9001 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMBCST : IMPROC, NMPROC:&#39;</span>,2i5,<span class="stringliteral">&#39;  ALLPRC :&#39;</span>)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;9002 <span class="keyword">FORMAT</span> (14x,13i5)</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="preprocessor"></span>9010 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMBCST : IAPROC =&#39;</span>,i5,<span class="stringliteral">&#39;    SENDING TO &#39;</span>,i5)</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="preprocessor"></span>9020 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMBCST : IAPROC =&#39;</span>,i5,                    &amp;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;         <span class="stringliteral">&#39;    RECEIVING FROM &#39;</span>,i5)</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="preprocessor"></span>9030 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMBCST : IAPROC =&#39;</span>,i5,<span class="stringliteral">&#39;    NO ACTION&#39;</span>)</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="comment">!/ End of WMBCST ----------------------------------------------------- /</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="wmmdatmd_8F90_source.html#l00360">wmmdatmd::allprc</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00545">wmmdatmd::croot</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00322">wmmdatmd::improc</a>, <a class="el" href="CMakeLists_8txt_source.html#l00015">include()</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00315">wmmdatmd::mdst</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00344">wmmdatmd::mpi_comm_mwave</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00345">wmmdatmd::mtagb</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00321">wmmdatmd::nmproc</a>, and <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="wmwavemd_8F90_source.html#l00091">wmwave()</a>.</p>

</div>
</div>
<a id="a8836e39c69006e03300e96855f605670"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8836e39c69006e03300e96855f605670">&#9670;&nbsp;</a></span>wmprnt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine wmwavemd::wmprnt </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MDSO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NRGRD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>TSYNC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nrgrd), intent(in)&#160;</td>
          <td class="paramname"><em>GRSTAT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print out action table in the log file log. mww3. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">MDSO</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NRGRD</td><td>Number of grids. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TSYNC</td><td>Synchronization time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GRSTAT</td><td>Status array per grid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-Feb-2005 </dd></dl>

<p class="definition">Definition at line <a class="el" href="wmwavemd_8F90_source.html#l01777">1777</a> of file <a class="el" href="wmwavemd_8F90_source.html">wmwavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">!/                  | Last update :         22-Feb-2005 |</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="comment">!/    22-Feb-2005 : Origination.                        ( version 3.07 )</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">!     Print out action table in the log file log.ww3m</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="comment">!       NRGRD   Int.   I   Number of grids.</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">!       TSYN    I.A.   I   Synchronization time.</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="comment">!       GRSTAT  I.A.   I   Status array per grid.</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">!      STME21    Subr. W3TIMEMD Print date and time readable.</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    <span class="comment">!      WMWAVE    Subr. WMWAVEMD Multi-grid wave model routine.</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">!     None.</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">!     See source code.</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">!     !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">!     !/T     Test output.</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3timemd.html">w3timemd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: MDSO, NRGRD, TSYNC(2), GRSTAT(NRGRD)</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span>      :: IW = 15</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: I, I0, IN</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IDLAST(2)</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">SAVE</span>           :: FIRST = .true.</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordtype">CHARACTER(LEN=23)</span>       :: IDTIME</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordtype">CHARACTER(LEN=3)</span>        :: STR(IW), LNE(IW)</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;WMPRNT&#39;</span>)</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">DO</span> i=1, iw</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      lne(i) = <span class="stringliteral">&#39;---&#39;</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">IF</span> ( first ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <span class="keyword">WRITE</span> (mdso,900) nrgrd, lne, <span class="stringliteral">&#39;-+&#39;</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      first  = .false.</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      idlast(1) = -1</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      idlast(2) =  0</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      backspace(mdso)</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( tsync, idtime )</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="keywordflow">DO</span> i=1, min(iw,nrgrd)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="keyword">WRITE</span> (str(i),<span class="stringliteral">&#39;(I3)&#39;</span>) grstat(i)</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">DO</span> i=1+min(iw,nrgrd), iw</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      str(i) = <span class="stringliteral">&#39;   &#39;</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">IF</span> ( idlast(1).EQ.tsync(1) .AND. idlast(2).EQ.tsync(2) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="preprocessor">#ifdef W3_O11</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (mdso,903) str, <span class="stringliteral">&#39; |&#39;</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( idlast(1) .EQ. tsync(1) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keyword">WRITE</span> (mdso,902) idtime(12:19), str, <span class="stringliteral">&#39; |&#39;</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keyword">WRITE</span> (mdso,901) idtime(01:19), str, <span class="stringliteral">&#39; |&#39;</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    idlast = tsync</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">IF</span> ( nrgrd .GT. iw ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      i0     = 1</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      in     = iw</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      <span class="keywordflow">DO</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        i0     = i0 + iw</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        in     = in + iw</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <span class="keywordflow">DO</span> i=i0, min(in,nrgrd)</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;          <span class="keyword">WRITE</span> (str(i-i0+1),<span class="stringliteral">&#39;(I3)&#39;</span>) grstat(i)</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <span class="keywordflow">DO</span> i=1+min(in,nrgrd), in</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;          str(i-i0+1) = <span class="stringliteral">&#39;   &#39;</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="keyword">WRITE</span> (mdso,903) str, <span class="stringliteral">&#39; |&#39;</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">IF</span> ( in .GE. nrgrd ) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keyword">WRITE</span> (mdso,904) lne, <span class="stringliteral">&#39;-+&#39;</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;900 <span class="keyword">FORMAT</span> (1x,<span class="stringliteral">&#39; Time (sync rank 1)  | Status for&#39;</span>,i3,<span class="stringliteral">&#39; grids&#39;</span>/     &amp;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;         1x,<span class="stringliteral">&#39;---------------------+&#39;</span>,16a)</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;901 <span class="keyword">FORMAT</span> (2x,a19,<span class="stringliteral">&#39; |&#39;</span>,16a)</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;902 <span class="keyword">FORMAT</span> (2x,11x,a8,<span class="stringliteral">&#39; |&#39;</span>,16a)</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;903 <span class="keyword">FORMAT</span> (21x,<span class="stringliteral">&#39; |&#39;</span>,16a)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;904 <span class="keyword">FORMAT</span> (1x,<span class="stringliteral">&#39;---------------------+&#39;</span>,16a)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">!/ End of WMPRNT ----------------------------------------------------- /</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3timemd_8F90_source.html#l00682">w3timemd::stme21()</a>, and <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="wmwavemd_8F90_source.html#l00091">wmwave()</a>.</p>

</div>
</div>
<a id="a00279e135de8f9d6c90eaa215d8d0a0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00279e135de8f9d6c90eaa215d8d0a0b">&#9670;&nbsp;</a></span>wmwave()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine wmwavemd::wmwave </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(2,nrgrd), intent(in)&#160;</td>
          <td class="paramname"><em>TEND</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run multi-grid version of WAVEWATCH III. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">TEND</td><td>Ending time for calculations for each grid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-Mar-2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="wmwavemd_8F90_source.html#l00091">91</a> of file <a class="el" href="wmwavemd_8F90_source.html">wmwavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">!/                  | Last update :         22-Mar-2021 |</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">!/    13-Jun-2005 : Origination.                        ( version 3.07 )</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">!/    30-Jan-2006 : Add static nesting.                 ( version 3.08 )</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">!/    25-May-2006 : Add overlapping grids.              ( version 3.09 )</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">!/    09-Aug-2006 : Unified point output added.         ( version 3.10 )</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">!/    22-Dec-2006 : Final algorith changes for tests.   ( version 3.10 )</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">!/    25-Jan-2007 : Tweaking algorithm.                 ( version 3.10 )</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">!/    02-Feb-2007 : Replacing MPI_BCAST with WMBCST.    ( version 3.10 )</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">!/    07-Feb-2007 : Reintroduce pre-fetching.           ( version 3.10 )</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">!/    10-May-2007 : Removing / streamlining WMBCST.     ( version 3.11 )</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">!/    21-Jun-2007 : Dedicated output processes.         ( version 3.11 )</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">!/    20-Sep-2007 : Fix reset of GRSTAT in 0.b          ( version 3.13 )</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">!/    20-Aug-2010 : Fix MAPSTA/MAPST2 bug sec. 9.a.   ( version 3.14.6 )</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">!/    12-Mar-2012 : Use MPI_COMM_NULL for checks.       ( version 3.14 )</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">!/    28-Jan-2014 : Add memory hwm to profiling.        ( version 5.00 )</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">!/    22-Mar-2021 : Support for air density input       ( version 7.13 )</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">!     Run multi-grid version of WAVEWATCH III.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">!     See manual.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">!       TEND    I.A.   I   Ending time for calculations for each grid.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">!     Local variables</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">!       J       Int.   Group counter.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">!       JJ      Int.   Grid in group counter.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">!       I       Int.   Grid counter.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">!      W3SETG    Subr  W3GDATMD Point to grid/model.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!      W3SETW    Subr  W3WDATMD Point to grid/model.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">!      W3SETA    Subr  W3ADATMD Point to grid/model.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!      W3SETO    Subr  W3ODATMD Point to grid/model.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">!      W3IOPE    Subr  W3IOPOMD Extracting point output.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">!      W3WAVE    Subr  W3WAVEMD Actual ave model routine.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">!      STRACE    Subr  W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">!      EXTCDE    Subr    Id.    Abort program with exit code.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">!      WWTIME    Subr    Id.    System time in readable format.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">!      PRTIME    Subr    Id.    Profiling routine ( !/MPRF )</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">!      STME21    Subr  W3TIMEMD Print date and time readable.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">!      DSEC21    Func    Id.    Difference between times.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">!      TICK21    Subr    Id.    Advance time.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">!      WMSETM    Subr  WMMDATMD Point to grid/model.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">!      WMUPDT    Subr  WMUPDTMD Update input fields at driver level.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">!      WMIOBG    Subr  WMINIOMD Gather staged boundary data.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">!      WMIOBS    Subr    Id.    Stage boundary data.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">!      WMIOBF    Subr    Id.    Finalize WMIOBS.            ( !/MPI )</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">!      WMIOHS    Subr    Id.    Stage high-to-low data.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">!      WMIOHG    Subr    Id.    Gather staged high-to-low data.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">!      WMIOHF    Subr    Id.    Finalize WMIOHS.            ( !/MPI )</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">!      WMIOES    Subr    Id.    Stage same-rank data.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">!      WMIOEG    Subr    Id.    Gather staged same-rank data.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">!      WMIOEF    Subr    Id.    Finalize WMIOES.            ( !/MPI )</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">!      WMIOPO    Subr  WMIOPOMD Unified point output.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">!      W3MLTI    Prog.   N/A    Multi-grid model driver.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">!      ....                     Any coupled model.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">!     See formats 1000 and following, or escape locations 2000 and</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">!     following.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">!     - If no action is taken in the endless loop, an error is</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!       assumed (code 2099). This should never take place in the</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!       default driver, but may be a problem in a coupled model.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">!     - If output is requested for the initial model time, TSYNC</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">!       is set to TIME instead of (-1,0) for GRSTAT = 0. In this case</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">!       input is updated, after which GRSTAT is set to 6 instead</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">!       of 1. This assures that restarts do not impact model results</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">!       by spurious double reconciliations.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">!     See source code and manual.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!       !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!       !/T     Enable test output.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">!       !/MPIT  Enable test output (use with !/MPI only).</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!       !/MPRF  Profiling.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!       !/SHRD, !/DIST, !/MPI</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!               Shared / distributed program model.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#a85874d43058e50547ab59d1f6fdc21c2">w3setg</a></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3wdatmd.html#ac0bd6dc2f0effae7dce2f111cde16802">w3setw</a></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#ab2c0f2e6e7524fb061d841ba7a7324a1">w3seta</a></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a40de4775d7cb1e739098ef04139a6019">w3seto</a>, <a class="code" href="namespacew3odatmd.html#a8f5a1eaad48354e6b56f1ff69ff00dd2">notype</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iopomd.html">w3iopomd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3iopomd.html#a9bbc253bffd32ee330cad4928783178e">w3iope</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wavemd.html">w3wavemd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3wavemd.html#a5e68663cd6aaa3a50e3de164a18db6b9">w3wave</a></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: extcde, <a class="code" href="namespacew3servmd.html#a4ff12f04b0c56a558d749b1cfed9837c">wwtime</a></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3timemd.html">w3timemd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3timemd.html#a06d1d666694aff42469ce3e1d925f713">prtime</a></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3timemd.html">w3timemd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>, <a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a>, <a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewmmdatmd.html">wmmdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmmdatmd.html#a05a21e8628a3da17474a972da7a6c10e">wmsetm</a></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewmupdtmd.html">wmupdtmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmupdtmd.html#a467a7fe3bceda4245d2424e82de326bd">wmupdt</a></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewminiomd.html">wminiomd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewminiomd.html#a71a7451b20e88010fa881508c6f05856">wmiobg</a>, <a class="code" href="namespacewminiomd.html#a5572bed109e848ebf2a203cc80417d44">wmiobs</a>, <a class="code" href="namespacewminiomd.html#ad418b078b01dab3f1095a8a7427153bd">wmiobf</a>, <a class="code" href="namespacewminiomd.html#a5718d371621787958652393e204f8643">wmiohg</a>, <a class="code" href="namespacewminiomd.html#aaab03e946466d9fd7b7d0708e5b3726e">wmiohs</a>,     &amp;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;         <a class="code" href="namespacewminiomd.html#a6da700c7a46d644a7950430cb609685a">wmiohf</a>, <a class="code" href="namespacewminiomd.html#aa726d9773260b7863e8de74b3d6bdca4">wmioeg</a>, <a class="code" href="namespacewminiomd.html#a94791d8fdf5527cc8d8ab4e012bde529">wmioes</a>, <a class="code" href="namespacewminiomd.html#a7c6dc364321a4028015d207ec5107ebd">wmioef</a></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewmiopomd.html">wmiopomd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmiopomd.html#a8ba5eb53840b8db721166904529e5aa9">wmiopo</a></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#a9524bdcdd2307c71564f9df2df040a6b">dtmax</a>, nx, ny, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, va</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>, <a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>, <a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>, <a class="code" href="namespacew3odatmd.html#a811019b8e0198c95c111311b1a36b66d">tolast</a>, <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,       &amp;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         <a class="code" href="namespacew3odatmd.html#a86e40dfd9101dbbdf8d8e95d8bfe4e3a">nappnt</a>, <a class="code" href="namespacew3odatmd.html#adfd64faa2165e36009af0b7b9fae44f0">nopts</a>, <a class="code" href="namespacew3odatmd.html#a9f5e0d144a9bb960616eaf2e830cccb3">unipts</a></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>, <a class="code" href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">irqpo1</a></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3idatmd.html">w3idatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewmmdatmd.html">wmmdatmd</a>, <span class="keywordtype">ONLY</span>: mdso, <a class="code" href="namespacewmmdatmd.html#a4ecc54bad82b08b6a2b5c0442fb3040d">mdss</a>, <a class="code" href="namespacewmmdatmd.html#a1c3b6c120a3391849d9d49238ce13d38">mdst</a>, <a class="code" href="namespacewmmdatmd.html#a545b1cbca9a52a30e829796993947e45">mdse</a>, <a class="code" href="namespacewmmdatmd.html#af9d8d2d4d2c15e2ca754f5ea2950f8cb">improc</a>,             &amp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         <a class="code" href="namespacewmmdatmd.html#a24416cdd0b4767f933e943e19a0578f5">nmproc</a>, <a class="code" href="namespacewmmdatmd.html#a57716bae728c55d2c9492ef2d48150bb">nmpscr</a>, <a class="code" href="namespacewmmdatmd.html#a49087c706a875500a1b1dd1981a7b26c">nmperr</a>, <a class="code" href="namespacewmmdatmd.html#a0ddac52118d3a9dcfc3964543518afc3">nmptst</a>, <a class="code" href="namespacewmmdatmd.html#a3d5fc7ef059560ca3ee99f9c66720c34">nmplog</a>,     &amp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;         <a class="code" href="namespacewmmdatmd.html#a18f62a347d7a6212c2b40f9bd19ad86c">stime</a>, <a class="code" href="namespacewmmdatmd.html#a1767c8959adc63f31c5962c965151f60">etime</a>, <a class="code" href="namespacewmmdatmd.html#a5d19fda88dfab964f912a8228343733c">nmv</a>, <a class="code" href="namespacewmmdatmd.html#a37b90f9d6571f875b18669532e8ae021">tmv</a>, <a class="code" href="namespacewmmdatmd.html#a951f16224f87a2f176cfda3c6bf9dc48">amv</a>, <a class="code" href="namespacewmmdatmd.html#a0d2ec80950da63735ef903b3f291274b">dmv</a>,           &amp;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;         nrgrd, <a class="code" href="namespacewmmdatmd.html#ac0062324f64bf30624617b18c27e24f7">nrgrp</a>, <a class="code" href="namespacewmmdatmd.html#a62e5c7d17668d5ad30950f345ef181f2">grank</a>, <a class="code" href="namespacewmmdatmd.html#a330e1c63163d8b6630caddd993e9b066">ingrp</a>, <a class="code" href="namespacewmmdatmd.html#ad5eb65d40ccfb521b5fb2b3b95ed20f9">grdhgh</a>, <a class="code" href="namespacewmmdatmd.html#a3b53b5e433921c9cbabb9b3b0333aecc">grdeql</a>, &amp;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         <a class="code" href="namespacewmmdatmd.html#a75b851c813c4635526a2a83ebc8962a2">grdlow</a>, tsync, <a class="code" href="namespacewmmdatmd.html#a94fd47efa201e22b60dd6aef5c15937b">tmax</a>, <a class="code" href="namespacewmmdatmd.html#a0613ba2a16bfcb827ec38d5c2ac8506b">toutp</a>, tdata, grstat,  &amp;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;         <a class="code" href="namespacewmmdatmd.html#a9bcaeeb6056e5ef546645f059aece1f8">fllstl</a>, <a class="code" href="namespacewmmdatmd.html#a8e3b5b55fc5e27edf99c3c8478c8c10f">fllsti</a>, <a class="code" href="namespacewmmdatmd.html#aa1d9f0e3ffb8a78c9c98aa6eb4f28e12">fllstr</a>, <a class="code" href="namespacewmmdatmd.html#a8e96f11b970bb9078037c503301b425d">dtres</a>, <a class="code" href="namespacewmmdatmd.html#a1928790ea627ec2a350b25e01455673c">flghg1</a>,      &amp;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;         <a class="code" href="namespacewmmdatmd.html#a617eda3eb1271c4d7702b850c0aa1124">flghg2</a>, <a class="code" href="namespacewmmdatmd.html#a5bca40f7b39183413a708fbd187b621b">mapmsk</a></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacewmmdatmd.html">wmmdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmmdatmd.html#a0456e8f8014e0660b9ff6250e6089ed1">mpi_comm_mwave</a>, <a class="code" href="namespacewmmdatmd.html#a87dd8cd7d939f4da5df3bfa8adc25360">mpi_comm_grd</a>,          &amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         <a class="code" href="namespacewmmdatmd.html#ae3e673b204824f49d68bae67dfdd7eda">mpi_comm_bct</a>, <a class="code" href="namespacewmmdatmd.html#aa1546f99a2809091a3466d2dd16d08c1">croot</a>, <a class="code" href="namespacewmmdatmd.html#ac5b81b0b34ab86d99aa11309f8fab349">fbcast</a></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacewmmdatmd.html">wmmdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor"></span>    <a class="code" href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a> <span class="stringliteral">&quot;mpif.h&quot;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: TEND(2,NRGRD)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: J, JJ, I, JO, TPRNT(2), TAUX(2),     &amp;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         II, JJJ, IX, IY, UPNEXT(2), UPLAST(2)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: DUMMY2(35)=0</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ILOOP</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: IERR_MPI, NMPSCS</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span>    :: STATUS(:,:)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>                    :: DTTST, DTMAXI</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>                    :: PRFT0, PRFTN, PRFTS</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keywordtype">    REAL</span>(KIND=8)            :: get_memory</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">CHARACTER(LEN=8)</span>        :: WTIME</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">CHARACTER(LEN=23)</span>       :: MTIME</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">LOGICAL</span>                 :: DONE, TSTAMP, FLAGOK, DO_UPT,        &amp;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         FLG_O1, FLG_O2</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>                 :: FLAG</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">ALLOCATABLE</span>    :: FLSYNC(:), GRSYNC(:), TMSYNC(:),     &amp;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         FLEQOK(:)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">ALLOCATABLE</span>    :: PREGTB(:), PREGTH(:), PREGTE(:)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;WMWAVE&#39;</span>)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">#ifdef W3_O10</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc ) <span class="keyword">WRITE</span> (mdss,900)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">! 0.  Initializations ------------------------------------------------ /</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">! 0.a Initial testing</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">!     Test GRSTAT</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">DO</span> i=1, nrgrd</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">IF</span> ( ( grstat(i).LT.0 .OR. grstat(i).GT.7 ) .AND.             &amp;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;           grstat(i).NE.99 ) <span class="keywordflow">GOTO</span> 2000</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="comment">!     Consistency of times for grids</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">IF</span> ( tsync(1,i) .NE. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tsync(:,i), tend(:,i) )</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">IF</span> ( dttst .LT. 0. ) <span class="keywordflow">GOTO</span> 2001</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">!     Consistency of times within groups, set global TSYNC(:,0)</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">DO</span> j=1, nrgrp</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">DO</span> jj=2, ingrp(j,0)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(tsync(:,ingrp(j,1)),tsync(:,ingrp(j,jj))).NE.0. &amp;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;             .OR. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(tend(:,ingrp(j,1)),tend(:,ingrp(j,jj))).NE.0. ) &amp;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;             <span class="keywordflow">GOTO</span> 2002</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">IF</span> ( grank(ingrp(j,1)).EQ.1 .AND. tsync(1,0).EQ.-1 )          &amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;           tsync(:,0) = tsync(:,ingrp(j,1))</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">!     Check if FLSYNC initialized</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">IF</span> ( .NOT. <span class="keyword">ALLOCATED</span>(flsync) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keyword">ALLOCATE</span> ( flsync(nrgrd), grsync(nrgrp), tmsync(nrgrd),     &amp;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;           fleqok(nrgrd) )</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor"></span>      <span class="keyword">ALLOCATE</span> ( pregtb(nrgrd), pregth(nrgrd), pregte(nrgrd) )</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor"></span>      flsync = .false.</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      grsync = .false.</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      tmsync = .true.</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      fleqok = .false.</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="preprocessor"></span>      pregtb = .false.</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      pregth = .false.</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      pregte = .false.</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">! 0.b Reset GRSTAT as needed</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">DO</span> i=1, nrgrd</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tend(:,i) )</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">IF</span> ( grstat(i).EQ.99 .AND. dttst.GT.0. ) grstat(i) = 0</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">! 0.c Other initializations</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    dtres  = 0.</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor"></span>    nmpscs = nmpscr</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">IF</span> ( unipts ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keyword">CALL </span>w3seto ( 0, mdse, mdst )</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      upnext = tonext(:,2)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      uplast = tolast(:,2)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      do_upt = .true.</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      upnext(1) = -1</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      upnext(2) =  0</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      do_upt = .false.</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">! 0.d Output</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keyword">CALL </span>wmprnt ( mdso, nrgrd, tsync(:,0), grstat )</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( tsync(:,0), mtime )</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keyword">CALL </span>wwtime ( wtime )</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">WRITE</span> (mdss,901) mtime, wtime, minval(grstat), maxval(grstat)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      tprnt  = tsync(:,0)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      tstamp = .true.</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>mpi_barrier (mpi_comm_mwave,ierr_mpi)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,990) prft0, prftn, get_memory()</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">! 1.  Setting up loop structure -------------------------------------- /</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor"></span>    iloop  = 0</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    loop_outer: <span class="keywordflow">DO</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc .AND.                &amp;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;           <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(tprnt,tsync(:,0)).NE.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">IF</span> ( .NOT. tstamp ) <span class="keyword">WRITE</span> (mdss,*)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keyword">CALL </span>wmprnt ( mdso, nrgrd, tsync(:,0), grstat )</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( tsync(:,0), mtime )</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keyword">CALL </span>wwtime ( wtime )</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keyword">WRITE</span> (mdss,901) mtime, wtime, minval(grstat), maxval(grstat)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        tprnt  = tsync(:,0)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        tstamp = .true.</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor"></span>      iloop  = iloop + 1</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keyword">WRITE</span> (mdst,9000) iloop, tsync(:,0)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">DO</span> i=1, nrgrd</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keyword">WRITE</span> (mdst,9001) i, grstat(i), <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tsync(:,i), tend(:,i)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">IF</span> ( iloop .EQ. -1 ) <span class="keyword">CALL </span>extcde ( 508 )</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      done   = .false.</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      tprnt  = tsync(:,0)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      loop_j: <span class="keywordflow">DO</span> j=1, nrgrp</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor"></span>        grsync(j) = .false.</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">DO</span> jj=1, ingrp(j,0)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          i      = ingrp(j,jj)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="keyword">CALL </span>wmsetm ( i, mdse, mdst )</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          grsync(j) = grsync(j) .OR. fbcast</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        loop_jj: <span class="keywordflow">DO</span> jj=1, ingrp(j,0)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          i      = ingrp(j,jj)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          <span class="keyword">CALL </span>wmsetm ( i, mdse, mdst )</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( grstat(i).EQ.0 ) tmsync(i) = .NOT. fbcast</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          <span class="keywordflow">IF</span> ( fbcast ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            nmpscr = croot</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            nmpscr = nmpscs</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          <span class="comment">! 2.  Update input fields -------------------------------------------- /</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="comment">!     ( GRSTAT = 0 )</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          <span class="comment">! 2.a Check TDATA and finish step if data is still OK</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( grstat(i).EQ.0 .AND. .NOT.flsync(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;              <span class="keywordflow">IF</span> ( tdata(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                dttst  = 0.</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , tdata(:,i) )</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9020) dttst</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;              <span class="keywordflow">IF</span> ( dttst .GT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                grstat(i) = 1</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9003) i, grstat(i)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor"></span>                done      = .true.</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! IF ( GRSTAT(I).EQ.0 .AND. .NOT.FLSYNC(I)</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 0 )</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;          <span class="comment">! 2.b Update input and TDATA</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( grstat(i).EQ.0 .AND. .NOT.flsync(i) .AND.       &amp;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                 mpi_comm_grd .NE. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( dttst .LE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc )        &amp;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                     <span class="keyword">WRITE</span> (mdss,*)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                tstamp = .false.</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacewmupdtmd.html#a467a7fe3bceda4245d2424e82de326bd">wmupdt</a> ( i, tdata(:,i) )</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9021) <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tdata(:,i), tend(:,i)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="preprocessor"></span><span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;              <span class="comment">! 2.c Finish up if possible ( !/SHRD or .NOT. FBCAST or no update )</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor"></span>              grstat(i) = 1</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;              done      = .true.</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( .NOT. grsync(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9902) i, grstat(i),             &amp;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                     <span class="stringliteral">&#39;NO SYNC FOR TDATA NEEDED&#39;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor"></span>                grstat(i) = 1</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                done      = .true.</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( .NOT. GRSYNC(J) )</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;              <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn, get_memory(),    &amp;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                   <span class="stringliteral">&#39;ST00&#39;</span>, i</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! IF ( GRSTAT(I).EQ.0 .AND. .NOT.FLSYNC(I) .AND. MPI_COMM_GRD .NE. MPI_COMM_NULL )</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 0 )</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          <span class="comment">! 2.d Synchronize in parts ( !/MPI )</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( grstat(i).EQ.0 .AND. grsync(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            done   = .true.</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( flsync(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9902) i, grstat(i),             &amp;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                   <span class="stringliteral">&#39;SYNCING TDATA&#39;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> (flsync(i)) <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( fbcast ) <span class="keyword">CALL </span>wmbcst                    &amp;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                   ( tdata(1,i), 2, i, nrgrd, 1 )</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> (flsync(i)) <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;              <span class="keywordflow">IF</span> (flsync(i)) <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991)             &amp;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                   prft0, prftn, get_memory(), <span class="stringliteral">&#39;BCST&#39;</span>,i</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9902) i, grstat(i), <span class="stringliteral">&#39;SYNCING DONE&#39;</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor"></span>              grstat(i) = 1</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;              flsync(i) = .false.</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;              <span class="keywordflow">IF</span> ( grsync(j) ) cycle loop_jj</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9902) i, grstat(i),             &amp;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                   <span class="stringliteral">&#39;CYCLE BEFORE SYNCING TDATA&#39;</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor"></span>              flsync(i) = .true.</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;              cycle loop_jj</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! IF ( FLSYNC(I) )</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I).EQ.0 .AND. GRSYNC(J)</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <span class="comment">! 3.  Update data from lower ranked grids ---------------------------- /</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="comment">!     ( GRSTAT = 1 )</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="comment">! 3.a Skip for initial output only</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 1 .AND. tsync(1,i) .NE. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39;FIRST PART&#39;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tsync(:,i) )</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              grstat(i) = 7</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9003) i, grstat(i)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor"></span>              done      = .true.</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 1 .AND. TSYNC(1,I) .NE. -1 )</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="comment">! 3.b Normal processing</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39;SECOND PART&#39;</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="comment">! 3.b.1 Test if data is there</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            flagok = .true.</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            taux   = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="keywordflow">DO</span> jjj=1, grdlow(i,0)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;              <span class="keyword">CALL </span>w3setw ( grdlow(i,jjj), mdse, mdst )</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;              flagok = flagok .AND. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(taux,<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>).GT.0.       &amp;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                   .AND. grstat(grdlow(i,jjj)).EQ.5</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9004) flagok</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="comment">! 3.b.1 Get the data</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( .NOT.flagok .AND. .NOT.pregtb(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;              <span class="keywordflow">IF</span> ( mpi_comm_grd.NE.mpi_comm_null )         &amp;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                   <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a71a7451b20e88010fa881508c6f05856">wmiobg</a> (i,flag)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;              pregtb(i) = .true.</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a71a7451b20e88010fa881508c6f05856">wmiobg</a> ( i, flagok )</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( mpi_comm_grd.NE.mpi_comm_null )         &amp;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                   <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a71a7451b20e88010fa881508c6f05856">wmiobg</a> ( i )</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;              pregtb(i) = .false.</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor"></span>              grstat(i) = 2</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;              done      = .true.</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn, get_memory(),    &amp;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                 <span class="stringliteral">&#39;ST01&#39;</span>, i</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 1 )</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="comment">! 4.  Update model time step ----------------------------------------- /</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          <span class="comment">!     ( GRSTAT = 2 )</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="comment">! 4.a Check TMAX and update as necessary ( needs !/MPI synchronizaion )</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="keywordflow">IF</span> ( tmax(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;              tmax(:,i) = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;              dttst  = 0.</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,tmax(:,i))</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">IF</span> ( dttst .LE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;              <span class="keyword">CALL </span>w3setg ( i, mdse, mdst )</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;              dtmaxi = real(nint(<a class="code" href="namespacew3gdatmd.html#a9524bdcdd2307c71564f9df2df040a6b">dtmax</a>+dtres(i)+0.0001))</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;              dtres(i)= dtres(i)+ <a class="code" href="namespacew3gdatmd.html#a9524bdcdd2307c71564f9df2df040a6b">dtmax</a> - dtmaxi</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;              <span class="keywordflow">IF</span> ( abs(dtres(i)) .LT. 0.001 ) dtres(i) = 0.</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;              tmax(:,i) = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( tmax(:,i), dtmaxi )</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;              taux   = tmax(:,i)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;              <span class="keywordflow">IF</span> ( tdata(1,i) .NE. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(tdata(:,i),tmax(:,i)) .GT. 0 )    &amp;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                     tmax(:,i) = tdata(:,i)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;              <span class="keywordflow">IF</span> ( toutp(1,i) .NE. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(toutp(:,i),tmax(:,i)) .GT. 0 )    &amp;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                     tmax(:,i) = toutp(:,i)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;              <span class="keywordflow">IF</span> ( unipts ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(upnext,tmax(:,i)) .GT. 0 )        &amp;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                     tmax(:,i) = upnext(:)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9040) tmax(:,i), dtres(i), taux,   &amp;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                   tdata(:,i), toutp(:,i), upnext</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="preprocessor"></span>              done   = .true.</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;              cycle loop_jj</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;              <span class="keyword">WRITE</span> (mdst,9041) tmax(:,i)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! IF ( DTTST .LE. 0 )</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="comment">! 4.b Lowest ranked grids, minimum of all TMAXes</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9042) grank(i)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">IF</span> ( grank(i) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              taux   = tmax(:,i)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;              flagok = .true.</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;              <span class="comment">! 4.b.1 Check if all grids have reached previous sync point</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;              <span class="keywordflow">DO</span> ii=1, nrgrd</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keyword">CALL </span>w3setw ( ii, mdse, mdst )</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1) .NE. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1).NE.-1 .AND.                   &amp;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                       mpi_comm_grd.NE.mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor"></span>                    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,tsync(:,0)) .NE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                      flagok = .false.</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                      <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                  END IF</span> <span class="comment">! IF ( TIME(1).NE.-1 .AND. MPI_COMM_GRD.NE.MPI_COMM_NULL )</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END IF</span> <span class="comment">! IF ( TIME(1) .NE. -1 ) THEN</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor"></span><span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;              <span class="comment">! 4.b.2 Check availability of data</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;              <span class="keywordflow">DO</span> ii=1, nrgrd</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">IF</span> ( grank(ii) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                  <span class="keywordflow">IF</span> ( tmax(1,ii) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    flagok = .false.</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(taux,tmax(:,ii)) .LT. 0. ) &amp;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                         taux   = tmax(:,ii)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;              flagok = flagok .AND. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,taux).GT.0.</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;              <span class="comment">! 4.b.3 Update TSYNC for all grids</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;              <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                tsync(:,0) = taux</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                do_upt = .true.</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                <span class="keywordflow">DO</span> ii=1, nrgrd</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                  <span class="keywordflow">IF</span> ( grank(ii) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    tsync(:,ii) = taux</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    <span class="keywordflow">IF</span> ( grstat(ii) .EQ. 2 ) grstat(ii) = 3</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor"></span>                    <span class="keywordflow">IF</span> ( grstat(ii) .EQ. 3 )             &amp;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                         <span class="keyword">WRITE</span> (mdst,9003) ii, grstat(ii)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                done   = .true.</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span>prtime ( prfts )</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,992) prfts, prfts,          &amp;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                     get_memory(), <span class="stringliteral">&#39;TIME&#39;</span>, tsync(:,0)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                <span class="comment">! 4.b.4 Output</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9043) tsync(:,0)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keyword">WRITE</span> (mdst,9045)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keyword">WRITE</span> (mdst,9046) (ii,tsync(:,ii),ii=0,nrgrd)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <span class="comment">! 4.b.5 Skip computations so that all grids start processing</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <span class="comment">!       simultaneously.</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,          &amp;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                     get_memory(), <span class="stringliteral">&#39;ST02&#39;</span>, i</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( ingrp(j,0) .GT. 1 ) <span class="keyword">WRITE</span> (mdst,9006)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( ingrp(j,0) .GT. 1 ) <span class="keywordflow">GOTO</span> 1111</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;              <span class="comment">! 4.c Other grids, logical from relations and TMAXes</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( tsync(1,0) .NE. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;              taux   = tsync(:,0)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              flagok = .true.</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;              <span class="comment">! 4.c.1 Check availability of data within group</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;              <span class="comment">!       Time within group needs to be the same for load balancing.</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;              <span class="keywordflow">DO</span> jjj=1, ingrp(j,0)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                ii     = ingrp(j,jjj)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <span class="keywordflow">IF</span> ( tmax(1,ii) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                  flagok = .false.</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                  <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                  <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(taux,tmax(:,ii)) .LT. 0. )     &amp;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                       taux   = tmax(:,ii)</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;              <span class="comment">! 4.c.2 Check with dependent lower rank grids ( TSYNC )</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;              <span class="keywordflow">DO</span> jjj=1, grdlow(i,0)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                ii     = grdlow(i,jjj)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <span class="keywordflow">IF</span> ( tsync(1,ii) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                  flagok = .false.</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                  <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                  <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(taux,tsync(:,ii)) .LT. 0. )     &amp;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                       taux   = tsync(:,ii)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;              <span class="comment">! 4.c.3 Check with dependent higher rank grids ( TSYNC )</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;              <span class="comment">!       No check needed</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;              <span class="comment">! 4.c.4 Final check against grid time</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;              flagok = flagok .AND. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,taux).GT.0.</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;              <span class="comment">! 4.c.5 Update TSYNC throughout group</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;              <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                <span class="keywordflow">DO</span> jjj=1, ingrp(j,0)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                  ii     = ingrp(j,jjj)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                  tsync(:,ii) = taux</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                  <span class="keywordflow">IF</span> ( grstat(ii) .EQ. 2 ) grstat(ii) = 3</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( grstat(ii) .EQ. 3 )                 &amp;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                       <span class="keyword">WRITE</span> (mdst,9003) ii, grstat(ii)</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                done   = .true.</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9044) tsync(:,i), taux</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <span class="keyword">WRITE</span> (mdst,9045)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keyword">WRITE</span> (mdst,9046) (ii,tsync(:,ii),ii=0,nrgrd)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="comment">! 4.c.6 Skip computations so that all grids in group are advanced</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="comment">!       simultaneously.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,          &amp;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                     get_memory(),  <span class="stringliteral">&#39;ST02&#39;</span>, i</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( ingrp(j,0) .GT. 1 ) <span class="keyword">WRITE</span> (mdst,9006)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( ingrp(j,0) .GT. 1 ) <span class="keywordflow">GOTO</span> 1111</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! 4.b IF ( GRANK(I) .EQ. 1 )</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="keywordflow">          END IF</span> <span class="comment">! 4. IF ( GRSTAT(I) .EQ. 2 )</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          <span class="comment">! 5.  Run the wave model --------------------------------------------- /</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          <span class="comment">!     ( GRSTAT = 3 ) w3xdatmd data structures set in W3WAVE</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          <span class="comment">! 5.a Run model</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( grstat(i).EQ.3 .AND.                            &amp;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                 mpi_comm_grd .EQ. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;              <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>      = tsync(:,i)</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;              grstat(i) = 4</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;              done      = .true.</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( grstat(i).EQ.3 .AND.                     &amp;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                 mpi_comm_grd .NE. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39;RUNNING MODEL&#39;</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;              <span class="keyword">CALL </span>wmsetm ( i, mdse, mdst )</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3wavemd.html#a5e68663cd6aaa3a50e3de164a18db6b9">w3wave</a> ( i, dummy2, tsync(:,i), .false., .true. )</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;              <span class="keywordflow">IF</span> ( fllstl ) <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(1) = .false.</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;              <span class="keywordflow">IF</span> ( fllsti ) <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(4) = .false.</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;              <span class="keywordflow">IF</span> ( fllstr ) <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(6) = .false.</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;              <span class="comment">! 5.b Stage data for grids with equal rank</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a7c6dc364321a4028015d207ec5107ebd">wmioef</a> ( i )</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a94791d8fdf5527cc8d8ab4e012bde529">wmioes</a> ( i )</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;              <span class="comment">! 5.c Finish up</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;              grstat(i) = 4</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;              done      = .true.</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn, get_memory(),    &amp;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                   <span class="stringliteral">&#39;ST03&#39;</span>, i</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! IF ( GRSTAT(I).EQ.3 .AND. MPI_COMM_GRD .EQ. MPI_COMM_NULL )</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 3 )</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          <span class="comment">! 6.  Reconcile grids with same rank --------------------------------- /</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;          <span class="comment">!     and stage data transfer to higher and lower ranked grids.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;          <span class="comment">!     ( GRSTAT = 4 )</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 4 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="comment">! 6.a Test against times and statuses of dependent grids</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="comment">!     Note: This is done per GROUP, not per local equal grid dependence</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="comment">!           Therefore, it is essential that sync times per group are</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="comment">!           equal (4.c.1) and that all equal grid dependences are a</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="comment">!           subset of groups (WMGEQL 5.d)</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39;FIRST PART&#39;</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keyword">WRITE</span> (mdst,9005) fleqok(i)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="comment">! 6.a.1 Check if sync point is reached</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordflow">IF</span> ( .NOT. fleqok(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;              flagok = .true.</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;              taux   = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;              <span class="keywordflow">DO</span> jjj=1, ingrp(j,0)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keyword">CALL </span>w3setw ( ingrp(j,jjj), mdse, mdst )</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                flagok = flagok .AND. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(taux,<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>).EQ.0.   &amp;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                     .AND. grstat(ingrp(j,jjj)).EQ.4</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9004) flagok</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;              <span class="comment">! 6.a.2 Point reached, set flag for all in group and cycle</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;              <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                <span class="keywordflow">DO</span> jjj=1, ingrp(j,0)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                  fleqok(ingrp(j,jjj)) = .true.</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">WRITE</span> (mdst,9061) ingrp(j,jjj),      &amp;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                       fleqok(ingrp(j,jjj))</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                done      = .true.</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,      &amp;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                     get_memory(), <span class="stringliteral">&#39;ST04&#39;</span>, i</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( ingrp(j,0) .GT. 1 ) <span class="keyword">WRITE</span> (mdst,9006)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( ingrp(j,0) .GT. 1 ) <span class="keywordflow">GOTO</span> 1111</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">!  IF ( .NOT. FLEQOK(I) )</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            <span class="comment">! 6.b Call gathering routine, reset FLEQOK and cycle</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( .NOT.fleqok(i) .AND. .NOT.pregte(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;              <span class="keywordflow">IF</span> ( mpi_comm_grd.NE.mpi_comm_null )    &amp;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                   <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#aa726d9773260b7863e8de74b3d6bdca4">wmioeg</a> (i,flag)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;              pregte(i) = .true.</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordflow">IF</span> ( fleqok(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#aa726d9773260b7863e8de74b3d6bdca4">wmioeg</a> ( i )</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( mpi_comm_grd.NE.mpi_comm_null )    &amp;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                   <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#aa726d9773260b7863e8de74b3d6bdca4">wmioeg</a> ( i )</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;              pregte(i) = .false.</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor"></span>              grstat(i) = 5</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;              fleqok(i) = .false.</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;              done      = .true.</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            <span class="comment">! 6.c Stage data</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">IF</span> ( grstat(i) .EQ. 5 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i)-1, <span class="stringliteral">&#39;SECOND PART&#39;</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a5572bed109e848ebf2a203cc80417d44">wmiobs</a> ( i )</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( mpi_comm_grd .NE. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#ad418b078b01dab3f1095a8a7427153bd">wmiobf</a> ( i )</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a5572bed109e848ebf2a203cc80417d44">wmiobs</a> ( i )</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;              <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,          &amp;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                   get_memory(), <span class="stringliteral">&#39;ST04&#39;</span>, i</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="preprocessor"></span>              cycle loop_jj</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 5 )</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,              &amp;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                 get_memory(),  <span class="stringliteral">&#39;ST04&#39;</span>, i</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keywordflow">          END IF</span> <span class="comment">! 6. IF ( GRSTAT(I) .EQ. 4 )</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          <span class="comment">! 7.  Reconcile with higher ranked grids ----------------------------- /</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="comment">!     ( GRSTAT = 5 )</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          <span class="comment">!     This needs to be a little more complicated than with boundary</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <span class="comment">!     data to assure proper logic in cases where data providing</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          <span class="comment">!     data does not get data back (e.g., as for the boundary grid</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          <span class="comment">!     in mww3_test_04)</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 5 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment">! 7.a Test against times and statuses of dependent grids</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">IF</span> ( grdhgh(i,0) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;              grstat(i) = 6</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;              done      = .true.</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;              flagok = .true.</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;              taux   = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;              <span class="keywordflow">DO</span> jjj=1, grdhgh(i,0)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="keyword">CALL </span>w3setw ( grdhgh(i,jjj), mdse, mdst )</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">IF</span> ( .NOT. ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(taux,<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>).EQ.0. .AND.      &amp;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                     ( grstat(grdhgh(i,jjj)).GE.7  .OR. &amp;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                     grstat(grdhgh(i,jjj)).LE.2 ) ) ) &amp;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                     flagok = .false.</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9004) flagok</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;              <span class="comment">! 7.b Call gathering routine</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( .NOT.flagok .AND. .NOT.pregth(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="keywordflow">IF</span> ( mpi_comm_grd.NE.mpi_comm_null )     &amp;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a5718d371621787958652393e204f8643">wmiohg</a> ( i, flag )</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                pregth(i) = .true.</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;              <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a5718d371621787958652393e204f8643">wmiohg</a> ( i, flagok )</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( mpi_comm_grd.NE.mpi_comm_null )     &amp;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                     <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a5718d371621787958652393e204f8643">wmiohg</a> ( i )</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                pregth(i) = .false.</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="preprocessor"></span>                grstat(i) = 6</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                done      = .true.</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! IF ( GRDHGH(I,0) .EQ. 0 )</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="comment">! 7.c Stage data</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( grstat(i) .EQ. 6 ) <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#aaab03e946466d9fd7b7d0708e5b3726e">wmiohs</a> ( i )</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( grstat(i) .EQ. 6 .AND.                  &amp;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                 mpi_comm_grd .NE. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a6da700c7a46d644a7950430cb609685a">wmiohf</a> ( i )</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#aaab03e946466d9fd7b7d0708e5b3726e">wmiohs</a> ( i )</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (grstat(i).EQ.6) <span class="keyword">WRITE</span>(mdst,9003) i, grstat(i)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn, get_memory(),     &amp;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                 <span class="stringliteral">&#39;ST05&#39;</span>, i</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! 7. IF ( GRSTAT(I) .EQ. 5 )</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          <span class="comment">! 8.  Perform data assimmilation ------------------------------------- /</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <span class="comment">!     ( GRSTAT = 6 ) Placeholder only .....</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 6 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="preprocessor"></span>            grstat(i) = 7</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn, get_memory(),     &amp;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                 <span class="stringliteral">&#39;ST06&#39;</span>, i</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor"></span>            done      = .true.</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 6 )</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;          <span class="comment">! 9.  Perform output ------------------------------------------------- /</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;          <span class="comment">!     ( GRSTAT = 7 ) w3xdatmd data structures set in W3WAVE</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;          <span class="comment">! 9.a Check times and finish step if no output to be made</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 7 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( grstat(i).EQ.7 .AND. .NOT.flsync(i) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;              <span class="keywordflow">IF</span> ( toutp(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                dttst  = 1.</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , toutp(:,i) )</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9090) dttst</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="preprocessor"></span>              flg_o1 = dttst .EQ. 0.</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;              <span class="keywordflow">IF</span> ( unipts ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , upnext )</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                flg_o2 = dttst .EQ. 0.</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                flg_o2 = .false.</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;              <span class="keywordflow">IF</span> ( .NOT.flg_o1 .AND. .NOT.flg_o2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                grstat(i) = 8</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9003) i, grstat(i)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="preprocessor"></span>                done      = .true.</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! IF ( GRSTAT(I).EQ.7 .AND. .NOT.FLSYNC(I) )</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF ( GRSTAT(I) .EQ. 7 )</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="comment">! 9.b Perform output</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 7 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> ( mpi_comm_grd .NE. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;              <span class="keywordflow">IF</span> ( flg_o1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                <span class="keyword">CALL </span>w3setg ( i, mdse, mdst )</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keyword">CALL </span>wmsetm ( i, mdse, mdst )</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                <span class="keywordflow">IF</span> ( flghg1 .AND. .NOT.flghg2 .AND.               &amp;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                     grdhgh(i,0).GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                  <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a> = <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a> - 8*mapmsk</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                  <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a> = abs(<a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                  <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    <span class="keywordflow">DO</span> iy=1, ny</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a>(iy,ix) .GT. 0 )               &amp;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                           <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix) = - <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="keywordflow">                    END DO</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="keywordflow">                  END DO</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3wavemd.html#a5e68663cd6aaa3a50e3de164a18db6b9">w3wave</a> ( i, dummy2, tsync(:,i), .false. )</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                <span class="keywordflow">IF</span> ( flghg1 .AND. .NOT.flghg2 .AND.               &amp;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                     grdhgh(i,0).GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                  <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a> = <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a> + 8*mapmsk</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                  <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a> = abs(<a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                  <span class="keywordflow">DO</span> ix=1, nx</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                    <span class="keywordflow">DO</span> iy=1, ny</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">mapst2</a>(iy,ix) .GT. 0 )               &amp;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                           <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix) = - <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="keywordflow">                    END DO</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="keywordflow">                  END DO</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="keywordflow">IF</span> ( fllstl ) <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(1) = .false.</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                <span class="keywordflow">IF</span> ( fllsti ) <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(4) = .false.</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                <span class="keywordflow">IF</span> ( fllstr ) <a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(6) = .false.</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                <span class="comment">! 9.c Update TOUPT</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                toutp(1,i) = -1</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                toutp(2,i) =  0</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                <span class="keywordflow">DO</span> jo=1, notype</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                  <span class="keywordflow">IF</span> ( .NOT.flout(jo) ) cycle</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                  <span class="keywordflow">IF</span> ( toutp(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( toutp(:,i) , tonext(:,jo) )</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                    <span class="keywordflow">IF</span> (dttst.LT.0.) toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                <span class="comment">! CHECKPOINT</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                jo=8</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                <span class="keywordflow">IF</span> ( .NOT.flout(jo) ) cycle</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                <span class="keywordflow">IF</span> ( toutp(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                  toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                  dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( toutp(:,i) , tonext(:,jo) )</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                  <span class="keywordflow">IF</span> (dttst.LT.0.) toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="keywordflow">                ENDIF</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                <span class="comment">! END CHECKPOINT</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="preprocessor"></span>                <span class="keyword">WRITE</span> (mdst,9091) toutp(:,i)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLG_O1 )</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;              <span class="comment">! 9.d Process unified point output for selected grid</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;              <span class="keywordflow">IF</span> ( unipts ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <span class="keywordflow">IF</span> ( flg_o2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                  <span class="keyword">CALL </span>w3seto ( i, mdse, mdst )</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>.NE.0 ) <span class="keyword">CALL </span>mpi_startall      &amp;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                       ( <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>, <a class="code" href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">irqpo1</a>, ierr_mpi )</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                  <span class="keywordflow">IF</span> ( nopts.NE.0 .AND. iaproc.EQ.nappnt ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    <span class="keyword">CALL </span>w3setg ( i, mdse, mdst )</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3adatmd.html#ab2c0f2e6e7524fb061d841ba7a7324a1">w3seta</a> ( i, mdse, mdst )</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3iopomd.html#a9bbc253bffd32ee330cad4928783178e">w3iope</a> ( va )</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a> .NE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                    <span class="keyword">ALLOCATE</span> ( status(mpi_status_size,<a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>) )</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                    <span class="keyword">CALL </span>mpi_waitall                      &amp;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                         ( <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>, <a class="code" href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">irqpo1</a>, status, ierr_mpi )</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                    <span class="keyword">DEALLOCATE</span> ( status )</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">WRITE</span> (mdst,9092) nopts</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="keywordflow">                END IF</span> <span class="comment">! IF ( FLG_O2 )</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( UNIPTS )</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;              <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,get_memory(),      &amp;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                   <span class="stringliteral">&#39;ST07&#39;</span>, i</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;              <span class="comment">! 9.e Update TOUPT outside communicator</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( flg_o1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>w3seto ( i, mdse, mdst )</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="preprocessor"></span>              <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>       = toutp(:,i)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;              toutp(1,i) = -1</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;              toutp(2,i) =  0</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">DO</span> jo=1, notype</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( flout(jo) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                  <span class="keywordflow">DO</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                    dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tonext(:,jo) )</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                    <span class="keywordflow">IF</span> ( dttst .LE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                      <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( tonext(:,jo), dtout(jo) )</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                      dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tonext(:,jo), tolast(:,jo) )</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                      <span class="keywordflow">IF</span> ( dttst .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                        flout(jo) = .false.</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                        <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="keywordflow">                      END IF</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                      <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="keywordflow">                  END DO</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="keywordflow">                END IF</span> <span class="comment">! IF ( FLOUT(JO) )</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( .NOT.flout(jo) ) cycle</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                <span class="keywordflow">IF</span> ( toutp(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                  toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                  dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( toutp(:,i) , tonext(:,jo) )</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                  <span class="keywordflow">IF</span> (dttst.LT.0.) toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">                ENDIF</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="preprocessor"></span><span class="keywordflow">              END DO</span> <span class="comment">! DO JO=1, NOTYPE</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;              <span class="comment">! Checkpoint</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="preprocessor"></span>              jo=8</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( flout(jo) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                <span class="keywordflow">DO</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                  dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tonext(:,jo) )</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                  <span class="keywordflow">IF</span> ( dttst .LE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( tonext(:,jo), dtout(jo) )</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                    dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tonext(:,jo), tolast(:,jo) )</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                    <span class="keywordflow">IF</span> ( dttst .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                      flout(jo) = .false.</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                      <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLOUT(JO) )</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( .NOT.flout(jo) ) cycle</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;              <span class="keywordflow">IF</span> ( toutp(1,i) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                dttst = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( toutp(:,i) , tonext(:,jo) )</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                <span class="keywordflow">IF</span> (dttst.LT.0.) toutp(:,i) = tonext(:,jo)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keywordflow">              ENDIF</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;              <span class="comment">! End Checkpoint</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9991) toutp(:,i)</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! 9.b IF ( MPI_COMM_GRD .NE. MPI_COMM_NULL )</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <span class="comment">! 9.f Finish up</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            grstat(i) = 8</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            done      = .true.</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keywordflow">          END IF</span> <span class="comment">! 9.b IF ( GRSTAT(I) .EQ. 7 )</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;          <span class="comment">! 10. Go to next time step ------------------------------------------- /</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          <span class="comment">!     ( GRSTAT = 8 ) ( 9 added for diagnostic output only ... )</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          <span class="comment">!                    ( Unified point output and synchronization added )</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          <span class="keywordflow">IF</span> ( grstat(i) .EQ. 8 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (mdst,9002) i, grstat(i), <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <span class="comment">! 10.a Processing unified point output</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="keywordflow">IF</span> ( unipts .AND. do_upt ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;              flagok = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, upnext ) .EQ. 0.</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9095) flagok</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;              flagok = .false.</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;              <span class="keywordflow">DO</span> ii=1, nrgrd</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                <span class="keyword">CALL </span>w3setw ( ii, mdse, mdst )</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                flagok = flagok .AND. grstat(ii).EQ.8 .AND.     &amp;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                     <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,upnext).EQ.0.</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9096) flagok</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;              <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span>prtime ( prft0 )</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span><a class="code" href="namespacewmiopomd.html#a8ba5eb53840b8db721166904529e5aa9">wmiopo</a> ( upnext )</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                do_upt = .false.</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                <span class="keyword">CALL </span>w3seto ( 0, mdse, mdst )</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( upnext, dtout(2) )</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(upnext,uplast) .GE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                  tonext(:,2) = upnext</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                  unipts = .false.</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                  upnext(1) = -1</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                  upnext(2) =  0</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                <span class="keywordflow">DO</span> ii=1, nrgrd</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                  <span class="keyword">CALL </span>w3setw ( ii, mdse, mdst )</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                  dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tend(:,ii) )</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                  <span class="keywordflow">IF</span> ( dttst .GT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                    grstat(ii) = 9</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( dttst .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                    grstat(ii) = 99</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                  tsync(1,ii) = -1</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                  tsync(2,ii) =  0</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( i .NE. ii )                         &amp;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                       <span class="keyword">WRITE</span> (mdst,9003) ii, grstat(ii)</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                done      = .true.</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="preprocessor"></span>                <span class="keyword">CALL </span>prtime ( prftn )</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                <span class="keyword">WRITE</span> (<a class="code" href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">mdsp</a>,991) prft0, prftn,          &amp;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                     get_memory(), <span class="stringliteral">&#39;UPTS&#39;</span>,i</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="preprocessor"></span><span class="keywordflow">              END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;              flagok = .true.</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="comment">! 10.b Regular processing</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            <span class="keywordflow">IF</span> ( flagok ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;              <span class="keyword">CALL </span>w3setw ( i, mdse, mdst )</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tend(:,i) )</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;              <span class="keywordflow">IF</span> ( dttst .GT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                grstat(i) = 9</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                done      = .true.</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( dttst .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                grstat(i) = 99</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                done      = .true.</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (mdst,9003) i, grstat(i)</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span> <span class="comment">! IF ( FLAGOK )</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="keywordflow">IF</span> ( grstat(i).EQ.9 .OR. grstat(i).EQ.99 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;              tsync(1,i) = -1</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;              tsync(2,i) =  0</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="keywordflow">          END IF</span> <span class="comment">! 10. IF ( GRSTAT(I) .EQ. 8 )</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;          <span class="comment">! ... End of loops started in 1. ------------------------------------- /</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="keywordflow">        END DO</span> loop_jj</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;1111    <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="keywordflow">      END DO</span> loop_j</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="preprocessor"></span>      nmpscr = nmpscs</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc )                    &amp;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;           <span class="keyword">CALL </span>wmprnt ( mdso, nrgrd, tsync(:,0), grstat )</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="keywordflow">DO</span> i=1, nrgrd</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="keywordflow">IF</span> ( grstat(i) .EQ. 9 ) grstat(i) = 0</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <span class="keywordflow">IF</span> ( .NOT. done ) <span class="keywordflow">GOTO</span> 2099</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      <span class="keywordflow">IF</span> ( minval(grstat) .EQ. 99 ) <span class="keywordflow">EXIT</span> loop_outer</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="keywordflow">    END DO</span> loop_outer</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">!    End of routine -------------------------------------------------- /</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keyword">CALL </span>wwtime ( wtime )</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keyword">WRITE</span> (mdss,902) wtime</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> i=1, nrgrd</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keyword">CALL </span>wmsetm ( i, mdse, mdst )</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="keywordflow">IF</span> ( mpi_comm_grd .NE. mpi_comm_null ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#ad418b078b01dab3f1095a8a7427153bd">wmiobf</a> ( i )</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a6da700c7a46d644a7950430cb609685a">wmiohf</a> ( i )</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacewminiomd.html#a7c6dc364321a4028015d207ec5107ebd">wmioef</a> ( i )</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="preprocessor">#ifdef W3_O10</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( mdss.NE.mdso .AND. nmpscr.EQ.improc ) <span class="keyword">WRITE</span> (mdss,999)</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (mdst,9100)</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">! Escape locations</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;2000 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">IF</span> ( improc .EQ. nmperr ) <span class="keyword">WRITE</span> (mdse,1000) i, grstat(i)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keyword">CALL </span>extcde ( 2000 )</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;2001 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">IF</span> ( improc .EQ. nmperr ) <span class="keyword">WRITE</span> (mdse,1001) i, tsync(:,i),      &amp;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;         tend(:,i)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keyword">CALL </span>extcde ( 2001 )</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;2002 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">IF</span> ( improc .EQ. nmperr ) <span class="keyword">WRITE</span> (mdse,1002) j, ingrp(j,1),      &amp;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;         ingrp(j,jj), tsync(:,ingrp(j,1)), tsync(:,ingrp(j,jj)),    &amp;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;         tend(:,ingrp(j,1)), tend(:,ingrp(j,jj))</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keyword">CALL </span>extcde ( 2002 )</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;2099 <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">IF</span> ( improc .EQ. nmperr ) <span class="keyword">WRITE</span> (mdse,1099)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keyword">CALL </span>extcde ( 2099 )</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;900 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; ========== STARTING WAVE MODEL (WMWAVE) ==========&#39;</span>, &amp;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;         <span class="stringliteral">&#39;============================&#39;</span>/)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;901 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39;  MWW3 calculating for &#39;</span>,a,<span class="stringliteral">&#39; at &#39;</span>,a,<span class="stringliteral">&#39;  status [&#39;</span>,      &amp;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;         i2,<span class="stringliteral">&#39;-&#39;</span>,i2,<span class="stringliteral">&#39;]&#39;</span>)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;902 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39;  MWW3 reached the end of the computation loop at &#39;</span>,a)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="preprocessor">#ifdef W3_MPRF</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="preprocessor"></span>990 <span class="keyword">FORMAT</span> (1x,3f12.3,<span class="stringliteral">&#39; WMWAVE INIT&#39;</span>)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;991 <span class="keyword">FORMAT</span> (1x,3f12.3,<span class="stringliteral">&#39; WMWAVE &#39;</span>,a4,i6)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;992 <span class="keyword">FORMAT</span> (1x,3f12.3,<span class="stringliteral">&#39; WMWAVE &#39;</span>,a4,i9.8,i7.6)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor"></span>999 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; ========== END OF WAVE MODEL (WMWAVE) ============&#39;</span>, &amp;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;         <span class="stringliteral">&#39;============================&#39;</span>/)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;1000 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN WMWAVE : *** &#39;</span>/           &amp;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;         <span class="stringliteral">&#39;     GRID&#39;</span>,i3,<span class="stringliteral">&#39; HAS ILLEGAL GRSTAT :&#39;</span>,i8/)</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;1001 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN WMWAVE : *** &#39;</span>/           &amp;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;         <span class="stringliteral">&#39;     GRID&#39;</span>,i3,<span class="stringliteral">&#39; HAS ILLEGAL TSYNC / TEND &#39;</span>/           &amp;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;         <span class="stringliteral">&#39;     TSYNC :&#39;</span>,i9.8,i7.6/                              &amp;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;         <span class="stringliteral">&#39;     TEND  :&#39;</span>,i9.8,i7.6/)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;1002 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN WMWAVE : *** &#39;</span>/           &amp;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;         <span class="stringliteral">&#39;     GROUP&#39;</span>,i3,<span class="stringliteral">&#39; HAS INCOMPATIBLE TIMES &#39;</span>,            &amp;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;         <span class="stringliteral">&#39;IN GRIDS &#39;</span>,i3,<span class="stringliteral">&#39; AND &#39;</span>,i3/                             &amp;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;         <span class="stringliteral">&#39;     TSYNC :&#39;</span>,i9.8,i7.6,1x,i9.8,i7.6/                 &amp;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;         <span class="stringliteral">&#39;     TEND  :&#39;</span>,i9.8,i7.6,1x,i9.8,i7.6/)</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="comment">! Note: This 1099 error can occur when multi-grid time steps are not</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">!       compatible.</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;1099 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN WMWAVE : *** &#39;</span>/           &amp;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;         <span class="stringliteral">&#39;     ABORT FOR POSSIBLE ENDLESS LOOP &#39;</span>/)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : LOOP&#39;</span>,i8,<span class="stringliteral">&#39; ======================&#39;</span>, &amp;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;         <span class="stringliteral">&#39;===== (&#39;</span>,i9.8,i7.6,<span class="stringliteral">&#39; ) ==&#39;</span>/ &amp;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;         <span class="stringliteral">&#39;               GRID, GRSTAT, TIME, TSYNC, TEND&#39;</span>)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;9001 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39;              &#39;</span>,i3,i3,3(i10.8,i7.6))</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;9002 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : PROCESSING GRID&#39;</span>,i3,                &amp;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;         <span class="stringliteral">&#39; STATUS&#39;</span>,i3,<span class="stringliteral">&#39; &#39;</span>,a)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="preprocessor"></span>9902 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; MPIT WMWAVE : PROCESSING GRID&#39;</span>,i3,             &amp;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;         <span class="stringliteral">&#39; STATUS&#39;</span>,i3,<span class="stringliteral">&#39; &#39;</span>,a)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="preprocessor"></span>9003 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : GRID&#39;</span>,i3,<span class="stringliteral">&#39; STATUS RESET TO&#39;</span>,i3)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;9004 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : FLAGOK = &#39;</span>,l1)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;9005 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : FLEQOK = &#39;</span>,l1)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;9006 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : CYCLE GROUP&#39;</span>)</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="preprocessor"></span>9020 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : DTTST &#39;</span>,e10.3)</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;9021 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : TIME  :&#39;</span>,i10.8,i7.6/                &amp;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;         <span class="stringliteral">&#39;               TDATA :&#39;</span>,i10.8,i7.6/                &amp;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;         <span class="stringliteral">&#39;               TEND  :&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="preprocessor"></span>9040 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : TMAX  :&#39;</span>,i10.8,i7.6,f8.2/           &amp;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;         <span class="stringliteral">&#39;               DTMAX :&#39;</span>,i10.8,i7.6/                &amp;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;         <span class="stringliteral">&#39;               TDATA :&#39;</span>,i10.8,i7.6/                &amp;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;         <span class="stringliteral">&#39;               TOUTP :&#39;</span>,i10.8,i7.6/                &amp;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;         <span class="stringliteral">&#39;               UPNEXT:&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;9041 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : TMAX  :&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="preprocessor"></span>9941 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; MPIT WMWAVE : TMAX  :&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="preprocessor"></span>9042 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : GRANK :&#39;</span>,i4,<span class="stringliteral">&#39; FOR GRSTAT = 2&#39;</span>)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;9043 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : GLOBAL TSYNC :&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;9044 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : LOCAL TSYNC :&#39;</span>,i10.8,i7.6,          &amp;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;         <span class="stringliteral">&#39; (&#39;</span>,i8.8,i7.6,<span class="stringliteral">&#39;)&#39;</span>)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;9045 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : GRID TSYNC&#39;</span>)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;9046 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39;             &#39;</span>,i5,i10.8,i7.6)</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="preprocessor"></span>9061 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39;               GRID&#39;</span>,i4,<span class="stringliteral">&#39;,  FLEQOK = &#39;</span>,l1)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="preprocessor"></span>9090 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : DTTST &#39;</span>,e10.3)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;9091 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : NEXT TOUTP :&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="preprocessor"></span>9991 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; MPIT WMWAVE : NEXT TOUTP :&#39;</span>,i10.8,i7.6)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="preprocessor"></span>9092 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : UNIFIED POINT OUTPUT PREP DONE&#39;</span>,i6)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="preprocessor"></span>9095 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : UNIFIED POINT OUTPUT, FLAGOK = &#39;</span>,l1)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;9096 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39;               ALL GRIDS, FLAGOK = &#39;</span>,l1)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="preprocessor"></span>9100 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWAVE : LOOP DONE  ======================&#39;</span>, &amp;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;         <span class="stringliteral">&#39;==============================&#39;</span>)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">!/ End of WMWAVE ----------------------------------------------------- /</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="wmmdatmd_8F90_source.html#l00550">wmmdatmd::amv</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00545">wmmdatmd::croot</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00551">wmmdatmd::dmv</a>, <a class="el" href="w3timemd_8F90_source.html#l00333">w3timemd::dsec21()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dtmax</a>, <a class="el" href="w3odatmd_8F90_source.html#l00467">w3odatmd::dtout</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00377">wmmdatmd::dtres</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00329">wmmdatmd::etime</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00568">wmmdatmd::fbcast</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00379">wmmdatmd::flghg1</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00380">wmmdatmd::flghg2</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00562">wmmdatmd::fllsti</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00560">wmmdatmd::fllstl</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00561">wmmdatmd::fllstr</a>, <a class="el" href="w3odatmd_8F90_source.html#l00468">w3odatmd::flout</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00353">wmmdatmd::grank</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00357">wmmdatmd::grdeql</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00356">wmmdatmd::grdhgh</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00359">wmmdatmd::grdlow</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00366">wmmdatmd::grstat</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00322">wmmdatmd::improc</a>, <a class="el" href="CMakeLists_8txt_source.html#l00015">include()</a>, <a class="el" href="w3idatmd_8F90_source.html#l00260">w3idatmd::inflags1</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00355">wmmdatmd::ingrp</a>, <a class="el" href="w3odatmd_8F90_source.html#l00490">w3odatmd::irqpo1</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00540">wmmdatmd::mapmsk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapst2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsta</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00316">wmmdatmd::mdse</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00313">wmmdatmd::mdso</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00341">wmmdatmd::mdsp</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00314">wmmdatmd::mdss</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00315">wmmdatmd::mdst</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00544">wmmdatmd::mpi_comm_bct</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00543">wmmdatmd::mpi_comm_grd</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00344">wmmdatmd::mpi_comm_mwave</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::nappnt</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00326">wmmdatmd::nmperr</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00323">wmmdatmd::nmplog</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00321">wmmdatmd::nmproc</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00324">wmmdatmd::nmpscr</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00325">wmmdatmd::nmptst</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00537">wmmdatmd::nmv</a>, <a class="el" href="w3odatmd_8F90_source.html#l00484">w3odatmd::nopts</a>, <a class="el" href="w3odatmd_8F90_source.html#l00327">w3odatmd::notype</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00330">wmmdatmd::nrgrd</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00332">wmmdatmd::nrgrp</a>, <a class="el" href="w3odatmd_8F90_source.html#l00486">w3odatmd::nrqpo</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="w3timemd_8F90_source.html#l00990">w3timemd::prtime()</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00328">wmmdatmd::stime</a>, <a class="el" href="w3timemd_8F90_source.html#l00682">w3timemd::stme21()</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00365">wmmdatmd::tdata</a>, <a class="el" href="w3timemd_8F90_source.html#l00084">w3timemd::tick21()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::time</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00363">wmmdatmd::tmax</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00538">wmmdatmd::tmv</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tolast</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tonext</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00364">wmmdatmd::toutp</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00362">wmmdatmd::tsync</a>, <a class="el" href="w3odatmd_8F90_source.html#l00333">w3odatmd::unipts</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::va</a>, <a class="el" href="w3iopomd_8F90_source.html#l00697">w3iopomd::w3iope()</a>, <a class="el" href="w3adatmd_8F90_source.html#l02645">w3adatmd::w3seta()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l02152">w3gdatmd::w3setg()</a>, <a class="el" href="w3odatmd_8F90_source.html#l01523">w3odatmd::w3seto()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00660">w3wdatmd::w3setw()</a>, <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wavemd::w3wave()</a>, <a class="el" href="wmwavemd_8F90_source.html#l01952">wmbcst()</a>, <a class="el" href="wminiomd_8F90_source.html#l01212">wminiomd::wmiobf()</a>, <a class="el" href="wminiomd_8F90_source.html#l00497">wminiomd::wmiobg()</a>, <a class="el" href="wminiomd_8F90_source.html#l00105">wminiomd::wmiobs()</a>, <a class="el" href="wminiomd_8F90_source.html#l03399">wminiomd::wmioef()</a>, <a class="el" href="wminiomd_8F90_source.html#l02820">wminiomd::wmioeg()</a>, <a class="el" href="wminiomd_8F90_source.html#l02493">wminiomd::wmioes()</a>, <a class="el" href="wminiomd_8F90_source.html#l02325">wminiomd::wmiohf()</a>, <a class="el" href="wminiomd_8F90_source.html#l01724">wminiomd::wmiohg()</a>, <a class="el" href="wminiomd_8F90_source.html#l01384">wminiomd::wmiohs()</a>, <a class="el" href="wmiopomd_8F90_source.html#l00640">wmiopomd::wmiopo()</a>, <a class="el" href="wmwavemd_8F90_source.html#l01777">wmprnt()</a>, <a class="el" href="wmmdatmd_8F90_source.html#l01169">wmmdatmd::wmsetm()</a>, <a class="el" href="wmupdtmd_8F90_source.html#l00103">wmupdtmd::wmupdt()</a>, and <a class="el" href="w3servmd_8F90_source.html#l00664">w3servmd::wwtime()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ww3__multi_8F90_source.html#l00014">w3mlti()</a>, and <a class="el" href="ww3__sbs1_8F90_source.html#l00036">w3sbs1()</a>.</p>

</div>
</div>
<a id="a97e5439129ce74e693469e87f50e8856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e5439129ce74e693469e87f50e8856">&#9670;&nbsp;</a></span>wmwout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine wmwavemd::wmwout </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IMOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NMOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Non-blocking broadcast using dummy parameter to have output. </p>
<p>Processes wait for computations on first node to be finished. Needed for profiling purposes only.</p>
<p>Standard send and recieves using defined communicator. Send form first processor in communicator.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">IMOD</td><td>Model number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NMOD</td><td>Number of models. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ID</td><td>ID number, used with NMOD for ITAG.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>21-Jun-2007 </dd></dl>

<p class="definition">Definition at line <a class="el" href="wmwavemd_8F90_source.html#l02134">2134</a> of file <a class="el" href="wmwavemd_8F90_source.html">wmwavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="comment">!/                  | Last update :         21-Jun-2007 !</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="comment">!/    21-Jun-2007 : Origination.                        ( version 3.11 )</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="comment">!     Non-blocking broadcast using dummy parameter to have output!</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="comment">!     processes wait for computations on first node to be finished.</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="comment">!     Neede for profiling purposes only.</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="comment">!     Standard send and recieves using defined communicator. Send</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="comment">!     form first processor in communicator.</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">!       IMOD    Int.   I   Model number.</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="comment">!       NMOD    Int.   I   Number of models.</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="comment">!       ID      Int.   I   ID number, used with NMOD for ITAG.</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="comment">!      STRACE    Sur.  W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">!      W3SETO    Subr. W3ODATMD Point to data structure</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="comment">!      W3SETA    Subr. W3ADATMD Point to data structure</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">!      WMWAVE    Subr. WMWAVEMD Multi-grid wave model routine.</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="comment">!     !/S    Enable subroutine tracing.</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">!     !/MPIT Enable test output</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a40de4775d7cb1e739098ef04139a6019">w3seto</a></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#ab2c0f2e6e7524fb061d841ba7a7324a1">w3seta</a></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a>, <a class="code" href="namespacew3odatmd.html#ad5eb132c9c8e7bbf415e52ad5bb81db1">ntproc</a></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">mpi_comm_wave</a></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewmmdatmd.html">wmmdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacewmmdatmd.html#a1c3b6c120a3391849d9d49238ce13d38">mdst</a>, <a class="code" href="namespacewmmdatmd.html#a545b1cbca9a52a30e829796993947e45">mdse</a>, <a class="code" href="namespacewmmdatmd.html#a7574d0e2aa572bf92fdab3ced4e02ac0">mtagb</a></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="preprocessor"></span>    <a class="code" href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a> <span class="stringliteral">&quot;mpif.h&quot;</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: IMOD, NMOD, ID</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ITAG, IP, IERR_MPI,             &amp;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;         STATUS(MPI_STATUS_SIZE)</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>, <span class="keywordtype">SAVE</span>              :: DUMMY = 999.</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;WMWOUT&#39;</span>)</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">! 0.  Initializations</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>w3seto ( imod, <a class="code" href="namespacewmmdatmd.html#a545b1cbca9a52a30e829796993947e45">mdse</a>, <a class="code" href="namespacewmmdatmd.html#a1c3b6c120a3391849d9d49238ce13d38">mdst</a> )</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keyword">CALL </span>w3seta ( imod, <a class="code" href="namespacewmmdatmd.html#a545b1cbca9a52a30e829796993947e45">mdse</a>, <a class="code" href="namespacewmmdatmd.html#a1c3b6c120a3391849d9d49238ce13d38">mdst</a> )</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    itag   = <a class="code" href="namespacewmmdatmd.html#a7574d0e2aa572bf92fdab3ced4e02ac0">mtagb</a> + imod + id*nmod</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .LT. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    <span class="comment">! 1.  Processor to send data from</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="keywordflow">DO</span> ip=<a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a>+1, <a class="code" href="namespacew3odatmd.html#ad5eb132c9c8e7bbf415e52ad5bb81db1">ntproc</a></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>mpi_send ( dummy, 1, mpi_integer, ip-1,         &amp;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;             itag, <a class="code" href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">mpi_comm_wave</a>, ierr_mpi )</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="comment">! 2.  Processor to receive data at</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .GT. <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span>mpi_recv ( dummy, 1, mpi_integer, 0, itag,        &amp;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;           <a class="code" href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">mpi_comm_wave</a>, status, ierr_mpi )</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="comment">! -------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      <span class="comment">! 3.  Processor with no action</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWOUT : INPUTS :&#39;</span>,4i4)</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;9001 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWOUT : IAPROC, NAPROC, NTPROC :&#39;</span>,3i5)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;9002 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWOUT : NOT IN COMMUNICATOR&#39;</span>)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="preprocessor"></span>9010 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWOUT : IAPROC =&#39;</span>,i5,<span class="stringliteral">&#39;    SENDING TO &#39;</span>,i5)</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="preprocessor"></span>9020 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWOUT : IAPROC =&#39;</span>,i5,                    &amp;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;         <span class="stringliteral">&#39;    RECEIVING FROM &#39;</span>,i5)</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="preprocessor"></span>9030 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST WMWOUT : IAPROC =&#39;</span>,i5,<span class="stringliteral">&#39;    NO ACTION&#39;</span>)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="comment">!/ End of WMWOUT ----------------------------------------------------- /</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="CMakeLists_8txt_source.html#l00015">include()</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00316">wmmdatmd::mdse</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00315">wmmdatmd::mdst</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::mpi_comm_wave</a>, <a class="el" href="wmmdatmd_8F90_source.html#l00345">wmmdatmd::mtagb</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::ntproc</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="w3adatmd_8F90_source.html#l02645">w3adatmd::w3seta()</a>, and <a class="el" href="w3odatmd_8F90_source.html#l01523">w3odatmd::w3seto()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacew3timemd_html_a32487c213ce877b1194cb0244ebfafc7"><div class="ttname"><a href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">w3timemd::dsec21</a></div><div class="ttdeci">real function dsec21(TIME1, TIME2)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00333">w3timemd.F90:333</a></div></div>
<div class="ttc" id="aCMakeLists_8txt_html_a8c90ab403bf8fd22fc61c4912dbfce20"><div class="ttname"><a href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a></div><div class="ttdeci">cmake src_list cmake include(${CMAKE_CURRENT_SOURCE_DIR}/cmake/check_switches.cmake) check_switches(&quot;$</div><div class="ttdef"><b>Definition:</b> <a href="CMakeLists_8txt_source.html#l00015">CMakeLists.txt:15</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_aa632438d41b3b855e4d77e5267b2712d"><div class="ttname"><a href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">w3odatmd::nrqpo</a></div><div class="ttdeci">integer, pointer nrqpo</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00486">w3odatmd.F90:486</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a545b1cbca9a52a30e829796993947e45"><div class="ttname"><a href="namespacewmmdatmd.html#a545b1cbca9a52a30e829796993947e45">wmmdatmd::mdse</a></div><div class="ttdeci">integer mdse</div><div class="ttdoc">MDSE.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00316">wmmdatmd.F90:316</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_afbd06f609252e097fb41aabfffce4e73"><div class="ttname"><a href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">w3idatmd::inflags1</a></div><div class="ttdeci">logical, dimension(:), pointer inflags1</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00260">w3idatmd.F90:260</a></div></div>
<div class="ttc" id="anamespacewmiopomd_html"><div class="ttname"><a href="namespacewmiopomd.html">wmiopomd</a></div><div class="ttdoc">Module for generating a single point output file for a multi- grid model implementation.</div><div class="ttdef"><b>Definition:</b> <a href="wmiopomd_8F90_source.html#l00015">wmiopomd.F90:15</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a8f5a1eaad48354e6b56f1ff69ff00dd2"><div class="ttname"><a href="namespacew3odatmd.html#a8f5a1eaad48354e6b56f1ff69ff00dd2">w3odatmd::notype</a></div><div class="ttdeci">integer notype</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00327">w3odatmd.F90:327</a></div></div>
<div class="ttc" id="anamespacewmupdtmd_html"><div class="ttname"><a href="namespacewmupdtmd.html">wmupdtmd</a></div><div class="ttdoc">Update model input at the driver level of the multi-grid version of WAVEWATCH III.</div><div class="ttdef"><b>Definition:</b> <a href="wmupdtmd_8F90_source.html#l00014">wmupdtmd.F90:14</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html"><div class="ttname"><a href="namespacew3adatmd.html">w3adatmd</a></div><div class="ttdoc">Define data structures to set up wave model auxiliary data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00026">w3adatmd.F90:26</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a18f62a347d7a6212c2b40f9bd19ad86c"><div class="ttname"><a href="namespacewmmdatmd.html#a18f62a347d7a6212c2b40f9bd19ad86c">wmmdatmd::stime</a></div><div class="ttdeci">integer, dimension(2) stime</div><div class="ttdoc">STIME.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00328">wmmdatmd.F90:328</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a8e3b5b55fc5e27edf99c3c8478c8c10f"><div class="ttname"><a href="namespacewmmdatmd.html#a8e3b5b55fc5e27edf99c3c8478c8c10f">wmmdatmd::fllsti</a></div><div class="ttdeci">logical, pointer fllsti</div><div class="ttdoc">FLLSTI.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00562">wmmdatmd.F90:562</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a0d2ec80950da63735ef903b3f291274b"><div class="ttname"><a href="namespacewmmdatmd.html#a0d2ec80950da63735ef903b3f291274b">wmmdatmd::dmv</a></div><div class="ttdeci">real, dimension(:,:), pointer dmv</div><div class="ttdoc">DMV.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00551">wmmdatmd.F90:551</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_aa1546f99a2809091a3466d2dd16d08c1"><div class="ttname"><a href="namespacewmmdatmd.html#aa1546f99a2809091a3466d2dd16d08c1">wmmdatmd::croot</a></div><div class="ttdeci">integer, pointer croot</div><div class="ttdoc">CROOT.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00545">wmmdatmd.F90:545</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html"><div class="ttname"><a href="namespacew3wdatmd.html">w3wdatmd</a></div><div class="ttdoc">Define data structures to set up wave model dynamic data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00018">w3wdatmd.F90:18</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a57716bae728c55d2c9492ef2d48150bb"><div class="ttname"><a href="namespacewmmdatmd.html#a57716bae728c55d2c9492ef2d48150bb">wmmdatmd::nmpscr</a></div><div class="ttdeci">integer nmpscr</div><div class="ttdoc">NMPSCR.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00324">wmmdatmd.F90:324</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_adfd64faa2165e36009af0b7b9fae44f0"><div class="ttname"><a href="namespacew3odatmd.html#adfd64faa2165e36009af0b7b9fae44f0">w3odatmd::nopts</a></div><div class="ttdeci">integer, pointer nopts</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00484">w3odatmd.F90:484</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a94fd47efa201e22b60dd6aef5c15937b"><div class="ttname"><a href="namespacewmmdatmd.html#a94fd47efa201e22b60dd6aef5c15937b">wmmdatmd::tmax</a></div><div class="ttdeci">integer, dimension(:,:), allocatable tmax</div><div class="ttdoc">TMAX.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00363">wmmdatmd.F90:363</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a9bcaeeb6056e5ef546645f059aece1f8"><div class="ttname"><a href="namespacewmmdatmd.html#a9bcaeeb6056e5ef546645f059aece1f8">wmmdatmd::fllstl</a></div><div class="ttdeci">logical, pointer fllstl</div><div class="ttdoc">FLLSTL.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00560">wmmdatmd.F90:560</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ad5eb132c9c8e7bbf415e52ad5bb81db1"><div class="ttname"><a href="namespacew3odatmd.html#ad5eb132c9c8e7bbf415e52ad5bb81db1">w3odatmd::ntproc</a></div><div class="ttdeci">integer, pointer ntproc</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_aad527950f206377d049ee70b94ed4ba7"><div class="ttname"><a href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">w3odatmd::dtout</a></div><div class="ttdeci">real, dimension(:), pointer dtout</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00467">w3odatmd.F90:467</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_ac0062324f64bf30624617b18c27e24f7"><div class="ttname"><a href="namespacewmmdatmd.html#ac0062324f64bf30624617b18c27e24f7">wmmdatmd::nrgrp</a></div><div class="ttdeci">integer nrgrp</div><div class="ttdoc">NRGRP.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00332">wmmdatmd.F90:332</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a5d19fda88dfab964f912a8228343733c"><div class="ttname"><a href="namespacewmmdatmd.html#a5d19fda88dfab964f912a8228343733c">wmmdatmd::nmv</a></div><div class="ttdeci">integer, pointer nmv</div><div class="ttdoc">NMV.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00537">wmmdatmd.F90:537</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a36a4047055987bb52cab303f0207f676"><div class="ttname"><a href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">w3odatmd::iaproc</a></div><div class="ttdeci">integer, pointer iaproc</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a4ecc54bad82b08b6a2b5c0442fb3040d"><div class="ttname"><a href="namespacewmmdatmd.html#a4ecc54bad82b08b6a2b5c0442fb3040d">wmmdatmd::mdss</a></div><div class="ttdeci">integer mdss</div><div class="ttdoc">MDSS.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00314">wmmdatmd.F90:314</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a91e6f2e680d6b6e615a4eb6828182bf6"><div class="ttname"><a href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">w3wdatmd::time</a></div><div class="ttdeci">integer, dimension(:), pointer time</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_af26b24a4c6da8cdb20568a2883599969"><div class="ttname"><a href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">w3odatmd::irqpo1</a></div><div class="ttdeci">integer, dimension(:), pointer irqpo1</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00490">w3odatmd.F90:490</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a9f5e0d144a9bb960616eaf2e830cccb3"><div class="ttname"><a href="namespacew3odatmd.html#a9f5e0d144a9bb960616eaf2e830cccb3">w3odatmd::unipts</a></div><div class="ttdeci">logical unipts</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00333">w3odatmd.F90:333</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a87dd8cd7d939f4da5df3bfa8adc25360"><div class="ttname"><a href="namespacewmmdatmd.html#a87dd8cd7d939f4da5df3bfa8adc25360">wmmdatmd::mpi_comm_grd</a></div><div class="ttdeci">integer, pointer mpi_comm_grd</div><div class="ttdoc">MPI_COMM_GRD.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00543">wmmdatmd.F90:543</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a3b53b5e433921c9cbabb9b3b0333aecc"><div class="ttname"><a href="namespacewmmdatmd.html#a3b53b5e433921c9cbabb9b3b0333aecc">wmmdatmd::grdeql</a></div><div class="ttdeci">integer, dimension(:,:), allocatable grdeql</div><div class="ttdoc">GRDEQL.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00357">wmmdatmd.F90:357</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a3d5fc7ef059560ca3ee99f9c66720c34"><div class="ttname"><a href="namespacewmmdatmd.html#a3d5fc7ef059560ca3ee99f9c66720c34">wmmdatmd::nmplog</a></div><div class="ttdeci">integer nmplog</div><div class="ttdoc">NMPLOG.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00323">wmmdatmd.F90:323</a></div></div>
<div class="ttc" id="anamespacewminiomd_html"><div class="ttname"><a href="namespacewminiomd.html">wminiomd</a></div><div class="ttdoc">Internal IO routines for the multi-grid model.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l00014">wminiomd.F90:14</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_af9d8d2d4d2c15e2ca754f5ea2950f8cb"><div class="ttname"><a href="namespacewmmdatmd.html#af9d8d2d4d2c15e2ca754f5ea2950f8cb">wmmdatmd::improc</a></div><div class="ttdeci">integer improc</div><div class="ttdoc">IMPROC.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00322">wmmdatmd.F90:322</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a85874d43058e50547ab59d1f6fdc21c2"><div class="ttname"><a href="namespacew3gdatmd.html#a85874d43058e50547ab59d1f6fdc21c2">w3gdatmd::w3setg</a></div><div class="ttdeci">subroutine w3setg(IMOD, NDSE, NDST)</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l02152">w3gdatmd.F90:2152</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_ad5eb65d40ccfb521b5fb2b3b95ed20f9"><div class="ttname"><a href="namespacewmmdatmd.html#ad5eb65d40ccfb521b5fb2b3b95ed20f9">wmmdatmd::grdhgh</a></div><div class="ttdeci">integer, dimension(:,:), allocatable grdhgh</div><div class="ttdoc">GRDHGH.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00356">wmmdatmd.F90:356</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a330e1c63163d8b6630caddd993e9b066"><div class="ttname"><a href="namespacewmmdatmd.html#a330e1c63163d8b6630caddd993e9b066">wmmdatmd::ingrp</a></div><div class="ttdeci">integer, dimension(:,:), allocatable ingrp</div><div class="ttdoc">INGRP.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00355">wmmdatmd.F90:355</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a4ff12f04b0c56a558d749b1cfed9837c"><div class="ttname"><a href="namespacew3servmd.html#a4ff12f04b0c56a558d749b1cfed9837c">w3servmd::wwtime</a></div><div class="ttdeci">subroutine wwtime(STRNG)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00664">w3servmd.F90:664</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a0613ba2a16bfcb827ec38d5c2ac8506b"><div class="ttname"><a href="namespacewmmdatmd.html#a0613ba2a16bfcb827ec38d5c2ac8506b">wmmdatmd::toutp</a></div><div class="ttdeci">integer, dimension(:,:), allocatable toutp</div><div class="ttdoc">TOUTP.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00364">wmmdatmd.F90:364</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a24416cdd0b4767f933e943e19a0578f5"><div class="ttname"><a href="namespacewmmdatmd.html#a24416cdd0b4767f933e943e19a0578f5">wmmdatmd::nmproc</a></div><div class="ttdeci">integer nmproc</div><div class="ttdoc">NMPROC.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00321">wmmdatmd.F90:321</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ab2c0f2e6e7524fb061d841ba7a7324a1"><div class="ttname"><a href="namespacew3adatmd.html#ab2c0f2e6e7524fb061d841ba7a7324a1">w3adatmd::w3seta</a></div><div class="ttdeci">subroutine w3seta(IMOD, NDSE, NDST)</div><div class="ttdoc">Select one of the WAVEWATCH III grids / models.</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l02645">w3adatmd.F90:2645</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_a7c6dc364321a4028015d207ec5107ebd"><div class="ttname"><a href="namespacewminiomd.html#a7c6dc364321a4028015d207ec5107ebd">wminiomd::wmioef</a></div><div class="ttdeci">subroutine wmioef(IMOD)</div><div class="ttdoc">Finalize staging of internal same-rank data in the data structure EQSTGE (MPI only).</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l03399">wminiomd.F90:3399</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a7ef077701293c27bbb6c4ad7d7377975"><div class="ttname"><a href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">w3odatmd::tonext</a></div><div class="ttdeci">integer, dimension(:,:), pointer tonext</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a6ce07b91fa2a2a535551a5cd8bf2ba6e"><div class="ttname"><a href="namespacewmmdatmd.html#a6ce07b91fa2a2a535551a5cd8bf2ba6e">wmmdatmd::mdsp</a></div><div class="ttdeci">integer mdsp</div><div class="ttdoc">MDSP.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00341">wmmdatmd.F90:341</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a1928790ea627ec2a350b25e01455673c"><div class="ttname"><a href="namespacewmmdatmd.html#a1928790ea627ec2a350b25e01455673c">wmmdatmd::flghg1</a></div><div class="ttdeci">logical flghg1</div><div class="ttdoc">FLGHG1.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00379">wmmdatmd.F90:379</a></div></div>
<div class="ttc" id="anamespacew3wavemd_html"><div class="ttname"><a href="namespacew3wavemd.html">w3wavemd</a></div><div class="ttdoc">Contains wave model subroutine, w3wave.</div><div class="ttdef"><b>Definition:</b> <a href="w3wavemd_8F90_source.html#l00013">w3wavemd.F90:13</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a951f16224f87a2f176cfda3c6bf9dc48"><div class="ttname"><a href="namespacewmmdatmd.html#a951f16224f87a2f176cfda3c6bf9dc48">wmmdatmd::amv</a></div><div class="ttdeci">real, dimension(:,:), pointer amv</div><div class="ttdoc">AMV.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00550">wmmdatmd.F90:550</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a5bca40f7b39183413a708fbd187b621b"><div class="ttname"><a href="namespacewmmdatmd.html#a5bca40f7b39183413a708fbd187b621b">wmmdatmd::mapmsk</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapmsk</div><div class="ttdoc">MAPMSK.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00540">wmmdatmd.F90:540</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_aa1d9f0e3ffb8a78c9c98aa6eb4f28e12"><div class="ttname"><a href="namespacewmmdatmd.html#aa1d9f0e3ffb8a78c9c98aa6eb4f28e12">wmmdatmd::fllstr</a></div><div class="ttdeci">logical, pointer fllstr</div><div class="ttdoc">FLLSTR.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00561">wmmdatmd.F90:561</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_ae3e673b204824f49d68bae67dfdd7eda"><div class="ttname"><a href="namespacewmmdatmd.html#ae3e673b204824f49d68bae67dfdd7eda">wmmdatmd::mpi_comm_bct</a></div><div class="ttdeci">integer, pointer mpi_comm_bct</div><div class="ttdoc">MPI_COMM_BCT.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00544">wmmdatmd.F90:544</a></div></div>
<div class="ttc" id="anamespacew3servmd_html"><div class="ttname"><a href="namespacew3servmd.html">w3servmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00003">w3servmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a3996a3e8c926f774b969de60786d957d"><div class="ttname"><a href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">w3timemd::tick21</a></div><div class="ttdeci">subroutine tick21(TIME, DTIME)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00084">w3timemd.F90:84</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a7574d0e2aa572bf92fdab3ced4e02ac0"><div class="ttname"><a href="namespacewmmdatmd.html#a7574d0e2aa572bf92fdab3ced4e02ac0">wmmdatmd::mtagb</a></div><div class="ttdeci">integer, parameter mtagb</div><div class="ttdoc">MTAGB.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00345">wmmdatmd.F90:345</a></div></div>
<div class="ttc" id="anamespacewmupdtmd_html_a467a7fe3bceda4245d2424e82de326bd"><div class="ttname"><a href="namespacewmupdtmd.html#a467a7fe3bceda4245d2424e82de326bd">wmupdtmd::wmupdt</a></div><div class="ttdeci">subroutine wmupdt(IMOD, TDATA)</div><div class="ttdoc">Update inputs for selected wave model grid.</div><div class="ttdef"><b>Definition:</b> <a href="wmupdtmd_8F90_source.html#l00103">wmupdtmd.F90:103</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_ac0bd6dc2f0effae7dce2f111cde16802"><div class="ttname"><a href="namespacew3wdatmd.html#ac0bd6dc2f0effae7dce2f111cde16802">w3wdatmd::w3setw</a></div><div class="ttdeci">subroutine w3setw(IMOD, NDSE, NDST)</div><div class="ttdoc">Select one of the WAVEWATCH III grids / models.</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00660">w3wdatmd.F90:660</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a37b90f9d6571f875b18669532e8ae021"><div class="ttname"><a href="namespacewmmdatmd.html#a37b90f9d6571f875b18669532e8ae021">wmmdatmd::tmv</a></div><div class="ttdeci">integer, dimension(:,:,:), pointer tmv</div><div class="ttdoc">TMV.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00538">wmmdatmd.F90:538</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a40de4775d7cb1e739098ef04139a6019"><div class="ttname"><a href="namespacew3odatmd.html#a40de4775d7cb1e739098ef04139a6019">w3odatmd::w3seto</a></div><div class="ttdeci">subroutine w3seto(IMOD, NDSERR, NDSTST)</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l01523">w3odatmd.F90:1523</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_aa726d9773260b7863e8de74b3d6bdca4"><div class="ttname"><a href="namespacewminiomd.html#aa726d9773260b7863e8de74b3d6bdca4">wminiomd::wmioeg</a></div><div class="ttdeci">subroutine wmioeg(IMOD, DONE)</div><div class="ttdoc">Gather internal same-rank data for a given model.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l02820">wminiomd.F90:2820</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a86ec2ee307c805e375e36c1d28ab2dbb"><div class="ttname"><a href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">w3timemd::stme21</a></div><div class="ttdeci">subroutine stme21(TIME, DTME21)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00682">w3timemd.F90:682</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html"><div class="ttname"><a href="namespacew3odatmd.html">w3odatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00003">w3odatmd.F90:3</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a75b851c813c4635526a2a83ebc8962a2"><div class="ttname"><a href="namespacewmmdatmd.html#a75b851c813c4635526a2a83ebc8962a2">wmmdatmd::grdlow</a></div><div class="ttdeci">integer, dimension(:,:), allocatable grdlow</div><div class="ttdoc">GRDLOW.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00359">wmmdatmd.F90:359</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a811019b8e0198c95c111311b1a36b66d"><div class="ttname"><a href="namespacew3odatmd.html#a811019b8e0198c95c111311b1a36b66d">w3odatmd::tolast</a></div><div class="ttdeci">integer, dimension(:,:), pointer tolast</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a5fb3206737f511149173f90ece6bb54f"><div class="ttname"><a href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">w3odatmd::naproc</a></div><div class="ttdeci">integer, pointer naproc</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_ad1cf051563c5f193649a544134f4fad1"><div class="ttname"><a href="namespacewmmdatmd.html#ad1cf051563c5f193649a544134f4fad1">wmmdatmd::allprc</a></div><div class="ttdeci">integer, dimension(:,:), allocatable allprc</div><div class="ttdoc">ALLPRC.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00360">wmmdatmd.F90:360</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_ac5b81b0b34ab86d99aa11309f8fab349"><div class="ttname"><a href="namespacewmmdatmd.html#ac5b81b0b34ab86d99aa11309f8fab349">wmmdatmd::fbcast</a></div><div class="ttdeci">logical, pointer fbcast</div><div class="ttdoc">FBCAST.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00568">wmmdatmd.F90:568</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a49087c706a875500a1b1dd1981a7b26c"><div class="ttname"><a href="namespacewmmdatmd.html#a49087c706a875500a1b1dd1981a7b26c">wmmdatmd::nmperr</a></div><div class="ttdeci">integer nmperr</div><div class="ttdoc">NMPERR.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00326">wmmdatmd.F90:326</a></div></div>
<div class="ttc" id="anamespacewmiopomd_html_a8ba5eb53840b8db721166904529e5aa9"><div class="ttname"><a href="namespacewmiopomd.html#a8ba5eb53840b8db721166904529e5aa9">wmiopomd::wmiopo</a></div><div class="ttdeci">subroutine wmiopo(TOUT)</div><div class="ttdoc">Gather and write unified point output.</div><div class="ttdef"><b>Definition:</b> <a href="wmiopomd_8F90_source.html#l00640">wmiopomd.F90:640</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a1c3b6c120a3391849d9d49238ce13d38"><div class="ttname"><a href="namespacewmmdatmd.html#a1c3b6c120a3391849d9d49238ce13d38">wmmdatmd::mdst</a></div><div class="ttdeci">integer mdst</div><div class="ttdoc">MDST.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00315">wmmdatmd.F90:315</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_a5718d371621787958652393e204f8643"><div class="ttname"><a href="namespacewminiomd.html#a5718d371621787958652393e204f8643">wminiomd::wmiohg</a></div><div class="ttdeci">subroutine wmiohg(IMOD, DONE)</div><div class="ttdoc">Gather internal high-to-low data for a given model.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l01724">wminiomd.F90:1724</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a06d1d666694aff42469ce3e1d925f713"><div class="ttname"><a href="namespacew3timemd.html#a06d1d666694aff42469ce3e1d925f713">w3timemd::prtime</a></div><div class="ttdeci">subroutine prtime(PTIME)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00990">w3timemd.F90:990</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a9b7bb5578bdf960761d68a2c7f903176"><div class="ttname"><a href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">w3odatmd::flout</a></div><div class="ttdeci">logical, dimension(:), pointer flout</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00468">w3odatmd.F90:468</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a0ddac52118d3a9dcfc3964543518afc3"><div class="ttname"><a href="namespacewmmdatmd.html#a0ddac52118d3a9dcfc3964543518afc3">wmmdatmd::nmptst</a></div><div class="ttdeci">integer nmptst</div><div class="ttdoc">NMPTST.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00325">wmmdatmd.F90:325</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a3b050f1196ad182ba44915b0c7bfb22f"><div class="ttname"><a href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">w3servmd::strace</a></div><div class="ttdeci">subroutine strace(IENT, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00148">w3servmd.F90:148</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a05a21e8628a3da17474a972da7a6c10e"><div class="ttname"><a href="namespacewmmdatmd.html#a05a21e8628a3da17474a972da7a6c10e">wmmdatmd::wmsetm</a></div><div class="ttdeci">subroutine wmsetm(IMOD, NDSE, NDST)</div><div class="ttdoc">Select one of the WAVEWATCH III grids / models.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l01169">wmmdatmd.F90:1169</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_ad418b078b01dab3f1095a8a7427153bd"><div class="ttname"><a href="namespacewminiomd.html#ad418b078b01dab3f1095a8a7427153bd">wminiomd::wmiobf</a></div><div class="ttdeci">subroutine wmiobf(IMOD)</div><div class="ttdoc">Finalize staging of internal boundary data in the data structure BPSTGE (MPI only).</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l01212">wminiomd.F90:1212</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html"><div class="ttname"><a href="namespacew3idatmd.html">w3idatmd</a></div><div class="ttdoc">Define data structures to set up wave model input data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00016">w3idatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a62e5c7d17668d5ad30950f345ef181f2"><div class="ttname"><a href="namespacewmmdatmd.html#a62e5c7d17668d5ad30950f345ef181f2">wmmdatmd::grank</a></div><div class="ttdeci">integer, dimension(:), allocatable grank</div><div class="ttdoc">GRANK.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00353">wmmdatmd.F90:353</a></div></div>
<div class="ttc" id="anamespacew3wavemd_html_a5e68663cd6aaa3a50e3de164a18db6b9"><div class="ttname"><a href="namespacew3wavemd.html#a5e68663cd6aaa3a50e3de164a18db6b9">w3wavemd::w3wave</a></div><div class="ttdeci">subroutine w3wave(IMOD, ODAT, TEND, STAMP, NO_OUT ifdef W3_OASIS</div><div class="ttdoc">Run WAVEWATCH III for a given time interval.</div><div class="ttdef"><b>Definition:</b> <a href="w3wavemd_8F90_source.html#l00230">w3wavemd.F90:230</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a86e40dfd9101dbbdf8d8e95d8bfe4e3a"><div class="ttname"><a href="namespacew3odatmd.html#a86e40dfd9101dbbdf8d8e95d8bfe4e3a">w3odatmd::nappnt</a></div><div class="ttdeci">integer, pointer nappnt</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_a94791d8fdf5527cc8d8ab4e012bde529"><div class="ttname"><a href="namespacewminiomd.html#a94791d8fdf5527cc8d8ab4e012bde529">wminiomd::wmioes</a></div><div class="ttdeci">subroutine wmioes(IMOD)</div><div class="ttdoc">Stage internal same-rank data in the data structure EQSTGE.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l02493">wminiomd.F90:2493</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_a6da700c7a46d644a7950430cb609685a"><div class="ttname"><a href="namespacewminiomd.html#a6da700c7a46d644a7950430cb609685a">wminiomd::wmiohf</a></div><div class="ttdeci">subroutine wmiohf(IMOD)</div><div class="ttdoc">Finalize staging of internal high-to-low data in the data structure HGSTGE (MPI only).</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l02325">wminiomd.F90:2325</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a3783f725d94c2d2e4fc946f2677f4939"><div class="ttname"><a href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">w3adatmd::mpi_comm_wave</a></div><div class="ttdeci">integer, pointer mpi_comm_wave</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html"><div class="ttname"><a href="namespacewmmdatmd.html">wmmdatmd</a></div><div class="ttdoc">Define data structures to set up wave model dynamic data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00016">wmmdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a617eda3eb1271c4d7702b850c0aa1124"><div class="ttname"><a href="namespacewmmdatmd.html#a617eda3eb1271c4d7702b850c0aa1124">wmmdatmd::flghg2</a></div><div class="ttdeci">logical flghg2</div><div class="ttdoc">FLGHG2.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00380">wmmdatmd.F90:380</a></div></div>
<div class="ttc" id="anamespacew3timemd_html"><div class="ttname"><a href="namespacew3timemd.html">w3timemd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00003">w3timemd.F90:3</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_a5572bed109e848ebf2a203cc80417d44"><div class="ttname"><a href="namespacewminiomd.html#a5572bed109e848ebf2a203cc80417d44">wminiomd::wmiobs</a></div><div class="ttdeci">subroutine wmiobs(IMOD)</div><div class="ttdoc">Stage internal boundary data in the data structure BPSTGE.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l00105">wminiomd.F90:105</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_a71a7451b20e88010fa881508c6f05856"><div class="ttname"><a href="namespacewminiomd.html#a71a7451b20e88010fa881508c6f05856">wminiomd::wmiobg</a></div><div class="ttdeci">subroutine wmiobg(IMOD, DONE)</div><div class="ttdoc">Gather internal boundary data for a given model.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l00497">wminiomd.F90:497</a></div></div>
<div class="ttc" id="anamespacewminiomd_html_aaab03e946466d9fd7b7d0708e5b3726e"><div class="ttname"><a href="namespacewminiomd.html#aaab03e946466d9fd7b7d0708e5b3726e">wminiomd::wmiohs</a></div><div class="ttdeci">subroutine wmiohs(IMOD)</div><div class="ttdoc">Stage internal high-to-low data in the data structure HGSTGE.</div><div class="ttdef"><b>Definition:</b> <a href="wminiomd_8F90_source.html#l01384">wminiomd.F90:1384</a></div></div>
<div class="ttc" id="anamespacew3iopomd_html_a9bbc253bffd32ee330cad4928783178e"><div class="ttname"><a href="namespacew3iopomd.html#a9bbc253bffd32ee330cad4928783178e">w3iopomd::w3iope</a></div><div class="ttdeci">subroutine w3iope(A)</div><div class="ttdoc">Extract point output data and store in output COMMONs.</div><div class="ttdef"><b>Definition:</b> <a href="w3iopomd_8F90_source.html#l00697">w3iopomd.F90:697</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aa1dedf011701000d3c8a2b58fa819e65"><div class="ttname"><a href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">w3gdatmd::mapsta</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapsta</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01163">w3gdatmd.F90:1163</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a8e96f11b970bb9078037c503301b425d"><div class="ttname"><a href="namespacewmmdatmd.html#a8e96f11b970bb9078037c503301b425d">wmmdatmd::dtres</a></div><div class="ttdeci">real, dimension(:), allocatable dtres</div><div class="ttdoc">DTRES.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00377">wmmdatmd.F90:377</a></div></div>
<div class="ttc" id="anamespacew3iopomd_html"><div class="ttname"><a href="namespacew3iopomd.html">w3iopomd</a></div><div class="ttdoc">Process point output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iopomd_8F90_source.html#l00019">w3iopomd.F90:19</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad61699801c9e68a0d804779eecc42309"><div class="ttname"><a href="namespacew3gdatmd.html#ad61699801c9e68a0d804779eecc42309">w3gdatmd::mapst2</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapst2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01163">w3gdatmd.F90:1163</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a1767c8959adc63f31c5962c965151f60"><div class="ttname"><a href="namespacewmmdatmd.html#a1767c8959adc63f31c5962c965151f60">wmmdatmd::etime</a></div><div class="ttdeci">integer, dimension(2) etime</div><div class="ttdoc">ETIME.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00329">wmmdatmd.F90:329</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a9524bdcdd2307c71564f9df2df040a6b"><div class="ttname"><a href="namespacew3gdatmd.html#a9524bdcdd2307c71564f9df2df040a6b">w3gdatmd::dtmax</a></div><div class="ttdeci">real, pointer dtmax</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacewmmdatmd_html_a0456e8f8014e0660b9ff6250e6089ed1"><div class="ttname"><a href="namespacewmmdatmd.html#a0456e8f8014e0660b9ff6250e6089ed1">wmmdatmd::mpi_comm_mwave</a></div><div class="ttdeci">integer mpi_comm_mwave</div><div class="ttdoc">MPI_COMM_MWAVE.</div><div class="ttdef"><b>Definition:</b> <a href="wmmdatmd_8F90_source.html#l00344">wmmdatmd.F90:344</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacewmwavemd.html">wmwavemd</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
