<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: w3str1md Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacew3str1md.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">w3str1md Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module for inclusion of triad nonlinear interaction according to Eldeberky's (1996) Lumped Triad Interaction (LTA) source term.  
<a href="namespacew3str1md.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa4ec6c259281a7b2bc8c8c3dc7e8fe9b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3str1md.html#aa4ec6c259281a7b2bc8c8c3dc7e8fe9b">w3str1</a> (A, AOLD, CG, WN, DEPTH, IX, S, D)</td></tr>
<tr class="memdesc:aa4ec6c259281a7b2bc8c8c3dc7e8fe9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Triad interaction source term computed using the Lumped Triad Appproximation (LTA) of Eldeberky (1996).  <a href="namespacew3str1md.html#aa4ec6c259281a7b2bc8c8c3dc7e8fe9b">More...</a><br /></td></tr>
<tr class="separator:aa4ec6c259281a7b2bc8c8c3dc7e8fe9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module for inclusion of triad nonlinear interaction according to Eldeberky's (1996) Lumped Triad Interaction (LTA) source term. </p>
<dl class="section author"><dt>Author</dt><dd>A. J. van der Westhuysen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Jan-2013 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa4ec6c259281a7b2bc8c8c3dc7e8fe9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ec6c259281a7b2bc8c8c3dc7e8fe9b">&#9670;&nbsp;</a></span>w3str1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3str1md::w3str1 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nspec), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(in)&#160;</td>
          <td class="paramname"><em>AOLD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>CG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>WN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DEPTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(out)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(out)&#160;</td>
          <td class="paramname"><em>D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Triad interaction source term computed using the Lumped Triad Appproximation (LTA) of Eldeberky (1996). </p>
<pre class="fragment">     The parametrized biphase is given by:

                                  0.2
     beta = - pi/2 + pi/2 tanh ( ----- )
                                   Ur

     where Ur is the Ursell number.

     The source term as function of frequency p is:

             +      -
     S(p) = S(p) + S(p)

     in which

      +
     S(p) = alpha Cp Cg,p (R(p/2,p/2))**2 sin (|beta|) ( E(p/2)**2 -2 E(p) E(p/2) )

      -          +
     S(p) = - 2 S(2p)

     with alpha a tunable coefficient and R(p/2,p/2) is the interaction
     coefficient of which the expression can be found in Eldeberky (1996).

     Note that a slightly adapted formulation of the LTA is used in
     in the SWAN model:

     - Only positive contributions to higher harmonics are considered
       here (no energy is transferred to lower harmonics).

     - The mean frequency in the expression of the Ursell number
       is calculated according to the first order moment over the
       zeroth order moment (personal communication, Y.Eldeberky, 1997).

     - The interactions are calculated up to 2.5 times the mean
       frequency only.

     - Since the spectral grid is logarithmically distributed in frequency
       space, the interactions between central bin and interacting bin
       are interpolated such that the distance between these bins is
       factor 2 (nearly).

     - The interactions are calculated in terms of energy density
       instead of action density. So the action density spectrum
       is firstly converted to the energy density grid, then the
       interactions are calculated and then the spectrum is converted
       to the action density spectrum back.</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">A</td><td>Action density spectrum (1-D) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CG</td><td>Group velocities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WN</td><td>Wavenumbers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DEPTH</td><td>Mean water depth. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IX</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">S</td><td>Source term (1-D version). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">D</td><td>Diagonal term of derivative (1-D version).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>A. J. van der Westhuysen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Jan-2013 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3str1md_8F90_source.html#l00184">184</a> of file <a class="el" href="w3str1md_8F90_source.html">w3str1md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">!/                  |     A. J. van der Westhuysen      |</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">!/                  |     A. Roland                     |</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">!/                  | Last update :         13-Jan-2013 |</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">!/    13 Jan-2013 : Origination, based on SWAN v40.91 code ( version 4.08 )</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">!/    05 Oct-2016 : Avoiding divide by zero for EMEAN      ( version 5.15 )</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">!/    28 Feb-2023 : Improvement of efficiency and stability ( version 7.xx)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!     Triad interaction source term computed using the Lumped Triad</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">!     Appproximation (LTA) of Eldeberky (1996).</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!     (Taken from SWAN v40.91, based on code by Marcel Zijlema, TU Delft)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">!     The parametrized biphase is given by:</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">!                                  0.2</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">!     beta = - pi/2 + pi/2 tanh ( ----- )</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!                                   Ur</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!     where Ur is the Ursell number.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">!     The source term as function of frequency p is:</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">!             +      -</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">!     S(p) = S(p) + S(p)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">!     in which</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">!      +</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">!     S(p) = alpha Cp Cg,p (R(p/2,p/2))**2 sin (|beta|) ( E(p/2)**2 -2 E(p) E(p/2) )</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">!      -          +</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">!     S(p) = - 2 S(2p)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!     with alpha a tunable coefficient and R(p/2,p/2) is the interaction</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">!     coefficient of which the expression can be found in Eldeberky (1996).</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">!     Note that a slightly adapted formulation of the LTA is used in</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">!     in the SWAN model:</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">!     - Only positive contributions to higher harmonics are considered</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">!       here (no energy is transferred to lower harmonics).</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">!     - The mean frequency in the expression of the Ursell number</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">!       is calculated according to the first order moment over the</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">!       zeroth order moment (personal communication, Y.Eldeberky, 1997).</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">!     - The interactions are calculated up to 2.5 times the mean</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">!       frequency only.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">!     - Since the spectral grid is logarithmically distributed in frequency</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">!       space, the interactions between central bin and interacting bin</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">!       are interpolated such that the distance between these bins is</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">!       factor 2 (nearly).</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">!     - The interactions are calculated in terms of energy density</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">!       instead of action density. So the action density spectrum</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">!       is firstly converted to the energy density grid, then the</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">!       interactions are calculated and then the spectrum is converted</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">!       to the action density spectrum back.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">!       A       R.A.  I   Action density spectrum (1-D)</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">!       CG      R.A.  I   Group velocities.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">!       WN      R.A.  I   Wavenumbers.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">!       DEPTH   Real  I   Mean water depth.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">!       EMEAN   Real  I   Mean wave energy.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">!       FMEAN   Real  I   Mean wave frequency.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">!       S       R.A.  O   Source term (1-D version).</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">!       D       R.A.  O   Diagonal term of derivative (1-D version).</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">!      W3SRCE    Subr. W3SRCEMD Source term integration.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">!      W3EXPO    Subr.   N/A    Point output post-processor.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">!      GXEXPO    Subr.   N/A    GrADS point output post-processor.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">!       None.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">!     Determine resonance condition and the maximum discrete freq.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">!     for which the interactions are calculated.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">!     If Ursell number larger than prescribed value compute interactions</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">!        Calculate biphase</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">!        Do for each direction</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">!           Convert action density to energy density</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">!           Do for all frequencies</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">!             Calculate interaction coefficient and interaction factor</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">!             Compute interactions and store results in matrix</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">!     !/S  Enable subroutine tracing.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a>, <a class="code" href="namespaceconstants.html#a815ad954ef712211ed1b1fdb8be42487">pi</a>, <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>, <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>, <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>, <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>, <a class="code" href="namespacew3gdatmd.html#a34dcba9e2f5baca86ca51293d5118d73">fte</a>, <a class="code" href="namespacew3gdatmd.html#ad278641a97747d24c30d79dcfab430b0">ftf</a></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: CG(NK), WN(NK), DEPTH, A(NSPEC), AOLD(NSPEC) </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: IX</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>       :: S(NSPEC), D(NSPEC)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">!     AUX1  :     auxiliary real</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">!     AUX2  :     auxiliary real</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">!     BIPH  :     parameterized biphase of the spectrum</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">!     C0    :     phase velocity at central bin</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">!     CM    :     phase velocity at interacting bin</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">!     DEP   :     water depth</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">!     DEP_2 :     water depth to power 2</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">!     DEP_3 :     water depth to power 3</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">!     E     :     energy density as function of frequency</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">!     E0    :     energy density at central bin</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">!     EM    :     energy density at interacting bin</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">!     HS    :     significant wave height</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!     FT    :     auxiliary real indicating multiplication factor</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">!                 for triad contribution</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">!     I1    :     auxiliary integer</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">!     I2    :     auxiliary integer</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">!     ID    :     counter</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">!     IDDUM :     loop counter in direction space</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">!     IENT  :     number of entries</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">!     II    :     loop counter</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">!     IS    :     loop counter in frequency space</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">!     ISM   :     negative range for IS</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">!     ISM1  :     negative range for IS</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">!     ISMAX :     maximum of the counter in frequency space for</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">!                 which the triad interactions are calculated (cut-off)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">!     ISP   :     positive range for IS</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">!     ISP1  :     positive range for IS</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">!     RINT  :     interaction coefficient</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">!     SA    :     interaction contribution of triad</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">!     SIGPICG :   sigma times 2pi/Cg (a Jacobian for E(f) -&gt; E(k))</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">!     SINBPH:     absolute sine of biphase</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">!     STRI  :     total triad contribution</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">!     WISM  :     interpolation weight factor corresponding to lower harmonic</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">!     WISM1 :     interpolation weight factor corresponding to lower harmonic</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">!     WISP  :     interpolation weight factor corresponding to higher harmonic</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">!     WISP1 :     interpolation weight factor corresponding to higher harmonic</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">!     W0    :     radian frequency of central bin</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">!     WM    :     radian frequency of interacting bin</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">!     WN0   :     wave number at central bin</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">!     WNM   :     wave number at interacting bin</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">!     XIS   :     rate between two succeeding frequency counters</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">!     XISLN :     log of XIS</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span> :: IENT = 0</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span> :: I1, I2, ID, IDDUM, II, IS, ISM, ISM1, ISMAX</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">INTEGER</span> :: ISP, ISP1, ITH, IK</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordtype">    REAL</span>    :: AUX1, AUX2, BIPH, C0, CM, DEP, DEP_2, DEP_3, E0, EM, HS</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="keywordtype">    REAL</span>    :: FT, RINT, SIGPICG, SINBPH, STRI, WISM, WISM1, WISP</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordtype">    REAL</span>    :: WISP1, W0, WM, WN0, WNM, XIS, XISLN, EDM, ED0, G9DEP, STRI2</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keywordtype">    REAL</span>    :: E(NK), SA(NTH,100), SA2(NTH,100), A2(NSPEC), A3(NSPEC), HMAX</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordtype">    REAL</span>    :: EB(NK), EBAND, EMEAN, SIGM01, ED(NK)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">!----- Temp (to be moved) -----</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordtype">    REAL</span>    :: EF(NK), JACEPS, DIFFSTR</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordtype">    REAL</span>    :: PTRIAD(5)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordtype">    REAL</span>    :: URSELL, ALPHAR</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">!------------------------------</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">!/</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">!/</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3STR1&#39;</span>)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">!AR: todo: check all PRX routines for differences, check original thesis of elderberky. </span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">! 1.  Integral over directions</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    sigm01 = 0.</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    emean  = 0.</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    jaceps = 1e-12</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    hmax   = depth * 0.73</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">DO</span> ik=1, <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      eb(ik) = 0.</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      ed(ik) = 0.</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">DO</span> ith=1, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        eb(ik) = eb(ik) + a(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        ed(ik) = ed(ik) + a(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) * <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>(ik) / cg(ik)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">! 2.  Integrate over frequencies. </span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">DO</span> ik=1, <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      eb(ik) = eb(ik) * <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>(ik) / cg(ik)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      emean  = emean  + eb(ik)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      sigm01  = sigm01  + eb(ik)*<a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">! 3.  Add tail beyond discrete spectrum</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">!     ( DTH * SIG(NK) absorbed in FTxx )</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    eband  = eb(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) / <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    emean  = emean  + eband * <a class="code" href="namespacew3gdatmd.html#a34dcba9e2f5baca86ca51293d5118d73">fte</a></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    sigm01 = sigm01 + eband * <a class="code" href="namespacew3gdatmd.html#ad278641a97747d24c30d79dcfab430b0">ftf</a></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">! 4.  Final processing</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    sigm01 = sigm01 / emean</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">!---- Temporary parameters (to be replaced by namelists) -----</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    ptriad(1) = 1. </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    ptriad(2) = 10.</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ptriad(3) = 10. <span class="comment">! not used </span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    ptriad(4) = 0.2</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    ptriad(5) = 0.01</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    hs = 4.*sqrt( max(0.,emean) )</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    ursell = (<a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a>*hs)/(2.*sqrt(2.)*sigm01**2*depth**2)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">!---------------------------------------------</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    dep   = depth</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    dep_2 = dep**2</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    dep_3 = dep**3</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    g9dep = <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a> * dep</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">!     --- compute some indices in sigma space</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    i2     = int(float(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) / 2.)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    i1     = i2 - 1</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    xis    = <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(i2) / <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(i1)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    xisln  = log( xis )</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    isp    = int( log(2.) / xisln )</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    isp1   = isp + 1</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    wisp   = (2. - xis**isp) / (xis**isp1 - xis**isp)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    wisp1  = 1. - wisp</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    ism    = int( log(0.5) / xisln )</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    ism1   = ism - 1</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    wism   = (xis**ism -0.5) / (xis**ism - xis**ism1)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    wism1  = 1. - wism</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    e  = 0.</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    sa = 0.</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">!     --- compute maximum frequency for which interactions are calculated</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    ismax = 1</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">DO</span> ik = 1, <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;     <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik) .LT. ( ptriad(2) * sigm01) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        ismax = ik</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keywordflow">     ENDIF</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    ismax = max( ismax , isp1 )</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">!     --- compute 3-wave interactions</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keywordflow">IF</span> (ursell.GE.ptriad(5) ) <span class="keywordflow">THEN</span> <span class="comment">! AR: No need for switching it off from my point of view!</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">!       --- calculate biphase</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        biph   = (0.5*<a class="code" href="namespaceconstants.html#a815ad954ef712211ed1b1fdb8be42487">pi</a>)*(tanh(ptriad(4)/ursell)-1.)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        sinbph = abs(sin(biph) )</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        ef     = 0.</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">DO</span> ith = 1, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          <span class="keywordflow">DO</span> ik = 1, <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            e(ik)  = a(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) * <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a> * <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik) / cg(ik)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            ef(ik) = ef(ik) + e(ik)        </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="keywordflow">DO</span> ik = 1, ismax</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            e0  = e(ik)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            ed0 = eb(ik) </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            w0  = <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            wn0 = wn(ik)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            c0  = w0 / wn0</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">IF</span> ( ik.GT.-ism1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;               em  = wism * e(ik+ism1)   + wism1 * e(ik+ism)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;               edm = wism * eb(ik+ism1)  + wism1 * eb(ik+ism)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;               wm  = wism * <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik+ism1) + wism1 * <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik+ism)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;               wnm = wism * wn(ik+ism1)  + wism1 * wn(ik+ism)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;               cm  = wm / wnm</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;               em  = 0.</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;               edm = 0.</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;               wm  = 0.</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;               wnm = 0.</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;               cm  = 0.</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            aux1 = wnm**2 * ( g9dep + 2*cm**2 ) </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            aux2 = wn0*dep* (g9dep+(2./15.)*<a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a>*dep_3*wn0**2-(2./5.)*w0**2*dep_2)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            rint = aux1 / aux2</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            ft   = ptriad(1) * c0 * cg(ik) * rint**2 * sinbph </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            sa(ith,ik) = max(0.,ft * ( em * em - 2. * em * e0)) <span class="comment">! 1/(m*s) * m4 = m/s !!! [m/s]</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">DO</span> ik = 1, <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a> - 1 </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          sigpicg = <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik)*<a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a>/cg(ik) <span class="comment">! 1/s * s/m = 1/m</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;          <span class="keywordflow">DO</span> ith = 1, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            stri = sa(ith,ik) - 2 * (wisp *  sa(ith,ik+isp1) + wisp1 *  sa(ith,ik+isp))</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">IF</span> (a(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) .gt. jaceps) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;              d(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) = stri / ((a(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>)) * sigpicg) </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;              s(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) = stri / sigpicg </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;              d(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) = 0.</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;              s(ith+(ik-1)*<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>) = 0.</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        d = 0.</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        s = 0.</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">!/ End of W3STR1 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dden</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::fte</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::ftf</a>, <a class="el" href="constants_8F90_source.html#l00061">constants::grav</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="constants_8F90_source.html#l00071">constants::pi</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, and <a class="el" href="constants_8F90_source.html#l00072">constants::tpi</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3srcemd_8F90_source.html#l00195">w3srcemd::w3srce()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacew3gdatmd_html_af51536ea003579d04bb805183993f8ac"><div class="ttname"><a href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">w3gdatmd::nk</a></div><div class="ttdeci">integer, pointer nk</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a815ad954ef712211ed1b1fdb8be42487"><div class="ttname"><a href="namespaceconstants.html#a815ad954ef712211ed1b1fdb8be42487">constants::pi</a></div><div class="ttdeci">real, parameter pi</div><div class="ttdoc">PI Value of Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00071">constants.F90:71</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a4b6f7577a00b480afcec77e672fb25b2"><div class="ttname"><a href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">w3gdatmd::dth</a></div><div class="ttdeci">real, pointer dth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ae9ea4c0ae82712f485b0a6b9b546a0f4"><div class="ttname"><a href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">w3gdatmd::nspec</a></div><div class="ttdeci">integer, pointer nspec</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad451ba3fd6cfdb044986de89e4e4e4f8"><div class="ttname"><a href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">w3gdatmd::sig</a></div><div class="ttdeci">real, dimension(:), pointer sig</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a2e5aeb0943bf5031dc1f9552e5159290"><div class="ttname"><a href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">w3odatmd::ndse</a></div><div class="ttdeci">integer, pointer ndse</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3servmd_html"><div class="ttname"><a href="namespacew3servmd.html">w3servmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00003">w3servmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_acd2df21b8b595f4f5d2d22f0a4e4e9b3"><div class="ttname"><a href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">w3gdatmd::nth</a></div><div class="ttdeci">integer, pointer nth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html"><div class="ttname"><a href="namespacew3odatmd.html">w3odatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00003">w3odatmd.F90:3</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a5729459787df1ec9fac855545e0faaea"><div class="ttname"><a href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">constants::tpi</a></div><div class="ttdeci">real, parameter tpi</div><div class="ttdoc">TPI 2*Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00072">constants.F90:72</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a3b050f1196ad182ba44915b0c7bfb22f"><div class="ttname"><a href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">w3servmd::strace</a></div><div class="ttdeci">subroutine strace(IENT, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00148">w3servmd.F90:148</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a34dcba9e2f5baca86ca51293d5118d73"><div class="ttname"><a href="namespacew3gdatmd.html#a34dcba9e2f5baca86ca51293d5118d73">w3gdatmd::fte</a></div><div class="ttdeci">real, pointer fte</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aead1aecac711ead3469d954b2bd60fc2"><div class="ttname"><a href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">w3gdatmd::dden</a></div><div class="ttdeci">real, dimension(:), pointer dden</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_af5f50eeba6151acaef53bd9fbd767871"><div class="ttname"><a href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">w3servmd::extcde</a></div><div class="ttdeci">subroutine extcde(IEXIT, UNIT, MSG, FILE, LINE, COMM)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00736">w3servmd.F90:736</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad278641a97747d24c30d79dcfab430b0"><div class="ttname"><a href="namespacew3gdatmd.html#ad278641a97747d24c30d79dcfab430b0">w3gdatmd::ftf</a></div><div class="ttdeci">real, pointer ftf</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a27ed315e4f5c61762387c7fae2eb0c38"><div class="ttname"><a href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">constants::grav</a></div><div class="ttdeci">real, parameter grav</div><div class="ttdoc">GRAV Acc.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00061">constants.F90:61</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacew3str1md.html">w3str1md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
