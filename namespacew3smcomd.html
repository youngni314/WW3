<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: w3smcomd Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacew3smcomd.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">w3smcomd Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Service module for support of SMC regridding and interpolation.  
<a href="namespacew3smcomd.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a64254cf8aba40dfa8ae3def20efb8dba"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a64254cf8aba40dfa8ae3def20efb8dba">smc_interp</a> ()</td></tr>
<tr class="memdesc:a64254cf8aba40dfa8ae3def20efb8dba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate SMC interpolation/output information.  <a href="namespacew3smcomd.html#a64254cf8aba40dfa8ae3def20efb8dba">More...</a><br /></td></tr>
<tr class="separator:a64254cf8aba40dfa8ae3def20efb8dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a583b20f7d10224c8ab71419566c4d3b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a583b20f7d10224c8ab71419566c4d3b7">w3s2xy_smcrg</a> (S, XY)</td></tr>
<tr class="memdesc:a583b20f7d10224c8ab71419566c4d3b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regrid SMC data onto a regular grid.  <a href="namespacew3smcomd.html#a583b20f7d10224c8ab71419566c4d3b7">More...</a><br /></td></tr>
<tr class="separator:a583b20f7d10224c8ab71419566c4d3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af934ca3f2263b68c484458af37321dfc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#af934ca3f2263b68c484458af37321dfc">w3s2xy_smcrg_dir</a> (S, XY)</td></tr>
<tr class="memdesc:af934ca3f2263b68c484458af37321dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regrid directional SMC data onto a regular grid.  <a href="namespacew3smcomd.html#af934ca3f2263b68c484458af37321dfc">More...</a><br /></td></tr>
<tr class="separator:af934ca3f2263b68c484458af37321dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73858188e9a0dd157c0bb7c32acd874"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ad73858188e9a0dd157c0bb7c32acd874">mapsta_smc</a> ()</td></tr>
<tr class="memdesc:ad73858188e9a0dd157c0bb7c32acd874"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a new MAPSTA using SMC grid cell averaging.  <a href="namespacew3smcomd.html#ad73858188e9a0dd157c0bb7c32acd874">More...</a><br /></td></tr>
<tr class="separator:ad73858188e9a0dd157c0bb7c32acd874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8510d724845455a14a54a5fc5808345"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ab8510d724845455a14a54a5fc5808345">read_smcint</a> ()</td></tr>
<tr class="memdesc:ab8510d724845455a14a54a5fc5808345"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read interpolation information from smcint.ww3.  <a href="namespacew3smcomd.html#ab8510d724845455a14a54a5fc5808345">More...</a><br /></td></tr>
<tr class="separator:ab8510d724845455a14a54a5fc5808345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e887b875820981dc9ef1347e7eb38d7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a7e887b875820981dc9ef1347e7eb38d7">calc_interp</a> ()</td></tr>
<tr class="memdesc:a7e887b875820981dc9ef1347e7eb38d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates weights for SMC to arbitrary grid intepolation.  <a href="namespacew3smcomd.html#a7e887b875820981dc9ef1347e7eb38d7">More...</a><br /></td></tr>
<tr class="separator:a7e887b875820981dc9ef1347e7eb38d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd2436066c7e00f05928e631bc0cf6b2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#abd2436066c7e00f05928e631bc0cf6b2">w3s2xy_smcnn</a> (S, XY, DIRN)</td></tr>
<tr class="memdesc:abd2436066c7e00f05928e631bc0cf6b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill regular grid using nearest SMC point data.  <a href="namespacew3smcomd.html#abd2436066c7e00f05928e631bc0cf6b2">More...</a><br /></td></tr>
<tr class="separator:abd2436066c7e00f05928e631bc0cf6b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c765eae9ed8ff59aeed088ddb17194d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a2c765eae9ed8ff59aeed088ddb17194d">w3s2xy_smcnn_int</a> (S, XY, DIRN)</td></tr>
<tr class="memdesc:a2c765eae9ed8ff59aeed088ddb17194d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nearest neighbour interpolation.  <a href="namespacew3smcomd.html#a2c765eae9ed8ff59aeed088ddb17194d">More...</a><br /></td></tr>
<tr class="separator:a2c765eae9ed8ff59aeed088ddb17194d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9817e66ee95083cd1892a6e9086a26f7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a9817e66ee95083cd1892a6e9086a26f7">w3s2xy_smc</a> (S, XY, DIR)</td></tr>
<tr class="memdesc:a9817e66ee95083cd1892a6e9086a26f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point for SMC version of W3S2XY.  <a href="namespacew3smcomd.html#a9817e66ee95083cd1892a6e9086a26f7">More...</a><br /></td></tr>
<tr class="separator:a9817e66ee95083cd1892a6e9086a26f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a77c709250e3737e0cf9fbaec8da227ff"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a77c709250e3737e0cf9fbaec8da227ff">sxo</a></td></tr>
<tr class="memdesc:a77c709250e3737e0cf9fbaec8da227ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid longitude origin.  <a href="namespacew3smcomd.html#a77c709250e3737e0cf9fbaec8da227ff">More...</a><br /></td></tr>
<tr class="separator:a77c709250e3737e0cf9fbaec8da227ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34c7a51edcbf1cb757e6f7b10ace40b6"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a34c7a51edcbf1cb757e6f7b10ace40b6">syo</a></td></tr>
<tr class="memdesc:a34c7a51edcbf1cb757e6f7b10ace40b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid latitude origin.  <a href="namespacew3smcomd.html#a34c7a51edcbf1cb757e6f7b10ace40b6">More...</a><br /></td></tr>
<tr class="separator:a34c7a51edcbf1cb757e6f7b10ace40b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55623a0741f4da91a0e82182b208600e"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a55623a0741f4da91a0e82182b208600e">exo</a></td></tr>
<tr class="memdesc:a55623a0741f4da91a0e82182b208600e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid final longitude.  <a href="namespacew3smcomd.html#a55623a0741f4da91a0e82182b208600e">More...</a><br /></td></tr>
<tr class="separator:a55623a0741f4da91a0e82182b208600e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0075706d7ee6959cd654950681b77ac7"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a0075706d7ee6959cd654950681b77ac7">eyo</a></td></tr>
<tr class="memdesc:a0075706d7ee6959cd654950681b77ac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid final latitude.  <a href="namespacew3smcomd.html#a0075706d7ee6959cd654950681b77ac7">More...</a><br /></td></tr>
<tr class="separator:a0075706d7ee6959cd654950681b77ac7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77567fab62836cb6dc7ece70813e53b3"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a77567fab62836cb6dc7ece70813e53b3">dxo</a></td></tr>
<tr class="memdesc:a77567fab62836cb6dc7ece70813e53b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid cell longitude size.  <a href="namespacew3smcomd.html#a77567fab62836cb6dc7ece70813e53b3">More...</a><br /></td></tr>
<tr class="separator:a77567fab62836cb6dc7ece70813e53b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac05a2f4a044ece21237dfab2f8d4872"><td class="memItemLeft" align="right" valign="top">double precision&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#aac05a2f4a044ece21237dfab2f8d4872">dyo</a></td></tr>
<tr class="memdesc:aac05a2f4a044ece21237dfab2f8d4872"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid cell latitude size.  <a href="namespacew3smcomd.html#aac05a2f4a044ece21237dfab2f8d4872">More...</a><br /></td></tr>
<tr class="separator:aac05a2f4a044ece21237dfab2f8d4872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ae8892a7af8327f953716f1e5f9b00"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">nxo</a></td></tr>
<tr class="memdesc:ab8ae8892a7af8327f953716f1e5f9b00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid number of longitude cells.  <a href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">More...</a><br /></td></tr>
<tr class="separator:ab8ae8892a7af8327f953716f1e5f9b00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad85d17e24f1d49d5e5a58c41dc33c010"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">nyo</a></td></tr>
<tr class="memdesc:ad85d17e24f1d49d5e5a58c41dc33c010"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid number of latitude cells.  <a href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">More...</a><br /></td></tr>
<tr class="separator:ad85d17e24f1d49d5e5a58c41dc33c010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0a8bc6a59378d6a9931edadbf1e787"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a8a0a8bc6a59378d6a9931edadbf1e787">smcotype</a></td></tr>
<tr class="memdesc:a8a0a8bc6a59378d6a9931edadbf1e787"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of SMC output: 1=seapoint grid of SMC cells; 2=regridding to regular grid; 3=interpolation to arbtrary grid; 4=nearest neighbour interpolation to arbitrary grid.  <a href="namespacew3smcomd.html#a8a0a8bc6a59378d6a9931edadbf1e787">More...</a><br /></td></tr>
<tr class="separator:a8a0a8bc6a59378d6a9931edadbf1e787"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0da31995bac5e7a6795e1ae6795c0235"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a0da31995bac5e7a6795e1ae6795c0235">celfac</a></td></tr>
<tr class="memdesc:a0da31995bac5e7a6795e1ae6795c0235"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output grid cell scaling factor; should be an integer power of 2.  <a href="namespacew3smcomd.html#a0da31995bac5e7a6795e1ae6795c0235">More...</a><br /></td></tr>
<tr class="separator:a0da31995bac5e7a6795e1ae6795c0235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada8522a6abb9c831f14d621477823424"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ada8522a6abb9c831f14d621477823424">xidx</a></td></tr>
<tr class="memdesc:ada8522a6abb9c831f14d621477823424"><td class="mdescLeft">&#160;</td><td class="mdescRight">X-indices of SMC cells in regular grid.  <a href="namespacew3smcomd.html#ada8522a6abb9c831f14d621477823424">More...</a><br /></td></tr>
<tr class="separator:ada8522a6abb9c831f14d621477823424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a652e7cee8a199df01000b64b9dd69504"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a652e7cee8a199df01000b64b9dd69504">yidx</a></td></tr>
<tr class="memdesc:a652e7cee8a199df01000b64b9dd69504"><td class="mdescLeft">&#160;</td><td class="mdescRight">Y-Indices of SMC cells in regular grid.  <a href="namespacew3smcomd.html#a652e7cee8a199df01000b64b9dd69504">More...</a><br /></td></tr>
<tr class="separator:a652e7cee8a199df01000b64b9dd69504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef69a68c85d8a7e248e7f33a3283fdc1"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#aef69a68c85d8a7e248e7f33a3283fdc1">xspan</a></td></tr>
<tr class="memdesc:aef69a68c85d8a7e248e7f33a3283fdc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of longitude cells SMC cell spans.  <a href="namespacew3smcomd.html#aef69a68c85d8a7e248e7f33a3283fdc1">More...</a><br /></td></tr>
<tr class="separator:aef69a68c85d8a7e248e7f33a3283fdc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d63370b8e253ed0475735b4974d366"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a26d63370b8e253ed0475735b4974d366">yspan</a></td></tr>
<tr class="memdesc:a26d63370b8e253ed0475735b4974d366"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of longitude cells SMC cell spans.  <a href="namespacew3smcomd.html#a26d63370b8e253ed0475735b4974d366">More...</a><br /></td></tr>
<tr class="separator:a26d63370b8e253ed0475735b4974d366"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6205b1070b33a78febb5a5e5228f6ccc"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a6205b1070b33a78febb5a5e5228f6ccc">wts</a></td></tr>
<tr class="memdesc:a6205b1070b33a78febb5a5e5228f6ccc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regridding weights.  <a href="namespacew3smcomd.html#a6205b1070b33a78febb5a5e5228f6ccc">More...</a><br /></td></tr>
<tr class="separator:a6205b1070b33a78febb5a5e5228f6ccc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da0538eef44465bbd274f4d38056bda"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a8da0538eef44465bbd274f4d38056bda">cov</a></td></tr>
<tr class="memdesc:a8da0538eef44465bbd274f4d38056bda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wet fraction (coverage) of cell.  <a href="namespacew3smcomd.html#a8da0538eef44465bbd274f4d38056bda">More...</a><br /></td></tr>
<tr class="separator:a8da0538eef44465bbd274f4d38056bda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3313e70567be8697701d581676a5a345"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a3313e70567be8697701d581676a5a345">mapsmc</a></td></tr>
<tr class="memdesc:a3313e70567be8697701d581676a5a345"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regridded MAPSTA.  <a href="namespacew3smcomd.html#a3313e70567be8697701d581676a5a345">More...</a><br /></td></tr>
<tr class="separator:a3313e70567be8697701d581676a5a345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a94252e6755ab28606446a870ff231f"><td class="memItemLeft" align="right" valign="top">logical, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a2a94252e6755ab28606446a870ff231f">smcmask</a></td></tr>
<tr class="memdesc:a2a94252e6755ab28606446a870ff231f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask for type 1 output (flat array)  <a href="namespacew3smcomd.html#a2a94252e6755ab28606446a870ff231f">More...</a><br /></td></tr>
<tr class="separator:a2a94252e6755ab28606446a870ff231f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc2207e04490a6f4fbeec6f8e78771f"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#afcc2207e04490a6f4fbeec6f8e78771f">smcidx</a></td></tr>
<tr class="memdesc:afcc2207e04490a6f4fbeec6f8e78771f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indices of SMC cells within output grid domain.  <a href="namespacew3smcomd.html#afcc2207e04490a6f4fbeec6f8e78771f">More...</a><br /></td></tr>
<tr class="separator:afcc2207e04490a6f4fbeec6f8e78771f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90dc35be40344e532525e1183797aeef"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a90dc35be40344e532525e1183797aeef">smccx</a></td></tr>
<tr class="memdesc:a90dc35be40344e532525e1183797aeef"><td class="mdescLeft">&#160;</td><td class="mdescRight">SMC grid definition.  <a href="namespacew3smcomd.html#a90dc35be40344e532525e1183797aeef">More...</a><br /></td></tr>
<tr class="separator:a90dc35be40344e532525e1183797aeef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a562ee529cb980d15cbd0c3dfb59ba7c5"><td class="memItemLeft" align="right" valign="top">integer, dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a562ee529cb980d15cbd0c3dfb59ba7c5">smccy</a></td></tr>
<tr class="memdesc:a562ee529cb980d15cbd0c3dfb59ba7c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Latitude cell size factors.  <a href="namespacew3smcomd.html#a562ee529cb980d15cbd0c3dfb59ba7c5">More...</a><br /></td></tr>
<tr class="separator:a562ee529cb980d15cbd0c3dfb59ba7c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a945696421079f1993ee29b7de722d7d4"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a945696421079f1993ee29b7de722d7d4">dlat</a></td></tr>
<tr class="memdesc:a945696421079f1993ee29b7de722d7d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base longitude cell size.  <a href="namespacew3smcomd.html#a945696421079f1993ee29b7de722d7d4">More...</a><br /></td></tr>
<tr class="separator:a945696421079f1993ee29b7de722d7d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7f4426a7aae94d3e2d8fe852a3f5d71"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ac7f4426a7aae94d3e2d8fe852a3f5d71">dlon</a></td></tr>
<tr class="memdesc:ac7f4426a7aae94d3e2d8fe852a3f5d71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base latitude cell size.  <a href="namespacew3smcomd.html#ac7f4426a7aae94d3e2d8fe852a3f5d71">More...</a><br /></td></tr>
<tr class="separator:ac7f4426a7aae94d3e2d8fe852a3f5d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa76acdafd817b9016771cabe6e0139ea"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#aa76acdafd817b9016771cabe6e0139ea">cfac</a></td></tr>
<tr class="memdesc:aa76acdafd817b9016771cabe6e0139ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">SMC scaling factor (number of levels)  <a href="namespacew3smcomd.html#aa76acdafd817b9016771cabe6e0139ea">More...</a><br /></td></tr>
<tr class="separator:aa76acdafd817b9016771cabe6e0139ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35271eac0b82a1faf87be98d2d0204db"><td class="memItemLeft" align="right" valign="top">real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a35271eac0b82a1faf87be98d2d0204db">noval</a></td></tr>
<tr class="memdesc:a35271eac0b82a1faf87be98d2d0204db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill value for seapoints with no value.  <a href="namespacew3smcomd.html#a35271eac0b82a1faf87be98d2d0204db">More...</a><br /></td></tr>
<tr class="separator:a35271eac0b82a1faf87be98d2d0204db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bd1eed272a38cdbd57f5d19dd0d3cc5"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a3bd1eed272a38cdbd57f5d19dd0d3cc5">nnidx</a></td></tr>
<tr class="memdesc:a3bd1eed272a38cdbd57f5d19dd0d3cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nearest neighbour SMC point to regular grid.  <a href="namespacew3smcomd.html#a3bd1eed272a38cdbd57f5d19dd0d3cc5">More...</a><br /></td></tr>
<tr class="separator:a3bd1eed272a38cdbd57f5d19dd0d3cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19c8f9cdeb881deab82986071f32a4e0"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a19c8f9cdeb881deab82986071f32a4e0">xdist</a></td></tr>
<tr class="memdesc:a19c8f9cdeb881deab82986071f32a4e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lng.  <a href="namespacew3smcomd.html#a19c8f9cdeb881deab82986071f32a4e0">More...</a><br /></td></tr>
<tr class="separator:a19c8f9cdeb881deab82986071f32a4e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad31fa288a5819eab8191048406c52a62"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ad31fa288a5819eab8191048406c52a62">ydist</a></td></tr>
<tr class="memdesc:ad31fa288a5819eab8191048406c52a62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lat.  <a href="namespacew3smcomd.html#ad31fa288a5819eab8191048406c52a62">More...</a><br /></td></tr>
<tr class="separator:ad31fa288a5819eab8191048406c52a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6ebb3522bfd63305f484d08a72ef3d"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a2e6ebb3522bfd63305f484d08a72ef3d">ndsmc</a></td></tr>
<tr class="memdesc:a2e6ebb3522bfd63305f484d08a72ef3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">ww3_smcint file unit number  <a href="namespacew3smcomd.html#a2e6ebb3522bfd63305f484d08a72ef3d">More...</a><br /></td></tr>
<tr class="separator:a2e6ebb3522bfd63305f484d08a72ef3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d884537101c24f08580d829bd370c4f"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#a6d884537101c24f08580d829bd370c4f">smcnout</a></td></tr>
<tr class="memdesc:a6d884537101c24f08580d829bd370c4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of SMC output cells.  <a href="namespacew3smcomd.html#a6d884537101c24f08580d829bd370c4f">More...</a><br /></td></tr>
<tr class="separator:a6d884537101c24f08580d829bd370c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34e4ea119db98044a00eda715026a1b"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3smcomd.html#ad34e4ea119db98044a00eda715026a1b">nsmc</a></td></tr>
<tr class="memdesc:ad34e4ea119db98044a00eda715026a1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of SMC cells used in regridding.  <a href="namespacew3smcomd.html#ad34e4ea119db98044a00eda715026a1b">More...</a><br /></td></tr>
<tr class="separator:ad34e4ea119db98044a00eda715026a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Service module for support of SMC regridding and interpolation. </p>
<p>For SMC grids, four types of output are possible:</p><ol type="1">
<li>Flat grid (seapoint) output of SMC cells with associated cell size variables (cx and cy). Requires extra effort to plot as grid is not regular.</li>
<li>Regular, uniformly gridded output to a specified output grid. This is achieved by area averaging of the SMC cells. The output grid will be aligned with the SMC grid cell edges which may result in the actual output grid being slightly different to the original user request. A land/sea mask is created by keeping track of the cell coverage and setting cells with total coverage of &lt;50% UNDEF.</li>
<li>[<em>Experimental</em>] Arbitrary regualar grid re-gridding using indices and weights generated from WW3_SMCINT*. Uses the local gradient within the grid cell and distance between cell centres to interpolate.</li>
<li>[<em>Experimental</em>] As type 3, but with no interpolation - value from surrounding SMC cell only.</li>
</ol>
<p><em>* The ww3_smcint program is experimental and not yet included in the official WW3 distribution; it is currently part of the UK Met Office's suite of internal tools.</em></p>
<dl class="section remark"><dt>Remarks</dt><dd>Note - directional fields are expected to be passed to routines with units of <em>radians (cartesian convention)</em>. They will be OUTPUT in units of <em>degrees (nautical convention)</em>.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>21-Jul-2021</dd></dl>
<h3><a class="anchor" id="autotoc_md2"></a>
Change log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date </th><th class="markdownTableHeadNone">Ver </th><th class="markdownTableHeadNone">Comments  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">18-Jan-2016 </td><td class="markdownTableBodyNone">4.18 </td><td class="markdownTableBodyNone">Initial version  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">28-Sep-2016 </td><td class="markdownTableBodyNone">4.18 </td><td class="markdownTableBodyNone">Bug fix EXO/EYO calcs for whole domain output  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">05-Oct-2016 </td><td class="markdownTableBodyNone">4.18 </td><td class="markdownTableBodyNone">Bug fix regular grid indicies for type 2 output  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">29-Sep-2017 </td><td class="markdownTableBodyNone">4.18 </td><td class="markdownTableBodyNone">Revise calculation of indicies to ensure selected cells fall inside user selected areas.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">18-Apr-2018 </td><td class="markdownTableBodyNone">4.18 </td><td class="markdownTableBodyNone">Added Type 3 and 4 SMC output  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">20-Jun-2018 </td><td class="markdownTableBodyNone">4.18 </td><td class="markdownTableBodyNone">Directional fields output as nautical convention (deg)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">27-Jun-2018 </td><td class="markdownTableBodyNone">6.05 </td><td class="markdownTableBodyNone">Ported to V6  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">06-Jan-2021 </td><td class="markdownTableBodyNone">7.12 </td><td class="markdownTableBodyNone">Use ARCTC option for SMC grid.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">20-Jul-2021 </td><td class="markdownTableBodyNone">7.12 </td><td class="markdownTableBodyNone">Fix bug where edge cells in design grid may not be matched due where SMC cell &gt; base grid size.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">21-Jul-2021 </td><td class="markdownTableBodyNone">7.12 </td><td class="markdownTableBodyNone">Elevated some grid variables to DOUBLE PRECISION, fixed EXO/EYO bug  </td></tr>
</table>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7e887b875820981dc9ef1347e7eb38d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e887b875820981dc9ef1347e7eb38d7">&#9670;&nbsp;</a></span>calc_interp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::calc_interp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates weights for SMC to arbitrary grid intepolation. </p>
<p>Calculates the interpolation indices and weights for regridding an SMC grid to an arbitrary regular grid. Calculated index is that of the SMC cell that contains output cell centre. Weights are the distance in metres between the output and SMC cell centres.</p>
<p>A future version <em>may</em> allow for output grids to be on a rotated pole.</p>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>18-Apr-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00623">623</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span> : <a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a>, <a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#ifdef W3_RTD</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#af1e64ccb700c6fea79bb49ead3b38362">w3lltoeq</a></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#a3aa4415f24a71379c7c45b19df71bb33">polon</a>, <a class="code" href="namespacew3gdatmd.html#a0965a0f88831a1e573f4ee917a6d0bfe">polat</a></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">INTEGER</span> :: IERR, I, J, ISEA, N, CFAC</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordtype">    REAL</span> :: mlon(NSEA), mlat(NSEA), olon(nxo,nyo), olat(nxo,nyo),     &amp;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;         ang(nxo,nyo), lon, lat</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#ifdef W3_RTD</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span> :: tmplon(nxo,nyo), tmplat(nxo,nyo)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">! Determine smallest cell size factor:</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    cfac = 2**(nrlv - 1)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">! Get smallest SMC grid cells step size:</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    dlat = sy / cfac</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    dlon = sx / cfac</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keyword">ALLOCATE</span>(xdist(nx,ny), ydist(ny,nx))</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">! Model lat/lons:</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">DO</span> isea = 1,nsea</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      mlon(isea) = (x0-0.5*sx) + (ijkcel(1,isea) + 0.5 * ijkcel(3,isea)) * dlon</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      mlat(isea) = (y0-0.5*sy) + (ijkcel(2,isea) + 0.5 * ijkcel(4,isea)) * dlat</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">! Generate output grid cell centres:</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">DO</span> i=1,nxo</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">DO</span> j=1,nyo</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        olon(i,j) = sxo + (i-1) * dxo</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        olat(i,j) = syo + (j-1) * dyo</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#ifdef W3_RTD</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="preprocessor"></span>    tmplat = olat</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    tmplon = olon</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    print*,<span class="stringliteral">&#39;Rotating coordinates&#39;</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af1e64ccb700c6fea79bb49ead3b38362">w3lltoeq</a> ( tmplat, tmplon, olat, olon,                       &amp;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         ang, <a class="code" href="namespacew3gdatmd.html#a0965a0f88831a1e573f4ee917a6d0bfe">polat</a>, <a class="code" href="namespacew3gdatmd.html#a3aa4415f24a71379c7c45b19df71bb33">polon</a>, nxo*nyo )</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    print*,<span class="stringliteral">&#39;Rotating coordinates complete&#39;</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">! Cycle over output grid points and find containing SMC cell:</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">! NOTE : BRUTE FORCE!</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    nnidx(:,:) = -1</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">DO</span> i=1,nxo</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      print*,i,<span class="stringliteral">&#39; of &#39;</span>,nxo</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">DO</span> j=1,nyo</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        lon = olon(i,j)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        lat = olat(i,j)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">IF</span>(lon .LT. x0 - sx / 2) lon = lon + 360.0</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">IF</span>(lon .GT. (x0 + (nx-1) * sx) + 0.5 * sx) lon = lon - 360.0</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">DO</span> isea=1,nsea</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;          <span class="keywordflow">IF</span>(mlon(isea) - 0.5 * ijkcel(3,isea) * dlon .LE. lon .AND.    &amp;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;               mlon(isea) + 0.5 * ijkcel(3,isea) * dlon .GE. lon .AND.    &amp;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;               mlat(isea) - 0.5 * ijkcel(4,isea) * dlat .LE. lat .AND.    &amp;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;               mlat(isea) + 0.5 * ijkcel(4,isea) * dlat .GE. lat ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="comment">! Match!</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            nnidx(i,j) = isea</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            xdist(i,j) = (lon - mlon(isea)) * <a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a> * <a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a> * clats(isea)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            ydist(i,j) = (lat - mlat(isea)) * <a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a> * <a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01196">w3gdatmd::clats</a>, <a class="el" href="constants_8F90_source.html#l00077">constants::dera</a>, <a class="el" href="w3smcomd_8F90_source.html#l00106">dlat</a>, <a class="el" href="w3smcomd_8F90_source.html#l00107">dlon</a>, <a class="el" href="w3smcomd_8F90_source.html#l00081">dxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00082">dyo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00113">nnidx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01191">w3gdatmd::polat</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01191">w3gdatmd::polon</a>, <a class="el" href="constants_8F90_source.html#l00079">constants::radius</a>, <a class="el" href="w3smcomd_8F90_source.html#l00077">sxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00078">syo</a>, <a class="el" href="w3servmd_8F90_source.html#l01084">w3servmd::w3lltoeq()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00114">xdist</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00115">ydist</a>.</p>

</div>
</div>
<a id="ad73858188e9a0dd157c0bb7c32acd874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73858188e9a0dd157c0bb7c32acd874">&#9670;&nbsp;</a></span>mapsta_smc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::mapsta_smc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a new MAPSTA using SMC grid cell averaging. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>02-Jul-2013 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00519">519</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">! Local parameters</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">INTEGER</span>           :: I, J, IX, IY, IMX, IMY, ISEA</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">! Initialise coverage and output arrays:</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    cov(:,:) = 0.0</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    mapsmc(:,:) = 0</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">DO</span> isea=1,nsea</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      imx = mapsf(isea,1)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      imy = mapsf(isea,2)</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">IF</span>(xidx(isea) .EQ. -1) cycle   <span class="comment">! Out of grid</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">! Loop over number of spanned cells:</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">DO</span> i=0, xspan(isea) - 1</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">DO</span> j=0, yspan(isea) - 1</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;          ix = xidx(isea) + i</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          iy = yidx(isea) + j</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          <span class="comment">! Spans outside of grid?</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <span class="keywordflow">IF</span>(ix .GT. nxo .OR. iy .GT. nyo) cycle</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <span class="comment">! MAPSTA values: 0=Excluded, (+-)1=Sea, (+-2)=Input boundary</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="comment">! We will just keep track of sea and non-sea points:</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          <span class="keywordflow">IF</span>(mapsta(imy, imx) .NE. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment">! Keep track of how much of cell is (wet) covered:</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            cov(ix, iy) = cov(ix, iy) + wts(isea)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">! Create coastline by masking out areas with &lt; 50% coverage:</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">DO</span> ix=1,nxo</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">DO</span> iy=1,nyo</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">IF</span>(cov(ix,iy) .LT. 0.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;          mapsmc(ix, iy) = 0</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          mapsmc(ix, iy) = 1</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3smcomd_8F90_source.html#l00098">cov</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3smcomd_8F90_source.html#l00099">mapsmc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsta</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3smcomd_8F90_source.html#l00083">nxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00084">nyo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00097">wts</a>, <a class="el" href="w3smcomd_8F90_source.html#l00093">xidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00095">xspan</a>, <a class="el" href="w3smcomd_8F90_source.html#l00094">yidx</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00096">yspan</a>.</p>

</div>
</div>
<a id="ab8510d724845455a14a54a5fc5808345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8510d724845455a14a54a5fc5808345">&#9670;&nbsp;</a></span>read_smcint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::read_smcint</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read interpolation information from smcint.ww3. </p>
<p>Reads the interpolation indices and distance weights from the smcint.ww3 file generated by ww3_smcint program.</p>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>18-Apr-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00580">580</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">! Locals</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">INTEGER</span> :: IERR, I, J</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="keywordtype">    REAL</span> :: PLATO, PLONO <span class="comment">! Not used yet....future version might allow</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">! output to a rotated pole grid...</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    ndsmc = 50</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keyword">OPEN</span>(ndsmc, <a class="code" href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a>=<span class="stringliteral">&#39;smcint.ww3&#39;</span>, <a class="code" href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">status</a>=<span class="stringliteral">&#39;old&#39;</span>, form=<span class="stringliteral">&#39;unformatted&#39;</span>, convert=file_endian, iostat=ierr)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">IF</span>(ierr .NE. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&quot;ERROR! Failed to open smcint.ww3 for reading&quot;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a>(1)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">! Header</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keyword">READ</span>(ndsmc) nxo, nyo, sxo, syo, dxo, dyo, plono, plato</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keyword">ALLOCATE</span>(nnidx(nxo,nyo), xdist(nxo,nyo), ydist(nxo,nyo))</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">! Indices and weights:</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keyword">READ</span>(ndsmc)((nnidx(i,j), xdist(i,j), ydist(i,j),i=1,nxo),j=1,nyo)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keyword">CLOSE</span>(ndsmc)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3smcomd_8F90_source.html#l00081">dxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00082">dyo</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="CMakeLists_8txt_source.html#l00003">file()</a>, <a class="el" href="constants_8F90_source.html#l00086">constants::file_endian</a>, <a class="el" href="w3smcomd_8F90_source.html#l00116">ndsmc</a>, <a class="el" href="w3smcomd_8F90_source.html#l00113">nnidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00083">nxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00084">nyo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00077">sxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00078">syo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00114">xdist</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00115">ydist</a>.</p>

</div>
</div>
<a id="a64254cf8aba40dfa8ae3def20efb8dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64254cf8aba40dfa8ae3def20efb8dba">&#9670;&nbsp;</a></span>smc_interp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::smc_interp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate SMC interpolation/output information. </p>
<p>This subroutine generates index or mask values for extraction of SMC data to either a flat grid or regular lat/lon grid, depending on the type of SMC output grid selected:</p>
<p>Type 1: Generates a mask for extracting only points from the user requested region.</p>
<p>Type 2: Calculate interpolation indices and weights for regridding the irregular SMC grid onto a regular, uniformly spaced lat/lon grid.</p>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-Oct-2015 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00143">143</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">! Locals</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keywordtype">    REAL</span>    :: CX0, CY0   <span class="comment">! SW corner of origin of grid</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">    REAL</span>    :: S0CHK, XSNAP, YSNAP</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">INTEGER</span> :: ISEA, mx, my, ixx, iyy, J</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordtype">    REAL</span>    :: lat, lon</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    j = 1</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    nsmc = 0</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">! Determine smallest cell size factor:</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    cfac = 2**(nrlv - 1)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">! Get smallest SMC grid cells step size:</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    dlat = sy / cfac</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    dlon = sx / cfac</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">! SW Corner of grid origin cell:</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    cx0 = x0 - sx / 2.</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    cy0 = y0 - sy / 2.</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">! Grid cell size to snap design grid to. Will be regular grid</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">! resolution for cellsize &lt;= cfac, or cellsize for cellsize &gt; cfac</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    xsnap = sx</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    ysnap = sy</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">IF</span>(celfac .gt. cfac) xsnap = celfac * dlon</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">IF</span>(celfac .gt. cfac) ysnap = celfac * dlat</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">! Get start lat,lon (must be aligned with SMC grid edges). Use</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">! regular grid origins if SXO or SYO is -999.9 (use full grid):</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">IF</span>(abs(sxo + 999.9) .LT. 1e-4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      sxo = cx0</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      s0chk = cx0 + floor((sxo - cx0) / xsnap) * xsnap</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">! Ensure first grid value falls within specified range</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">IF</span> (s0chk .LT. sxo) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        sxo = s0chk + xsnap</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        sxo = s0chk</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">IF</span>(abs(syo + 999.9) .LT. 1e-4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      syo = cy0</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      s0chk = cy0 + floor((syo - cy0) / ysnap) * ysnap</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">! Ensure first grid value falls within specified range</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">IF</span> (s0chk .LT. syo) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        syo = s0chk + ysnap</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        syo = s0chk</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">! Use regular grid extents for last lat/lon if user</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">! specifies -999.9 for EXO/EYO (use full grid):</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">IF</span>(abs(exo + 999.9) .LT. 1e-4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      exo = cx0 + sx * nx <span class="comment">! TRHC of last cell</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">IF</span>(abs(eyo + 999.9) .LT. 1e-4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      eyo = cy0 + sy * ny <span class="comment">! TRHC of last cell</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">! Ouput grid cell dx/dy will be integer factor of smallest</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">! SMC grid cell size:</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    dxo = dlon * celfac</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    dyo = dlat * celfac</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">! Determine number of cells in grid:</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    nxo = nint((exo - sxo) / dxo)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    nyo = nint((eyo - syo) / dyo)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">IF</span>(smcotype .EQ. 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="comment">! Initialise all indices to &quot;missing&quot;:</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      xidx(:) = -1</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      yidx(:) = -1</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">! Loop over cell array and calculate regidding factors:</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">DO</span> isea=1, nsea</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">!          ! For grids with Arctic region: make sure we don&#39;t double count</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">!          ! the overlapping boundary cells. Also, don&#39;t process the arctic</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">!          ! cell (which is always the last cell).</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">!          ! Note: NARC contains ALL the boundary cells (global + arctic).</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">!          ! whereas NGLO contains only the global boundary cells.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">!          IF(ISEA .GT. NGLO-NBAC .AND. ISEA .LT. NSEA-NARC+1) CYCLE</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">IF</span>( arctc .AND. &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;           isea .GT. nglo-nbac .AND. isea .LT. nsea-narc+1) cycle</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">! Get grid cell size:</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      mx = ijkcel(3,isea)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      my = ijkcel(4,isea)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">! Determine cell lat/lon (bottom left corner of cell)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      lon = cx0 + ijkcel(1,isea) * dlon</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      lat = cy0 + ijkcel(2,isea) * dlat</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="comment">! For output type 1 (seapoint array), just check whether</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">! cell centre is within specified domain range, and update</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">! output mask accordingly:</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">IF</span>( smcotype .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">! Ensure longitude ranges are aligned</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        lon = lon + 0.5 * mx * dlon</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        lat = lat + 0.5 * my * dlat</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">IF</span>(lon .LT. sxo) lon = lon + 360.0</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">IF</span>(lon .GT. exo) lon = lon - 360.0</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">! Now check if it is within range of requested domain:</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">IF</span>(lon .GE. sxo .AND. lon .LE. exo .AND.           &amp;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;             lat .GE. syo .AND. lat .LE. eyo ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          smcmask(isea) = .true.</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          smcidx(j) = isea</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          j = j + 1</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        cycle</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">      ENDIF</span> <span class="comment">! SMCOTYPE == 1</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="comment">! For output type 2 (area averaged regular grid), determine</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">! SMC grid cell location and coverage in output grid:</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">! Align lons</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">IF</span>(lon .LT. sxo) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        lon = lon + 360.</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">IF</span>(lon .GT. exo) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        lon = lon - 360.</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="comment">! Find first SW cell in design grid:</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">! We add on 1/2 of the smallest SMC cell dlon/dlat values to ensure</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="comment">! source grid cell ends up in the correct target grid cell (after</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">! integer trunction):</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      ixx = floor((lon + 0.5*dlon - sxo) / dxo) + 1</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      iyy = floor((lat + 0.5*dlat - syo) / dyo) + 1</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">! If we fall outside the left/bottom edge of the design grid,</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">! check for cases where the SMC cell has a lon or lat</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">! scaling factor &gt; cfac (design grid is assumed to align</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="comment">! its origin with cells of size cfac). For such cells,</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="comment">! keep moving the left/bottom edge up by cfac until</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="comment">! the SW corner (possibly) matches a design grid cell.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">IF</span>(ixx .LE. 0 .AND. ixx + mx / celfac .GT. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(mx .GT. cfac)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          mx = mx - cfac</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          lon = lon + dlon * cfac</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          ixx = floor((lon + 0.5*dlon - sxo) / dxo) + 1</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;          <span class="keywordflow">IF</span>(ixx .GT. 0) <span class="keywordflow">EXIT</span> <span class="comment">! Found cell lon-edge in design grid</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">IF</span>(iyy .LE. 0 .AND. iyy + my / celfac .GT. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span>(my .GT. cfac)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;          my = my - cfac</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          lat = lat + dlat * cfac</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          iyy = floor((lat + 0.5*dlat - syo) / dyo) + 1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <span class="keywordflow">IF</span>(iyy .GT. 0) <span class="keywordflow">EXIT</span> <span class="comment">! Found cell lat-edge in design grid</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="comment">! If SMC cell definitely out of design grid domain, then cycle.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">IF</span>(ixx .LE. 0 .OR. ixx .GT. nxo .OR.                          &amp;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;           iyy .LE. 0 .OR. iyy .GT. nyo) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        xidx(isea) = -1</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        yidx(isea) = -1</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        cycle</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      xidx(isea) = ixx</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      yidx(isea) = iyy</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      nsmc = nsmc + 1</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      smcidx(nsmc) = isea</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">! find out how many cells it covers in the x/y directions:</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      xspan(isea) = max(1, int(mx / celfac))</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      yspan(isea) = max(1, int(my / celfac))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">! Do a bit of error checking (non fatal - just produced warning):</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">IF</span>(xspan(isea) .GT. 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">IF</span>(abs((sxo+(ixx-1)*dxo) - lon) .GT. dxo/100.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          print*, <span class="stringliteral">&#39;Potential problem with SMC grid cell span:&#39;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          print*, xspan(isea), float(mx) / celfac</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          print*, lon,lat</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          print*, sxo+(ixx-1)*dxo,syo+iyy*dyo,dxo,dyo</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          print*, <span class="stringliteral">&quot;diff:&quot;</span>, (sxo+(ixx-1)*dxo) - lon</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">! calc cell weight in relation to output grid:</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      wts(isea) = min(1., dble(min(celfac, mx) * min(celfac, my)) / &amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;           (celfac**2))</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">! Reset SXO and SYO to be the cell-centre (currently cell SW edge):</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    sxo = sxo + 0.5 * dxo</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    syo = syo + 0.5 * dyo</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01264">w3gdatmd::arctc</a>, <a class="el" href="w3smcomd_8F90_source.html#l00092">celfac</a>, <a class="el" href="w3smcomd_8F90_source.html#l00108">cfac</a>, <a class="el" href="w3smcomd_8F90_source.html#l00106">dlat</a>, <a class="el" href="w3smcomd_8F90_source.html#l00107">dlon</a>, <a class="el" href="w3smcomd_8F90_source.html#l00081">dxo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00082">dyo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00079">exo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00080">eyo</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01170">w3gdatmd::ijkcel</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01168">w3gdatmd::narc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01168">w3gdatmd::nbac</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01168">w3gdatmd::nglo</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01167">w3gdatmd::nrlv</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3smcomd_8F90_source.html#l00120">nsmc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00083">nxo</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="w3smcomd_8F90_source.html#l00084">nyo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00101">smcidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00100">smcmask</a>, <a class="el" href="w3smcomd_8F90_source.html#l00090">smcotype</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::sx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00077">sxo</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::sy</a>, <a class="el" href="w3smcomd_8F90_source.html#l00078">syo</a>, <a class="el" href="w3smcomd_8F90_source.html#l00097">wts</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::x0</a>, <a class="el" href="w3smcomd_8F90_source.html#l00093">xidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00095">xspan</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::y0</a>, <a class="el" href="w3smcomd_8F90_source.html#l00094">yidx</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00096">yspan</a>.</p>

</div>
</div>
<a id="a9817e66ee95083cd1892a6e9086a26f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9817e66ee95083cd1892a6e9086a26f7">&#9670;&nbsp;</a></span>w3s2xy_smc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::w3s2xy_smc </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(<a class="el" href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">nxo</a>,<a class="el" href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">nyo</a>), intent(out)&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>DIR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point for SMC version of W3S2XY. </p>
<p>Dispatches to regridding subroutine based on SMCOTYPE. Optional DIR logical specifies whether field is a directional value; in which case it will be decomposed into u/v components prior to any interpolation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Input array on SMC grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XY</td><td>Output array to store interpolated 2D field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DIR</td><td>(Optional) Set to .TRUE. if S is a directional field</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>18-Apr-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00817">817</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: S(:)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: XY(NXO,NYO)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">OPTIONAL</span> :: DIR</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordtype">LOGICAL</span>           :: DIRN</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordtype">INTEGER</span>           :: ISEA</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">IF</span>(<span class="keyword">PRESENT</span>(dir)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      dirn = dir</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      dirn = .false.</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">IF</span>(smcotype .EQ. 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="comment">! Flat sea point array</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      xy(:,1) = pack(s, smcmask)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">IF</span>(dirn) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="comment">! Convert to nautical convention in degrees</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">DO</span> isea=1,nxo</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          <span class="keywordflow">IF</span>(xy(isea,1) .NE. undef) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            xy(isea,1) = mod(630. - <a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a> * xy(isea,1), 360.)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">ELSEIF</span>(smcotype .EQ. 2) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="comment">! Regular gridded SMC cells</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">IF</span>(dirn) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keyword">CALL </span>w3s2xy_smcrg_dir(s, xy)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keyword">CALL </span>w3s2xy_smcrg(s, xy)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">ELSEIF</span>(smcotype .EQ. 3) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="comment">! Regridded to arbitrary regular grid with interpolation</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <span class="keyword">CALL </span>w3s2xy_smcnn_int(s, xy, dirn)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">ELSEIF</span>(smcotype .EQ. 4) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="comment">! Regridded to arbitrary regular grid - no interpolation</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keyword">CALL </span>w3s2xy_smcnn(s, xy, dirn)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&quot;Uknonwn SMC type!&quot;</span>, smcotype</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="comment">! Unknown SMC type!</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      stop</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="constants_8F90_source.html#l00076">constants::rade</a>, <a class="el" href="w3smcomd_8F90_source.html#l00100">smcmask</a>, <a class="el" href="w3smcomd_8F90_source.html#l00090">smcotype</a>, <a class="el" href="constants_8F90_source.html#l00084">constants::undef</a>, <a class="el" href="w3smcomd_8F90_source.html#l00712">w3s2xy_smcnn()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00763">w3s2xy_smcnn_int()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="abd2436066c7e00f05928e631bc0cf6b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd2436066c7e00f05928e631bc0cf6b2">&#9670;&nbsp;</a></span>w3s2xy_smcnn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::w3s2xy_smcnn </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(<a class="el" href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">nxo</a>,<a class="el" href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">nyo</a>), intent(out)&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>DIRN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill regular grid using nearest SMC point data. </p>
<p>Directional fields (DIRN=True) will be assumed to be in radians and will be converted to degrees in nautical convention.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Input array on SMC grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XY</td><td>Output array to store interpolated 2D field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DIRN</td><td>Set to .TRUE. if S is a directional field</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>18-Apr-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00712">712</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">! Input parameters:</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: S(:)        <span class="comment">! Inupt array</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>   :: XY(NXO,NYO) <span class="comment">! Output data</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: DIRN        <span class="comment">! Directional field?</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">! Local parameters</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">INTEGER</span>           :: I, J, IX, IY, ISEA, ISMC</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">DO</span> ix = 1,nxo</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">DO</span> iy = 1,nyo</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        isea = nnidx(ix,iy) <span class="comment">! Nearest neighbour SMC point</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">IF</span>(isea .EQ. -1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <span class="comment">! Land</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          xy(ix,iy) = undef</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="keywordflow">IF</span>(s(isea) .EQ. undef) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="comment">! Set undefined sea points to NOVAL</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            xy(ix,iy) = noval</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            xy(ix,iy) = s(isea)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="keywordflow">IF</span>(dirn) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;              <span class="comment">! Convert direction fields to degrees nautical</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;              xy(ix,iy) = mod(630. - <a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a> * xy(ix,iy), 360.0)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3smcomd_8F90_source.html#l00113">nnidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00110">noval</a>, <a class="el" href="constants_8F90_source.html#l00076">constants::rade</a>, and <a class="el" href="constants_8F90_source.html#l00084">constants::undef</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00817">w3s2xy_smc()</a>.</p>

</div>
</div>
<a id="a2c765eae9ed8ff59aeed088ddb17194d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c765eae9ed8ff59aeed088ddb17194d">&#9670;&nbsp;</a></span>w3s2xy_smcnn_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::w3s2xy_smcnn_int </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(<a class="el" href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">nxo</a>,<a class="el" href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">nyo</a>), intent(out)&#160;</td>
          <td class="paramname"><em>XY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>DIRN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nearest neighbour interpolation. </p>
<p>Fill regular grid using nearest SMC point data and interpolate output value based on local gradient and distance between grid cell centres.</p>
<p>Directional fields (DIRN=True) will be assumed to be in radians and will be converted to degrees in nautical convention.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Input array on SMC grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XY</td><td>Output array to store interpolated 2D field </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DIRN</td><td>Set to .TRUE. if S is a directional field</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>18-Apr-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00763">763</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3psmcmd.html">w3psmcmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3psmcmd.html#a7be0dcf198156813c6d37b80a140e71d">smcgradn</a></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">! Input parameters:</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>    :: S(:)        <span class="comment">! Input array</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>   :: XY(NXO,NYO) <span class="comment">! Output array</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: DIRN        <span class="comment">! Directional field?</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">! Locals</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordtype">INTEGER</span>           :: I, J, IX, IY, ISEA, ISMC</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="keywordtype">    REAL</span>              :: CVQ(-9:NSEA)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="keywordtype">    REAL</span>              :: GrdX(NSEA), GrdY(NSEA)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">! Calculate local gradients:</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    cvq(1:nsea) = s <span class="comment">! Need to copy S into array with bounds starting at -9</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#a7be0dcf198156813c6d37b80a140e71d">smcgradn</a>(cvq, grdx, grdy, 0)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">! Interpolate:</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">DO</span> ix = 1,nxo</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">DO</span> iy = 1,nyo</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        isea = nnidx(ix,iy) <span class="comment">! Nearest neighbour SMC point</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">IF</span>(isea .EQ. -1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          xy(ix,iy) = undef</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          <span class="comment">! Interpolate using local gradient and distance from cell centre:</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          xy(ix,iy) = s(isea) + grdx(isea) * xdist(ix,iy) + grdy(isea) * ydist(ix,iy)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          <span class="keywordflow">IF</span>(dirn) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="comment">! Convert direction fields to degrees nautical</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            xy(ix,iy) = mod(630. - <a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a> * xy(ix,iy), 360.0)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3smcomd_8F90_source.html#l00113">nnidx</a>, <a class="el" href="constants_8F90_source.html#l00076">constants::rade</a>, <a class="el" href="w3psmcmd_8F90_source.html#l02335">w3psmcmd::smcgradn()</a>, <a class="el" href="constants_8F90_source.html#l00084">constants::undef</a>, <a class="el" href="w3smcomd_8F90_source.html#l00114">xdist</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00115">ydist</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00817">w3s2xy_smc()</a>.</p>

</div>
</div>
<a id="a583b20f7d10224c8ab71419566c4d3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a583b20f7d10224c8ab71419566c4d3b7">&#9670;&nbsp;</a></span>w3s2xy_smcrg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::w3s2xy_smcrg </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(<a class="el" href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">nxo</a>,<a class="el" href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">nyo</a>), intent(out)&#160;</td>
          <td class="paramname"><em>XY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regrid SMC data onto a regular grid. </p>
<p>Regrids scalar data from the SMC grid onto a regular grid. Uses pre-calculated grid indices and weights generated from the <a class="el" href="namespacew3smcomd.html#a64254cf8aba40dfa8ae3def20efb8dba" title="Generate SMC interpolation/output information.">smc_interp()</a> subroutine.</p>
<dl class="section remark"><dt>Remarks</dt><dd>If source field is directional data, use the <a class="el" href="namespacew3smcomd.html#af934ca3f2263b68c484458af37321dfc" title="Regrid directional SMC data onto a regular grid.">w3s2xy_smcrg_dir()</a> subroutine instead.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Source field, on SMC grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XY</td><td>Storage for regridded field; must be 2D array with dimensions of (NXO,NYO).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>02-Jul-2013 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00360">360</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">! Input parameters:</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: S(:)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: XY(NXO,NYO)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">! Local parameters</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordtype">INTEGER</span>           :: I, J, IX, IY, ISEA, ISMC</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">! Initialise coverage and output arrays:</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    cov(:,:) = 0.0</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    xy(:,:) = 0.0</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">DO</span> ismc=1,nsmc</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      isea = smcidx(ismc)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">IF</span>(s(isea) .EQ. undef) cycle   <span class="comment">! MDI</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">! Loop over number of spanned cells:</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">DO</span> i=0, xspan(isea) - 1</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">DO</span> j=0, yspan(isea) - 1</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          ix = xidx(isea) + i</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          iy = yidx(isea) + j</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          <span class="comment">! Spans outside of grid?</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          <span class="keywordflow">IF</span>(ix .GT. nxo .OR. iy .GT. nyo) cycle</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          <span class="comment">! Interpolate:</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          xy(ix, iy) = xy(ix, iy) + s(isea) * wts(isea)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          <span class="comment">! Keep track of how much of cell is (wet) covered:</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          cov(ix, iy) = cov(ix, iy) + wts(isea)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">! Create coastline by masking out areas with &lt; 50% coverage:</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">DO</span> ix=1,nxo</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">DO</span> iy=1,nyo</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">IF</span>(mapsmc(ix,iy) .EQ. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          <span class="comment">! Make land point</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          xy(ix,iy) = undef</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(cov(ix,iy) .LT. 0.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="comment">! More than half of cell has UNDEF values - set to NOVAL:</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          xy(ix,iy) = noval</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(cov(ix,iy) .LT. 1.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="comment">! If coverage &lt; 1.0, scale values back to full cell coverage.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <span class="comment">! Without this step, points around coast could end up with lower</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="comment">! waveheights due to weights not summing to 1.0:</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          xy(ix,iy) = xy(ix,iy) * ( 1.0 / cov(ix,iy) )</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3smcomd_8F90_source.html#l00098">cov</a>, <a class="el" href="w3smcomd_8F90_source.html#l00099">mapsmc</a>, <a class="el" href="w3smcomd_8F90_source.html#l00110">noval</a>, <a class="el" href="w3smcomd_8F90_source.html#l00120">nsmc</a>, <a class="el" href="w3smcomd_8F90_source.html#l00101">smcidx</a>, <a class="el" href="constants_8F90_source.html#l00084">constants::undef</a>, <a class="el" href="w3smcomd_8F90_source.html#l00097">wts</a>, <a class="el" href="w3smcomd_8F90_source.html#l00093">xidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00095">xspan</a>, <a class="el" href="w3smcomd_8F90_source.html#l00094">yidx</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00096">yspan</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00817">w3s2xy_smc()</a>.</p>

</div>
</div>
<a id="af934ca3f2263b68c484458af37321dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af934ca3f2263b68c484458af37321dfc">&#9670;&nbsp;</a></span>w3s2xy_smcrg_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3smcomd::w3s2xy_smcrg_dir </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(<a class="el" href="namespacew3smcomd.html#ab8ae8892a7af8327f953716f1e5f9b00">nxo</a>,<a class="el" href="namespacew3smcomd.html#ad85d17e24f1d49d5e5a58c41dc33c010">nyo</a>), intent(out)&#160;</td>
          <td class="paramname"><em>XY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regrid directional SMC data onto a regular grid. </p>
<p>Regrids directioanl scalar data from the SMC grid onto a regular grid. Uses pre-calculated grid indices and weights generated from the <a class="el" href="namespacew3smcomd.html#a64254cf8aba40dfa8ae3def20efb8dba" title="Generate SMC interpolation/output information.">smc_interp()</a> subroutine.</p>
<dl class="section remark"><dt>Remarks</dt><dd>Functionality as per <a class="el" href="namespacew3smcomd.html#a9817e66ee95083cd1892a6e9086a26f7" title="Entry point for SMC version of W3S2XY.">w3s2xy_smc()</a>, but decomposes the field into u/v components first to ensure proper area averaging of directional data (handles cyclic transition between 359 -&gt; 0 degrees).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Directional source field, on SMC grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XY</td><td>Storage for regridded field; must be 2D array with dimensions of (NXO,NYO).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Chris Bunney </dd></dl>
<dl class="section date"><dt>Date</dt><dd>02-Jul-2013 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00439">439</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">! Input parameters:</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: S(:)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: XY(NXO,NYO)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">! Local parameters</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">INTEGER</span>           :: I, J, IX, IY, ISEA, ISMC</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: AUX1(:,:), AUX2(:,:)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordtype">    REAL</span>              :: COSS, SINS</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">! Initialise coverage and output arrays:</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">ALLOCATE</span>(aux1(nxo,nyo),aux2(nxo,nyo))</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    cov(:,:) = 0.0</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    xy(:,:) = 0.0</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    aux1(:,:) = 0.0</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    aux2(:,:) = 0.0</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">DO</span> ismc=1,nsmc</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      isea = smcidx(ismc)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">IF</span>(s(isea) .EQ. undef) cycle   <span class="comment">! MDI</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      coss = cos(s(isea))</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      sins = sin(s(isea))</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="comment">! Loop over number of spanned cells:</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">DO</span> i=0, xspan(isea) - 1</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">DO</span> j=0, yspan(isea) - 1</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          ix = xidx(isea) + i</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          iy = yidx(isea) + j</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="comment">! Spans outside of grid?</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          <span class="keywordflow">IF</span>(ix .GT. nxo .OR. iy .GT. nyo) cycle</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          <span class="comment">! Interpolate:</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          <span class="comment">!XY(IX, IY) = XY(IX, IY) + S(ISEA) * WTS(ISEA)</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          aux1(ix, iy) = aux1(ix, iy) + coss * wts(isea)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          aux2(ix, iy) = aux2(ix, iy) + sins * wts(isea)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          <span class="comment">! Keep track of how much of cell is (wet) covered:</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          cov(ix, iy) = cov(ix, iy) + wts(isea)</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">! Create coastline by masking out areas with &lt; 50% coverage:</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">DO</span> ix=1,nxo</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">DO</span> iy=1,nyo</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">IF</span>(mapsmc(ix,iy) .EQ. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          <span class="comment">! Make land point</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          xy(ix,iy) = undef</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(cov(ix,iy) .LT. 0.5) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          <span class="comment">! More than half of cell has UNDEF values - set to NOVAL</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          xy(ix,iy) = noval</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(cov(ix,iy) .LT. 1.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <span class="comment">! If coverage &lt; 1.0, scale values back to full cell coverage.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          <span class="comment">! Without this step, points around coast could end up with lower</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          <span class="comment">! waveheights due to weights not summing to 1.0:</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          xy(ix,iy) = atan2(aux2(ix,iy), aux1(ix,iy))</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          xy(ix,iy) = mod(630. - <a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a> * xy(ix,iy), 360. )</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          xy(ix,iy) = atan2(aux2(ix,iy), aux1(ix,iy))</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          xy(ix,iy) = mod(630. - <a class="code" href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">rade</a> * xy(ix,iy), 360. )</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordflow">      ENDDO</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keywordflow">    ENDDO</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3smcomd_8F90_source.html#l00098">cov</a>, <a class="el" href="w3smcomd_8F90_source.html#l00099">mapsmc</a>, <a class="el" href="w3smcomd_8F90_source.html#l00110">noval</a>, <a class="el" href="w3smcomd_8F90_source.html#l00120">nsmc</a>, <a class="el" href="constants_8F90_source.html#l00076">constants::rade</a>, <a class="el" href="w3smcomd_8F90_source.html#l00101">smcidx</a>, <a class="el" href="constants_8F90_source.html#l00084">constants::undef</a>, <a class="el" href="w3smcomd_8F90_source.html#l00097">wts</a>, <a class="el" href="w3smcomd_8F90_source.html#l00093">xidx</a>, <a class="el" href="w3smcomd_8F90_source.html#l00095">xspan</a>, <a class="el" href="w3smcomd_8F90_source.html#l00094">yidx</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00096">yspan</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00817">w3s2xy_smc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0da31995bac5e7a6795e1ae6795c0235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da31995bac5e7a6795e1ae6795c0235">&#9670;&nbsp;</a></span>celfac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::celfac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid cell scaling factor; should be an integer power of 2. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00092">92</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordtype">INTEGER</span>              :: CELFAC</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, and <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>.</p>

</div>
</div>
<a id="aa76acdafd817b9016771cabe6e0139ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa76acdafd817b9016771cabe6e0139ea">&#9670;&nbsp;</a></span>cfac</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::cfac</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SMC scaling factor (number of levels) </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00108">108</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">INTEGER</span>              :: CFAC</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="a8da0538eef44465bbd274f4d38056bda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da0538eef44465bbd274f4d38056bda">&#9670;&nbsp;</a></span>cov</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:), allocatable w3smcomd::cov</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wet fraction (coverage) of cell. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00098">98</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keywordtype">  REAL</span>, <span class="keywordtype">ALLOCATABLE</span>    :: COV(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="a945696421079f1993ee29b7de722d7d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a945696421079f1993ee29b7de722d7d4">&#9670;&nbsp;</a></span>dlat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real w3smcomd::dlat</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Base longitude cell size. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00106">106</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keywordtype">  REAL</span>                 :: DLAT</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="ac7f4426a7aae94d3e2d8fe852a3f5d71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7f4426a7aae94d3e2d8fe852a3f5d71">&#9670;&nbsp;</a></span>dlon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real w3smcomd::dlon</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Base latitude cell size. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00107">107</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">  REAL</span>                 :: DLON</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="a77567fab62836cb6dc7ece70813e53b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77567fab62836cb6dc7ece70813e53b3">&#9670;&nbsp;</a></span>dxo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision w3smcomd::dxo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid cell longitude size. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00081">81</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span>     :: DXO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="aac05a2f4a044ece21237dfab2f8d4872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac05a2f4a044ece21237dfab2f8d4872">&#9670;&nbsp;</a></span>dyo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision w3smcomd::dyo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid cell latitude size. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00082">82</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span>     :: DYO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="a55623a0741f4da91a0e82182b208600e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55623a0741f4da91a0e82182b208600e">&#9670;&nbsp;</a></span>exo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision w3smcomd::exo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid final longitude. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00079">79</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span>     :: EXO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, and <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>.</p>

</div>
</div>
<a id="a0075706d7ee6959cd654950681b77ac7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0075706d7ee6959cd654950681b77ac7">&#9670;&nbsp;</a></span>eyo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision w3smcomd::eyo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid final latitude. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00080">80</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span>     :: EYO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, and <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>.</p>

</div>
</div>
<a id="a3313e70567be8697701d581676a5a345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3313e70567be8697701d581676a5a345">&#9670;&nbsp;</a></span>mapsmc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable w3smcomd::mapsmc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regridded MAPSTA. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00099">99</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: MAPSMC(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="a2e6ebb3522bfd63305f484d08a72ef3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e6ebb3522bfd63305f484d08a72ef3d">&#9670;&nbsp;</a></span>ndsmc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::ndsmc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ww3_smcint file unit number </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00116">116</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">INTEGER</span>              :: NDSMC</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>.</p>

</div>
</div>
<a id="a3bd1eed272a38cdbd57f5d19dd0d3cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd1eed272a38cdbd57f5d19dd0d3cc5">&#9670;&nbsp;</a></span>nnidx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable w3smcomd::nnidx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nearest neighbour SMC point to regular grid. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00113">113</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: NNIDX(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00712">w3s2xy_smcnn()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00763">w3s2xy_smcnn_int()</a>.</p>

</div>
</div>
<a id="a35271eac0b82a1faf87be98d2d0204db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35271eac0b82a1faf87be98d2d0204db">&#9670;&nbsp;</a></span>noval</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real w3smcomd::noval</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill value for seapoints with no value. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00110">110</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keywordtype">  REAL</span>                 :: NOVAL</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00712">w3s2xy_smcnn()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="ad34e4ea119db98044a00eda715026a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34e4ea119db98044a00eda715026a1b">&#9670;&nbsp;</a></span>nsmc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::nsmc</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of SMC cells used in regridding. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00120">120</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordtype">INTEGER</span>              :: NSMC</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="ab8ae8892a7af8327f953716f1e5f9b00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8ae8892a7af8327f953716f1e5f9b00">&#9670;&nbsp;</a></span>nxo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::nxo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid number of longitude cells. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00083">83</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">INTEGER</span>              :: NXO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="ad85d17e24f1d49d5e5a58c41dc33c010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad85d17e24f1d49d5e5a58c41dc33c010">&#9670;&nbsp;</a></span>nyo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::nyo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid number of latitude cells. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00084">84</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">INTEGER</span>              :: NYO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>.</p>

</div>
</div>
<a id="a90dc35be40344e532525e1183797aeef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90dc35be40344e532525e1183797aeef">&#9670;&nbsp;</a></span>smccx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::smccx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SMC grid definition. </p>
<p>Longitude cell size factors </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00104">104</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: SMCCX(:)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a562ee529cb980d15cbd0c3dfb59ba7c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a562ee529cb980d15cbd0c3dfb59ba7c5">&#9670;&nbsp;</a></span>smccy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::smccy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Latitude cell size factors. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00105">105</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: SMCCY(:)</div>
</div><!-- fragment -->
</div>
</div>
<a id="afcc2207e04490a6f4fbeec6f8e78771f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc2207e04490a6f4fbeec6f8e78771f">&#9670;&nbsp;</a></span>smcidx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::smcidx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indices of SMC cells within output grid domain. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00101">101</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: SMCIDX(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="a2a94252e6755ab28606446a870ff231f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a94252e6755ab28606446a870ff231f">&#9670;&nbsp;</a></span>smcmask</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, dimension(:), allocatable w3smcomd::smcmask</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mask for type 1 output (flat array) </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00100">100</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: SMCMASK(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00817">w3s2xy_smc()</a>.</p>

</div>
</div>
<a id="a6d884537101c24f08580d829bd370c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d884537101c24f08580d829bd370c4f">&#9670;&nbsp;</a></span>smcnout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::smcnout</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of SMC output cells. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00119">119</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">INTEGER</span>              :: SMCNOUT</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a0a8bc6a59378d6a9931edadbf1e787"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a0a8bc6a59378d6a9931edadbf1e787">&#9670;&nbsp;</a></span>smcotype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer w3smcomd::smcotype</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of SMC output: 1=seapoint grid of SMC cells; 2=regridding to regular grid; 3=interpolation to arbtrary grid; 4=nearest neighbour interpolation to arbitrary grid. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00090">90</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">INTEGER</span>              :: SMCOTYPE</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3ounfmetamd_8F90_source.html#l00299">w3ounfmetamd::init_meta()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00817">w3s2xy_smc()</a>.</p>

</div>
</div>
<a id="a77c709250e3737e0cf9fbaec8da227ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77c709250e3737e0cf9fbaec8da227ff">&#9670;&nbsp;</a></span>sxo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision w3smcomd::sxo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid longitude origin. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00077">77</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span>     :: SXO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, and <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>.</p>

</div>
</div>
<a id="a34c7a51edcbf1cb757e6f7b10ace40b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34c7a51edcbf1cb757e6f7b10ace40b6">&#9670;&nbsp;</a></span>syo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision w3smcomd::syo</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output grid latitude origin. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00078">78</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">DOUBLE PRECISION</span>     :: SYO</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, and <a class="el" href="ww3__ounf_8F90_source.html#l00021">w3ounf()</a>.</p>

</div>
</div>
<a id="a6205b1070b33a78febb5a5e5228f6ccc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6205b1070b33a78febb5a5e5228f6ccc">&#9670;&nbsp;</a></span>wts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable w3smcomd::wts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regridding weights. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00097">97</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordtype">  REAL</span>, <span class="keywordtype">ALLOCATABLE</span>    :: WTS(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="a19c8f9cdeb881deab82986071f32a4e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c8f9cdeb881deab82986071f32a4e0">&#9670;&nbsp;</a></span>xdist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:), allocatable w3smcomd::xdist</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lng. </p>
<p>distance to nearest neighbour </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00114">114</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">  REAL</span>, <span class="keywordtype">ALLOCATABLE</span>    :: XDIST(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00763">w3s2xy_smcnn_int()</a>.</p>

</div>
</div>
<a id="ada8522a6abb9c831f14d621477823424"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada8522a6abb9c831f14d621477823424">&#9670;&nbsp;</a></span>xidx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::xidx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>X-indices of SMC cells in regular grid. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00093">93</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: XIDX(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="aef69a68c85d8a7e248e7f33a3283fdc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef69a68c85d8a7e248e7f33a3283fdc1">&#9670;&nbsp;</a></span>xspan</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::xspan</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of longitude cells SMC cell spans. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00095">95</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: XSPAN(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="ad31fa288a5819eab8191048406c52a62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad31fa288a5819eab8191048406c52a62">&#9670;&nbsp;</a></span>ydist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:), allocatable w3smcomd::ydist</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lat. </p>
<p>distance to nearest neighbour </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00115">115</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keywordtype">  REAL</span>, <span class="keywordtype">ALLOCATABLE</span>    :: YDIST(:,:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00623">calc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00580">read_smcint()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00763">w3s2xy_smcnn_int()</a>.</p>

</div>
</div>
<a id="a652e7cee8a199df01000b64b9dd69504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a652e7cee8a199df01000b64b9dd69504">&#9670;&nbsp;</a></span>yidx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::yidx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Y-Indices of SMC cells in regular grid. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00094">94</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: YIDX(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
<a id="a26d63370b8e253ed0475735b4974d366"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26d63370b8e253ed0475735b4974d366">&#9670;&nbsp;</a></span>yspan</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:), allocatable w3smcomd::yspan</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of longitude cells SMC cell spans. </p>

<p class="definition">Definition at line <a class="el" href="w3smcomd_8F90_source.html#l00096">96</a> of file <a class="el" href="w3smcomd_8F90_source.html">w3smcomd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span> :: YSPAN(:)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="w3smcomd_8F90_source.html#l00519">mapsta_smc()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00143">smc_interp()</a>, <a class="el" href="w3smcomd_8F90_source.html#l00360">w3s2xy_smcrg()</a>, and <a class="el" href="w3smcomd_8F90_source.html#l00439">w3s2xy_smcrg_dir()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespaceconstants_html_a7ca2bfab88e5cd9e0eda00a6147d1806"><div class="ttname"><a href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">constants::dera</a></div><div class="ttdeci">real, parameter dera</div><div class="ttdoc">DERA Conversion factor from degrees to radians.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00077">constants.F90:77</a></div></div>
<div class="ttc" id="anamespacem__constants_html_a01113a85af23de66ed1b9f7b7f305280"><div class="ttname"><a href="namespacem__constants.html#a01113a85af23de66ed1b9f7b7f305280">m_constants::rade</a></div><div class="ttdeci">real rade</div><div class="ttdoc">conversion from radians to degrees</div><div class="ttdef"><b>Definition:</b> <a href="mod__constants_8f90_source.html#l00033">mod_constants.f90:33</a></div></div>
<div class="ttc" id="anamespacescrip__timers_html_a13e5d8b1f71ebc95443c31da01c7d687"><div class="ttname"><a href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">scrip_timers::status</a></div><div class="ttdeci">character(len=8), dimension(max_timers), save status</div><div class="ttdef"><b>Definition:</b> <a href="scrip__timers_8f_source.html#l00063">scrip_timers.f:63</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a0965a0f88831a1e573f4ee917a6d0bfe"><div class="ttname"><a href="namespacew3gdatmd.html#a0965a0f88831a1e573f4ee917a6d0bfe">w3gdatmd::polat</a></div><div class="ttdeci">real, pointer polat</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01191">w3gdatmd.F90:1191</a></div></div>
<div class="ttc" id="anamespacew3servmd_html"><div class="ttname"><a href="namespacew3servmd.html">w3servmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00003">w3servmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_af1e64ccb700c6fea79bb49ead3b38362"><div class="ttname"><a href="namespacew3servmd.html#af1e64ccb700c6fea79bb49ead3b38362">w3servmd::w3lltoeq</a></div><div class="ttdeci">subroutine w3lltoeq(PHI, LAMBDA, PHI_EQ, LAMBDA_EQ, ANGLED, PHI_POLE, LAMBDA_POLE, POINTS)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l01084">w3servmd.F90:1084</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aad204763c51cb0df15891498f423285b"><div class="ttname"><a href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">w3gdatmd::clats</a></div><div class="ttdeci">real, dimension(:), pointer clats</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01196">w3gdatmd.F90:1196</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_a7be0dcf198156813c6d37b80a140e71d"><div class="ttname"><a href="namespacew3psmcmd.html#a7be0dcf198156813c6d37b80a140e71d">w3psmcmd::smcgradn</a></div><div class="ttdeci">subroutine smcgradn(CVQ, GrdX, GrdY, L0r1)</div><div class="ttdoc">Evaluate local gradient for sea points.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l02335">w3psmcmd.F90:2335</a></div></div>
<div class="ttc" id="aCMakeLists_8txt_html_a4ab12fe9f35a3436724ef90e0da910d1"><div class="ttname"><a href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a></div><div class="ttdeci">file(STRINGS ${CMAKE_BINARY_DIR}/switch switch_strings) separate_arguments(switches UNIX_COMMAND $</div><div class="ttdef"><b>Definition:</b> <a href="CMakeLists_8txt_source.html#l00003">CMakeLists.txt:3</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a4dceccc29b7e5529102409498706a17f"><div class="ttname"><a href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">constants::radius</a></div><div class="ttdeci">real, parameter radius</div><div class="ttdoc">RADIUS Radius of the earth (m).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00079">constants.F90:79</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html"><div class="ttname"><a href="namespacew3psmcmd.html">w3psmcmd</a></div><div class="ttdoc">Spherical Multiple-Cell (SMC) grid routines.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l00018">w3psmcmd.F90:18</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_af5f50eeba6151acaef53bd9fbd767871"><div class="ttname"><a href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">w3servmd::extcde</a></div><div class="ttdeci">subroutine extcde(IEXIT, UNIT, MSG, FILE, LINE, COMM)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00736">w3servmd.F90:736</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a3aa4415f24a71379c7c45b19df71bb33"><div class="ttname"><a href="namespacew3gdatmd.html#a3aa4415f24a71379c7c45b19df71bb33">w3gdatmd::polon</a></div><div class="ttdeci">real, pointer polon</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01191">w3gdatmd.F90:1191</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacew3smcomd.html">w3smcomd</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
