<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: ww3_uprstr.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ww3__uprstr_8F90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">ww3_uprstr.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains the program W3UPRSTR.  
<a href="#details">More...</a></p>

<p><a href="ww3__uprstr_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a139ca8003fdc26560a93d7147b3fe40e"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a139ca8003fdc26560a93d7147b3fe40e">w3uprstr</a></td></tr>
<tr class="memdesc:a139ca8003fdc26560a93d7147b3fe40e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update restart files based on Hs from DA.  <a href="ww3__uprstr_8F90.html#a139ca8003fdc26560a93d7147b3fe40e">More...</a><br /></td></tr>
<tr class="separator:a139ca8003fdc26560a93d7147b3fe40e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b14e61f0b0266f476dce784a2badfd9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a2b14e61f0b0266f476dce784a2badfd9">update_va</a> (PRCNTG, VATMP)</td></tr>
<tr class="memdesc:a2b14e61f0b0266f476dce784a2badfd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply correction to the spectrum.  <a href="ww3__uprstr_8F90.html#a2b14e61f0b0266f476dce784a2badfd9">More...</a><br /></td></tr>
<tr class="separator:a2b14e61f0b0266f476dce784a2badfd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94451f902bf63f66fd3545a7fa247873"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a94451f902bf63f66fd3545a7fa247873">check_prcntg</a> (PRCNTG, PRCNTG_CAP)</td></tr>
<tr class="memdesc:a94451f902bf63f66fd3545a7fa247873"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last sanity check before the update of the spectrum.  <a href="ww3__uprstr_8F90.html#a94451f902bf63f66fd3545a7fa247873">More...</a><br /></td></tr>
<tr class="separator:a94451f902bf63f66fd3545a7fa247873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa886751043975e9e79e9f1a44090127"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#aaa886751043975e9e79e9f1a44090127">read_grbtxt</a> (UPDPRCNT, FLNMCOR, SMCGRD)</td></tr>
<tr class="memdesc:aaa886751043975e9e79e9f1a44090127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read gribtxt files.  <a href="ww3__uprstr_8F90.html#aaa886751043975e9e79e9f1a44090127">More...</a><br /></td></tr>
<tr class="separator:aaa886751043975e9e79e9f1a44090127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca701a5ce71857b9244f0d067890382a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#aca701a5ce71857b9244f0d067890382a">read_grbtxtws</a> (UPDPRCNT, WSPD, WDIR, FLNMCOR, SMCGRD)</td></tr>
<tr class="memdesc:aca701a5ce71857b9244f0d067890382a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read txt files that include wind data.  <a href="ww3__uprstr_8F90.html#aca701a5ce71857b9244f0d067890382a">More...</a><br /></td></tr>
<tr class="separator:aca701a5ce71857b9244f0d067890382a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d1fee4c6d28c8fc58cc36a8fc7943f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#ad9d1fee4c6d28c8fc58cc36a8fc7943f">swh_rsrt_1p</a> (VA1p, ISEA1p, HSIG1p)</td></tr>
<tr class="memdesc:ad9d1fee4c6d28c8fc58cc36a8fc7943f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the significant wave height from the restart file for 1 point.  <a href="ww3__uprstr_8F90.html#ad9d1fee4c6d28c8fc58cc36a8fc7943f">More...</a><br /></td></tr>
<tr class="separator:ad9d1fee4c6d28c8fc58cc36a8fc7943f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d780c8a81e74782b6e97fe58dd9395f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a3d780c8a81e74782b6e97fe58dd9395f">swh_rsrt_1pw</a> (VA1p, WS, WD, ISEA1p, HSIG1p, HSIGwp, HSIGsp, VAMAPWS)</td></tr>
<tr class="memdesc:a3d780c8a81e74782b6e97fe58dd9395f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Hs from restart for 1 point.  <a href="ww3__uprstr_8F90.html#a3d780c8a81e74782b6e97fe58dd9395f">More...</a><br /></td></tr>
<tr class="separator:a3d780c8a81e74782b6e97fe58dd9395f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37ef58a5fa0a20b01b976558977f1527"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a37ef58a5fa0a20b01b976558977f1527">uvtocart</a> (UVEC, VVEC, SPD, DCART, SMCGRD)</td></tr>
<tr class="memdesc:a37ef58a5fa0a20b01b976558977f1527"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate speed and cartesian convention directions from u,v input vectors.  <a href="ww3__uprstr_8F90.html#a37ef58a5fa0a20b01b976558977f1527">More...</a><br /></td></tr>
<tr class="separator:a37ef58a5fa0a20b01b976558977f1527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c1c3d95838b65181f041cdea3d40c54"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a3c1c3d95838b65181f041cdea3d40c54">updtwspec</a> (VATMP, PRCNTG, VAMAPWS)</td></tr>
<tr class="memdesc:a3c1c3d95838b65181f041cdea3d40c54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the wind-sea part of the wave spectrum only.  <a href="ww3__uprstr_8F90.html#a3c1c3d95838b65181f041cdea3d40c54">More...</a><br /></td></tr>
<tr class="separator:a3c1c3d95838b65181f041cdea3d40c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8dc67428dfb4d27b677317393a03758"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#ae8dc67428dfb4d27b677317393a03758">updtwspecf</a> (VATMP, PRCNTG, VAMAPWS, ISEA1p, ADJALL)</td></tr>
<tr class="memdesc:ae8dc67428dfb4d27b677317393a03758"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the wind-sea part of the wave spectrum and shifts in frequency space.  <a href="ww3__uprstr_8F90.html#ae8dc67428dfb4d27b677317393a03758">More...</a><br /></td></tr>
<tr class="separator:ae8dc67428dfb4d27b677317393a03758"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d313eb90d8625cda4d548b290a922a3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ww3__uprstr_8F90.html#a0d313eb90d8625cda4d548b290a922a3">writematrix</a> (FILENAME, RDA_A)</td></tr>
<tr class="memdesc:a0d313eb90d8625cda4d548b290a922a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a 2D array to text file, column by column.  <a href="ww3__uprstr_8F90.html#a0d313eb90d8625cda4d548b290a922a3">More...</a><br /></td></tr>
<tr class="separator:a0d313eb90d8625cda4d548b290a922a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains the program W3UPRSTR. </p>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Feb-2017 </dd></dl>

<p class="definition">Definition in file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a94451f902bf63f66fd3545a7fa247873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94451f902bf63f66fd3545a7fa247873">&#9670;&nbsp;</a></span>check_prcntg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::check_prcntg </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>PRCNTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PRCNTG_CAP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Last sanity check before the update of the spectrum. </p>
<p>The percentage of change is compared against a user defined cap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PRCNTG</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">PRCNTG_CAP</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Oct-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01278">1278</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="comment">!/                  |         Stelios Flampouris        |</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="comment">!/                  | Created       :       16-Oct-2018 |</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">!/    16-Oct-2018 : Original Code                       ( version 6.06 )</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="comment">!/    24-Oct-2018 : Update by Andy Saulter              ( version 7.14 )</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">!     Last sanity check before the update of the spectrum</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="comment">!     The percentage of change is compared against a user defined cap.</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(INOUT)</span>  ::    PRCNTG</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN   )</span>  ::    PRCNTG_CAP</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="comment">! local</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordtype">CHARACTER(12)</span>, <span class="keywordtype">PARAMETER</span> :: MYNAME=<span class="stringliteral">&#39;CHECK_PRCNTG&#39;</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; The original correction is &quot;</span>,prcntg</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; The cap is &quot;</span>,prcntg_cap</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( prcntg_cap &lt; 1. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; WARNING: PRCNTG_CAP set &lt; 1.&quot;</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot;          This may introduce spurious corrections&quot;</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; The cap is &quot;</span>,prcntg_cap</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( prcntg &gt; 1. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; PRCNTG &gt; 1.&quot;</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="preprocessor"></span>      prcntg = min(prcntg, 1. * prcntg_cap)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( prcntg &lt; 1. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; PRCNTG &lt; 1.&quot;</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="preprocessor"></span>      prcntg = max(prcntg, 1. / prcntg_cap)</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&quot; The updated correction is &quot;</span>,prcntg</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="aaa886751043975e9e79e9f1a44090127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa886751043975e9e79e9f1a44090127">&#9670;&nbsp;</a></span>read_grbtxt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::read_grbtxt </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>UPDPRCNT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>FLNMCOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>SMCGRD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read gribtxt files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">UPDPRCNT</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FLNMCOR</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">SMCGRD</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Oct-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01369">1369</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">!/                  |         Stelios Flampouris        |</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="comment">!/                  | Created       :       15-Mar-2017 |</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="comment">!/                  | Last Update   :       16-Oct-2018 |</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">!/    15-Mar-2017 : Original Code                       ( version 6.04 )</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="comment">!/    16-Oct-2018 : Generalization of the reader        ( version 6.06 )</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="comment">!     Read gribtxt files</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: UPDPRCNT</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordtype">CHARACTER(*)</span>, <span class="keywordtype">INTENT(IN)</span> :: FLNMCOR</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: SMCGRD</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="comment">! Local Variables</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordtype">INTEGER</span>            :: I, J, IERR</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordtype">INTEGER</span>            :: K, L, M, N</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="keywordtype">    REAL</span> :: A</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: IP_FID = 123</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordtype">CHARACTER(25)</span>, <span class="keywordtype">PARAMETER</span>::myname=<span class="stringliteral">&#39;read_grbtxt&#39;</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="preprocessor"></span>    j     = len_trim(fnmpre)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keyword">OPEN</span> (ip_fid,<a class="code" href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a>=fnmpre(:j)//trim(flnmcor),status=<span class="stringliteral">&#39;OLD&#39;</span> &amp;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         ,action=<span class="stringliteral">&#39;read&#39;</span>,iostat=ierr)</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <span class="comment">! Read text header and check dimensions match expected values</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">IF</span> (.NOT. smcgrd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="keyword">READ</span>( ip_fid, *) m,n</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordflow">IF</span> (( <span class="keyword">SIZE</span>(updprcnt,1) /= n) .OR. ( <span class="keyword">SIZE</span>(updprcnt,2) /= m )) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&#39;: These are not the grid &#39;</span> // &amp;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;             <span class="stringliteral">&#39;dimensions: M=&#39;</span>,m,<span class="stringliteral">&#39; N=&#39;</span>,n</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        stop</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keyword">READ</span>( ip_fid, *) n</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">IF</span> ( <span class="keyword">SIZE</span>(updprcnt,1) /= n ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&#39;: These are not the grid &#39;</span> // &amp;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;             <span class="stringliteral">&#39;dimensions: N=&#39;</span>,n</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        stop</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    updprcnt=0</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="comment">! Read the data into its allocated array</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="keywordflow">IF</span> (.NOT. smcgrd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">DO</span> k=1,m</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;          a=0.</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          <span class="keyword">READ</span>(ip_fid,*)a</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          updprcnt(n+1-l,k)=a</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        a=0.</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keyword">READ</span>(ip_fid,*)a</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        updprcnt(l,1)=a</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keyword">CLOSE</span>(ip_fid)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">References <a class="el" href="CMakeLists_8txt_source.html#l00003">file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="aca701a5ce71857b9244f0d067890382a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca701a5ce71857b9244f0d067890382a">&#9670;&nbsp;</a></span>read_grbtxtws()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::read_grbtxtws </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>UPDPRCNT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>WSPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>WDIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>FLNMCOR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>SMCGRD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read txt files that include wind data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">UPDPRCNT</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">WSPD</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">WDIR</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FLNMCOR</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SMCGRD</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Andy Saulter </dd></dl>
<dl class="section date"><dt>Date</dt><dd>24-Oct-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01492">1492</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">!/                  |         Andy Saulter              |</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="comment">!/                  | Original code :       24-Oct-2018 |</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">!/                  | Last update :         05-Oct-2019 |</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">!/    24-Oct-2018 : Original Code                       ( version 6.07 )</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="comment">!     Read txt files that include wind data</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: UPDPRCNT, WSPD, WDIR</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordtype">CHARACTER(*)</span>, <span class="keywordtype">INTENT(IN)</span> :: FLNMCOR</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: SMCGRD</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">! Local Variables</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordtype">INTEGER</span>            :: I, J, IERR</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordtype">INTEGER</span>            :: K, L, M, N</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="keywordtype">    REAL</span> :: A, WS, WD</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: IP_FID = 123</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordtype">CHARACTER(25)</span>, <span class="keywordtype">PARAMETER</span>::myname=<span class="stringliteral">&#39;read_grbtxt&#39;</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="preprocessor"></span>    j     = len_trim(fnmpre)</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keyword">OPEN</span> (ip_fid,<a class="code" href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a>=fnmpre(:j)//trim(flnmcor),status=<span class="stringliteral">&#39;OLD&#39;</span> &amp;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;         ,action=<span class="stringliteral">&#39;read&#39;</span>,iostat=ierr)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">! Read text header and check dimensions match expected values</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">IF</span> (.NOT. smcgrd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keyword">READ</span>( ip_fid, *) m,n</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">IF</span> (( <span class="keyword">SIZE</span>(updprcnt,1) /= n) .OR. ( <span class="keyword">SIZE</span>(updprcnt,2) /= m )) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&#39;: These are not the grid &#39;</span> // &amp;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;             <span class="stringliteral">&#39;dimensions: M=&#39;</span>,m,<span class="stringliteral">&#39; N=&#39;</span>,n</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        stop</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keyword">READ</span>( ip_fid, *) n</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keywordflow">IF</span> ( <span class="keyword">SIZE</span>(updprcnt,1) /= n ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keyword">WRITE</span> (ndso,*) trim(myname),<span class="stringliteral">&#39;: These are not the grid &#39;</span> // &amp;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;             <span class="stringliteral">&#39;dimensions: N=&#39;</span>,n</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        stop</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    updprcnt=0</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    wspd=0.</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    wdir=0.</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="comment">! Read the data into allocated arrays</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">IF</span> (.NOT. smcgrd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <span class="keywordflow">DO</span> k=1,m</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;          a=0.</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;          ws=0.</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;          wd=0.</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          <span class="keyword">READ</span>(ip_fid,*)a, ws, wd</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;          <span class="comment">!SWH data read onto Y,X grid</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;          updprcnt(n+1-l,k)=a</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;          <span class="comment">!Wind data read onto X,Y grid</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          wspd(k,n+1-l)=ws</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;          wdir(k,n+1-l)=wd</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <span class="keywordflow">DO</span> l=1,n</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        a=0.</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="keyword">READ</span>(ip_fid,*)a, ws, wd</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        updprcnt(l,1)=a</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        wspd(l,1)=ws</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        wdir(l,1)=wd</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keyword">CLOSE</span>(ip_fid)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">References <a class="el" href="CMakeLists_8txt_source.html#l00003">file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="ad9d1fee4c6d28c8fc58cc36a8fc7943f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d1fee4c6d28c8fc58cc36a8fc7943f">&#9670;&nbsp;</a></span>swh_rsrt_1p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::swh_rsrt_1p </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>VA1p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISEA1p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>HSIG1p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the significant wave height from the restart file for 1 point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VA1p</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ISEA1p</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">HSIG1p</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>15-May-2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01621">1621</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">!/                  |         Stelios Flampouris        |</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="comment">!/                  | Last update :         15-Mar-2017 |</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="comment">!/    15-Mar-2017 : Original Code                       ( version 6.04 )</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="comment">!     Calculate the significant wave height from the restart file for 1 point</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: HSIG1p</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: ISEA1p</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span>  :: VA1p</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordtype">CHARACTER(25)</span>,<span class="keywordtype">PARAMETER</span> :: myname=<span class="stringliteral">&#39;SWH_RSRT_1p&#39;</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="preprocessor">#ifdef W3_FT</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*)<span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="preprocessor"></span>    hsig1p = 0.</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    depth  = max( dmin , -zb(isea1p) )</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    etot   = 0.</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keyword">CALL </span>wavnu1 ( sig(ik), depth, <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>, <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a> )</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      e1i    = 0.</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        e1i    = e1i + va1p(ith+(ik-1)*nth)  *  sig(ik) / <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      etot   = etot + e1i*dsip(ik)</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    hsig1p = 4. * sqrt( etot * dth )</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="preprocessor">#ifdef W3_FT</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) <span class="stringliteral">&#39; &#39;</span>, trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keyword">WRITE</span> (ndso,*)<span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="a3d780c8a81e74782b6e97fe58dd9395f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d780c8a81e74782b6e97fe58dd9395f">&#9670;&nbsp;</a></span>swh_rsrt_1pw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::swh_rsrt_1pw </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>VA1p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>WS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>WD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISEA1p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>HSIG1p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>HSIGwp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>HSIGsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>VAMAPWS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Hs from restart for 1 point. </p>
<p>Calculate the significant wave height for total, wind sea and swell components from the restart file for 1 point</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VA1p</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WS</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WD</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ISEA1p</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">HSIG1p</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">HSIGwp</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">HSIGsp</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VAMAPWS</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Andy Saulter </dd></dl>
<dl class="section date"><dt>Date</dt><dd>05-0ct-2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01714">1714</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">!/                  |         Andy Saulter              |</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">!/                  | Original code :       24-Oct-2018 |</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="comment">!/                  | Last update :         05-Oct-2019 |</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="comment">!/    24-Oct-2018 : Original Code                       ( version 6.07 )</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">!     Calculate the significant wave height for total, wind sea and</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">!     swell components from the restart file for 1 point</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#a76b9ae0dd90892fbddee70a810eb37f4">th</a></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a15774c959b98e1022224dfbf3d1da9fb">wsmult</a> <span class="comment">!same wind sea cut-off factor for sea/swell outputs</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: HSIG1p, HSIGwp, HSIGsp</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: ISEA1p</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span> :: WS, WD</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span>  :: VA1p</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: VAMAPWS <span class="comment">! Wind-sea id for spectral bins</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keywordtype">    REAL</span> :: RELWS, ETOTw, ETOTs, EwI, EsI</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordtype">CHARACTER(25)</span>,<span class="keywordtype">PARAMETER</span> :: myname=<span class="stringliteral">&#39;SWH_RSRT_1pw&#39;</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="preprocessor"></span>    hsig1p = 0.</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    hsigwp = 0.</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    hsigsp = 0.</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    depth  = max( dmin , -zb(isea1p) )</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    etot   = 0.</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    etotw  = 0.</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    etots  = 0.</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keyword">CALL </span>wavnu1 ( sig(ik), depth, <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>, <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a> )</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      e1i    = 0.</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      ewi    = 0.</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      esi    = 0.</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="comment">! Relative wind-sea calc assumes input with in direction toward</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="comment">! i.e. same as for the wave spectrum</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        relws = <a class="code" href="namespacew3odatmd.html#a15774c959b98e1022224dfbf3d1da9fb">wsmult</a> * ws * max(0.0, cos(wd - <a class="code" href="namespacew3gdatmd.html#a76b9ae0dd90892fbddee70a810eb37f4">th</a>(ith)))</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        e1i    = e1i + va1p(ith+(ik-1)*nth) * sig(ik) / <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="keywordflow">IF</span> ( relws &gt; (sig(ik)/<a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;          ewi = ewi + va1p(ith+(ik-1)*nth) * sig(ik) / <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;          vamapws(ith+(ik-1)*nth) = 1</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;          esi = esi + va1p(ith+(ik-1)*nth) * sig(ik) / <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          vamapws(ith+(ik-1)*nth) = 0</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      etot   = etot + e1i*dsip(ik)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      etotw  = etotw + ewi*dsip(ik)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      etots  = etots + esi*dsip(ik)</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    hsig1p = 4. * sqrt( etot * dth )</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    hsigwp = 4. * sqrt( etotw * dth )</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    hsigsp = 4. * sqrt( etots * dth )</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::th</a>, and <a class="el" href="w3odatmd_8F90_source.html#l00553">w3odatmd::wsmult</a>.</p>

<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="a2b14e61f0b0266f476dce784a2badfd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b14e61f0b0266f476dce784a2badfd9">&#9670;&nbsp;</a></span>update_va()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::update_va </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PRCNTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>VATMP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply correction to the spectrum. </p>
<p>The factor is (swh_anal/swh_bkg)**2 as applying to wave energy.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PRCNTG</td><td></td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">VATMP</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Oct-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01214">1214</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">!/                  |         Stelios Flampouris        |</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">!/                  | Created       :       16-Oct-2018 |</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="comment">!/    16-Oct-2018 : Original Code                       ( version 6.06 )</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="comment">!     Apply correction to the spectrum</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">!     The factor is (swh_anal/swh_bkg)**2 as applying to wave energy</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span> :: PRCNTG</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(INOUT)</span>  :: VATMP</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    vatmp = (prcntg**2)*vatmp</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">!</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="a3c1c3d95838b65181f041cdea3d40c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c1c3d95838b65181f041cdea3d40c54">&#9670;&nbsp;</a></span>updtwspec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::updtwspec </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>VATMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PRCNTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>VAMAPWS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the wind-sea part of the wave spectrum only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">VATMP</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRCNTG</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VAMAPWS</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Andy Saulter </dd></dl>
<dl class="section date"><dt>Date</dt><dd>05-Oct-2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01920">1920</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="comment">!/                  |         Andy Saulter              |</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="comment">!/                  | Original code :       24-Oct-2018 |</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="comment">!/                  | Last update :         05-Oct-2019 |</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="comment">!/    24-Oct-2018 : Original Code                       ( version 6.07 )</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="comment">!     Updates the wind-sea part of the wave spectrum only</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(INOUT)</span>  :: VATMP</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: VAMAPWS</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span> :: PRCNTG</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordtype">CHARACTER(25)</span>,<span class="keywordtype">PARAMETER</span> :: myname=<span class="stringliteral">&#39;UPDTWSPEC&#39;</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">IF</span> ( vamapws(ith+(ik-1)*nth) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          vatmp(ith+(ik-1)*nth) = vatmp(ith+(ik-1)*nth) * prcntg**2</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="ae8dc67428dfb4d27b677317393a03758"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8dc67428dfb4d27b677317393a03758">&#9670;&nbsp;</a></span>updtwspecf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::updtwspecf </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>VATMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>PRCNTG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>VAMAPWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISEA1p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>ADJALL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the wind-sea part of the wave spectrum and shifts in frequency space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">VATMP</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRCNTG</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VAMAPWS</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ISEA1p</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ADJALL</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Andy Saulter </dd></dl>
<dl class="section date"><dt>Date</dt><dd>05-Oct-2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l02000">2000</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="comment">!/                  |         Andy Saulter              |</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="comment">!/                  | Original code :       24-Oct-2018 |</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="comment">!/                  | Last update :         05-Oct-2019 |</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">!/    24-Oct-2018 : Original Code                       ( version 6.07 )</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="comment">!     Updates the wind-sea part of the wave spectrum and shifts in frequency</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="comment">!     space</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(INOUT)</span>  :: VATMP</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: VAMAPWS</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span> :: PRCNTG</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: ISEA1p</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: ADJALL</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="keywordtype">CHARACTER(25)</span>,<span class="keywordtype">PARAMETER</span> :: myname=<span class="stringliteral">&#39;UPDTWSPECF&#39;</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="keywordtype">    REAL</span> :: FFAC, SIGSHFT, FDM1, FDM2, WN1, CG1, WN2, CG2</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordtype">INTEGER</span> :: LPF, M1, M2</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: VASHFT(:)</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="preprocessor"></span>    depth  = max( dmin , -zb(isea1p))</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keyword">ALLOCATE</span>(vashft(<span class="keyword">SIZE</span>(vatmp)))</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    vashft(:) = 0.0</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">! 1st iteration shifts wind-sea energy in freq space</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    ffac = (1. / prcntg**2)**(1.0/3.0) <span class="comment">! uses Toba&#39;s relationship</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      <span class="keyword">CALL </span>wavnu1(sig(ik), depth, <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>, <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      sigshft = ffac * sig(ik)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="keywordflow">IF</span> ( vamapws(ith+(ik-1)*nth) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;          <span class="comment">! Interpolate frequency bin according to f-shift</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;          lpf = 1</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;          <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span> (lpf &lt; nk)</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;            <span class="keywordflow">IF</span> (sig(lpf) &gt;= sigshft) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;              <span class="keywordflow">IF</span> (lpf .EQ. 1) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                <span class="keyword">CALL </span>wavnu1(sig(lpf), depth, wn1, cg1)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                vashft(ith+(lpf-1)*nth) = vashft(ith+(lpf-1)*nth) + &amp;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                     vatmp(ith+(ik-1)*nth) *  &amp;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                     (dsip(ik)*sig(ik)/<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>) /  &amp;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                     (dsip(lpf)*sig(lpf)/cg1)</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                m2 = lpf</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                m1 = lpf - 1</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                fdm1 = sigshft - sig(m1)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                fdm2 = sig(m2) - sig(m1)</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                <span class="keyword">CALL </span>wavnu1(sig(m1), depth, wn1, cg1)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                <span class="keyword">CALL </span>wavnu1(sig(m2), depth, wn2, cg2)</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                vashft(ith+(m1-1)*nth) = vashft(ith+(m1-1)*nth) + &amp;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                     (fdm1 / fdm2) *         &amp;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                     vatmp(ith+(ik-1)*nth) * &amp;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                     (dsip(ik)*sig(ik)/<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>) / &amp;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                     (dsip(m1)*sig(m1)/cg1)</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                vashft(ith+(m2-1)*nth) = vashft(ith+(m2-1)*nth) + &amp;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                     (1.0 - fdm1 / fdm2) *   &amp;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                     vatmp(ith+(ik-1)*nth) * &amp;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                     (dsip(ik)*sig(ik)/<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>) / &amp;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                     (dsip(m2)*sig(m2)/cg2)</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;              lpf = nk + 1</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            lpf = lpf + 1</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;          <span class="keywordflow">IF</span> (lpf .EQ. nk) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            <span class="keyword">CALL </span>wavnu1(sig(lpf), depth, wn1, cg1)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            vashft(ith+(lpf-1)*nth) = vashft(ith+(lpf-1)*nth) + &amp;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                 vatmp(ith+(ik-1)*nth) *  &amp;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                 (dsip(ik)*sig(ik)/<a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>) /  &amp;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                 (dsip(lpf)*sig(lpf)/cg1)</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="comment">! 2nd iteration scales wind-sea energy</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        <span class="keywordflow">IF</span> ( vamapws(ith+(ik-1)*nth) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;          vashft(ith+(ik-1)*nth) = vashft(ith+(ik-1)*nth) * prcntg**2</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="comment">! 3rd iteration combines wind-sea and swell energy</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">DO</span> ik=1, nk</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <span class="keywordflow">DO</span> ith=1, nth</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        <span class="keywordflow">IF</span> ( vamapws(ith+(ik-1)*nth) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;          vatmp(ith+(ik-1)*nth) = vashft(ith+(ik-1)*nth)</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;          <span class="keywordflow">IF</span> ( adjall ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            <span class="comment">! Swell components are also re-scaled</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            vatmp(ith+(ik-1)*nth) = vatmp(ith+(ik-1)*nth) * &amp;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                 prcntg**2            + &amp;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                 vashft(ith+(ik-1)*nth)</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            <span class="comment">! Re-scaling wind-sea only</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            vatmp(ith+(ik-1)*nth) = vatmp(ith+(ik-1)*nth) + &amp;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                 vashft(ith+(ik-1)*nth)</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <span class="keyword">DEALLOCATE</span>(vashft)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="a37ef58a5fa0a20b01b976558977f1527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37ef58a5fa0a20b01b976558977f1527">&#9670;&nbsp;</a></span>uvtocart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::uvtocart </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>UVEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>VVEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>SPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>DCART</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>SMCGRD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate speed and cartesian convention directions from u,v input vectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UVEC</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VVEC</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SPD</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DCART</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SMCGRD</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Andy Saulter </dd></dl>
<dl class="section date"><dt>Date</dt><dd>05-Oct-2019 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l01828">1828</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="comment">!/                  |         Andy Saulter              |</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">!/                  | Original code :       05-Oct-2019 |</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="comment">!/    05-Oct-2019 : Original Code                       ( version 6.07 )</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">!     Calculate speed and cartesian convention directions from u,v</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="comment">!     input vectors</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(OUT)</span> :: SPD, DCART</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(IN)</span> :: UVEC, VVEC</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: SMCGRD</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; starts&#39;</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordflow">DO</span> isea=1, nsea, 1</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keywordflow">IF</span> (.NOT. smcgrd) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        ix = mapsf(isea,1)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        iy = mapsf(isea,2)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        ix = 1</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        iy = isea</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      spd(iy,ix) = sqrt( uvec(iy,ix)**2 + vvec(iy,ix)**2 )</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keywordflow">IF</span>( spd(iy,ix) .GT. 1.e-7) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        dcart = mod( <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a>+atan2(uvec(iy,ix),vvec(iy,ix)) , <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a> )</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        dcart = 0</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      spd(iy,ix) = max( spd(iy,ix) , 0.001 )</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndso,*) trim(myname), <span class="stringliteral">&#39; ends&#39;</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="preprocessor">#endif</span></div>
<span class="preprocessor"></span></div><!-- fragment -->
<p class="reference">References <a class="el" href="constants_8F90_source.html#l00072">constants::tpi</a>.</p>

<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
<a id="a139ca8003fdc26560a93d7147b3fe40e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a139ca8003fdc26560a93d7147b3fe40e">&#9670;&nbsp;</a></span>w3uprstr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program w3uprstr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update restart files based on Hs from DA. </p>
<p>Update the WAVEWATCH III restart files based on the significant wave height analysis from any data assimilation system.</p>
<p>The W3UPRSTR is the intermediator between the background WW3 and the analysis of the wave field, it modifies the original restart file according to the analysis. For the wave modeling and DA, the ww3_uprstr program applies the operator from the diagnostic to the prognostic variable.</p>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16-Feb-2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l00022">22</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>

<p class="reference">References <a class="el" href="ww3__uprstr_8F90_source.html#l01278">check_prcntg()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dmin</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dsip</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="CMakeLists_8txt_source.html#l00003">file()</a>, <a class="el" href="w3odatmd_8F90_source.html#l00330">w3odatmd::fnmpre</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01264">w3gdatmd::fswnd</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01223">w3gdatmd::gname</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01094">w3gdatmd::gtype</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00329">w3odatmd::idout</a>, <a class="el" href="w3servmd_8F90_source.html#l00091">w3servmd::itrace()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsta</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naperr</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naplog</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::napout</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::nds</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndso</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3servmd_8F90_source.html#l00222">w3servmd::nextln()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nseal</a>, <a class="el" href="w3adatmd_8F90_source.html#l00686">w3adatmd::nsealm</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01369">read_grbtxt()</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01492">read_grbtxtws()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01095">w3gdatmd::rstype</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00627">w3gdatmd::smctype</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01621">swh_rsrt_1p()</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01714">swh_rsrt_1pw()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::time</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01214">update_va()</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01920">updtwspec()</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l02000">updtwspecf()</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l01828">uvtocart()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::va</a>, <a class="el" href="w3iogrmd_8F90_source.html#l00117">w3iogrmd::w3iogr()</a>, <a class="el" href="w3iorsmd_8F90_source.html#l00113">w3iorsmd::w3iors()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00704">w3adatmd::w3naux()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00210">w3wdatmd::w3ndat()</a>, <a class="el" href="w3idatmd_8F90_source.html#l00283">w3idatmd::w3ninp()</a>, <a class="el" href="w3nmluprstrmd_8F90_source.html#l00050">w3nmluprstrmd::w3nmluprstr()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01433">w3gdatmd::w3nmod()</a>, <a class="el" href="w3odatmd_8F90_source.html#l00561">w3odatmd::w3nout()</a>, <a class="el" href="w3adatmd_8F90_source.html#l02645">w3adatmd::w3seta()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l02152">w3gdatmd::w3setg()</a>, <a class="el" href="w3idatmd_8F90_source.html#l00819">w3idatmd::w3seti()</a>, <a class="el" href="w3odatmd_8F90_source.html#l01523">w3odatmd::w3seto()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00660">w3wdatmd::w3setw()</a>, <a class="el" href="w3dispmd_8F90_source.html#l00085">w3dispmd::wavnu1()</a>, <a class="el" href="ww3__uprstr_8F90_source.html#l02157">writematrix()</a>, and <a class="el" href="w3gdatmd_8F90_source.html#l01195">w3gdatmd::zb</a>.</p>

</div>
</div>
<a id="a0d313eb90d8625cda4d548b290a922a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d313eb90d8625cda4d548b290a922a3">&#9670;&nbsp;</a></span>writematrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3uprstr::writematrix </td>
          <td>(</td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>FILENAME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:, :), intent(in)&#160;</td>
          <td class="paramname"><em>RDA_A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a 2D array to text file, column by column. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FILENAME</td><td>Path to the output file. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">RDA_A</td><td>2D array to write.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Stelios Flampouris </dd></dl>
<dl class="section date"><dt>Date</dt><dd>15-Mar-2017 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ww3__uprstr_8F90_source.html#l02157">2157</a> of file <a class="el" href="ww3__uprstr_8F90_source.html">ww3_uprstr.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <span class="comment">!/                  |         Stelios Flampouris        |</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">!/                  | Last update :         15-Mar-2017 |</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="comment">!/    15-Mar-2017 : Original Code                       ( version 6.04 )</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    <span class="comment">!/    Copyright 2010 National Weather Service (NWS),</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="comment">!/    National Oceanic and Atmospheric Administration.  All rights</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="comment">!/    reserved.  WAVEWATCH III is a trademark of the NWS.</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="comment">!/    No unauthorized use without permission.</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">!     Writes a 2D array to text file, column by column</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">!     fileName path to the output file</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">!     rda_A 2D array to write</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="comment">!     Local parameters.</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="comment">!  Internal Subroutines:</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="comment">!  Any routine that has to write 2d arrays !?!</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <span class="comment">!     !/T</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(:, :)</span>, <span class="keywordtype">INTENT(IN)</span> :: RDA_A</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordtype">CHARACTER(*)</span>         , <span class="keywordtype">INTENT(IN)</span> :: FILENAME</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordtype">INTEGER</span> IB_I, IB_J, IL_IOS</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: IP_FID = 123</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keyword">OPEN</span>( unit = ip_fid, <a class="code" href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a> = filename, status = <span class="stringliteral">&#39;REPLACE&#39;</span>, &amp;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;         form = <span class="stringliteral">&#39;FORMATTED&#39;</span>, iostat = il_ios)</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="keywordflow">IF</span> (il_ios /= 0) print*,<span class="stringliteral">&#39;In writeMatrix : Error creating file&#39;</span>//filename</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">DO</span> ib_j = 1, <span class="keyword">SIZE</span>(rda_a,2)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <span class="keywordflow">DO</span> ib_i = 1, <span class="keyword">SIZE</span>(rda_a,1)</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="comment">!               write(unit=ip_fid, fmt=&#39;(I, $)&#39;) rda_A(ib_i,ib_j)</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keyword">WRITE</span>(unit=ip_fid, fmt=<span class="stringliteral">&#39;(E18.8, $)&#39;</span>) rda_a(ib_i,ib_j)</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keyword">WRITE</span>(unit=ip_fid, fmt=*)<span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keyword">CLOSE</span>(ip_fid)</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="comment">!</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="CMakeLists_8txt_source.html#l00003">file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ww3__uprstr_8F90_source.html#l00022">w3uprstr()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacew3adatmd_html_adaccc46c70348e68ea06c9e0977522e6"><div class="ttname"><a href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">w3adatmd::cg</a></div><div class="ttdeci">real, dimension(:,:), pointer cg</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00575">w3adatmd.F90:575</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a76b9ae0dd90892fbddee70a810eb37f4"><div class="ttname"><a href="namespacew3gdatmd.html#a76b9ae0dd90892fbddee70a810eb37f4">w3gdatmd::th</a></div><div class="ttdeci">real, dimension(:), pointer th</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html"><div class="ttname"><a href="namespacew3odatmd.html">w3odatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00003">w3odatmd.F90:3</a></div></div>
<div class="ttc" id="aCMakeLists_8txt_html_a4ab12fe9f35a3436724ef90e0da910d1"><div class="ttname"><a href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a></div><div class="ttdeci">file(STRINGS ${CMAKE_BINARY_DIR}/switch switch_strings) separate_arguments(switches UNIX_COMMAND $</div><div class="ttdef"><b>Definition:</b> <a href="CMakeLists_8txt_source.html#l00003">CMakeLists.txt:3</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a15774c959b98e1022224dfbf3d1da9fb"><div class="ttname"><a href="namespacew3odatmd.html#a15774c959b98e1022224dfbf3d1da9fb">w3odatmd::wsmult</a></div><div class="ttdeci">real, pointer wsmult</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00553">w3odatmd.F90:553</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a2087a76dd0ef641047dfa5788f9833fd"><div class="ttname"><a href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">w3adatmd::wn</a></div><div class="ttdeci">real, dimension(:,:), pointer wn</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00575">w3adatmd.F90:575</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a5729459787df1ec9fac855545e0faaea"><div class="ttname"><a href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">constants::tpi</a></div><div class="ttdeci">real, parameter tpi</div><div class="ttdoc">TPI 2*Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00072">constants.F90:72</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3f14f6767c31cb4a1d22c13c18cc6fc3.html">model</a></li><li class="navelem"><a class="el" href="dir_ad2ad3705a826a4c9e367d6e0b566103.html">src</a></li><li class="navelem"><a class="el" href="ww3__uprstr_8F90.html">ww3_uprstr.F90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
