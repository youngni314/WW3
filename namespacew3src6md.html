<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: w3src6md Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacew3src6md.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">w3src6md Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Observation-based wind input and dissipation after Donelan et al (2006), and Babanin et al.  
<a href="namespacew3src6md.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a064e623fb0535096684df132a6b0b71f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3src6md.html#a064e623fb0535096684df132a6b0b71f">w3spr6</a> (A, CG, WN, EMEAN, FMEAN, WNMEAN, AMAX, FP)</td></tr>
<tr class="memdesc:a064e623fb0535096684df132a6b0b71f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate mean wave parameters.  <a href="namespacew3src6md.html#a064e623fb0535096684df132a6b0b71f">More...</a><br /></td></tr>
<tr class="separator:a064e623fb0535096684df132a6b0b71f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af908087dd7ebc32c35530a0c4e387b7c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3src6md.html#af908087dd7ebc32c35530a0c4e387b7c">w3sin6</a> (A, CG, WN2, UABS, USTAR, USDIR, CD, DAIR, TAUWX, TAUWY, TAUNWX, TAUNWY, S, D)</td></tr>
<tr class="memdesc:af908087dd7ebc32c35530a0c4e387b7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Observation-based source term for wind input.  <a href="namespacew3src6md.html#af908087dd7ebc32c35530a0c4e387b7c">More...</a><br /></td></tr>
<tr class="separator:af908087dd7ebc32c35530a0c4e387b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4e2cb5ea7fe7f3542029b0af8906dc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3src6md.html#afc4e2cb5ea7fe7f3542029b0af8906dc">w3sds6</a> (A, CG, WN, S, D)</td></tr>
<tr class="memdesc:afc4e2cb5ea7fe7f3542029b0af8906dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Observation-based source term for dissipation.  <a href="namespacew3src6md.html#afc4e2cb5ea7fe7f3542029b0af8906dc">More...</a><br /></td></tr>
<tr class="separator:afc4e2cb5ea7fe7f3542029b0af8906dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b1e1afeb0153e3502d225afd3f37240"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3src6md.html#a0b1e1afeb0153e3502d225afd3f37240">tau_wave_atmos</a> (S, CINV, SIG, DSII, TAUNWX, TAUNWY)</td></tr>
<tr class="memdesc:a0b1e1afeb0153e3502d225afd3f37240"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculated the stress for the negative part of the input term.  <a href="namespacew3src6md.html#a0b1e1afeb0153e3502d225afd3f37240">More...</a><br /></td></tr>
<tr class="separator:a0b1e1afeb0153e3502d225afd3f37240"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Observation-based wind input and dissipation after Donelan et al (2006), and Babanin et al. </p>
<p>(2010).</p>
<p>Parameterisation is based on the field data from Lake George, Australia. Initial implementation of input and dissipation is based on work from Tsagareli et al. (2010) and Rogers et al. (2012). Parameterisation extended and account for negative input due to opposing winds (see Donelan et al, 2006) and the vector version of the stress computation.</p>
<dl class="section author"><dt>Author</dt><dd>S. Zieger </dd>
<dd>
Q. Liu </dd></dl>
<dl class="section date"><dt>Date</dt><dd>26-Jun-2018 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0b1e1afeb0153e3502d225afd3f37240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b1e1afeb0153e3502d225afd3f37240">&#9670;&nbsp;</a></span>tau_wave_atmos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3src6md::tau_wave_atmos </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nth,nk), intent(in)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>CINV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>SIG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>DSII</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>TAUNWX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>TAUNWY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculated the stress for the negative part of the input term. </p>
<p>Calculated the stress for the negative part of the input term, that is the stress from the waves to the atmosphere. Relevant in the case of opposing winds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>Wind-input source term Sin. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CINV</td><td>Inverse phase speed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SIG</td><td>Relative frequencies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DSII</td><td>Frequency bandwidths. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUNWX</td><td>Stress components (wave-&gt;atmos). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUNWY</td><td>Stress components (wave-&gt;atmos).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>S. Zieger </dd>
<dd>
Q. Liu </dd></dl>
<dl class="section date"><dt>Date</dt><dd>26-Jun-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3src6md_8F90_source.html#l01067">1067</a> of file <a class="el" href="w3src6md_8F90_source.html">w3src6md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">!/                  |           S. Zieger               |</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">!/                  |           Q. Liu                  |</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">!/                  | Last update :         26-Jun-2018 |</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">!/    24-Oct-2013 : Origination following LFACTOR</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">!/                                                        (S. Zieger)</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">!/    26-Jun-2018 : Updates on DSII10Hz                 ( version 6.06)</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="comment">!/                                                        (Q. Liu)</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">!     Calculated the stress for the negative part of the input term,</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">!     that is the stress from the waves to the atmosphere. Relevant</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">!     in the case of opposing winds.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">!     1) If required, extend resolved part of the spectrum to 10Hz using</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">!        an approximation for the spectral slope at the high frequency</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">!        limit: Sin(F) prop. F**(-2) and for E(F) prop. F**(-5).</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">!     2) Calculate stresses:</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="comment">!        stress components (x,y):      /10Hz</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="comment">!            TAUNW_X,Y = GRAV * DWAT * | [SinX,Y(F)]/C(F) dF</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="comment">!                                      /</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">!      S        R.A. I  Wind input energy density spectrum</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">!      CINV     R.A. I  Inverse phase speed                 1/C(sigma)</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">!      SIG      R.A. I  Relative frequencies [in rad.]</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">!      DSII     R.A. I  Frequency bandwiths [in rad.]</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">!      TAUNWX-Y Real O  Component of the negative wave-supported stress</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="comment">!      Name      Type  Scope    Description</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">!      IRANGE    Func. Private  Index generator (ie, array addressing)</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">!      TAUWINDS  Func. Private  Normal stress calculation (TAU_NRM)</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">!  5. Source code :</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a>, <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>, <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>, <a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>, <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>, <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="comment">!/ ------ I/O parameters --------------------------------------------- /</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: S(NTH,NK)      <span class="comment">! wind-input source term Sin</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: CINV(NK)       <span class="comment">! inverse phase speed</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: SIG(NK)        <span class="comment">! relative frequencies</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: DSII(NK)       <span class="comment">! frequency bandwidths</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: TAUNWX, TAUNWY <span class="comment">! stress components (wave-&gt;atmos)</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">!/    --- local parameters (in order of appearance) ------------------ /</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>     :: IENT = 0</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>, <span class="keywordtype">PARAMETER</span>   :: FRQMAX  = 10.  <span class="comment">! Upper freq. limit to extrapolate to.</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordtype">INTEGER</span>           :: NK10Hz</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keywordtype">    REAL</span>              :: ECOS2(NSPEC), ESIN2(NSPEC)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: IK10Hz(:), SIG10Hz(:), CINV10Hz(:)</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: SDENSX10Hz(:), SDENSY10Hz(:)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span> :: DSII10Hz(:), UCINV10Hz(:)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;TAU_WAVE_ATMOS&#39;</span>)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">!/ 0) --- Find the number of frequencies required to extend arrays</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">!/        up to f=10Hz and allocate arrays --------------------------- /</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    nk10hz = ceiling(alog(frqmax/(sig(1)/<a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a>))/alog(<a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>))+1</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    nk10hz = max(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,nk10hz)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="keyword">ALLOCATE</span>(ik10hz(nk10hz))</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    ik10hz = real( irange(1,nk10hz,1) )</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keyword">ALLOCATE</span>(sig10hz(nk10hz))</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keyword">ALLOCATE</span>(cinv10hz(nk10hz))</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keyword">ALLOCATE</span>(dsii10hz(nk10hz))</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keyword">ALLOCATE</span>(sdensx10hz(nk10hz))</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keyword">ALLOCATE</span>(sdensy10hz(nk10hz))</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keyword">ALLOCATE</span>(ucinv10hz(nk10hz))</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    ecos2  = <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(1:<a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>)</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    esin2  = <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(1:<a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>)</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">!/ 1) --- Either extrapolate arrays up to 10Hz or use discrete spectral</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">!         grid per se. Limit the constraint to the positive part of the</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="comment">!         wind input only. ---------------------------------------------- /</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a> .LT. nk10hz) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      sdensx10hz(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)        = sum(abs(min(0.,s))*reshape(ecos2,(/<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>,<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>/)),1) * <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      sdensy10hz(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)        = sum(abs(min(0.,s))*reshape(esin2,(/<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>,<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>/)),1) * <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      sig10hz                 = sig(1)*<a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>**(ik10hz-1.0)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      cinv10hz(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)          = cinv</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      cinv10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1:nk10hz)   = sig10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1:nk10hz)*0.101978</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      dsii10hz                = 0.5 * sig10hz * (<a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>-1.0/<a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="comment">!        The first and last frequency bin:</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      dsii10hz(1)             = 0.5 * sig10hz(1) * (<a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>-1.0)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      dsii10hz(nk10hz)        = 0.5 * sig10hz(nk10hz) * (<a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a>-1.0) / <a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="comment">!        --- Spectral slope for S_IN(F) is proportional to F**(-2) ------ /</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      sdensx10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1:nk10hz) = sdensx10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) * (sig10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)/sig10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1:nk10hz))**2</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      sdensy10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1:nk10hz) = sdensy10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) * (sig10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)/sig10hz(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1:nk10hz))**2</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      sig10hz          = sig</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      cinv10hz         = cinv</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      dsii10hz         = dsii</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      sdensx10hz(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) = sum(abs(min(0.,s))*reshape(ecos2,(/<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>,<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>/)),1) * <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      sdensy10hz(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) = sum(abs(min(0.,s))*reshape(esin2,(/<a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>,<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>/)),1) * <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">!/ 2) --- Stress calculation ----------------------------------------- /</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="comment">!     --- The wave supported stress (waves to atmosphere) ------------ /</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    taunwx = tauwinds(sdensx10hz,cinv10hz,dsii10hz)   <span class="comment">! x-component</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    taunwy = tauwinds(sdensy10hz,cinv10hz,dsii10hz)   <span class="comment">! y-component</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="constants_8F90_source.html#l00062">constants::dwat</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::ecos</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::esin</a>, <a class="el" href="constants_8F90_source.html#l00061">constants::grav</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="constants_8F90_source.html#l00072">constants::tpi</a>, and <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::xfr</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3src6md_8F90_source.html#l00292">w3sin6()</a>.</p>

</div>
</div>
<a id="afc4e2cb5ea7fe7f3542029b0af8906dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4e2cb5ea7fe7f3542029b0af8906dc">&#9670;&nbsp;</a></span>w3sds6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public w3src6md::w3sds6 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nspec), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>CG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>WN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(out)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(out)&#160;</td>
          <td class="paramname"><em>D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Observation-based source term for dissipation. </p>
<p>After Babanin et al. (2010) following the implementation by Rogers et al. (2012). The dissipation function Sds accommodates an inherent breaking term T1 and an additional cumulative term T2 at all frequencies above the peak. The forced dissipation term T2 is an integral that grows toward higher frequencies and dominates at smaller scales (Babanin et al. 2010).</p>
<p>References: Babanin et al. 2010: JPO 40(4), 667-683 Rogers et al. 2012: JTECH 29(9) 1329-1346</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">A</td><td>Action density spectrum. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CG</td><td>Group velocities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WN</td><td>Wavenumbers. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">S</td><td>Source term (1-D version). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">D</td><td>Diagonal term of derivative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>S. Zieger </dd>
<dd>
Q. Liu </dd></dl>
<dl class="section date"><dt>Date</dt><dd>26-Jun-2018 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3src6md_8F90_source.html#l00547">547</a> of file <a class="el" href="w3src6md_8F90_source.html">w3src6md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">!/                  |           S. Zieger               |</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">!/                  |           Q. Liu                  |</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">!/                  | Last update :         26-Jun-2018 |</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">!/    23-Jun-2010 : Origination.                        ( version 4.04 )</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">!/                                                        (S. Zieger)</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">!/    26-Jun-2018 : Revise the width of the last bin    ( version 6.06 )</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">!/                                                        (Q. Liu)</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">!      Observation-based source term for dissipation after Babanin et al.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">!      (2010) following the implementation by Rogers et al. (2012). The</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">!      dissipation function Sds accommodates an inherent breaking term T1</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">!      and an additional cumulative term T2 at all frequencies above the</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">!      peak. The forced dissipation term T2 is an integral that grows</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">!      toward higher frequencies and dominates at smaller scales</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">!      (Babanin et al. 2010).</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">!      References:</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">!       Babanin et al. 2010: JPO 40(4), 667-683</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">!       Rogers  et al. 2012: JTECH 29(9) 1329-1346</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">!      Sds = (T1 + T2) * E</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">!      Parameter list</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">!      A¹      R.A. I  Action density spectrum</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">!      CG      R.A. I  Group velocities</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">!      WN      R.A. I  Wavenumbers</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">!      S¹      R.A. O  Source term (1-D version)</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">!      D¹      R.A. O  Diagonal term of derivative</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">!      ¹ Stored as 1-D array with dimension NTH*NK (column by column).</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">!      W3SRCE    Subr. W3SRCEMD Source term integration.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">!      W3EXPO    Subr.   N/A    Point output post-processor.</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">!      GXEXPO    Subr.   N/A    GrADS point output post-processor.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">!      None.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">!      See source code.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">!      !/S   Enable subroutine tracing.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">!      !/T6  Test output for dissipation terms T1 and T2.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a>, <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>, <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>, <a class="code" href="namespacew3gdatmd.html#a923f717f20c2c0991fa3798768f3526a">dsii</a>, <a class="code" href="namespacew3gdatmd.html#a87981ee1fa941ca919854b529a9e3a02">sig2</a>, <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>, <a class="code" href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">xfr</a></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#ac81d941a0d4ff89310b621a7fd1ff2a0">sds6a1</a>, <a class="code" href="namespacew3gdatmd.html#a060e95c013cf9047783f6b2f08e5f09d">sds6a2</a>, <a class="code" href="namespacew3gdatmd.html#ac61129ed69603d0a195ffdcc95b672bf">sds6p1</a>, <a class="code" href="namespacew3gdatmd.html#a1102afacb7e7dedb506a7cb3d3e4ea08">sds6p2</a>, <a class="code" href="namespacew3gdatmd.html#af3adabbac1c1b0b421dd873b7c9c612c">sds6et</a></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#ifdef W3_T6</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3timemd.html">w3timemd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>  :: A(NSPEC), CG(NK), WN(NK)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span> :: S(NSPEC), D(NSPEC)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>     :: IENT = 0</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>           :: IK, ITH, IKN(NK)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordtype">    REAL</span>              :: FREQ(NK)     <span class="comment">! frequencies [Hz]</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordtype">    REAL</span>              :: DFII(NK)     <span class="comment">! frequency bandwiths [Hz]</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordtype">    REAL</span>              :: ANAR(NK)     <span class="comment">! directional narrowness</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="keywordtype">    REAL</span>              :: BNT          <span class="comment">! empirical constant for</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">! wave breaking probability</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="keywordtype">    REAL</span>              :: EDENS (NK)   <span class="comment">! spectral density E(f)</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="keywordtype">    REAL</span>              :: ETDENS(NK)   <span class="comment">! threshold spec. density ET(f)</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keywordtype">    REAL</span>              :: EXDENS(NK)   <span class="comment">! excess spectral density EX(f)</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordtype">    REAL</span>              :: NEXDENS(NK)  <span class="comment">! normalised excess spectral density</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="keywordtype">    REAL</span>              :: T1(NK)       <span class="comment">! inherent breaking term</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordtype">    REAL</span>              :: T2(NK)       <span class="comment">! forced dissipation term</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordtype">    REAL</span>              :: T12(NK)      <span class="comment">! = T1+T2 or combined dissipation</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="keywordtype">    REAL</span>              :: ADF(NK), XFAC, EDENSMAX <span class="comment">! temp. variables</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#ifdef W3_T6</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">CHARACTER(LEN=23)</span> :: IDTIME</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3SDS6&#39;</span>)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="comment">!/ 0) --- Initialize essential parameters ---------------------------- /</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    ikn     = irange(1,nspec,nth)    <span class="comment">! Index vector for elements of 1,</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">!                                      ! 2,..., NK such that for example</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="comment">!                                      ! SIG(1:NK) = SIG2(IKN).</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    freq    = sig2(ikn)/<a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    anar    = 1.0</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    bnt     = 0.035**2</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    t1      = 0.0</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    t2      = 0.0</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    nexdens = 0.0</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">!/ 1) --- Calculate threshold spectral density, spectral density, and</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">!/        the level of exceedence EXDENS(f) -------------------------- /</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    etdens  = ( <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a> * bnt ) / ( anar * cg * wn**3 )</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    edens   = sum(reshape(a,(/ nth,nk /)),1) * <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a> * sig2(ikn) * dth / cg  <span class="comment">! E(f)</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    exdens  = max(0.0,edens-etdens)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">!/    --- normalise by a generic spectral density -------------------- /</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#af3adabbac1c1b0b421dd873b7c9c612c">sds6et</a>) <span class="keywordflow">THEN</span>                <span class="comment">! ww3_grid.inp: &amp;SDS6 SDSET = T or F</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      nexdens = exdens / etdens    <span class="comment">! normalise by threshold spectral density</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">ELSE</span>                            <span class="comment">! normalise by spectral density</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      edensmax = maxval(edens)*1e-5</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">IF</span> (all(edens .GT. edensmax)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        nexdens = exdens / edens</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">DO</span> ik = 1,nk</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;          <span class="keywordflow">IF</span> (edens(ik) .GT. edensmax) nexdens(ik) = exdens(ik) / edens(ik)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">!/ 2) --- Calculate inherent breaking component T1 ------------------- /</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    t1 = <a class="code" href="namespacew3gdatmd.html#ac81d941a0d4ff89310b621a7fd1ff2a0">sds6a1</a> * anar * freq * (nexdens**<a class="code" href="namespacew3gdatmd.html#ac61129ed69603d0a195ffdcc95b672bf">sds6p1</a>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">!/ 3) --- Calculate T2, the dissipation of waves induced by</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">!/        the breaking of longer waves T2 ---------------------------- /</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    adf    = anar * (nexdens**<a class="code" href="namespacew3gdatmd.html#a1102afacb7e7dedb506a7cb3d3e4ea08">sds6p2</a>)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    xfac   = (1.0-1.0/xfr)/(xfr-1.0/xfr)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">DO</span> ik = 1,nk</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      dfii = dsii/<a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="comment">!        IF (IK .GT. 1) DFII(IK) = DFII(IK) * XFAC</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">IF</span> (ik .GT. 1 .AND. ik .LT. nk) dfii(ik) = dfii(ik) * xfac</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      t2(ik) = <a class="code" href="namespacew3gdatmd.html#a060e95c013cf9047783f6b2f08e5f09d">sds6a2</a> * sum( adf(1:ik)*dfii(1:ik) )</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">!/ 4) --- Sum up dissipation terms and apply to all directions ------- /</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    t12 = -1.0 * ( max(0.0,t1)+max(0.0,t2) )</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">DO</span> ith = 1, nth</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      d(ikn+ith-1) = t12</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    s = d * a</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">!/ 5) --- Diagnostic output (switch !/T6) ---------------------------- /</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">#ifdef W3_T6</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , idtime )</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,270) <span class="stringliteral">&#39;T1*E&#39;</span>,idtime(1:19),(t1*edens)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,270) <span class="stringliteral">&#39;T2*E&#39;</span>,idtime(1:19),(t2*edens)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,271) sum(sum(reshape(s,(/ nth,nk /)),1)*dden/cg)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;270 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3SDS6 : &#39;</span>,a,<span class="stringliteral">&#39;(&#39;</span>,a,<span class="stringliteral">&#39;)&#39;</span>,<span class="stringliteral">&#39;:&#39;</span>,70e11.3)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;271 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3SDS6 : Total SDS  =&#39;</span>,e13.5)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">!/ End of W3SDS6 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="constants_8F90_source.html#l00063">constants::dair</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dden</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dsii</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::ecos</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::esin</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="constants_8F90_source.html#l00061">constants::grav</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naperr</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01335">w3gdatmd::sds6a1</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01335">w3gdatmd::sds6a2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01338">w3gdatmd::sds6et</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01337">w3gdatmd::sds6p1</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01337">w3gdatmd::sds6p2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01335">w3gdatmd::sin6ws</a>, <a class="el" href="w3timemd_8F90_source.html#l00682">w3timemd::stme21()</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::time</a>, <a class="el" href="constants_8F90_source.html#l00072">constants::tpi</a>, and <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::xfr</a>.</p>

<p class="reference">Referenced by <a class="el" href="gx__outp_8F90_source.html#l00583">gxexpo()</a>, <a class="el" href="ww3__ounp_8F90_source.html#l01452">w3exnc()</a>, <a class="el" href="ww3__outp_8F90_source.html#l01045">w3expo()</a>, and <a class="el" href="w3srcemd_8F90_source.html#l00195">w3srcemd::w3srce()</a>.</p>

</div>
</div>
<a id="af908087dd7ebc32c35530a0c4e387b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af908087dd7ebc32c35530a0c4e387b7c">&#9670;&nbsp;</a></span>w3sin6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public w3src6md::w3sin6 </td>
          <td>(</td>
          <td class="paramtype">real, dimension (nspec), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>CG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(in)&#160;</td>
          <td class="paramname"><em>WN2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>UABS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>USTAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>USDIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DAIR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>TAUWX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>TAUWY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>TAUNWX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>TAUNWY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(out)&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nspec), intent(out)&#160;</td>
          <td class="paramname"><em>D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Observation-based source term for wind input. </p>
<p>After Donelan, Babanin, Young and Banner (Donelan et al ,2006) following the implementation by Rogers et al. (2012). </p><pre class="fragment">References:
  Donelan et al. 2006: JPO 36(8) 1672-1689.
  Rogers  et al. 2012: JTECH 29(9) 1329-1346
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">A</td><td>Action density spectrum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CG</td><td>Group velocities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WN2</td><td>Wavenumbers. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">UABS</td><td>Wind speed at 10 m above sea level (U10). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">USTAR</td><td>Friction velocity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">USDIR</td><td>Direction of USTAR. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CD</td><td>Drag coefficient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DAIR</td><td>Air density. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUWX</td><td>Component of the wave-supported stress. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUWY</td><td>Component of the wave-supported stress. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUWNX</td><td>Component of the negative part of the stress. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUWNY</td><td>Component of the negative part of the stress. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">S</td><td>Source term. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">D</td><td>Diagonal term of derivative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>S. Zieger </dd>
<dd>
Q. Liu </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Aug-2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3src6md_8F90_source.html#l00292">292</a> of file <a class="el" href="w3src6md_8F90_source.html">w3src6md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">!/                  | WAVEWATCH III      NOAA/NCEP/NOPP |</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">!/                  |           S. Zieger               |</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">!/                  |           Q. Liu                  |</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">!/                  | Last update :         13-Aug-2021 |</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">!/    20-Dec-2010 : Origination.                        ( version 4.04 )</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">!/                                                        (S. Zieger)</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">!/    26-Jun-2018 : UPROXY Update &amp; UABS                ( version 6.06 )</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">!/                                                        (Q. Liu)</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">!/    13-Aug-2021 : Consider DAIR a variable           ( version x.xx )</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">!      Observation-based source term for wind input after Donelan, Babanin,</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">!      Young and Banner (Donelan et al ,2006) following the implementation</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">!      by Rogers et al. (2012).</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">!      References:</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">!       Donelan et al. 2006: JPO 36(8) 1672-1689.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">!       Rogers  et al. 2012: JTECH 29(9) 1329-1346</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">!      Sin = B * E</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">!      Parameter list</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">!      A¹       R.A. I  Action density spectrum</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">!      CG       R.A. I  Group velocities</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">!      WN2¹     R.A. I  Wavenumbers</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">!      UABS     Real I  Wind speed at 10 m above sea level (U10)</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">!      USTAR    Real I  Friction velocity</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">!      USDIR    Real I  Direction of USTAR</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">!      CD       Real I  Drag coefficient</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">!      DAIR     Real I  Air density</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">!      S¹       R.A. O  Source term</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">!      D¹       R.A. O  Diagonal term of derivative</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">!      TAUWX-Y  Real O  Component of the wave-supported stress</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">!      TAUNWX-Y Real O  Component of the negative part of the stress</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">!      ¹ Stored as 1-D array with dimension NTH*NK (column by column).</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">!      LFACTOR   Subr. W3SRC6MD</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">!      IRANGE    Func. W3SRC6MD</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">!      W3SRCE    Subr. W3SRCEMD Source term integration.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">!      W3EXPO    Subr.   N/A    Point output post-processor.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">!      GXEXPO    Subr.   N/A    GrADS point output post-processor.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">!      None.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">!      See comments in source code.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">!      !/S   Enable subroutine tracing.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">!      !/T6  Test and diagnostic output for tail reduction.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespaceconstants.html#a643ab71343261437d0a8937d8b1207ff">dwat</a>, <a class="code" href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">tpi</a>, <a class="code" href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">grav</a></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>, <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>, <a class="code" href="namespacew3gdatmd.html#a87981ee1fa941ca919854b529a9e3a02">sig2</a>, <a class="code" href="namespacew3gdatmd.html#a523fbaa34156255cbf82b583569d2e2e">dden2</a></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>, <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>, <a class="code" href="namespacew3gdatmd.html#a570f554e30dab13ba532fdc5bc89e166">sin6a0</a>, <a class="code" href="namespacew3gdatmd.html#af4f61ccc6d647a01586672d6733c802d">sin6ws</a></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>       :: A (NSPEC), CG(NK), WN2(NSPEC)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>       :: UABS, USTAR, USDIR, CD, DAIR</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>      :: TAUWX, TAUWY, TAUNWX, TAUNWY</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>      :: S(NSPEC), D(NSPEC)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>          :: IENT = 0</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                :: IK, ITH, IKN(NK)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="keywordtype">    REAL</span>                   :: COSU, SINU, UPROXY</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(NSPEC)</span> :: CG2, ECOS2, ESIN2, DSII2</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(NK)</span>    :: DSII, SIG, WN</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keywordtype">    REAL</span>                   :: K(NTH,NK), SDENSIG(NTH,NK)           <span class="comment">! 1,2,5)</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(NK)</span>    :: ADENSIG, KMAX, ANAR, SQRTBN          <span class="comment">! 1,2,3)</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(NSPEC)</span> :: W1, W2, SQRTBN2, CINV2               <span class="comment">! 4,7)</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">DIMENSION(NK)</span>    :: LFACT, CINV                          <span class="comment">! 5)</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3SIN6&#39;</span>)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">!/ 0) --- set up a basic variables ----------------------------------- /</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    cosu   = cos(usdir)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    sinu   = sin(usdir)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    taunwx = 0.</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    taunwy = 0.</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    tauwx  = 0.</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    tauwy  = 0.</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">!/    --- scale  friction velocity to wind speed (10m) in</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">!/        the boundary layer ----------------------------------------- /</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">!/    Donelan et al. (2006) used U10 or U_{λ/2} in their S_{in}</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">!/    parameterization. To avoid some disadvantages of using U10 or</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">!/    U_{λ/2}, Rogers et al. (2012) used the following engineering</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">!/    conversion:</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">!/                    UPROXY = SIN6WS * UST</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">!/    SIN6WS = 28.0 following Komen et al. (1984)</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">!/    SIN6WS = 32.0 suggested by E. Rogers (2014)</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    uproxy = <a class="code" href="namespacew3gdatmd.html#af4f61ccc6d647a01586672d6733c802d">sin6ws</a> * ustar        <span class="comment">! Scale wind speed</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    ecos2  = <a class="code" href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">ecos</a>(1:nspec)         <span class="comment">! Only indices from 1 to NSPEC</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    esin2  = <a class="code" href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">esin</a>(1:nspec)         <span class="comment">! are requested.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    ikn    = irange(1,nspec,nth)   <span class="comment">! Index vector for elements of 1 ... NK</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">!                                    ! such that e.g. SIG(1:NK) = SIG2(IKN).</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    dsii2  = dden2 / dth / sig2    <span class="comment">! Frequency bandwidths (int.)  (rad)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    dsii   = dsii2(ikn)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    sig    = sig2(ikn)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    wn     = wn2(ikn)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    cinv2  = wn2 / sig2            <span class="comment">! inverse phase speed</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">DO</span> ith = 1, nth</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      cg2(ikn+(ith-1)) = cg       <span class="comment">! Apply CG to all directions.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">!/ 1) --- calculate 1d action density spectrum (A(sigma)) and</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">!/        zero-out values less than 1.0E-32 to avoid NaNs when</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">!/        computing directional narrowness in step 4). --------------- /</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    k       = reshape(a,(/ nth,nk /))</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    adensig = sum(k,1) * sig * dth <span class="comment">! Integrate over directions.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">!/ 2) --- calculate normalised directional spectrum K(theta,sigma) --- /</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    kmax = maxval(k,1)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">DO</span> ik = 1,nk</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">IF</span> (kmax(ik).LT.1.0e-34) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        k(1:nth,ik) = 1.</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        k(1:nth,ik) = k(1:nth,ik)/kmax(ik)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">!/ 3) --- calculate normalised spectral saturation BN(IK) ------------ /</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    anar    = 1.0/( sum(k,1) * dth )          <span class="comment">! directional narrowness</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    sqrtbn  = sqrt( anar * adensig * wn**3 )</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">DO</span> ith  = 1, nth</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      sqrtbn2(ikn+(ith-1)) = sqrtbn          <span class="comment">! Calculate SQRTBN for</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="keywordflow">    END DO</span>                                    <span class="comment">! the entire spectrum.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">!/ 4) --- calculate growth rate GAMMA and S for all directions for</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">!/        following winds (U10/c - 1 is positive; W1) and in 7) for</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">!/        adverse winds (U10/c -1 is negative, W2). W1 and W2</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">!/        complement one another. ------------------------------------ /</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    w1      = max( 0., uproxy * cinv2* ( ecos2*cosu + esin2*sinu ) - 1. )**2</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    d       = (dair / <a class="code" href="namespaceconstants.html#a643ab71343261437d0a8937d8b1207ff">dwat</a>) * sig2 * &amp;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;         (2.8 - ( 1. + tanh(10.*sqrtbn2*w1 - 11.) )) *sqrtbn2*w1</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    s       = d * a</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">!/ 5) --- calculate reduction factor LFACT using non-directional</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">!         spectral density of the wind input ------------------------- /</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    cinv    = cinv2(ikn)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    sdensig = reshape(s*sig2/cg2,(/ nth,nk /))</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keyword">CALL </span>lfactor(sdensig, cinv, uabs, ustar, usdir, sig, dsii, &amp;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;         lfact, tauwx, tauwy                          )</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">!/ 6) --- apply reduction (LFACT) to the entire spectrum ------------- /</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">IF</span> (sum(lfact) .LT. nk) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">DO</span> ith = 1, nth</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        d(ikn+ith-1) = d(ikn+ith-1) * lfact</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      s = d * a</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">!/ 7) --- compute negative wind input for adverse winds. negative</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">!/        growth is typically smaller by a factor of ~2.5 (=.28/.11)</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">!/        than those for the favourable winds [Donelan, 2006, Eq. (7)].</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">!/        the factor is adjustable with NAMELIST parameter in</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">!/        ww3_grid.inp: &#39;&amp;SIN6 SINA0 = 0.04 /&#39; ----------------------- /</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a570f554e30dab13ba532fdc5bc89e166">sin6a0</a>.GT.0.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      w2    = min( 0., uproxy * cinv2* ( ecos2*cosu + esin2*sinu ) - 1. )**2</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      d     = d - ( (dair / <a class="code" href="namespaceconstants.html#a643ab71343261437d0a8937d8b1207ff">dwat</a>) * sig2 * <a class="code" href="namespacew3gdatmd.html#a570f554e30dab13ba532fdc5bc89e166">sin6a0</a> *                   &amp;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;           (2.8 - ( 1. + tanh(10.*sqrtbn2*w2 - 11.) )) *sqrtbn2*w2 )</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      s     = d * a</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">!     --- compute negative component of the wave supported stresses</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="comment">!         from negative part of the wind input  ---------------------- /</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      sdensig = reshape(s*sig2/cg2,(/ nth,nk /))</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3src6md.html#a0b1e1afeb0153e3502d225afd3f37240">tau_wave_atmos</a>(sdensig, cinv, sig, dsii, taunwx, taunwy )</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">!/ End of W3SIN6 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dden2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="constants_8F90_source.html#l00062">constants::dwat</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::ecos</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::esin</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="constants_8F90_source.html#l00061">constants::grav</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01335">w3gdatmd::sin6a0</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01335">w3gdatmd::sin6ws</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="w3src6md_8F90_source.html#l01067">tau_wave_atmos()</a>, and <a class="el" href="constants_8F90_source.html#l00072">constants::tpi</a>.</p>

<p class="reference">Referenced by <a class="el" href="gx__outp_8F90_source.html#l00583">gxexpo()</a>, <a class="el" href="ww3__ounp_8F90_source.html#l01452">w3exnc()</a>, <a class="el" href="ww3__outp_8F90_source.html#l01045">w3expo()</a>, and <a class="el" href="w3srcemd_8F90_source.html#l00195">w3srcemd::w3srce()</a>.</p>

</div>
</div>
<a id="a064e623fb0535096684df132a6b0b71f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a064e623fb0535096684df132a6b0b71f">&#9670;&nbsp;</a></span>w3spr6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public w3src6md::w3spr6 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nth,nk), intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>CG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nk), intent(in)&#160;</td>
          <td class="paramname"><em>WN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>EMEAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>FMEAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>WNMEAN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>AMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>FP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate mean wave parameters. </p>
<p>See source term routines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">A</td><td>Action as a function of direction and wavenumber. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CG</td><td>Group velocities. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WN</td><td>Wavenumbers. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">EMEAN</td><td>Mean wave energy. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FMEAN</td><td>Mean wave frequency. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WNMEAN</td><td>Mean wavenumber. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">AMAX</td><td>Maximum action density in spectrum. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FP</td><td>Peak frequency (rad).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>S. Zieger </dd></dl>
<dl class="section date"><dt>Date</dt><dd>11-Feb-2011 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3src6md_8F90_source.html#l00122">122</a> of file <a class="el" href="w3src6md_8F90_source.html">w3src6md.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">!/                  | WAVEWATCH III      NOAA/NCEP/NOPP |</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">!/                  |           S. Zieger               |</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">!/                  | Last update :         11-Feb-2011 |</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">!/    08-Oct-2007 : Origination.                        ( version 3.13 )</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">!/    11-Feb-2011 : Implementation based on W3SPR1      ( version 4.04 )</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">!/                                                        (S. Zieger)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">!      Calculate mean wave parameters.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">!      See source term routines.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!      Parameter list</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!      A      R.A. I  Action as a function of direction and wavenumber</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">!      CG     R.A. I  Group velocities</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">!      WN     R.A. I  Wavenumbers</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">!      EMEAN  REAL O  Mean wave energy</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">!      FMEAN  REAL O  Mean wave frequency</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">!      WNMEAN REAL O  Mean wavenumber</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">!      AMAX   REAL O  Maximum action density in spectrum</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">!      FP     REAL O  Peak frequency (rad)</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">!      W3SRCE    Subr. W3SRCEMD Source term integration.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">!      W3EXPO    Subr.   N/A    Point output post-processor.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">!      GXEXPO    Subr.   N/A    GrADS point output post-processor.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">!       None.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">!      See source code.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">!      !/S  Enable subroutine tracing.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespaceconstants.html#ab81445207bb044b4a638d50ecf4470e5">tpiinv</a></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>, <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>, <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>, <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>, <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>, <a class="code" href="namespacew3gdatmd.html#a34dcba9e2f5baca86ca51293d5118d73">fte</a>, <a class="code" href="namespacew3gdatmd.html#ad278641a97747d24c30d79dcfab430b0">ftf</a>, <a class="code" href="namespacew3gdatmd.html#a9c80cb13cb565b5f0022447b8f15350a">ftwn</a>, <a class="code" href="namespacew3gdatmd.html#a923f717f20c2c0991fa3798768f3526a">dsii</a></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>,  <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: A(NTH,NK), CG(NK), WN(NK)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>       :: EMEAN, FMEAN, WNMEAN, AMAX, FP</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: IMAX</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="keywordtype">    REAL</span>                    :: EB(NK), EBAND</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">PARAMETER</span>         :: HSMIN = 0.05</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keywordtype">    REAL</span>                    :: COEFF(3)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3SPR6&#39;</span>)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">! 1.  Integrate over directions -------------------------------------- /</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    eb   = sum(a,1) * <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a> / cg</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    amax = maxval(a)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">! 2.  Integrate over wavenumbers ------------------------------------- /</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    emean  = sum(eb)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    fmean  = sum(eb / <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>))</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    wnmean = sum(eb / sqrt(wn))</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">! 3.  Add tail beyond discrete spectrum and get mean pars ------------ /</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">!     ( DTH * SIG absorbed in FTxx )</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    eband  = eb(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) / <a class="code" href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">dden</a>(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    emean  = emean  + eband * <a class="code" href="namespacew3gdatmd.html#a34dcba9e2f5baca86ca51293d5118d73">fte</a></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    fmean  = fmean  + eband * <a class="code" href="namespacew3gdatmd.html#ad278641a97747d24c30d79dcfab430b0">ftf</a></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    wnmean = wnmean + eband * <a class="code" href="namespacew3gdatmd.html#a9c80cb13cb565b5f0022447b8f15350a">ftwn</a></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">! 4.  Final processing</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    fmean  = <a class="code" href="namespaceconstants.html#ab81445207bb044b4a638d50ecf4470e5">tpiinv</a> * emean / max(1.0e-7, fmean)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    wnmean = ( emean / max(1.0e-7,wnmean) )**2</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">! 5.  Determine peak frequency using a weighted integral ------------- /</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">!     Young (1999) p239: integrate f F**4 df / integrate F**4 df ----- /</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">!     TODO: keep in mind that **fp** calculated in this way may not</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">!           work under mixing (wind-sea and swell) sea states (QL)</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    fp    = 0.0</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">IF</span> (4.0*sqrt(emean) .GT. hsmin) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      eb = sum(a,1) * <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) /cg * <a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      fp = sum(<a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) * eb**4 * <a class="code" href="namespacew3gdatmd.html#a923f717f20c2c0991fa3798768f3526a">dsii</a>) / max(1e-10, sum(eb**4 * <a class="code" href="namespacew3gdatmd.html#a923f717f20c2c0991fa3798768f3526a">dsii</a>))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      fp = fp * <a class="code" href="namespaceconstants.html#ab81445207bb044b4a638d50ecf4470e5">tpiinv</a></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">!/ End of W3SPR6 ----------------------------------------------------- /</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dden</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::dsii</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::fte</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::ftf</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::ftwn</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, and <a class="el" href="constants_8F90_source.html#l00074">constants::tpiinv</a>.</p>

<p class="reference">Referenced by <a class="el" href="gx__outp_8F90_source.html#l00583">gxexpo()</a>, <a class="el" href="ww3__ounp_8F90_source.html#l01452">w3exnc()</a>, <a class="el" href="ww3__outp_8F90_source.html#l01045">w3expo()</a>, and <a class="el" href="w3srcemd_8F90_source.html#l00195">w3srcemd::w3srce()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacew3gdatmd_html_af51536ea003579d04bb805183993f8ac"><div class="ttname"><a href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">w3gdatmd::nk</a></div><div class="ttdeci">integer, pointer nk</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a1102afacb7e7dedb506a7cb3d3e4ea08"><div class="ttname"><a href="namespacew3gdatmd.html#a1102afacb7e7dedb506a7cb3d3e4ea08">w3gdatmd::sds6p2</a></div><div class="ttdeci">integer, pointer sds6p2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01337">w3gdatmd.F90:1337</a></div></div>
<div class="ttc" id="anamespacew3src6md_html_a0b1e1afeb0153e3502d225afd3f37240"><div class="ttname"><a href="namespacew3src6md.html#a0b1e1afeb0153e3502d225afd3f37240">w3src6md::tau_wave_atmos</a></div><div class="ttdeci">subroutine tau_wave_atmos(S, CINV, SIG, DSII, TAUNWX, TAUNWY)</div><div class="ttdoc">Calculated the stress for the negative part of the input term.</div><div class="ttdef"><b>Definition:</b> <a href="w3src6md_8F90_source.html#l01067">w3src6md.F90:1067</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a4b6f7577a00b480afcec77e672fb25b2"><div class="ttname"><a href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">w3gdatmd::dth</a></div><div class="ttdeci">real, pointer dth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ae9ea4c0ae82712f485b0a6b9b546a0f4"><div class="ttname"><a href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">w3gdatmd::nspec</a></div><div class="ttdeci">integer, pointer nspec</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html"><div class="ttname"><a href="namespacew3wdatmd.html">w3wdatmd</a></div><div class="ttdoc">Define data structures to set up wave model dynamic data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00018">w3wdatmd.F90:18</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ac81d941a0d4ff89310b621a7fd1ff2a0"><div class="ttname"><a href="namespacew3gdatmd.html#ac81d941a0d4ff89310b621a7fd1ff2a0">w3gdatmd::sds6a1</a></div><div class="ttdeci">real, pointer sds6a1</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01335">w3gdatmd.F90:1335</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad451ba3fd6cfdb044986de89e4e4e4f8"><div class="ttname"><a href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">w3gdatmd::sig</a></div><div class="ttdeci">real, dimension(:), pointer sig</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a91e6f2e680d6b6e615a4eb6828182bf6"><div class="ttname"><a href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">w3wdatmd::time</a></div><div class="ttdeci">integer, dimension(:), pointer time</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a77230bde44d23a91e680520547fcaeb9"><div class="ttname"><a href="namespacew3gdatmd.html#a77230bde44d23a91e680520547fcaeb9">w3gdatmd::ecos</a></div><div class="ttdeci">real, dimension(:), pointer ecos</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a523fbaa34156255cbf82b583569d2e2e"><div class="ttname"><a href="namespacew3gdatmd.html#a523fbaa34156255cbf82b583569d2e2e">w3gdatmd::dden2</a></div><div class="ttdeci">real, dimension(:), pointer dden2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a2e5aeb0943bf5031dc1f9552e5159290"><div class="ttname"><a href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">w3odatmd::ndse</a></div><div class="ttdeci">integer, pointer ndse</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a345f95d975f7c29614d7096b4a2c4073"><div class="ttname"><a href="namespacew3gdatmd.html#a345f95d975f7c29614d7096b4a2c4073">w3gdatmd::esin</a></div><div class="ttdeci">real, dimension(:), pointer esin</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a060e95c013cf9047783f6b2f08e5f09d"><div class="ttname"><a href="namespacew3gdatmd.html#a060e95c013cf9047783f6b2f08e5f09d">w3gdatmd::sds6a2</a></div><div class="ttdeci">real, pointer sds6a2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01335">w3gdatmd.F90:1335</a></div></div>
<div class="ttc" id="anamespacew3servmd_html"><div class="ttname"><a href="namespacew3servmd.html">w3servmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00003">w3servmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a923f717f20c2c0991fa3798768f3526a"><div class="ttname"><a href="namespacew3gdatmd.html#a923f717f20c2c0991fa3798768f3526a">w3gdatmd::dsii</a></div><div class="ttdeci">real, dimension(:), pointer dsii</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespaceconstants_html_ab81445207bb044b4a638d50ecf4470e5"><div class="ttname"><a href="namespaceconstants.html#ab81445207bb044b4a638d50ecf4470e5">constants::tpiinv</a></div><div class="ttdeci">real, parameter tpiinv</div><div class="ttdoc">TPIINV Inverse of 2*Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00074">constants.F90:74</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a86ec2ee307c805e375e36c1d28ab2dbb"><div class="ttname"><a href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">w3timemd::stme21</a></div><div class="ttdeci">subroutine stme21(TIME, DTME21)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00682">w3timemd.F90:682</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_acd2df21b8b595f4f5d2d22f0a4e4e9b3"><div class="ttname"><a href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">w3gdatmd::nth</a></div><div class="ttdeci">integer, pointer nth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html"><div class="ttname"><a href="namespacew3odatmd.html">w3odatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00003">w3odatmd.F90:3</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a643ab71343261437d0a8937d8b1207ff"><div class="ttname"><a href="namespaceconstants.html#a643ab71343261437d0a8937d8b1207ff">constants::dwat</a></div><div class="ttdeci">real, parameter dwat</div><div class="ttdoc">DWAT Density of water (kg/m3).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00062">constants.F90:62</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_af3adabbac1c1b0b421dd873b7c9c612c"><div class="ttname"><a href="namespacew3gdatmd.html#af3adabbac1c1b0b421dd873b7c9c612c">w3gdatmd::sds6et</a></div><div class="ttdeci">logical, pointer sds6et</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01338">w3gdatmd.F90:1338</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a87981ee1fa941ca919854b529a9e3a02"><div class="ttname"><a href="namespacew3gdatmd.html#a87981ee1fa941ca919854b529a9e3a02">w3gdatmd::sig2</a></div><div class="ttdeci">real, dimension(:), pointer sig2</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a5729459787df1ec9fac855545e0faaea"><div class="ttname"><a href="namespaceconstants.html#a5729459787df1ec9fac855545e0faaea">constants::tpi</a></div><div class="ttdeci">real, parameter tpi</div><div class="ttdoc">TPI 2*Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00072">constants.F90:72</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a3b050f1196ad182ba44915b0c7bfb22f"><div class="ttname"><a href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">w3servmd::strace</a></div><div class="ttdeci">subroutine strace(IENT, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00148">w3servmd.F90:148</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a786c419d2555ff81ae608ab9bcffd381"><div class="ttname"><a href="namespacew3gdatmd.html#a786c419d2555ff81ae608ab9bcffd381">w3gdatmd::xfr</a></div><div class="ttdeci">real, pointer xfr</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_af4f61ccc6d647a01586672d6733c802d"><div class="ttname"><a href="namespacew3gdatmd.html#af4f61ccc6d647a01586672d6733c802d">w3gdatmd::sin6ws</a></div><div class="ttdeci">real, pointer sin6ws</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01335">w3gdatmd.F90:1335</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a34dcba9e2f5baca86ca51293d5118d73"><div class="ttname"><a href="namespacew3gdatmd.html#a34dcba9e2f5baca86ca51293d5118d73">w3gdatmd::fte</a></div><div class="ttdeci">real, pointer fte</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ac61129ed69603d0a195ffdcc95b672bf"><div class="ttname"><a href="namespacew3gdatmd.html#ac61129ed69603d0a195ffdcc95b672bf">w3gdatmd::sds6p1</a></div><div class="ttdeci">integer, pointer sds6p1</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01337">w3gdatmd.F90:1337</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_abe07088ac5bfde0d0d6ea1d0860667c4"><div class="ttname"><a href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">w3odatmd::ndst</a></div><div class="ttdeci">integer, pointer ndst</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aead1aecac711ead3469d954b2bd60fc2"><div class="ttname"><a href="namespacew3gdatmd.html#aead1aecac711ead3469d954b2bd60fc2">w3gdatmd::dden</a></div><div class="ttdeci">real, dimension(:), pointer dden</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_af5f50eeba6151acaef53bd9fbd767871"><div class="ttname"><a href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">w3servmd::extcde</a></div><div class="ttdeci">subroutine extcde(IEXIT, UNIT, MSG, FILE, LINE, COMM)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00736">w3servmd.F90:736</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad278641a97747d24c30d79dcfab430b0"><div class="ttname"><a href="namespacew3gdatmd.html#ad278641a97747d24c30d79dcfab430b0">w3gdatmd::ftf</a></div><div class="ttdeci">real, pointer ftf</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3timemd_html"><div class="ttname"><a href="namespacew3timemd.html">w3timemd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00003">w3timemd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a9c80cb13cb565b5f0022447b8f15350a"><div class="ttname"><a href="namespacew3gdatmd.html#a9c80cb13cb565b5f0022447b8f15350a">w3gdatmd::ftwn</a></div><div class="ttdeci">real, pointer ftwn</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a27ed315e4f5c61762387c7fae2eb0c38"><div class="ttname"><a href="namespaceconstants.html#a27ed315e4f5c61762387c7fae2eb0c38">constants::grav</a></div><div class="ttdeci">real, parameter grav</div><div class="ttdoc">GRAV Acc.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00061">constants.F90:61</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a570f554e30dab13ba532fdc5bc89e166"><div class="ttname"><a href="namespacew3gdatmd.html#a570f554e30dab13ba532fdc5bc89e166">w3gdatmd::sin6a0</a></div><div class="ttdeci">real, pointer sin6a0</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01335">w3gdatmd.F90:1335</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacew3src6md.html">w3src6md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
