<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WAVEWATCH III: w3wavemd Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WAVEWATCH III
   &#160;<span id="projectnumber">beta 0.0.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacew3wavemd.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">w3wavemd Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains wave model subroutine, w3wave.  
<a href="namespacew3wavemd.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a5e68663cd6aaa3a50e3de164a18db6b9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3wavemd.html#a5e68663cd6aaa3a50e3de164a18db6b9">w3wave</a> (IMOD, ODAT, TEND, STAMP, NO_OUT ifdef W3_OASIS</td></tr>
<tr class="memdesc:a5e68663cd6aaa3a50e3de164a18db6b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run WAVEWATCH III for a given time interval.  <a href="namespacew3wavemd.html#a5e68663cd6aaa3a50e3de164a18db6b9">More...</a><br /></td></tr>
<tr class="separator:a5e68663cd6aaa3a50e3de164a18db6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae754c9bf3babd41b52178d0f4ed65276"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3wavemd.html#ae754c9bf3babd41b52178d0f4ed65276">w3gath</a> (ISPEC, FIELD)</td></tr>
<tr class="memdesc:ae754c9bf3babd41b52178d0f4ed65276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gather spectral bin information into a propagation field array.  <a href="namespacew3wavemd.html#ae754c9bf3babd41b52178d0f4ed65276">More...</a><br /></td></tr>
<tr class="separator:ae754c9bf3babd41b52178d0f4ed65276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d4179c2d80ede79ad29eb5718e5e6f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3wavemd.html#a58d4179c2d80ede79ad29eb5718e5e6f">w3scat</a> (ISPEC, MAPSTA, FIELD)</td></tr>
<tr class="memdesc:a58d4179c2d80ede79ad29eb5718e5e6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scatter data back to spectral storage after propagation.  <a href="namespacew3wavemd.html#a58d4179c2d80ede79ad29eb5718e5e6f">More...</a><br /></td></tr>
<tr class="separator:a58d4179c2d80ede79ad29eb5718e5e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eeef9cdd1886cc75045ca5bffdf1a76"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacew3wavemd.html#a8eeef9cdd1886cc75045ca5bffdf1a76">w3nmin</a> (MAPSTA, FLAG0)</td></tr>
<tr class="memdesc:a8eeef9cdd1886cc75045ca5bffdf1a76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check minimum number of active sea points at given processor to evaluate the need for a MPI_BARRIER call.  <a href="namespacew3wavemd.html#a8eeef9cdd1886cc75045ca5bffdf1a76">More...</a><br /></td></tr>
<tr class="separator:a8eeef9cdd1886cc75045ca5bffdf1a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains wave model subroutine, w3wave. </p>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-Mar-2021 </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ae754c9bf3babd41b52178d0f4ed65276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae754c9bf3babd41b52178d0f4ed65276">&#9670;&nbsp;</a></span>w3gath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3wavemd::w3gath </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISPEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1-ny:ny*(nx+2)), intent(out)&#160;</td>
          <td class="paramname"><em>FIELD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gather spectral bin information into a propagation field array. </p>
<p>Direct copy or communication calls (MPP version). The field is extracted but not converted.</p>
<p>MPI version requires posing of send and receive calls in W3WAVE to match local calls.</p>
<p>MPI version does not require an MPI_TESTALL call for the posted gather operation as MPI_WAITALL is mandatory to reset persistent communication for next time step.</p>
<p>MPI version allows only two new pre-fetch postings per call to minimize chances to be slowed down by gathers that are not yet needed, while maximizing the pre-loading during the early (low-frequency) calls to the routine where the amount of calculation needed for proagation is the largest.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ISPEC</td><td>Spectral bin considered. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">FIELD</td><td>Full field to be propagated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>26-Dec-2012 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3wavemd_8F90_source.html#l02938">2938</a> of file <a class="el" href="w3wavemd_8F90_source.html">w3wavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <span class="comment">!/                  | Last update :         26-Dec-2012 |</span></div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="comment">!/    04-Jan-1999 : Distributed FORTRAN 77 version.     ( version 1.18 )</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="comment">!/    13-Jan-2000 : Upgrade to FORTRAN 90               ( version 2.00 )</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    <span class="comment">!/                  Major changes to logistics.</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    <span class="comment">!/    29-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    <span class="comment">!/    13-Jun-2006 : Split STORE in G/SSTORE             ( version 3.09 )</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    <span class="comment">!/    26-Dec-2012 : Move FIELD init. to W3GATH.         ( version 4.OF )</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="comment">!     Gather spectral bin information into a propagation field array.</span></div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <span class="comment">!     Direct copy or communication calls (MPP version).</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <span class="comment">!       ISPEC   Int.   I   Spectral bin considered.</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="comment">!       FIELD   R.A.   O   Full field to be propagated.</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="comment">!      MPI_STARTALL, MPI_WAITALL</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;    <span class="comment">!                Subr. mpif.h   MPI persistent comm. routines (!/MPI).</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <span class="comment">!      W3WAVE    Subr. W3WAVEMD Actual wave model routine.</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <span class="comment">!       None.</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    <span class="comment">!     - The field is extracted but not converted.</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="comment">!     - MPI version requires posing of send and receive calls in</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    <span class="comment">!       W3WAVE to match local calls.</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <span class="comment">!     - MPI version does not require an MPI_TESTALL call for the</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="comment">!       posted gather operation as MPI_WAITALL is mandatory to</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    <span class="comment">!       reset persistent communication for next time step.</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="comment">!     - MPI version allows only two new pre-fetch postings per</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    <span class="comment">!       call to minimize chances to be slowed down by gathers that</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="comment">!       are not yet needed, while maximizing the pre-loading</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="comment">!       during the early (low-frequency) calls to the routine</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="comment">!       where the amount of calculation needed for proagation is</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="comment">!       the largest.</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="comment">!     See source code.</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="comment">!     !/SHRD  Switch for message passing method.</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <span class="comment">!     !/MPI   Id.</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="comment">!     !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="comment">!     !/MPIT  MPI test output.</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>, <a class="code" href="namespacew3gdatmd.html#a0e0a999259afdc6d3e50cc46bb1d2d1d">nx</a>, <a class="code" href="namespacew3gdatmd.html#a4a12f6a80542f3f220bbd5ad2ac9057f">ny</a>, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>, <a class="code" href="namespacew3gdatmd.html#a2dadaadcc7dbc940f8b3b267ed06a597">dmin</a></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3parall.html#aa67a4fafe08f0720282ad106b7ba3763">init_get_isea</a></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a>, <span class="keywordtype">ONLY</span>: a =&gt; <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a>, <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>, <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>, <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a>, <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>, &amp;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;         <a class="code" href="namespacew3adatmd.html#a3c3df716a34d6bf987427f80907087db">nsploc</a>, <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>, <a class="code" href="namespacew3adatmd.html#a846808e0efa51a39c1f1d78f308bcab3">gstore</a></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>, <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a>, <a class="code" href="namespacew3odatmd.html#a8f5a1eaad48354e6b56f1ff69ff00dd2">notype</a></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="preprocessor"></span>    <a class="code" href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a> <span class="stringliteral">&quot;mpif.h&quot;</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: ISPEC</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(OUT)</span>       :: FIELD(1-NY:NY*(NX+2))</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ISEA, IXY</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: STATUS(MPI_STATUS_SIZE,NSPEC),  &amp;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;         IOFF, IERR_MPI, JSEA, ISEA,     &amp;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;         IXY, IS0, IB0, NPST, J</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">CHARACTER(LEN=15)</span>       :: STR(MPIBUF), STRT</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3GATH&#39;</span>)</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    field  = 0.</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    <span class="comment">! 1.  Shared memory version ------------------------------------------ /</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      ixy        = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      field(ixy) = a(ispec,isea)</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="comment">! 2.  Distributed memory version ( MPI ) ----------------------------- /</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;    <span class="comment">! 2.a Update counters</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="preprocessor"></span>    <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a> = <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a> + 1</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a> = <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a> + 1</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a> .GT. <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a> ) <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a> = 1</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a> .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      str = <span class="stringliteral">&#39;--------------+&#39;</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) str</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    str    = <span class="stringliteral">&#39;              |&#39;</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    strt   = str(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>)</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    strt(9:9) = <span class="stringliteral">&#39;A&#39;</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <span class="comment">! 2.b Check status of present buffer</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="comment">! 2.b.1 Scatter (send) still in progress, wait to end</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) .EQ. 2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      ioff =  1 + (<a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>)-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,2), <a class="code" href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">status</a>, ierr_mpi )</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = 0</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;<span class="preprocessor"></span>      strt(13:13) = <span class="stringliteral">&#39;S&#39;</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="comment">! 2.b.2 Gather (recv) not yet posted, post now</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = 1</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      ioff =  1 + (<a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a>-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,1), ierr_mpi )</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="preprocessor"></span>      strt(10:10) = <span class="stringliteral">&#39;g&#39;</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="comment">! 2.c Put local spectral densities in store</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> jsea=1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#aa67a4fafe08f0720282ad106b7ba3763">init_get_isea</a>(isea, jsea)</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      <a class="code" href="namespacew3adatmd.html#a846808e0efa51a39c1f1d78f308bcab3">gstore</a>(isea,<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = a(ispec,jsea)</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    <span class="comment">! 2.d Wait for remote spectral densities</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="preprocessor"></span>    ioff =  1 + (<a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>)-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,1), <a class="code" href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">status</a>, ierr_mpi )</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="preprocessor"></span>    strt(11:11) = <span class="stringliteral">&#39;G&#39;</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>), <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    str(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = strt</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="comment">! 2.e Convert storage array to field.</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      ixy        = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      field(ixy) = <a class="code" href="namespacew3adatmd.html#a846808e0efa51a39c1f1d78f308bcab3">gstore</a>(isea,<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>)</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <span class="comment">! 2.f Pre-fetch data in available buffers</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="preprocessor"></span>    is0    = <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    ib0    = <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    npst   = 0</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> j=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a>-1</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      is0    = is0 + 1</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;      <span class="keywordflow">IF</span> ( is0 .GT. <a class="code" href="namespacew3adatmd.html#a3c3df716a34d6bf987427f80907087db">nsploc</a> ) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      ib0    = 1 + mod(ib0,<a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a>)</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) = 1</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0) = is0</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;        ioff       = 1 + (is0-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,1), ierr_mpi )</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;        npst       = npst + 1</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="preprocessor"></span>        strt        = str(ib0)</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        strt(10:10) = <span class="stringliteral">&#39;g&#39;</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0), <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        str(ib0)    = strt</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <span class="keywordflow">IF</span> ( npst .GE. 2 ) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="comment">! 2.g Test output</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> ib0=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      strt   = str(ib0)</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      <span class="keywordflow">IF</span> ( strt(2:2) .EQ. <span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;          <span class="keyword">WRITE</span> (strt(1:2),<span class="stringliteral">&#39;(I2)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0)</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;          <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0), <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        str(ib0) = strt</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9010) <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a>, str</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST OF BUFFER MANAGEMENT MPI :&#39;</span>/              &amp;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;         <span class="stringliteral">&#39; -------------------------------&#39;</span>/              &amp;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;         <span class="stringliteral">&#39;      RECORDS ALTERNATELY WRITTEN BY W3GATH AND W3SCAT&#39;</span>/ &amp;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;         <span class="stringliteral">&#39;      FRIST COLLUMN  : LOCAL ISPEC&#39;</span>/                     &amp;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;         <span class="stringliteral">&#39;      OTHER COLLUMNS : BUFFER STATUS INDICATOR &#39;</span>/        &amp;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;         <span class="stringliteral">&#39;                        0 : INACTIVE&#39;</span>/                   &amp;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;         <span class="stringliteral">&#39;                        1 : RECEIVING&#39;</span>/                  &amp;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;         <span class="stringliteral">&#39;                        2 : SENDING&#39;</span>/                    &amp;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;         <span class="stringliteral">&#39;                       LOCAL ISPEC FOR BUFFER&#39;</span>/          &amp;</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;         <span class="stringliteral">&#39;                       A  : ACTIVE BUFFER&#39;</span>/              &amp;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;         <span class="stringliteral">&#39;                       g/G: START/FINISH RECIEVE&#39;</span>/       &amp;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;         <span class="stringliteral">&#39;                       s/S: START/FINISH SEND&#39;</span>/          &amp;</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;         <span class="stringliteral">&#39; +-----+&#39;</span>,8a15)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;9010 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; |&#39;</span>,i4,<span class="stringliteral">&#39; |&#39;</span>,8a15)</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="comment">!/ End of W3GATH ----------------------------------------------------- /</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3adatmd_8F90_source.html#l00680">w3adatmd::bispl</a>, <a class="el" href="w3adatmd_8F90_source.html#l00680">w3adatmd::bstat</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dmin</a>, <a class="el" href="w3adatmd_8F90_source.html#l00682">w3adatmd::gstore</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::ibfloc</a>, <a class="el" href="CMakeLists_8txt_source.html#l00015">include()</a>, <a class="el" href="w3parall_8F90_source.html#l01398">w3parall::init_get_isea()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00681">w3adatmd::irqsg2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::isploc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3adatmd_8F90_source.html#l00376">w3adatmd::mpibuf</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3odatmd_8F90_source.html#l00327">w3odatmd::notype</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::nrqsg2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nseal</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::nsploc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, and <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::va</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wave()</a>.</p>

</div>
</div>
<a id="a8eeef9cdd1886cc75045ca5bffdf1a76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eeef9cdd1886cc75045ca5bffdf1a76">&#9670;&nbsp;</a></span>w3nmin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3wavemd::w3nmin </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(ny*nx), intent(in)&#160;</td>
          <td class="paramname"><em>MAPSTA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(out)&#160;</td>
          <td class="paramname"><em>FLAG0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check minimum number of active sea points at given processor to evaluate the need for a MPI_BARRIER call. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">MAPSTA</td><td>Status map for spatial grid. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">FLAG0</td><td>Flag to identify 0 as minimum.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>28-Dec-2004 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3wavemd_8F90_source.html#l03568">3568</a> of file <a class="el" href="w3wavemd_8F90_source.html">w3wavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    <span class="comment">!/                  | Last update :         28-Dec-2004 |</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    <span class="comment">!/    23-Feb-2001 : Origination.                        ( version 2.07 )</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;    <span class="comment">!/    28-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <span class="comment">!     Check minimum number of active sea points at given processor to</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    <span class="comment">!     evaluate the need for a MPI_BARRIER call.</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    <span class="comment">!     Evaluate mapsta.</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    <span class="comment">!       MAPSTA  I.A.   I   Status map for spatial grid.</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    <span class="comment">!       FLAG0   log.   O   Flag to identify 0 as minimum.</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    <span class="comment">!      W3WAVE    Subr. W3WAVEMD Actual wave model routine.</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <span class="comment">!     None.</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    <span class="comment">!     See source code.</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    <span class="comment">!     !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    <span class="comment">!     !/T     Test output.</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>, <a class="code" href="namespacew3gdatmd.html#a0e0a999259afdc6d3e50cc46bb1d2d1d">nx</a>, <a class="code" href="namespacew3gdatmd.html#a4a12f6a80542f3f220bbd5ad2ac9057f">ny</a></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3parall.html#a22d21e5ec9142a2ac7039576de612e84">init_get_jsea_isproc</a></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: MAPSTA(NY*NX)</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(OUT)</span>    :: FLAG0</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: NMIN, IPROC, NLOC, ISEA, IXY</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: JSEA, ISPROC</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3NMIN&#39;</span>)</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    nmin   = <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP PARALLEL PRIVATE (IPROC,NLOC,ISEA,JSEA,ISPROC,IXY,NMIN)</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    <span class="comment">!$OMP DO SCHEDULE (DYNAMIC,1)</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> iproc=1, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      nloc   = 0</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;      <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a22d21e5ec9142a2ac7039576de612e84">init_get_jsea_isproc</a>(isea, jsea, isproc)</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;        <span class="keywordflow">IF</span> (isproc .eq. iproc) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;          ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;          <span class="keywordflow">IF</span> ( mapsta(ixy) .EQ. 1 ) nloc = nloc + 1</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="preprocessor"></span>      <span class="comment">!!Li   For SMC grid, local sea points are equally NSEA/NAPROC</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;      <span class="comment">!!Li   so the NLOC is overwirte by a constant.</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      nloc = <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>/<a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) iproc, nloc</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="preprocessor"></span>      nmin   = min( nmin , nloc )</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="preprocessor"></span>    <span class="comment">!$OMP END DO</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    <span class="comment">!$OMP END PARALLEL</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    flag0  = nmin .EQ. 0</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9001) nmin, flag0</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST W3NMIN : IPROC =&#39;</span>,i3,<span class="stringliteral">&#39;  NLOC =&#39;</span>,i5)</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;9001 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; TEST W3NMIN : NMIN =&#39;</span>,i5,<span class="stringliteral">&#39;  FLAG0 =&#39;</span>,l2)</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    <span class="comment">!/ End of W3NMIN ----------------------------------------------------- /</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3parall_8F90_source.html#l01163">w3parall::init_get_jsea_isproc()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, and <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wave()</a>.</p>

</div>
</div>
<a id="a58d4179c2d80ede79ad29eb5718e5e6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58d4179c2d80ede79ad29eb5718e5e6f">&#9670;&nbsp;</a></span>w3scat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3wavemd::w3scat </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ISPEC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ny*nx), intent(in)&#160;</td>
          <td class="paramname"><em>MAPSTA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(1-ny:ny*(nx+2)), intent(in)&#160;</td>
          <td class="paramname"><em>FIELD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scatter data back to spectral storage after propagation. </p>
<p>Direct copy or communication calls (MPP version). See also W3GATH. The field is put back but not converted! MPI persistent communication calls initialize in W3MPII. See W3GATH and W3MPII for additional comments on data buffering.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ISPEC</td><td>Spectral bin considered. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">MAPSTA</td><td>Status map for spatial grid. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FIELD</td><td>Full field to be propagated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13-Jun-2006 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3wavemd_8F90_source.html#l03256">3256</a> of file <a class="el" href="w3wavemd_8F90_source.html">w3wavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <span class="comment">!/                  | Last update :         13-Jun-2006 |</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <span class="comment">!/    04-Jan-1999 : Distributed FORTRAN 77 version.     ( version 1.18 )</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    <span class="comment">!/    13-Jan-2000 : Upgrade to FORTRAN 90               ( version 2.00 )</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="comment">!/                  Major changes to logistics.</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    <span class="comment">!/    28-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="comment">!/    07-Sep-2005 : Updated boundary conditions.        ( version 3.08 )</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="comment">!/    13-Jun-2006 : Split STORE in G/SSTORE             ( version 3.09 )</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="comment">!     &#39;Scatter&#39; data back to spectral storage after propagation.</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    <span class="comment">!  2. Method :</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    <span class="comment">!     Direct copy or communication calls (MPP version).</span></div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="comment">!     See also W3GATH.</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    <span class="comment">!       ISPEC   Int.   I   Spectral bin considered.</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;    <span class="comment">!       MAPSTA  I.A.   I   Status map for spatial grid.</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    <span class="comment">!       FIELD   R.A.   I   Full field to be propagated.</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <span class="comment">!      STRACE    Subr. W3SERVMD Subroutine tracing.</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    <span class="comment">!      MPI_STARTALL, MPI_WAITALL, MPI_TESTALL</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    <span class="comment">!                Subr. mpif.h   MPI persistent comm. routines (!/MPI).</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="comment">!      Name      Type  Module   Description</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <span class="comment">!      W3WAVE    Subr. W3WAVEMD Actual wave model routine.</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    <span class="comment">!     None.</span></div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="comment">!     - The field is put back but not converted !</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    <span class="comment">!     - MPI persistent communication calls initialize in W3MPII.</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    <span class="comment">!     - See W3GATH and W3MPII for additional comments on data</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    <span class="comment">!       buffering.</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    <span class="comment">!     See source code.</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    <span class="comment">!     !/SHRD  Switch for message passing method.</span></div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    <span class="comment">!     !/MPI   Id.</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;    <span class="comment">!     !/S     Enable subroutine tracing.</span></div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    <span class="comment">!     !/MPIT  MPI test output.</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>, <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>, <a class="code" href="namespacew3gdatmd.html#a0e0a999259afdc6d3e50cc46bb1d2d1d">nx</a>, <a class="code" href="namespacew3gdatmd.html#a4a12f6a80542f3f220bbd5ad2ac9057f">ny</a></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a>, <span class="keywordtype">ONLY</span>: a =&gt; <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a>, <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>, <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>, <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a>, <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>, &amp;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;         <a class="code" href="namespacew3adatmd.html#a3c3df716a34d6bf987427f80907087db">nsploc</a>, <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>, <a class="code" href="namespacew3adatmd.html#af5e19c195842dc07f7b05db5f0e81aad">sstore</a></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a></div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a>, <span class="keywordtype">ONLY</span> : <a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">only</span>: <a class="code" href="namespacew3parall.html#aa67a4fafe08f0720282ad106b7ba3763">init_get_isea</a></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="preprocessor"></span>    <a class="code" href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a> <span class="stringliteral">&quot;mpif.h&quot;</span></div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>     :: ISPEC, MAPSTA(NY*NX)</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">INTENT(IN)</span>        :: FIELD(1-NY:NY*(NX+2))</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    <span class="comment">!/ Local parameters</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ISEA, IXY</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ISEA, IXY, IOFF, IERR_MPI, J,   &amp;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;         STATUS(MPI_STATUS_SIZE,NSPEC),  &amp;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;         JSEA, IB0</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">CHARACTER(LEN=15)</span>       :: STR(MPIBUF), STRT</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>                 :: DONE</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3SCAT&#39;</span>)</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <span class="comment">! 1.  Shared memory version ------------------------------------------ *</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      ixy           = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      <span class="keywordflow">IF</span> ( mapsta(ixy) .NE. 0 ) a(ispec,isea) = field(ixy)</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;    <span class="comment">! 2.  Distributed memory version ( MPI ) ----------------------------- *</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    <span class="comment">! 2.a Initializations</span></div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> ib0=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      str(ib0) = <span class="stringliteral">&#39;              |&#39;</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<span class="preprocessor"></span>    strt   = str(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>)</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;    strt(9:9) = <span class="stringliteral">&#39;A&#39;</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <span class="comment">! 2.b Convert full grid to sea grid, active points only</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> isea=1, <a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      <span class="keywordflow">IF</span> ( mapsta(ixy) .NE. 0 ) <a class="code" href="namespacew3adatmd.html#af5e19c195842dc07f7b05db5f0e81aad">sstore</a>(isea,<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = field(ixy)</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    <span class="comment">! 2.c Send spectral densities to appropriate remote</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="preprocessor"></span>    ioff   = 1 + (<a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a>-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,2), ierr_mpi )</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = 2</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="preprocessor"></span>    strt(12:12) = <span class="stringliteral">&#39;s&#39;</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>), <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    str(<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>) = strt</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;    <span class="comment">! 2.d Save locally stored results</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> jsea=1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#aa67a4fafe08f0720282ad106b7ba3763">init_get_isea</a>(isea, jsea)</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;      ixy    = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,3)</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      <span class="keywordflow">IF</span> (mapsta(ixy) .NE. 0) a(ispec,jsea) = <a class="code" href="namespacew3adatmd.html#af5e19c195842dc07f7b05db5f0e81aad">sstore</a>(isea,<a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a>)</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;    <span class="comment">! 2.e Check if any sends have finished</span></div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;<span class="preprocessor"></span>    ib0    = <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> j=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;      ib0    = 1 + mod(ib0,<a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a>)</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) .EQ. 2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        ioff   = 1 + (<a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;          <span class="keyword">CALL </span>mpi_testall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,2), done, <a class="code" href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">status</a>, ierr_mpi )</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;          done   = .true.</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;        <span class="keywordflow">IF</span> ( done .AND. <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>.GT.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;          <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,2), <a class="code" href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">status</a>, ierr_mpi )</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        <span class="keywordflow">IF</span> ( done ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;          <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) = 0</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="preprocessor"></span>          strt        = str(ib0)</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;          <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0), <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;          strt(13:13) = <span class="stringliteral">&#39;S&#39;</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;          str(ib0)    = strt</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    <span class="comment">! 2.f Last component, finish message passing, reset buffer control</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a> .EQ. <a class="code" href="namespacew3adatmd.html#a3c3df716a34d6bf987427f80907087db">nsploc</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">DO</span> ib0=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) .EQ. 2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;          ioff   = 1 + (<a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)-1)*<a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a> .GT. 0 ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">nrqsg2</a>, <a class="code" href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">irqsg2</a>(ioff,2), <a class="code" href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">status</a>, ierr_mpi )</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;          <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) = 0</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="preprocessor"></span>          strt        = str(ib0)</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;          <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0), <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;          strt(13:13) = <span class="stringliteral">&#39;S&#39;</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;          str(ib0)    = strt</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="preprocessor"></span><span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="preprocessor"></span>      <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a> = 0</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <a class="code" href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">ibfloc</a> = 0</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="comment">! 2.g Test output</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">DO</span> ib0=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      strt   = str(ib0)</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <span class="keywordflow">IF</span> ( strt(2:2) .EQ. <span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0) .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;          <span class="keyword">WRITE</span> (strt(1:2),<span class="stringliteral">&#39;(I2)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0)</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;          <span class="keyword">WRITE</span> (strt(1:7),<span class="stringliteral">&#39;(I2,I5)&#39;</span>) <a class="code" href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">bstat</a>(ib0), <a class="code" href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">bispl</a>(ib0)</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        str(ib0) = strt</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (ndst,9000) str</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">isploc</a> .EQ. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      <span class="keywordflow">DO</span> ib0=1, <a class="code" href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">mpibuf</a></div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        str(ib0) = <span class="stringliteral">&#39;--------------+&#39;</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      <span class="keyword">WRITE</span> (ndst,9010) str</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <span class="keyword">WRITE</span> (ndst,*)</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; |     |&#39;</span>,8a15)</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;9010 <span class="keyword">FORMAT</span> ( <span class="stringliteral">&#39; +-----+&#39;</span>,8a15)</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    <span class="comment">!/ End of W3SCAT ----------------------------------------------------- /</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3adatmd_8F90_source.html#l00680">w3adatmd::bispl</a>, <a class="el" href="w3adatmd_8F90_source.html#l00680">w3adatmd::bstat</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::ibfloc</a>, <a class="el" href="CMakeLists_8txt_source.html#l00015">include()</a>, <a class="el" href="w3parall_8F90_source.html#l01398">w3parall::init_get_isea()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00681">w3adatmd::irqsg2</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::isploc</a>, <a class="el" href="constants_8F90_source.html#l00101">constants::lpdlib</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3adatmd_8F90_source.html#l00376">w3adatmd::mpibuf</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::nrqsg2</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nsea</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nseal</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nspec</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::nsploc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="w3adatmd_8F90_source.html#l00682">w3adatmd::sstore</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, and <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::va</a>.</p>

<p class="reference">Referenced by <a class="el" href="w3wavemd_8F90_source.html#l00230">w3wave()</a>.</p>

</div>
</div>
<a id="a5e68663cd6aaa3a50e3de164a18db6b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e68663cd6aaa3a50e3de164a18db6b9">&#9670;&nbsp;</a></span>w3wave()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine w3wavemd::w3wave </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IMOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(35), intent(in)&#160;</td>
          <td class="paramname"><em>ODAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>TEND</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>STAMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>NO_OUT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ifdef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>W3_OASIS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run WAVEWATCH III for a given time interval. </p>
<p>Currents are updated before winds as currents are used in wind and USTAR processing.</p>
<p>Ice and water levels can be updated only once per call.</p>
<p>If ice or water level time are undefined, the update takes place asap, otherwise around the "half-way point" between the old and new times.</p>
<p>To increase accuracy, the calculation of the intra-spectral propagation is performed in two parts around the spatial propagation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">IMOD</td><td>Model number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TEND</td><td>Ending time of integration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">STAMP</td><td>Write time stamp (optional, defaults to T). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NO_OUT</td><td>Skip output (optional, defaults to F). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ODAT</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ID_LCOMM</td><td>Present only when using W3_OASIS. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIMEN</td><td>Present only when using W3_OASIS.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>H. L. Tolman </dd></dl>
<dl class="section date"><dt>Date</dt><dd>22-Mar-2021 </dd></dl>

<p class="definition">Definition at line <a class="el" href="w3wavemd_8F90_source.html#l00230">230</a> of file <a class="el" href="w3wavemd_8F90_source.html">w3wavemd.F90</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;       ,id_lcomm, timen                 &amp;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor"></span>       )</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">!/                  | WAVEWATCH III           NOAA/NCEP |</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">!/                  |           H. L. Tolman            |</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">!/                  |                        FORTRAN 90 |</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">!/                  | Last update :         22-Mar-2021 |</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">!/                  +-----------------------------------+</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">!/    17-Mar-1999 : Distributed FORTRAN 77 version.     ( version 1.18 )</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">!/    04-Feb-2000 : Upgrade to FORTRAN 90               ( version 2.00 )</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">!/                  Major changes to logistics.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">!/    05-Jan-2001 : Bug fix to allow model to run       ( version 2.05 )</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">!/                  without output.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">!/    24-Jan-2001 : Flat grid version.                  ( version 2.06 )</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">!/    09-Feb-2001 : Third propagation scheme added.     ( version 2.08 )</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">!/    23-Feb-2001 : Check for barrier after source</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">!/                  terms added ( W3NMIN ).     ( delayed version 2.07 )</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">!/    16-Mar-2001 : Fourth propagation scheme added.    ( version 2.09 )</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">!/    30-Mar-2001 : Sub-grid obstacles added.           ( version 2.10 )</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">!/    23-May-2001 : Barrier added for dry run, changed  ( version 2.10 )</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">!/                  declaration of FLIWND.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">!/    10-Dec-2001 : Sub-grid obstacles for UQ schemes.  ( version 2.14 )</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">!/    11-Jan-2002 : Sub-grid ice.                       ( version 2.15 )</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">!/    24-Jan-2002 : Zero time step dor data ass.        ( version 2.17 )</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">!/    09-May-2002 : Switch clean up.                    ( version 2.21 )</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">!/    13-Nov-2002 : Add stress vector.                  ( version 3.00 )</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">!/    26-Dec-2002 : Moving grid version.                ( version 3.02 )</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">!/    01-Aug-2003 : Moving grid GSE correction.         ( version 3.03 )</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">!/    07-Oct-2003 : Output options for NN training.     ( version 3.05 )</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">!/    29-Dec-2004 : Multiple grid version.              ( version 3.06 )</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">!/    04-Feb-2005 : Add STAMP to par list.              ( version 3.07 )</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">!/    04-May-2005 : Change to MPI_COMM_WAVE.            ( version 3.07 )</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">!/    28-Jun-2005 : Adding map recalc for W3ULEV call.  ( version 3.07 )</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">!/    07-Sep-2005 : Updated boundary conditions.        ( version 3.08 )</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">!/    26-Jun-2006 : Add output type 6.                  ( version 3.09 )</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">!/    04-Jul-2006 : Consolidate stress arrays.          ( version 3.09 )</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">!/    18-Oct-2006 : Partitioned spectral data output.   ( version 3.10 )</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">!/    02-Feb-2007 : Add FLAGST test.                    ( version 3.10 )</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">!/    02-Apr-2007 : Add partitioned field data.         ( version 3.11 )</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">!/                  Improve MPI_WAITALL call tests/allocations.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">!/    07-May-2007 : Bug fix SKIP_O treatment.           ( version 3.11 )</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">!/    17-May-2007 : Adding NTPROC/NAPROC separation.    ( version 3.11 )</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">!/    08-Oct-2007 : Adding AS CX-Y to W3SRCE par. list. ( version 3.13 )</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">!/    22-Feb-2008 : Initialize VGX-Y properly.          ( version 3.13 )</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">!/    10-Apr-2008 : Bug fix writing log file (MPI).     ( version 3.13 )</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">!/    30-Oct-2009 : Implement run-time grid selection.  ( version 3.14 )</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">!/                  (W. E. Rogers &amp; T. J. Campbell, NRL)</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">!/    30-Oct-2009 : Implement curvilinear grid type.    ( version 3.14 )</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">!/                  (W. E. Rogers &amp; T. J. Campbell, NRL)</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">!/    31-Mar-2010 : Add reflections                     ( version 3.14.4 )</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">!/    29-Oct-2010 : Implement unstructured grids        ( version 3.14.4 )</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">!/                  (A. Roland and F. Ardhuin)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">!/    06-Mar-2011 : Output of max. CFL (F.Ardhuin)      ( version 3.14.4 )</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">!/    05-Apr-2011 : Implement iteration for DTMAX &lt;1s   ( version 3.14.4 )</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">!/    02-Jul-2012 : Update for PALM coupling            ( version 4.07 )</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">!/    02-Sep-2012 : Clean up of open BC for UG grids    ( version 4.08 )</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">!/    03-Sep-2012 : Fix format 902.                     ( version 4.10 )</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">!/    10-Dec-2012 : Modify field output MPI for new     ( version 4.OF )</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">!/                  structure and smaller memory footprint.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">!/    16-Nov-2013 : Allows reflection on curvi. grids   ( version 4.13 )</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">!/    27-Nov-2013 : Fixes for OpenMP versions.          ( version 4.15 )</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">!/    23-May-2014 : Adding ice fluxes to W3SRCE         ( version 5.01 )</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">!/    27-May-2014 : Move to OMPG/X switch.              ( version 5.02 )</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">!/    24-Apr-2015 : Adding OASIS coupling calls         ( version 5.07 )</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">!/                  (M. Accensi &amp; F. Ardhuin, IFREMER)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">!/    27-Aug-2015 : Update for ICEH, ICEF               ( version 5.10 )</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">!/    31-Mar-2016 : Current option for smc grid.        ( version 5.18 )</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">!/    06-Jun-2018 : Add PDLIB/MEMCHECK/SETUP/NETCDF_QAD/TIMING</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">!/                  OASIS/DEBUGINIT/DEBUGSRC/DEBUGRUN/DEBUGCOH</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">!/                  DEBUGIOBP/DEBUGIOBC                 ( version 6.04 )</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">!/    14-Sep-2018 : Remove PALM implementation          ( version 6.06 )</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">!/    25-Sep-2020 : Oasis coupling at T+0               ( version 7.10 )</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">!/    22-Mar-2021 : Update TAUA, RHOA                   ( version 7.13 )</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">!/    06-May-2021 : Use ARCTC and SMCTYPE options. JGLi ( version 7.13 )</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">!  1. Purpose :</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">!     Run WAVEWATCH III for a given time interval.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">!  3. Parameters :</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">!     Parameter list</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">!       IMOD    Int.   I   Model number.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">!       TEND    I.A.   I   Ending time of integration.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">!       STAMP   Log.   I   WRITE(*,*)time stamp (optional, defaults to T).</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">!       NO_OUT  Log.   I   Skip output (optional, defaults to F).</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">!                          Skip at ending time only!</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">!     Local parameters : Flags</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">!       FLOUTG  Log.  Flag for running W3OUTG.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">!       FLPART  Log.  Flag for running W3CPRT.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">!       FLZERO  Log.  Flag for zero time interval.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">!       FLAG0   Log.  Flag for processors without tasks.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">!     ----------------------------------------------------------------</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">!  4. Subroutines used :</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">!     See module documentation.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">!  5. Called by :</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">!     Any program shell or integrated model which uses WAVEWATCH III.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">!  6. Error messages :</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">!  7. Remarks :</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">!     - Currents are updated before winds as currents are used in wind</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">!       and USTAR processing.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">!     - Ice and water levels can be updated only once per call.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">!     - If ice or water level time are undefined, the update</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">!       takes place asap, otherwise around the &quot;half-way point&quot;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">!       betweem the old and new times.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">!     - To increase accuracy, the calculation of the intra-spectral</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">!       propagation is performed in two parts around the spatial propagation.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">!  8. Structure :</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">!     -----------------------------------------------------------</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">!       0.  Initializations</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">!         a Point to data structures</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">!         b Subroutine tracing</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">!         c Local parameter initialization</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">!         d Test output</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">!       1.  Check the consistency of the input.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">!         a Ending time versus initial time.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">!         b Water level time.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">!         c Current time interval.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">!         d Wind time interval.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">!         e Ice time.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">!       2.  Determine next time from ending and output</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">!           time and get corresponding time step.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">!       3.  Loop over time steps (see below).</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">!       4.  Perform output to file if requested.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">!         a Check if time is output time.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">!         b Processing and MPP preparations.  ( W3CPRT, W3OUTG )</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">!         c Reset next output time.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">!        -------------- loop over output types ------------------</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">!         d Perform output.                           ( W3IOxx )</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">!         e Update next output time.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">!        -------------------- end loop --------------------------</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">!       5.  Update log file.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">!       6.  If time is not ending time, branch back to 2.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">!     -----------------------------------------------------------</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">!      Section 3.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">!     ----------------------------------------------------------</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">!       3.1  Interpolate winds and currents. ( W3UCUR, W3DCXY )</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">!                                                    ( W3UWND )</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">!                                                    ( W3UINI )</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">!       3.2  Update boundary conditions.     ( W3IOBC, W3UBPT )</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">!       3.3  Update ice coverage (if new ice map).   ( W3UICE )</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!       3.4  Transform grid (if new water level).    ( W3ULEV )</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">!       3.5  Update maps and dirivatives.    ( W3MAPn, W3DDXY )</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">!                                            ( W3NMIN, W3UTRN )</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">!            Update grid advection vector.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">!       3.6  Perform propagation</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">!          a Preparations.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">!          b Intra spectral part 1.                  ( W3KTPn )</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">!          c Longitude-latitude       ( W3GATH, W3XYPn W3SCAT )</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">!          b Intra spectral part 2.                  ( W3KTPn )</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">!       3.7  Calculate and integrate source terms.   ( W3SRCE )</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">!       3.8  Update global time step.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">!     ----------------------------------------------------------</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">!  9. Switches :</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">!     See module documentation.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">! 10. Source code :</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceconstants.html">constants</a></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3gdatmd.html">w3gdatmd</a></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3wdatmd.html">w3wdatmd</a></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3adatmd.html">w3adatmd</a></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3idatmd.html">w3idatmd</a></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3odatmd.html">w3odatmd</a></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3updtmd.html">w3updtmd</a></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3srcemd.html">w3srcemd</a></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3pro1md.html">w3pro1md</a></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3pro2md.html">w3pro2md</a></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3pro3md.html">w3pro3md</a></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3psmcmd.html">w3psmcmd</a></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3profsmd.html">w3profsmd</a></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3profsmd.html">w3profsmd</a></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3profsmd.html">w3profsmd</a></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3triamd.html">w3triamd</a></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iogrmd.html">w3iogrmd</a></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iogomd.html">w3iogomd</a></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iopomd.html">w3iopomd</a></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iotrmd.html">w3iotrmd</a></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iorsmd.html">w3iorsmd</a></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iobcmd.html">w3iobcmd</a></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3iosfmd.html">w3iosfmd</a></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacepdlib__w3profsmd.html">pdlib_w3profsmd</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacepdlib__w3profsmd.html#a2f448c554d696e07d0c44b62c5ca4fac">apply_boundary_condition_va</a></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacepdlib__w3profsmd.html">pdlib_w3profsmd</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacepdlib__w3profsmd.html#a54ee1b549a62a0f752ae0c0a5b6cf7e8">pdlib_w3xypug</a>, <a class="code" href="namespacepdlib__w3profsmd.html#a4087dea72336c68afcff08eaeee05ed6">pdlib_w3xypug_block_implicit</a>, <a class="code" href="namespacepdlib__w3profsmd.html#afd68f1a9ca145d4d4a0a6bf3c7e22d62">pdlib_w3xypug_block_explicit</a></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacepdlib__w3profsmd.html">pdlib_w3profsmd</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacepdlib__w3profsmd.html#af299d7224d0fb5c176bb51badbe642fb">all_va_integral_print</a>, <a class="code" href="namespacepdlib__w3profsmd.html#ab69e9d8da2213bbdab66cbdb3b60badc">all_vaold_integral_print</a>, <a class="code" href="namespacepdlib__w3profsmd.html#a7695cd67695f227dbbaa3b12570c11bd">all_field_integral_print</a></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacew3parall.html#aee1ccd850c86a682a087913c5230b24f">pdlib_nseal</a>, <a class="code" href="namespacew3parall.html#a73c588d37e952e093a55352ad8a56754">pdlib_nsealm</a></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceyownodepool.html">yownodepool</a>, <span class="keywordtype">only</span>: <a class="code" href="namespaceyownodepool.html#ab77f5a6052a07d32d3f2debc49086fdc">npa</a>, <a class="code" href="namespaceyownodepool.html#aeb9586089a351e66fced1e5fa617e2ec">iplg</a>, <a class="code" href="namespaceyownodepool.html#a2bfec316a2280fff5c93b744f6e7e77e">np</a></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3servmd.html">w3servmd</a></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3timemd.html">w3timemd</a></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3sic3md.html">w3sic3md</a></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_IS2</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3sis2md.html">w3sis2md</a></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_UOST</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3uostmd.html">w3uostmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3uostmd.html#a7f150bdd9996668dc90556523a8a0e18">uost_setgrid</a></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">ONLY</span> : <a class="code" href="namespacew3parall.html#aa67a4fafe08f0720282ad106b7ba3763">init_get_isea</a></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#ifdef W3_SETUP</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3wavset.html">w3wavset</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacew3wavset.html#ae485fd028484633bed078aef2bfed499">wave_setup_computation</a></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor">#ifdef W3_OASIS</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3oacpmd.html">w3oacpmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3oacpmd.html#a03021aaaa8a0151addefd94d3bbd0602">id_oasis_time</a>, <a class="code" href="namespacew3oacpmd.html#a18ef249660ccfaae10f579b697932a0c">cplt0</a></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASOCM</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3ogcmmd.html">w3ogcmmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3ogcmmd.html#a2b8b896ac770500a569caff3baba06fd">snd_fields_to_ocean</a></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASACM</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3agcmmd.html">w3agcmmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3agcmmd.html#a0771a75b5e4498340cc6591ebfe1c9a8">snd_fields_to_atmos</a></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASICM</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3igcmmd.html">w3igcmmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacew3igcmmd.html#a5cb75732015e4fc711d470dc75f1a206">snd_fields_to_ice</a></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacepdlib__field__vec.html">pdlib_field_vec</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacepdlib__field__vec.html#aaefa22a0d64dcc21acbe49d8e1f27734">do_output_exchanges</a></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacepdlib__w3profsmd.html">pdlib_w3profsmd</a>, <span class="keywordtype">ONLY</span>: <a class="code" href="namespacepdlib__w3profsmd.html#a6f24b19ae09bf47426ada64d8798627e">aspar_jac</a>, <a class="code" href="namespacepdlib__w3profsmd.html#a9a2856f96ec8c63ba45fabaee8632034">aspar_diag_all</a>, <a class="code" href="namespacepdlib__w3profsmd.html#aa1e901d192ea0797931744db67caef59">b_jac</a></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacew3parall.html#a0876a0343ba7eebd915d0859d8c78e30">lsloc</a></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">USE </span><a class="code" href="namespacew3parall.html">w3parall</a>, <span class="keywordtype">only</span> : <a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor"></span>    <a class="code" href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a> <span class="stringliteral">&quot;mpif.h&quot;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">!/ Parameter list</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>           :: IMOD, TEND(2),ODAT(35)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">OPTIONAL</span> :: STAMP, NO_OUT</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">#ifdef W3_OASIS</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">OPTIONAL</span> :: ID_LCOMM</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">OPTIONAL</span> :: TIMEN(2)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">!/ Local parameters :</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">!/</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ILEN</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>           :: IENT = 0</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: IP</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: TCALC(2), IT, IT0, NT, ITEST,        &amp;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         ITLOC, ITLOCH, NTLOC, ISEA, JSEA,    &amp;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;         IX, IY, ISPEC, J, TOUT(2), TLST(2),  &amp;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;         REFLED(6), IK, ITH, IS, NKCFL</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: ISP, IP_glob</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">INTEGER</span>                 :: TTEST(2),DTTEST</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordtype">    REAL</span>                    :: ICEDAVE</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>                 :: SBSED</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SEC1</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: ISEC1</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: JJ, NDSOFLG</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: IERR_MPI, NRQMAX</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">ALLOCATABLE</span>    :: STATCO(:,:), STATIO(:,:)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">INTEGER</span>                 :: IXrel</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keywordtype">    REAL</span>                    :: DTTST, DTTST1, DTTST2, DTTST3,       &amp;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         DTL0, DTI0, DTR0, DTI10, DTI50,      &amp;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         DTGA, DTG, DTGpre, DTRES,            &amp;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         FAC, VGX, VGY, FACK, FACTH,          &amp;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         FACX, XXX, REFLEC(4),                &amp;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         DELX, DELY, DELA, DEPTH, D50, PSIC</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordtype">    REAL</span>                     :: VSioDummy(NSPEC), VDioDummy(NSPEC), VAoldDummy(NSPEC)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">LOGICAL</span>                  :: SHAVETOTioDummy</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#ifdef W3_SEC1</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>                    :: DTGTEMP</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span>       :: FIELD(:)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keywordtype">    REAL</span>                    :: TMP1(4), TMP2(3), TMP3(2), TMP4(2)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span>       :: WN_I(:)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_REFRX</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span>       :: CIK(:)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">! Orphaned arrays from old data structure</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span>       :: TAUWX(:), TAUWY(:)</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">LOGICAL</span>                 :: FLACT, FLZERO, FLFRST, FLMAP, TSTAMP,&amp;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;         SKIP_O, FLAG_O, FLDDIR, READBC,      &amp;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;         FLAG0 = .false., floutg, flpfld,     &amp;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;         flpart, local, floutg2</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>                 :: FLGMPI(0:8)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>                    :: FIXEDVISC,FIXEDDENS,FIXEDELAS</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keywordtype">    REAL</span>                    :: USE_CHENG, USE_CGICE, HICE</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">LOGICAL</span>                 :: UGDTUPDATE    <span class="comment">! true if time step should be updated for UG schemes</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordtype">CHARACTER(LEN=8)</span>        :: STTIME</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">CHARACTER(LEN=21)</span>       :: IDACT</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordtype">CHARACTER(LEN=16)</span>       :: OUTID</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">CHARACTER(LEN=23)</span>       :: IDTIME</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordtype">INTEGER</span> eIOBP</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordtype">INTEGER</span> ITH_F</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span> ::             VS_SPEC(NSPEC)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordtype">    REAL</span> ::             VD_SPEC(NSPEC)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">CHARACTER(LEN=30)</span>       :: FOUTNAME</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor"></span><span class="keywordtype">    REAL</span>             :: INDSORT(NSEA), DTCFL1(NSEA)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor"></span>    <span class="comment">!Li   Temperature spectra for Arctic boundary update.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="keywordtype">    REAL</span>, <span class="keywordtype">ALLOCATABLE</span>       :: BACSPEC(:)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordtype">    REAL</span>                    :: BACANGL</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">integer</span> :: memunit</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">!/ ------------------------------------------------------------------- /</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">! 0.  Initializations</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    xxx = <a class="code" href="namespaceconstants.html#a68363e10dc3879aff798962c524a73d0">undef</a></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    memunit = 40000+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">! 0.a Set pointers to data structure</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#ifdef W3_COU</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor"></span>    <a class="code" href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">screen</a>   =  333</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a83178e31a5472cd0f4e837ab64e9c16f">ioutp</a>  .NE. imod ) <span class="keyword">CALL </span><a class="code" href="namespacew3odatmd.html#a40de4775d7cb1e739098ef04139a6019">w3seto</a> ( imod, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#af395fc4465c603b1c92b8644e8b168d9">igrid</a>  .NE. imod ) <span class="keyword">CALL </span><a class="code" href="namespacew3gdatmd.html#a85874d43058e50547ab59d1f6fdc21c2">w3setg</a> ( imod, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a656a9d6fe55319863647f66759d86e3a">iwdata</a> .NE. imod ) <span class="keyword">CALL </span><a class="code" href="namespacew3wdatmd.html#ac0bd6dc2f0effae7dce2f111cde16802">w3setw</a> ( imod, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a40321cbf97d9ff690b041ed4c5866b71">iadata</a> .NE. imod ) <span class="keyword">CALL </span><a class="code" href="namespacew3adatmd.html#ab2c0f2e6e7524fb061d841ba7a7324a1">w3seta</a> ( imod, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ac0554636f2c325ce03b75bdf4f2d5e50">iidata</a> .NE. imod ) <span class="keyword">CALL </span><a class="code" href="namespacew3idatmd.html#a0d197238708114cc861c919bb7b0f04f">w3seti</a> ( imod, <a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>, <a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a> )</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#ifdef W3_UOST</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3uostmd.html#a7f150bdd9996668dc90556523a8a0e18">uost_setgrid</a>(imod)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;W3WAVEMD, step 1&quot;</span>, 1)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keyword">ALLOCATE</span>(tauwx(<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>), tauwy(<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#ifdef W3_REFRX</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor"></span>    <span class="keyword">ALLOCATE</span>(cik(<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>))</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">IF</span> ( <span class="keyword">PRESENT</span>(stamp) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      tstamp = stamp</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      tstamp = .true.</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">IF</span> ( <span class="keyword">PRESENT</span>(no_out) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      skip_o = no_out</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      skip_o = .false.</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;W3WAVEMD, step 2&quot;</span>, 1)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">! 0.b Subroutine tracing</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="preprocessor">#ifdef W3_S</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">strace</a> (ient, <span class="stringliteral">&#39;W3WAVE&#39;</span>)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">! 0.c Local parameter initialization</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a>  = <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a> + 1</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    idact  = <span class="stringliteral">&#39;                 &#39;</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    outid  = <span class="stringliteral">&#39;           &#39;</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    flact  = <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a> .EQ. 0</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    flmap  = <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a> .EQ. 0</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    flddir = <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a> .EQ. 0 .AND. ( <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> .OR. <a class="code" href="namespacew3gdatmd.html#a0562b2c290aa03249c1b196abc8f76a1">fsrefraction</a> .OR. <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> .OR. <a class="code" href="namespacew3gdatmd.html#afe733a06094e01f0c34208268374d03e">fsfreqshift</a> )</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    flpfld = .false.</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">DO</span> j=1,<a class="code" href="namespacew3odatmd.html#a921ed1ae97819563ed92448ff8498cfe">noge</a>(4)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      flpfld = flpfld .OR. <a class="code" href="namespacew3odatmd.html#a720da8acfb369bb59c63e6cd20bb7015">flogrd</a>(4,j) .OR. <a class="code" href="namespacew3odatmd.html#a681fab510c2b7ef119b4a5eaf1f7a3f3">flogr2</a>(4,j)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#a5442839e64fe6e007c3e465344e562a6">naplog</a> ) backspace( <a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a> )</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a882a07450a1ea1b297ef4a428c64cc56">flcold</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="namespacew3adatmd.html#a6890e5fa08d022433cfe314aac88944a">dtdyn</a> = 0.</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <a class="code" href="namespacew3adatmd.html#a150a3fab6d4a2db874aff23e94edcccf">fcut</a>  = <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>) * <a class="code" href="namespaceconstants.html#ab81445207bb044b4a638d50ecf4470e5">tpiinv</a></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">IF</span>( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      j = 1</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="preprocessor"></span>      <span class="comment">!!Li   Use sea point only field for SMC grid.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keyword">ALLOCATE</span> ( field(<a class="code" href="namespacew3gdatmd.html#adcca98a47abf7a6cc59226f0daf4ddbe">ncel</a>) )</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keyword">ALLOCATE</span> ( field(1-<a class="code" href="namespacew3gdatmd.html#a4a12f6a80542f3f220bbd5ad2ac9057f">ny</a>:<a class="code" href="namespacew3gdatmd.html#a4a12f6a80542f3f220bbd5ad2ac9057f">ny</a>*(<a class="code" href="namespacew3gdatmd.html#a0e0a999259afdc6d3e50cc46bb1d2d1d">nx</a>+2)) )</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="keywordflow">    ENDIF</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    local   = <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .LE. <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    ugdtupdate = .false.</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">flagll</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      facx   =  1./(<a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a> * <a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a>)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      facx   =  1.</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="preprocessor"></span>    ndsoflg = 99</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="preprocessor"></span>    sbsed = .false.</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor"></span>    sbsed = .true.</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    tauwx  = 0.</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    tauwy  = 0.</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">! 0.d Test output</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="preprocessor"></span>    ilen   = len_trim(<a class="code" href="namespacew3gdatmd.html#abeb9b7e95d4bec175d3427770dd2a80f">filext</a>)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9000) imod, <a class="code" href="namespacew3gdatmd.html#abeb9b7e95d4bec175d3427770dd2a80f">filext</a>(:ilen), tend</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">! 1.  Check the consistency of the input ----------------------------- /</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">! 1.a Ending time versus initial time</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , tend )</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    flzero = dttst .EQ. 0.</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor"></span>    <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9010) dttst, flzero</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( dttst .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1000)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 1 )</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">! 1.b Water level time</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a6f229c5cdeb68cf99a791a112772b0df">fllev</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a1ab605165ff755c6c378199958590018">tlev</a>(1) .GE. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        dtl0   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a1ab605165ff755c6c378199958590018">tlev</a> , <a class="code" href="namespacew3idatmd.html#a1c9f38c7339e6c45e9251d3bc47a57e7">tln</a> )</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        dtl0   = 1.</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9011) dtl0</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dtl0 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1001)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 2 )</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      dtl0   = 0.</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;W3WAVEMD, step 4&quot;</span>, 1)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">! 1.c Current interval</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      dttst1 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#a43c4fb87c0217c6c64fddbe622918fa4">tc0</a> , <a class="code" href="namespacew3idatmd.html#ad70d5c6e1f261d24716765d7bfebf366">tcn</a> )</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      dttst2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#a43c4fb87c0217c6c64fddbe622918fa4">tc0</a> , <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> )</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      dttst3 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tend , <a class="code" href="namespacew3idatmd.html#ad70d5c6e1f261d24716765d7bfebf366">tcn</a> )</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9012) dttst1, dttst2, dttst3</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dttst1.LT.0. .OR. dttst2.LT.0. .OR. dttst3.LT.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1002)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 3 )</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <span class="keywordflow">IF</span> ( dttst2.EQ.0..AND. <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        idact(7:7) = <span class="stringliteral">&#39;F&#39;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">! 1.d Wind interval</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#adcca631fb490998384d35ba60ebb8d6c">flwind</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      dttst1 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#af18fcfeebde40801af91008732e25cd2">tw0</a> , <a class="code" href="namespacew3idatmd.html#ada3fd04c642166b9b0f23a9d7eb46603">twn</a> )</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      dttst2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#af18fcfeebde40801af91008732e25cd2">tw0</a> , <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> )</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      dttst3 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tend , <a class="code" href="namespacew3idatmd.html#ada3fd04c642166b9b0f23a9d7eb46603">twn</a> )</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9013) dttst1, dttst2, dttst3</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dttst1.LT.0. .OR. dttst2.LT.0. .OR. dttst3.LT.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1003)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 4 )</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keywordflow">IF</span> ( dttst2.EQ.0..AND. <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        idact(3:3) = <span class="stringliteral">&#39;F&#39;</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;W3WAVEMD, step 5&quot;</span>, 1)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">! 1.e Ice concentration interval</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a9861e40146c42386bd4fe4390a7eb28d">flice</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a270079df5d11fa510b5a2db8d511e143">tice</a>(1) .GE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        dti0   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a270079df5d11fa510b5a2db8d511e143">tice</a> , <a class="code" href="namespacew3idatmd.html#afd38249ce59819daee86c6bc40805a3d">tin</a> )</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        dti0   = 1.</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9014) dti0</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dti0 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1004)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 5 )</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      dti0   = 0.</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor"></span>    <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;W3WAVEMD, step 6&quot;</span>, 1)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">! 1.f Momentum interval</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a9dc8a62b7e0ae88d2d53ac0ed3e1d6cc">fltaua</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      dttst1 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#a7f2151c09ba8cc1cc43838f3a99e6be2">tu0</a> , <a class="code" href="namespacew3idatmd.html#ac4c78c77cd36d3b05d4d79f236c70f34">tun</a> )</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      dttst2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#a7f2151c09ba8cc1cc43838f3a99e6be2">tu0</a> , <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> )</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      dttst3 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tend , <a class="code" href="namespacew3idatmd.html#ac4c78c77cd36d3b05d4d79f236c70f34">tun</a> )</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9017) dttst1, dttst2, dttst3</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dttst1.LT.0. .OR. dttst2.LT.0. .OR. dttst3.LT.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1007)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 3 )</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">IF</span> ( dttst2.EQ.0..AND. <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        idact(9:9) = <span class="stringliteral">&#39;F&#39;</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">! 1.g Air density time</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ad2c7a25bbd93d62ee0b514eb46c2101d">flrhoa</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      dttst1 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#a0e7b428c965dabf38ea4bf8cbc07a0ec">tr0</a> , <a class="code" href="namespacew3idatmd.html#a0e18f271cd635642ad54f48a73401d60">trn</a> )</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      dttst2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#a0e7b428c965dabf38ea4bf8cbc07a0ec">tr0</a> , <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> )</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      dttst3 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tend , <a class="code" href="namespacew3idatmd.html#a0e18f271cd635642ad54f48a73401d60">trn</a> )</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9018) dttst1, dttst2, dttst3</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dttst1.LT.0. .OR. dttst2.LT.0. .OR. dttst3.LT.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1008)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 2 )</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">IF</span> ( dttst2.EQ.0..AND. <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        idact(11:11) = <span class="stringliteral">&#39;F&#39;</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">! 1.e Ice thickness interval</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a85cf2903005c250a233a16c987eb2cc5">flic1</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#aecc5543cbd995a96c37e0836f9c69e3c">tic1</a>(1) .GE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        dti10   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#aecc5543cbd995a96c37e0836f9c69e3c">tic1</a> , <a class="code" href="namespacew3idatmd.html#abe5a8f2b70d9f709dd356ec593814b70">ti1</a> )</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        dti10   = 1.</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9015) dti10</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dti10 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1005)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 5 )</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      dti10   = 0.</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">! 1.e Ice floe interval</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="preprocessor">#ifdef W3_IS2</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae8baca0b90b2c23f25933a57f86dd6a5">flic5</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a6c84e7ce56ee8dd1e66047efb58ae545">tic5</a>(1) .GE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        dti50   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a6c84e7ce56ee8dd1e66047efb58ae545">tic5</a> , <a class="code" href="namespacew3idatmd.html#a189f1113da93ad048b3b62aa0951f9f5">ti5</a> )</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        dti50   = 1.</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9016) dti50</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">IF</span> ( dti50 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1006)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a> ( 5 )</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      dti50   = 0.</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">! 2.  Determine next time from ending and output --------------------- /</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">!     time and get corresponding time step.</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    flfrst = .true.</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">DO</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;First entry in the TIME LOOP&quot;</span>)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;W3WAVEMD, step 6.1&quot;</span>, 1)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="comment">! 2.a Pre-calculate table for IC3 ------------------------------------ /</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor"></span>      use_cheng=<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(9)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">IF</span>( use_cheng==1.0 )<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        fixedvisc=<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(14)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        fixeddens=<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(15)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        fixedelas=<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(16)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">IF</span> ( (fixedvisc.LT.0.0).OR.(fixeddens.LT.0.0) .OR. (fixedelas.LT.0.0) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> )                          &amp;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;               <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*)<span class="stringliteral">&#39;Cheng method requires stationary&#39;</span>,   &amp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;               <span class="stringliteral">&#39; and uniform rheology from namelist.&#39;</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a>(2)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacew3sic3md.html#a30512b9b491d5dffe72a182e0bc04de8">calledic3table</a>==0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3sic3md.html#aa47c09ce75e4fb6cec196b92d4a4d49f">ic3table_cheng</a>(fixedvisc,fixeddens,fixedelas)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          <a class="code" href="namespacew3sic3md.html#a30512b9b491d5dffe72a182e0bc04de8">calledic3table</a> = 1</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <span class="comment">! 2.b Update group velocity and wavenumber from ice parameters ------- /</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="comment">!     from W3SIC3MD module. ------------------------------------------ /</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="comment">!     Note: &quot;IF FLFRST&quot; can be added for efficiency, but testing req&#39;d</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      jsea=1 <span class="comment">! no switch (intentional)</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="preprocessor"></span>      use_cgice=<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(12)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordflow">IF</span> ( use_cgice==1.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">screen</a>,920)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">DO</span> jsea=1,<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_DIST</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="preprocessor"></span>          isea   = <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> + (jsea-1)*<a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor"></span>          isea   = jsea</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor"></span>          <span class="keyword">ALLOCATE</span>(wn_i(<span class="keyword">SIZE</span>(<a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea))))</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          wn_i(:) = 0.</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          depth  = max( <a class="code" href="namespacew3gdatmd.html#a2dadaadcc7dbc940f8b3b267ed06a597">dmin</a> , <a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(isea) )</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;          ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;          iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <span class="comment">! 2.b.1 Using Cheng method: requires stationary/uniform rheology.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          <span class="comment">!       However, ice thickness may be input by either method</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( use_cheng==1.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3idatmd.html#a85cf2903005c250a233a16c987eb2cc5">flic1</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;              hice=icep1(ix,iy)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(13).GE.0.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;              hice=<a class="code" href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">ic3pars</a>(13)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*)<span class="stringliteral">&#39;ICE THICKNESS NOT AVAILABLE FOR CG CALC&#39;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a>(2)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keywordflow">IF</span> (hice &gt; 0.0) <span class="keywordflow">THEN</span> <span class="comment">! non-zero ice</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3sic3md.html#aac4486692decf3a3d9f1f6e54a6728d1">w3ic3wncg_cheng</a>(<a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea),wn_i(:), <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea),hice,fixedvisc, &amp;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                   fixeddens, fixedelas, depth)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="keywordflow">            END IF</span> <span class="comment">! non-zero ice</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">ELSE</span> <span class="comment">! not using Cheng method</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="preprocessor"></span>            <span class="comment">! 2.b.2 If not using Cheng method: require FLIC1 to FLIC4 (not strictly</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="comment">!       necesssary, but makes code simpler)</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3idatmd.html#a85cf2903005c250a233a16c987eb2cc5">flic1</a>.AND.<a class="code" href="namespacew3idatmd.html#a3da4213bb3b6a7340de1053d4e8f02a5">flic2</a>.AND.<a class="code" href="namespacew3idatmd.html#a34e33a3956adbd1ec3097c91a454f18c">flic3</a>.AND.<a class="code" href="namespacew3idatmd.html#a84217f6f8c1bd90696eb220db08af4c6">flic4</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;              <span class="keywordflow">IF</span> (icep1(ix,iy)&gt;0.0) <span class="keywordflow">THEN</span> <span class="comment">! non-zero ice</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3sic3md.html#a72ddfeb0539730005d8af242bd2fb79d">w3ic3wncg_v1</a>(<a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea),wn_i(:), <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea),icep1(ix,iy), &amp;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                     icep2(ix,iy), icep3(ix,iy),icep4(ix,iy),depth)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordflow">              END IF</span> <span class="comment">! non-zero ice</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*)<span class="stringliteral">&#39;ICE PARAMETERS NOT AVAILABLE FOR CG CALC&#39;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a>(2)</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="keywordflow">          ENDIF</span> <span class="comment">! IF USE_CHENG...</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="preprocessor"></span>          <span class="keyword">DEALLOCATE</span>(wn_i)</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="keywordflow">        END DO</span> <span class="comment">! DO JSEA=1,NSEAL</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordflow">      END IF</span> <span class="comment">!  IF USE_CGICE ...</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>(1) .GT. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tend , <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> )</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        dttst  = 0.</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="keywordflow">      ENDIF</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keywordflow">IF</span> ( dttst.GE.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        tcalc = tend</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        tcalc = <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , tcalc )</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      nt     = 1 + int( dttst / <a class="code" href="namespacew3gdatmd.html#a9524bdcdd2307c71564f9df2df040a6b">dtmax</a> - 0.001 )</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      dtga   = dttst / real(nt)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        it0    = 0</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">IF</span> ( .NOT.flzero ) <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>  = <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a> - 1</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        nt     = 0</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        it0    = 1</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE&#39;</span>)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9020) it0, nt, dtga</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <span class="comment">! ==================================================================== /</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="comment">! 3.  Loop over time steps</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      dtres  = 0.</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">DO</span> it = it0, nt</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Begin of IT loop&quot;</span>)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SETUP</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3wavset.html#ae485fd028484633bed078aef2bfed499">wave_setup_computation</a></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="preprocessor"></span>        <span class="comment">! copy old values</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">DO</span> ip=1,<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          <span class="keywordflow">DO</span> ispec=1,<a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <a class="code" href="namespacew3wdatmd.html#adfa3c3e4ffbc58db1d4f4d86877eb8cf">vaold</a>(ispec,ip)=<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(ispec,ip)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Beginning time loop&quot;</span>, 1)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After assigning VAOLD&quot;</span>)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 0&#39;</span>)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>  = <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a> + 1</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        dtg    = real(nint(dtga+dtres+0.0001))</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        dtres  = dtres + dtga - dtg</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">IF</span> ( abs(dtres) .LT. 0.001 ) dtres  = 0.</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , dtg )</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 1&#39;</span>)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">IF</span> ( tstamp .AND. <a class="code" href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">screen</a>.NE.<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a> .AND. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.EQ.<a class="code" href="namespacew3odatmd.html#ac465fc564dba68a335292494392cc7f9">napout</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a4ff12f04b0c56a558d749b1cfed9837c">wwtime</a> ( sttime )</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , idtime )</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">screen</a>,950) idtime, sttime</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 2&#39;</span>)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        vgx = 0.</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        vgy = 0.</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">inflags1</a>(10)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          dttst1 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3idatmd.html#aa48e147109f92b138611d3b62674d738">tgn</a> )</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;          dttst2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3idatmd.html#ab445dafdaf1059fda1bf2968429d7f25">tg0</a>, <a class="code" href="namespacew3idatmd.html#aa48e147109f92b138611d3b62674d738">tgn</a> )</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;          <a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>    = dttst1 / max( 1. , dttst2 )</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;          vgx    = (<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>*<a class="code" href="namespacew3idatmd.html#a852d8b4384e2cfd7c84c71aa11932f39">ga0</a>+(1.-<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>)*<a class="code" href="namespacew3idatmd.html#a6ce31197926cd11c3696617a44407616">gan</a>) * cos(<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>*<a class="code" href="namespacew3idatmd.html#aabf770709d5ddc3608aadc2f72374c1e">gd0</a>+(1.-<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>)*<a class="code" href="namespacew3idatmd.html#a4a019b36b65e812462eacc03cb8c805b">gdn</a>)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;          vgy    = (<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>*<a class="code" href="namespacew3idatmd.html#a852d8b4384e2cfd7c84c71aa11932f39">ga0</a>+(1.-<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>)*<a class="code" href="namespacew3idatmd.html#a6ce31197926cd11c3696617a44407616">gan</a>) * sin(<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>*<a class="code" href="namespacew3idatmd.html#aabf770709d5ddc3608aadc2f72374c1e">gd0</a>+(1.-<a class="code" href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">fac</a>)*<a class="code" href="namespacew3idatmd.html#a4a019b36b65e812462eacc03cb8c805b">gdn</a>)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After VGX/VGY assignation&quot;</span>)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9021) <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, it, <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, flmap, flddir, vgx, vgy, dtg, dtres</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="comment">! 3.1 Interpolate winds, currents, and momentum.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="comment">!     (Initialize wave fields with winds)</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGDCXDX</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;Debug DCXDX FLCUR=&#39;</span>, <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 3a&#39;</span>)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a>  ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Before UCUR&quot;</span>, 1)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;W3WAVE, step 6.4.1&quot;</span>)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#a578b5955197616107c38b96b44e6cf5d">w3ucur</a> ( flfrst )</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 3b&#39;</span>)</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            ix = 1</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="preprocessor"></span>            <span class="comment">!!Li  Use new sub for DCXDX/Y and DCYDX/Y assignment.</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#a2c642900a28afbe55fa4a80cd2e298c2">smcdcxy</a></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGDCXDX</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;Before call to UG_GRADIENT for assigning DCXDX/DCXDY array&#39;</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3triamd.html#ac5ba612fd291a65f6528b5616a7b3465">ug_gradients</a>(<a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>, <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>, <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3triamd.html#ac5ba612fd291a65f6528b5616a7b3465">ug_gradients</a>(<a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>, <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>, <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>)</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            ugdtupdate=.true.</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <a class="code" href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">cflxymax</a> = 0.</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#af512f4f684985cd9e281d986e72a5d57">w3dzxy</a>(<a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(1:ubound(<a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>,1)),<span class="stringliteral">&#39;m/s&#39;</span>,<a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>, <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>) <span class="comment">!CX GRADIENT</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#af512f4f684985cd9e281d986e72a5d57">w3dzxy</a>(<a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(1:ubound(<a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>,1)),<span class="stringliteral">&#39;m/s&#39;</span>,<a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>, <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>) <span class="comment">!CY GRADIENT</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="keywordflow">          ENDIF</span>  <span class="comment">!! End GTYPE</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 4&#39;</span>)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( flfrst ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          ugdtupdate=.true.</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;          <a class="code" href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">cflxymax</a> = 0.</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a> = 0.</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a> = 0.</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="keywordflow">        END IF</span> <span class="comment">! FLCUR</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After CX/CY assignation&quot;</span>)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 5&#39;</span>)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#adcca631fb490998384d35ba60ebb8d6c">flwind</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;          <span class="keywordflow">IF</span> ( flfrst ) <a class="code" href="namespacew3wdatmd.html#a040679b85e93b0f3960bbc31fcd6bd37">asf</a> = 1.</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#afea7dd47fb438fe49c36c45802a59ec3">w3uwnd</a> ( flfrst, vgx, vgy )</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( flfrst ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;          <a class="code" href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">u10</a>    = 0.01</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;          <a class="code" href="namespacew3adatmd.html#a01dd3a2f2005cd24b5b07468b217cdb7">u10d</a>   = 0.</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          <a class="code" href="namespacew3wdatmd.html#a5268804018b2fd994091fb7af42f61e6">ust</a>    = 0.05</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          <a class="code" href="namespacew3wdatmd.html#ad9ea52f8b5bc1a26a34e0e30cc9f3b80">ustdir</a> = 0.05</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGRUN</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">DO</span> jsea = 1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          <span class="keywordflow">DO</span> is = 1, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(is, jsea) .LT. 0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;TEST W3WAVE 5&#39;</span>, <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(is,jsea)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;              <span class="keyword">CALL </span>flush(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="keywordflow">          ENDDO</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="keywordflow">        ENDDO</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">IF</span> (sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>) .NE. sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;NAN in ACTION 5&#39;</span>, ix, iy, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;          <span class="keyword">CALL </span>flush(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          <a class="code" href="namespacew3odatmd.html#a8b59b4d408269981d91de0eea81fd951">stop</a></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="keywordflow">        ENDIF</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 6&#39;</span>)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After U10, etc. assignation&quot;</span>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Before call to W3UINI&quot;</span>, 1)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Before call W3UINI&quot;</span>)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a440981c75b91c0e7a45f0bed69c15d24">fliwnd</a> .AND. local ) <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#aa0f0fc927e295c0742a760166a327a14">w3uini</a> ( <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a> )</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a9dc8a62b7e0ae88d2d53ac0ed3e1d6cc">fltaua</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#ade6e16e82c7a1c78df101d9cbc494e5c">w3utau</a> ( flfrst )</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( flfrst ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <a class="code" href="namespacew3adatmd.html#a169cdcb1ad0be4046b70d04720e9075a">taua</a>    = 0.01</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;          <a class="code" href="namespacew3adatmd.html#a816cd10227f361872854d2e9d5897189">tauadir</a> = 0.</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ad2c7a25bbd93d62ee0b514eb46c2101d">flrhoa</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#ad11d338d589100bb11aed0ecc4a6441e">w3urho</a> ( flfrst )</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( flfrst ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;          <a class="code" href="namespacew3wdatmd.html#aa626e09614f191b606dbd343a57d5ab4">rhoair</a> = <a class="code" href="namespaceconstants.html#a792972a6a5a50a0ecf7247862528f086">dair</a></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <span class="comment">! 3.2 Update boundary conditions if boundary flag is true (FLBPI)</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Before boundary update&quot;</span>, 1)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Before boundary update&quot;</span>)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 7&#39;</span>)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a39d5d567aa1a036c1863ced7728f1105">flbpi</a> .AND. local ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;          <span class="keywordflow">DO</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">tbpin</a>(1) .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;              readbc = .true.</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;              idact(1:1) = <span class="stringliteral">&#39;F&#39;</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;              readbc = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">tbpin</a>).LT.0.</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;              <span class="keywordflow">IF</span> (readbc.AND.idact(1:1).EQ.<span class="stringliteral">&#39; &#39;</span>) idact(1:1) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            flact  = readbc .OR. flact</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="keywordflow">IF</span> ( readbc ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3iobcmd.html#a019a5e37867ef70ddb68edd47abb01ce">w3iobc</a> ( <span class="stringliteral">&#39;READ&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(9), <a class="code" href="namespacew3odatmd.html#a8fa813e24da2f99107bb8a001a582842">tbpi0</a>, <a class="code" href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">tbpin</a>, itest, imod )</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;              <span class="keywordflow">IF</span> ( itest .NE. 1 ) <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#ace014a54222141d85f417972cd4dd60d">w3ubpt</a></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;              itest  = 0</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            <span class="keywordflow">IF</span> ( itest .LT. 0 ) idact(1:1) = <span class="stringliteral">&#39;L&#39;</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            <span class="keywordflow">IF</span> ( itest .GT. 0 ) idact(1:1) = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="keywordflow">IF</span> ( .NOT. (readbc.AND.<a class="code" href="namespacew3odatmd.html#a39d5d567aa1a036c1863ced7728f1105">flbpi</a>) ) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 7&#39;</span>)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>apply_boundary_condition_va</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;After FLBPI and LOCAL&quot;</span>, 1)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After FLBPI and LOCAL&quot;</span>)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 8&#39;</span>)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="comment">! 3.3.1 Update ice coverage (if new ice map).</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="comment">!     Need to be run on output nodes too, to update MAPSTx</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a9861e40146c42386bd4fe4390a7eb28d">flice</a> .AND. dti0.NE.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a270079df5d11fa510b5a2db8d511e143">tice</a>(1).GE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordflow">IF</span> ( dti0 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;              idact(13:13) = <span class="stringliteral">&#39;B&#39;</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3idatmd.html#afd38249ce59819daee86c6bc40805a3d">tin</a> )</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;              <span class="keywordflow">IF</span> ( dttst .LE. 0.5*dti0 ) idact(13:13) = <span class="stringliteral">&#39;U&#39;</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            idact(13:13) = <span class="stringliteral">&#39;I&#39;</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;          <span class="keywordflow">IF</span> ( idact(13:13).NE.<span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#a80aecdb3367ca9330f8e9fcf630f249b">w3uice</a> ( <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a> )</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            dti0   = 0.</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            flact  = .true.</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            flmap  = .true.</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;After FLICE and DTI0&quot;</span>, 1)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After FLICE and DTI0&quot;</span>)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 9&#39;</span>)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">! 3.3.2 Update ice thickness</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a85cf2903005c250a233a16c987eb2cc5">flic1</a> .AND. dti10.NE.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#aecc5543cbd995a96c37e0836f9c69e3c">tic1</a>(1).GE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">IF</span> ( dti10 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;              idact(15:15) = <span class="stringliteral">&#39;B&#39;</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3idatmd.html#abe5a8f2b70d9f709dd356ec593814b70">ti1</a> )</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;              <span class="keywordflow">IF</span> ( dttst .LE. 0.5*dti10 ) idact(15:15) = <span class="stringliteral">&#39;U&#39;</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            idact(15:15) = <span class="stringliteral">&#39;I&#39;</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          <span class="keywordflow">IF</span> ( idact(15:15).NE.<span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#aab92af4a45337d957b401970e2a9e492">w3uic1</a> ( flfrst )</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            dti10   = 0.</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            flact  = .true.</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            flmap  = .true.</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 10&#39;</span>)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="comment">! 3.3.3 Update ice floe diameter</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="preprocessor">#ifdef W3_IS2</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae8baca0b90b2c23f25933a57f86dd6a5">flic5</a> .AND. dti50.NE.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a6c84e7ce56ee8dd1e66047efb58ae545">tic5</a>(1).GE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keywordflow">IF</span> ( dti50 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;              idact(18:18) = <span class="stringliteral">&#39;B&#39;</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3idatmd.html#a189f1113da93ad048b3b62aa0951f9f5">ti5</a> )</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;              <span class="keywordflow">IF</span> ( dttst .LE. 0.5*dti50 ) idact(18:18) = <span class="stringliteral">&#39;U&#39;</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            idact(18:18) = <span class="stringliteral">&#39;I&#39;</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          <span class="keywordflow">IF</span> ( idact(18:18).NE.<span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#a37c36b4294153346e7c39c54b2fddf8c">w3uic5</a>( flfrst )</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            dti50   = 0.</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            flact  = .true.</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            flmap  = .true.</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 11a&#39;</span>)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="comment">! 3.4 Transform grid (if new water level).</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a6f229c5cdeb68cf99a791a112772b0df">fllev</a> .AND. dtl0 .NE.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3wdatmd.html#a1ab605165ff755c6c378199958590018">tlev</a>(1) .GE. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="keywordflow">IF</span> ( dtl0 .LT. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;              idact(5:5) = <span class="stringliteral">&#39;B&#39;</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3idatmd.html#a1c9f38c7339e6c45e9251d3bc47a57e7">tln</a> )</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;              <span class="keywordflow">IF</span> ( dttst .LE. 0.5*dtl0 ) idact(5:5) = <span class="stringliteral">&#39;U&#39;</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            idact(5:5) = <span class="stringliteral">&#39;I&#39;</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          <span class="keywordflow">IF</span> ( idact(5:5).NE.<span class="stringliteral">&#39; &#39;</span> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#a72384e08e3a5a05766bafc9c2ad74d6a">w3ulev</a> ( <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>, <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a> )</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            ugdtupdate=.true.</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <a class="code" href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">cflxymax</a> = 0.</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            dtl0   = 0.</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            flact  = .true.</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            flmap  = .true.</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            flddir = flddir .OR. <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> .OR. <a class="code" href="namespacew3gdatmd.html#a0562b2c290aa03249c1b196abc8f76a1">fsrefraction</a> .OR. <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> .OR. <a class="code" href="namespacew3gdatmd.html#afe733a06094e01f0c34208268374d03e">fsfreqshift</a></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;After FFLEV and DTL0&quot;</span>, 1)</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After FFLEV and DTL0&quot;</span>)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 11b&#39;</span>)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="comment">! 3.5 Update maps and derivatives.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keywordflow">IF</span> ( flmap ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .NE. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3pro1md.html#a96de654f1927ba56977aa3512de722e5">w3map1</a> ( <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a> )</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3pro2md.html#aaa7a36f453793970b41eabd01a22efd8">w3map2</a></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3pro3md.html#a3ddb9e958aa30a451ec26e940263ad6b">w3map3</a></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#a50937661d782c54631373514d6561f71">w3utrn</a> ( <a class="code" href="namespacew3gdatmd.html#a61cadb0c4a6348fd421419b6aadf525b">trnx</a>, <a class="code" href="namespacew3gdatmd.html#acd3e7ae02814c69fc9324dc915858654">trny</a> )</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3pro3md.html#a1e6b4cae3e0bf68fd6857e52ae3210c0">w3mapt</a></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span>  <span class="comment">!! GTYPE</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="comment">!! Hides call to W3NMIN, which currently only serves to warn when</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;          <span class="comment">!! one or more procs have zero active seapoints.</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGRUN</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>w3nmin ( <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, flag0 )</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          <span class="keywordflow">IF</span> ( flag0 .AND. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.EQ.<a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1030) imod</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="preprocessor"></span>          flmap  = .false.</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">IF</span> ( flddir ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            ix = 1</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="preprocessor"></span>            <span class="comment">!!Li  Use new sub for DDDX and DDDY assignment.</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#a66c1a390b74205c189b73c138070214d">smcdhxy</a></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3triamd.html#ac5ba612fd291a65f6528b5616a7b3465">ug_gradients</a>(<a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>, <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>, <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#af512f4f684985cd9e281d986e72a5d57">w3dzxy</a>(<a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(1:ubound(<a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>,1)),<span class="stringliteral">&#39;m&#39;</span>,<a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>,<a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          flddir = .false.</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 12&#39;</span>)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="comment">! Calculate PHASE SPEED GRADIENT.</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a> = 0.</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a> = 0.</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="preprocessor">#ifdef W3_REFRX</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="preprocessor"></span>        cik  = 0.</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .NE. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          <span class="keywordflow">DO</span> ik=0,<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>+1</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            cik = <a class="code" href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">sig</a>(ik) / <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(ik,1:<a class="code" href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">nsea</a>)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3updtmd.html#af512f4f684985cd9e281d986e72a5d57">w3dzxy</a>(cik,<span class="stringliteral">&#39;m/s&#39;</span>,<a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(ik,:,:),<a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(ik,:,:))</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="keywordflow">          END DO</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,1040)</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">extcde</a>(2)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          <span class="comment">! CALL UG_GRADIENTS(CMN, DCDX, DCDY) !/ Stefan, to be confirmed!</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <a class="code" href="namespacew3adatmd.html#a440981c75b91c0e7a45f0bed69c15d24">fliwnd</a> = .false.</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        flfrst = .false.</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_DEBUGSRC</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;ITIME=&#39;</span>, <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <span class="stringliteral">&#39; IT=&#39;</span>, it</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;VA before W3SRCE_IMP_PRE&quot;</span>, 1)</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keyword">CALL </span>all_field_integral_print(<a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>, <span class="stringliteral">&quot;VSTOT before W3SRCE_IMP_PRE&quot;</span>)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keyword">CALL </span>all_field_integral_print(<a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>, <span class="stringliteral">&quot;VDTOT before W3SRCE_IMP_PRE&quot;</span>)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a> .le. <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     Values for DEBUG_NODE=&#39;</span>, <a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VA)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VSTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VDTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> (it .eq. 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;          dtgpre = 1.</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          dtgpre = dtg</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 13&#39;</span>)</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a> .and. <a class="code" href="namespacew3gdatmd.html#a256ca10a028a394f3c7a2f0ca95667f0">flsou</a> .and. <a class="code" href="namespacew3gdatmd.html#a2324653ee9eefd860fe277dc83c8e073">fssource</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="preprocessor">#ifdef W3_OMP0</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="preprocessor"></span>          <span class="comment">!$OMP PARALLEL DO PRIVATE (JSEA,ISEA,IX,IY) SCHEDULE (DYNAMIC,1)</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="preprocessor"></span>          d50=0.0002</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;          reflec(:)=0.</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;          refled(:)=0</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;          psic=0.</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> (lsloc) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            <a class="code" href="namespacepdlib__w3profsmd.html#aa1e901d192ea0797931744db67caef59">b_jac</a>     = 0.</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <a class="code" href="namespacepdlib__w3profsmd.html#a6f24b19ae09bf47426ada64d8798627e">aspar_jac</a> = 0.</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a> = 0.</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            <a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a> = 0.</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keywordflow">          ENDIF</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          <span class="keywordflow">DO</span> jsea = 1, <a class="code" href="namespaceyownodepool.html#a2bfec316a2280fff5c93b744f6e7e77e">np</a></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <span class="keyword">CALL </span>init_get_isea(isea, jsea)</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            dela=1.</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            delx=1.</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            dely=1.</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="preprocessor">#ifdef W3_REF1</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a>.EQ.<a class="code" href="namespacew3gdatmd.html#a79e88ab04db1d3ac00f3e45d2625312c">rlgtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;              delx=<a class="code" href="namespacew3gdatmd.html#ace4b7064f5b270ac5564b3484566042d">sx</a>*<a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)/facx</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;              dely=<a class="code" href="namespacew3gdatmd.html#ae8e13cd23548b33eaaae230040049539">sy</a>/facx</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;              dela=delx*dely</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a>.EQ.<a class="code" href="namespacew3gdatmd.html#a063c55199a8786edf383f3c6359108f2">clgtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;              <span class="comment">! Maybe what follows works also for RLGTYPE ... to be verified</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;              delx=<a class="code" href="namespacew3gdatmd.html#a26759ceeed28f07100b31cab17d5c7ea">hpfac</a>(iy,ix)/ facx</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;              dely=<a class="code" href="namespacew3gdatmd.html#ad0202e8b0d4d789838ffaf63de3be312">hqfac</a>(iy,ix)/ facx</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;              dela=delx*dely</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            reflec=<a class="code" href="namespacew3gdatmd.html#a84f9a09b83a4c65df6185b83e26be0ae">reflc</a>(:,isea)</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            reflec(4)=<a class="code" href="namespacew3wdatmd.html#a4c5b7b938201316f96216714e8aa5da5">berg</a>(isea)*reflec(4)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            refled=<a class="code" href="namespacew3gdatmd.html#a466f03db630a1aaa5437b8c30c2722a3">refld</a>(:,isea)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="preprocessor">#ifdef W3_BT4</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="preprocessor"></span>            d50=<a class="code" href="namespacew3gdatmd.html#a148a77b8c3bf5f6274bd25c1e5e4c30d">sed_d50</a>(isea)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            psic=<a class="code" href="namespacew3gdatmd.html#a3a9e8350eb31a71dd85af858ca7d97bd">sed_psic</a>(isea)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGSRC</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (ix .eq. <a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;NODE_SRCE_IMP_PRE : IX=&#39;</span>, ix, <span class="stringliteral">&#39; JSEA=&#39;</span>, jsea</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;IT/IX/IY/IMOD=&#39;</span>, it, ix, iy, imod</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;ISEA/JSEA=&#39;</span>, isea, jsea</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;Before sum(VA)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea))</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <span class="keyword">FLUSH</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>)</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacew3srcemd.html#a1eba2fe496738bdd2aee6e835d064045">w3srce</a>(<a class="code" href="namespaceconstants.html#a3faf2a3d2d54ac342cf9591d5a73c931">srce_imp_pre</a>, it, isea, jsea, ix, iy, imod, &amp;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                 <a class="code" href="namespacew3wdatmd.html#adfa3c3e4ffbc58db1d4f4d86877eb8cf">vaold</a>(:,jsea), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea),                         &amp;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                 vsiodummy, vdiodummy, <a class="code" href="namespacew3wdatmd.html#a24c895280e10751a3396a14462552aa4">shavetot</a>(jsea),              &amp;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a2f49fab96f67af285b8ccd46e2439294">alpha</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,jsea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,isea),                   &amp;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                 <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,isea), <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea), <a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(isea), <a class="code" href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">u10</a>(isea),   &amp;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a01dd3a2f2005cd24b5b07468b217cdb7">u10d</a>(isea),                                        &amp;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="preprocessor">#ifdef W3_FLX5</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="preprocessor"></span>                 <a class="code" href="namespacew3adatmd.html#a169cdcb1ad0be4046b70d04720e9075a">taua</a>(isea), <a class="code" href="namespacew3adatmd.html#a816cd10227f361872854d2e9d5897189">tauadir</a>(isea),                         &amp;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="preprocessor"></span>                 <a class="code" href="namespacew3adatmd.html#a1f9e1a2b29d3ef362960cb92c7151239">as</a>(isea), <a class="code" href="namespacew3wdatmd.html#a5268804018b2fd994091fb7af42f61e6">ust</a>(isea),                               &amp;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                 <a class="code" href="namespacew3wdatmd.html#ad9ea52f8b5bc1a26a34e0e30cc9f3b80">ustdir</a>(isea), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea), <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea),                  &amp;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                 <a class="code" href="namespacew3wdatmd.html#a2c813f9962425c9a3b22aa9e1bdc8c23">ice</a>(isea), <a class="code" href="namespacew3wdatmd.html#a82429c6f49a881c7b7bd1722a879129a">iceh</a>(isea), <a class="code" href="namespacew3wdatmd.html#aef670a8d6c1723d7c0b4797aeaedc075">icef</a>(isea),                 &amp;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                 <a class="code" href="namespacew3wdatmd.html#aa45cc09f73e0f9570153921446de4802">icedmax</a>(isea),                                     &amp;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                 reflec, refled, delx, dely, dela,                  &amp;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                 <a class="code" href="namespacew3gdatmd.html#a61cadb0c4a6348fd421419b6aadf525b">trnx</a>(iy,ix), <a class="code" href="namespacew3gdatmd.html#acd3e7ae02814c69fc9324dc915858654">trny</a>(iy,ix), <a class="code" href="namespacew3wdatmd.html#a4c5b7b938201316f96216714e8aa5da5">berg</a>(isea),              &amp;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                 <a class="code" href="namespacew3wdatmd.html#acd22302f4efdce8264a63cb414a77a8c">fpis</a>(isea), <a class="code" href="namespacew3adatmd.html#a6890e5fa08d022433cfe314aac88944a">dtdyn</a>(jsea),                           &amp;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a150a3fab6d4a2db874aff23e94edcccf">fcut</a>(jsea), dtgpre, tauwx(jsea), tauwy(jsea),      &amp;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a5815a5e5db5057647c4fcb5f0e8074cc">tauox</a>(jsea), <a class="code" href="namespacew3adatmd.html#a919d21c98d221807f8b0e1396df10f68">tauoy</a>(jsea), <a class="code" href="namespacew3adatmd.html#a678edbd1a5e1a8efb55658b63d46e7f2">tauwix</a>(jsea),            &amp;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a9e21a5411799a5e9c496f94a98f8a8f1">tauwiy</a>(jsea), <a class="code" href="namespacew3adatmd.html#a890a58325991ff8ffb0eaaed7c7a5b2e">tauwnx</a>(jsea),                        &amp;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a3d8350daaed64832e6d59d70965a034b">tauwny</a>(jsea),  <a class="code" href="namespacew3adatmd.html#a365e54d83b1e2d7d446a6c573c4442fe">phiaw</a>(jsea), <a class="code" href="namespacew3adatmd.html#a6f59c884d68bc4696a47dc2afa3dc19e">charn</a>(jsea),           &amp;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                 <a class="code" href="namespacew3adatmd.html#ac02ea099394a1abc67864b699abdae83">tws</a>(jsea), <a class="code" href="namespacew3adatmd.html#a4d452918b35b8b72c08389a1993240e0">phioc</a>(jsea), tmp1, d50, psic, tmp2,     &amp;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                 <a class="code" href="namespacew3adatmd.html#aee58911c6e89169fec3a6fe601c4344e">phibbl</a>(jsea), tmp3, tmp4, <a class="code" href="namespacew3adatmd.html#a38ffe354e8a494678e53465842bfcba4">phice</a>(jsea),             &amp;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                 <a class="code" href="namespacew3adatmd.html#a1d57a74d37bd727e82acb579ec010a68">tauocx</a>(jsea), <a class="code" href="namespacew3adatmd.html#a07dcce783dd8aed189a74a7347570df8">tauocy</a>(jsea), <a class="code" href="namespacew3adatmd.html#af9561b789f9f6236ed9560f1fd543a2b">wnmean</a>(jsea),          &amp;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                 <a class="code" href="namespacew3wdatmd.html#aa626e09614f191b606dbd343a57d5ab4">rhoair</a>(isea), <a class="code" href="namespacew3wdatmd.html#a040679b85e93b0f3960bbc31fcd6bd37">asf</a>(isea))</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordflow">IF</span> (.not. lsloc) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;              <a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>(:,jsea) = vsiodummy</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;              <a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>(:,jsea) = vdiodummy</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGSRC</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;After sum(VA)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea))</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;   sum(VSTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>(:,jsea))</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;   sum(VDTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>(:,jsea))</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     SHAVETOT=&#39;</span>, <a class="code" href="namespacew3wdatmd.html#a24c895280e10751a3396a14462552aa4">shavetot</a>(jsea)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            <span class="keyword">FLUSH</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END DO</span> <span class="comment">! JSEA</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="keywordflow">        END IF</span> <span class="comment">! PDLIB</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_DEBUGSRC</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;ITIME=&#39;</span>, <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <span class="stringliteral">&#39; IT=&#39;</span>, it</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;VA after W3SRCE_IMP_PRE&quot;</span>, 1)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keyword">CALL </span>all_field_integral_print(<a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>, <span class="stringliteral">&quot;VSTOT after W3SRCE_IMP_PRE&quot;</span>)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keyword">CALL </span>all_field_integral_print(<a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>, <span class="stringliteral">&quot;VDTOT after W3SRCE_IMP_PRE&quot;</span>)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a> .le. <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     Values for DEBUG_NODE=&#39;</span>, <a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VA)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VSTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;          <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VDTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 14&#39;</span>)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordflow">IF</span> ( flzero ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="preprocessor"></span>          <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9022)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">GOTO</span> 400</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordflow">IF</span> ( it.EQ.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          dtg = 1.</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;          <span class="comment">!            DTG = 60.</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;          <span class="keywordflow">GOTO</span> 370</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a6a53b6f153d86cd9ab7b382128a0a2bf">fldry</a> .OR. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.GT.<a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="preprocessor"></span>          <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9023)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">GOTO</span> 380</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <span class="comment">! Estimation of the local maximum CFL for XY propagation</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*) <span class="stringliteral">&#39;Computing CFLs .... &#39;</span>,<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a720da8acfb369bb59c63e6cd20bb7015">flogrd</a>(9,3).AND. ugdtupdate ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a5e8c7eaf07d6ec026aac523e229d53b2">fstotalimp</a> .eqv. .false.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            nkcfl=<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="preprocessor"></span>            nkcfl=1</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="preprocessor"></span>            <span class="comment">!$OMP PARALLEL DO PRIVATE (JSEA,ISEA) SCHEDULE (DYNAMIC,1)</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <span class="keywordflow">DO</span> jsea=1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;              <span class="keyword">CALL </span>init_get_isea(isea, jsea)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a720da8acfb369bb59c63e6cd20bb7015">flogrd</a>(9,3) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> (mod(isea,100).EQ.0) <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*) <span class="stringliteral">&#39;COMPUTING CFL FOR NODE:&#39;</span>,isea</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> (.NOT. <a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3profsmd.html#a3e21a85c8c5b52f908b6334c1db8803d">w3cflug</a> ( isea, nkcfl, facx, facx, dtg, <a class="code" href="namespacew3gdatmd.html#aab61e99d161fc0c2bca0cde5c4c975ee">mapfs</a>, <a class="code" href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">cflxymax</a>(jsea), &amp;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                         vgx, vgy )</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3pro3md.html#aabe1620330467de15ca418ae8c5c2508">w3cflxy</a> ( isea, dtg, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, <a class="code" href="namespacew3gdatmd.html#aab61e99d161fc0c2bca0cde5c4c975ee">mapfs</a>, <a class="code" href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">cflxymax</a>(jsea), vgx, vgy )</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="preprocessor"></span>            <span class="comment">!$OMP END PARALLEL DO</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 15&#39;</span>)</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a720da8acfb369bb59c63e6cd20bb7015">flogrd</a>(9,3) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            dtcfl1(:)=1.</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <span class="keywordflow">DO</span> jsea=1,<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;              indsort(jsea)=float(jsea)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;              dtcfl1(jsea)=dtg/<a class="code" href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">cflxymax</a>(jsea)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a61494bd0f5e2421669fd4442b1517bbe">ssort1</a> (dtcfl1, indsort, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>, 2)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,*) <span class="stringliteral">&#39;Nodes requesting smallest timesteps:&#39;</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,<span class="stringliteral">&#39;(A,10I10)&#39;</span>)   <span class="stringliteral">&#39;Nodes      &#39;</span>,nint(indsort(1:10))</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">naperr</a> ) <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,<span class="stringliteral">&#39;(A,10F10.2)&#39;</span>) <span class="stringliteral">&#39;time steps &#39;</span>,dtcfl1(1:10)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">DO</span> jsea = 1, min(<a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>,200)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;              isea   = nint(indsort(jsea))            <span class="comment">! will not work with MPI</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;              ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;              <span class="keywordflow">IF</span> (jsea.EQ.1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                <span class="keyword">WRITE</span>(995,*) <span class="stringliteral">&#39;       IP  dtmax_exp(ip)        x-coord        y-coord        z-coord&#39;</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;              <span class="keyword">WRITE</span>(995,<span class="stringliteral">&#39;(I10,F10.2,3F10.4)&#39;</span>) ix,  dtcfl1(jsea), <a class="code" href="namespacew3gdatmd.html#a74463b1ffb13fda60c4b7f6c20c2123c">xgrd</a>(1,ix), <a class="code" href="namespacew3gdatmd.html#adff59174f70e9631f993d0d98127f586">ygrd</a>(2,ix), <a class="code" href="namespacew3gdatmd.html#a081d78fa85ae3d71307db972c92ddcb8">zb</a>(ix)</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="keywordflow">            END DO</span> <span class="comment">! JSEA</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="keyword">CLOSE</span>(995)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="comment">! 3.6 Perform Propagation = = = = = = = = = = = = = = = = = = = = = = =</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <span class="comment">! 3.6.1 Preparations</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="preprocessor">#ifdef W3_SEC1</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="preprocessor"></span>        dtgtemp=dtg</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        dtg=dtg/<a class="code" href="namespacew3gdatmd.html#a67c48aac303564691d4f117704bc8d30">nitersec1</a></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keywordflow">DO</span> isec1=1,<a class="code" href="namespacew3gdatmd.html#a67c48aac303564691d4f117704bc8d30">nitersec1</a></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="preprocessor"></span>          ntloc  = 1 + int( dtg/<a class="code" href="namespacew3gdatmd.html#ab719f4a306a71097e22857589eb59622">dtcfli</a> - 0.001 )</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="preprocessor">#ifdef W3_SEC1</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#ac465fc564dba68a335292494392cc7f9">napout</a> ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            <span class="keyword">WRITE</span>(<a class="code" href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">ndse</a>,<span class="stringliteral">&#39;(A,I4,A,I4)&#39;</span>) <span class="stringliteral">&#39;   SUBSECOND STEP:&#39;</span>,isec1,<span class="stringliteral">&#39; out of &#39;</span>,<a class="code" href="namespacew3gdatmd.html#a67c48aac303564691d4f117704bc8d30">nitersec1</a></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;          facth  = dtg / (<a class="code" href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">dth</a>*real(ntloc))</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;          fack   = dtg / real(ntloc)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;          ttest(1) = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1)</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;          ttest(2) = 0</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;          dttest = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(ttest,<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;          itloch = ( ntloc + 1 - mod(nint(dttest/dtg),2) ) / 2</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;          <span class="comment">! 3.6.2 Intra-spectral part 1</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Before intraspectral part 1&quot;</span>, 1)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Before intraspectral&quot;</span>)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> .OR. <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="keywordflow">DO</span> itloc=1, itloch</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="preprocessor"></span>              <span class="comment">!$OMP PARALLEL PRIVATE (JSEA,ISEA,IX,IY,DEPTH,IXrel)</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;              <span class="comment">!$OMP DO SCHEDULE (DYNAMIC,1)</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;              <span class="keywordflow">DO</span> jsea=1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                <span class="keyword">CALL </span>init_get_isea(isea, jsea)</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="preprocessor"></span>                    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a1f30ee4349738120d2f73c56f6ea2923">iobp_loc</a>(jsea) .NE. 1) cycle</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#addf9a452930d73b382eea45436929034">iobp</a>(isea) .NE. 1) cycle</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="keywordflow">                ENDIF</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                  depth  = max( <a class="code" href="namespacew3gdatmd.html#a2dadaadcc7dbc940f8b3b267ed06a597">dmin</a> , <a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(isea) )</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                    ixrel = jsea</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                    ixrel = ix</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                  <span class="keywordflow">IF</span>( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                    j = 1</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!!Li    Refraction and GCT in theta direction is done by rotation.</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#acdac9c3652423c237a8122e91e7a0e4a">w3krtn</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aa6f29a64e772be7fbf59f3061d4e6978">dhdx</a>(isea), <a class="code" href="namespacew3adatmd.html#a528e5c99e65966c5ecca52fc751cdc58">dhdy</a>(isea), <a class="code" href="namespacew3adatmd.html#a115d225c7877e15bdb8ab3a554c5e67e">dhlmt</a>(:,isea),          &amp;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea), <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ix),               &amp;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ix), <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ix), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ix),       &amp;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ix), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ix), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea) )</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                    j = 1</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                    <span class="comment">!</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro1md.html#ae08c00a2c7907d23998e413b9eb6167c">w3ktp1</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea),       &amp;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ixrel),     &amp;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ixrel),               &amp;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ixrel), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea))</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro2md.html#aece5b76209f20456b27e78c092fd6b4b">w3ktp2</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea),       &amp;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ixrel),     &amp;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ixrel),               &amp;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ixrel), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea))</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro3md.html#a22b7a45b518b51fc432d6ebe5ed5d48f">w3ktp3</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea),       &amp;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ixrel),     &amp;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ixrel),               &amp;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ixrel), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea), &amp;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a2472f8af7829f731ec1a0f6506005b59">cflthmax</a>(jsea), <a class="code" href="namespacew3adatmd.html#aad766a34f23e9b3bbce063e2f8b9736f">cflkmax</a>(jsea) )</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="keywordflow">                  END IF</span>  <span class="comment">!!  GTYPE</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="preprocessor"></span>              <span class="comment">!$OMP END DO</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;              <span class="comment">!$OMP END PARALLEL</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;          <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 16&#39;</span>)</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Before spatial advection&quot;</span>, 1)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Before spatial advection&quot;</span>)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;          <span class="comment">! 3.6.3 Longitude-latitude</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;          <span class="comment">!       (time step correction in routine)</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">flagll</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;              facx   =  1./(<a class="code" href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">dera</a> * <a class="code" href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">radius</a>)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;              facx   =  1.</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;          <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a> .or. <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;              <span class="keywordflow">IF</span> (.NOT. <a class="code" href="namespacew3gdatmd.html#a5e8c7eaf07d6ec026aac523e229d53b2">fstotalimp</a> .AND. .NOT. <a class="code" href="namespacew3gdatmd.html#a9c8d9683b5bbc9081fbf10995a834ee6">fstotalexp</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                <span class="keywordflow">DO</span> ispec=1,<a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                  <span class="keyword">CALL </span>pdlib_w3xypug ( ispec, facx, facx, dtg, vgx, vgy, ugdtupdate )</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="keywordflow">                END DO</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a5e8c7eaf07d6ec026aac523e229d53b2">fstotalimp</a> .and. (it .ne. 0)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;Before Block implicit&quot;</span>, 1)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>pdlib_w3xypug_block_implicit(imod, facx, facx, dtg, vgx, vgy, ugdtupdate )</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(<a class="code" href="namespacew3gdatmd.html#a9c8d9683b5bbc9081fbf10995a834ee6">fstotalexp</a> .and. (it .ne. 0)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>pdlib_w3xypug_block_explicit(imod, facx, facx, dtg, vgx, vgy, ugdtupdate )</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            ENDIF</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">flcx</a> .or. <a class="code" href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">flcy</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a> .GT. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                <span class="keyword">CALL </span>mpi_startall (<a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a>, <a class="code" href="namespacew3adatmd.html#ac7c512a398f6dca9c750cb6214acb1ad">irqsg1</a>(1,1), ierr_mpi)</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                <span class="keyword">CALL </span>mpi_startall (<a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a>, <a class="code" href="namespacew3adatmd.html#ac7c512a398f6dca9c750cb6214acb1ad">irqsg1</a>(1,2), ierr_mpi)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;              <span class="comment">! Initialize FIELD variable</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;              field = 0.</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;              <span class="keywordflow">DO</span> ispec=1, <a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a581fbacd6df17da34ac6eae6a2dd9298">iappro</a>(ispec) .EQ. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                  <span class="keywordflow">IF</span>( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                    ix = 1</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!!Li   Use SMC sub to gether field</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#a962fc82166d5a68baa41d3c3dc9fffa6">w3gathsmc</a> ( ispec, field )</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (.NOT.<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    <span class="keyword">CALL </span>w3gath ( ispec, field )</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="keywordflow">                  END IF</span>   <span class="comment">!! GTYPE</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                    ix = 1</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!!Li   Propagation on SMC grid uses UNO2 scheme.</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#ab48ebaa11df3f33e2c8183fba42deb35">w3psmc</a> ( ispec, dtg, field )</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    ix = 1</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="preprocessor"></span>                    <span class="keywordflow">IF</span> (.NOT. <a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="preprocessor"></span>                      <span class="keyword">CALL </span><a class="code" href="namespacew3profsmd.html#a3f27659e77da56d3ce04e92336cf1e1a">w3xypug</a> ( ispec, facx, facx, dtg, field, vgx, vgy, ugdtupdate )</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="preprocessor"></span>                      <span class="keyword">CALL </span><a class="code" href="namespacew3profsmd.html#a3f27659e77da56d3ce04e92336cf1e1a">w3xypug</a> ( ispec, facx, facx, dtg, field, vgx, vgy, ugdtupdate )</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="preprocessor"></span>                      <span class="keyword">CALL </span><a class="code" href="namespacew3profsmd.html#a3f27659e77da56d3ce04e92336cf1e1a">w3xypug</a> ( ispec, facx, facx, dtg, field, vgx, vgy, ugdtupdate )</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                    END IF</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                    ix = 1</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro1md.html#a7e9cd1ea9310363dffaffc0d1f4edec5">w3xyp1</a> ( ispec, dtg, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, field, vgx, vgy )</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro2md.html#a74e542a8d41f921542394a284bf08ed5">w3xyp2</a> ( ispec, dtg, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, <a class="code" href="namespacew3gdatmd.html#aab61e99d161fc0c2bca0cde5c4c975ee">mapfs</a>, field, vgx, vgy )</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro3md.html#a65d9779614cc6e8e9180f4128de0e673">w3xyp3</a> ( ispec, dtg, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, <a class="code" href="namespacew3gdatmd.html#aab61e99d161fc0c2bca0cde5c4c975ee">mapfs</a>, field, vgx, vgy )</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="keywordflow">                  END IF</span>   <span class="comment">!! GTYPE</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                  <span class="keywordflow">IF</span>( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                    ix = 1</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!!Li   Use SMC sub to scatter field</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#aa963b1ff04f7cd17a26f4f8bc57aaca8">w3scatsmc</a> ( ispec, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, field )</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> (.NOT.<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                    <span class="keyword">CALL </span>w3scat ( ispec, <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>, field )</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="keywordflow">                  END IF</span>   <span class="comment">!! GTYPE</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a> .GT. 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                <span class="keyword">ALLOCATE</span> ( statco(mpi_status_size,<a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a>) )</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                <span class="keyword">CALL </span>mpi_waitall (<a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a>, <a class="code" href="namespacew3adatmd.html#ac7c512a398f6dca9c750cb6214acb1ad">irqsg1</a>(1,1), statco, ierr_mpi)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                <span class="keyword">CALL </span>mpi_waitall (<a class="code" href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">nrqsg1</a>, <a class="code" href="namespacew3adatmd.html#ac7c512a398f6dca9c750cb6214acb1ad">irqsg1</a>(1,2), statco, ierr_mpi)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                <span class="keyword">DEALLOCATE</span> ( statco )</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="preprocessor"></span>              <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE TIME LOOP 17&#39;</span>)</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;              <span class="comment">!Li   Initialise IK IX IY in case ARC option is not used to avoid warnings.</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;              ik=1</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;              ix=1</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;              iy=1</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="preprocessor"></span>              <span class="comment">!Li    Find source boundary spectra and assign to SPCBAC</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;              <span class="keywordflow">IF</span>( <a class="code" href="namespacew3gdatmd.html#a608ecea2ecff3c7334783046328a518c">arctc</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                <span class="keywordflow">DO</span> ik = 1, <a class="code" href="namespacew3gdatmd.html#a95c4c90a667b622273c7c5a734fa4d8b">nbac</a></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                  <span class="keywordflow">IF</span>( ik .LE. (<a class="code" href="namespacew3gdatmd.html#a95c4c90a667b622273c7c5a734fa4d8b">nbac</a>-<a class="code" href="namespacew3gdatmd.html#ab2e24ebfb64255d0fc873c171b8ec169">nbgl</a>) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                    iy = <a class="code" href="namespacew3gdatmd.html#a650e9a3dbdf70196bf427799a16564c1">iclbac</a>(ik)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                    iy = <a class="code" href="namespacew3gdatmd.html#a34675c0b462ef817c553220b95d22d85">nglo</a> + ik</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; </div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                  <span class="comment">!Li    Work out root PE (ISPEC) and JSEA numbers for IY</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="preprocessor">#ifdef W3_DIST</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="preprocessor"></span>                  ispec = mod( iy-1, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a> )</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                  jsea = 1 + (iy - ispec - 1)/<a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="preprocessor"></span>                  ispec = 0</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                  jsea = iy</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="preprocessor"></span>                  <span class="comment">! W3_SMC ...</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!!Li   Assign boundary cell spectra.</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                  <span class="keywordflow">IF</span>( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. ispec+1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                    <a class="code" href="namespacew3gdatmd.html#a3079307963b24f5148c3363572308f88">spcbac</a>(:,ik)=<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!!Li   Broadcast local SPCBAC(:,IK) to all other PEs.</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">CALL </span>mpi_bcast(<a class="code" href="namespacew3gdatmd.html#a3079307963b24f5148c3363572308f88">spcbac</a>(1,ik),<a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>,mpi_real,ispec,<a class="code" href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">mpi_comm_wave</a>,ierr_mpi)</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                  <span class="keyword">CALL </span>mpi_barrier (<a class="code" href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">mpi_comm_wave</a>,ierr_mpi)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END DO</span>   <span class="comment">!! Loop IK ends.</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="preprocessor"></span>                <span class="comment">!</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="preprocessor"></span>                <span class="comment">!!Li    Update Arctic boundary cell spectra if within local range</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                <span class="keyword">ALLOCATE</span> ( bacspec(<a class="code" href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">nspec</a>) )</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                <span class="keywordflow">DO</span> ik = 1, <a class="code" href="namespacew3gdatmd.html#a95c4c90a667b622273c7c5a734fa4d8b">nbac</a></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                  <span class="keywordflow">IF</span>( ik .LE. (<a class="code" href="namespacew3gdatmd.html#a95c4c90a667b622273c7c5a734fa4d8b">nbac</a>-<a class="code" href="namespacew3gdatmd.html#ab2e24ebfb64255d0fc873c171b8ec169">nbgl</a>) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                    ix = <a class="code" href="namespacew3gdatmd.html#a34675c0b462ef817c553220b95d22d85">nglo</a> + ik</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                    bacangl = <a class="code" href="namespacew3gdatmd.html#aa599ecb57c894afbc3640fd24e7a5492">angarc</a>(ik)</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                    ix = <a class="code" href="namespacew3gdatmd.html#a650e9a3dbdf70196bf427799a16564c1">iclbac</a>(ik)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                    bacangl = - <a class="code" href="namespacew3gdatmd.html#aa599ecb57c894afbc3640fd24e7a5492">angarc</a>(ik)</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                  <span class="comment">!!Li    Work out boundary PE (ISPEC) and JSEA numbers for IX</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="preprocessor">#ifdef W3_DIST</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="preprocessor"></span>                  ispec = mod( ix-1, <a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a> )</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                  jsea = 1 + (ix - ispec - 1)/<a class="code" href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">naproc</a></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_SHRD</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="preprocessor"></span>                  ispec = 0</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                  jsea = ix</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span>( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. ispec+1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                    bacspec = <a class="code" href="namespacew3gdatmd.html#a3079307963b24f5148c3363572308f88">spcbac</a>(:,ik)</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a0851078625aaed8195c185821c599411">w3acturn</a>( <a class="code" href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">nth</a>, <a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>, bacangl, bacspec )</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                    <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea) = bacspec</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                    <span class="comment">!!Li              WRITE(NDSE,*) &quot;IAPROC, IX, JSEAx, IK=&quot;, IAPROC, IX, JSEA, IK</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="keywordflow">                END DO</span>  <span class="comment">!! Loop IK ends.</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                <span class="keyword">DEALLOCATE</span> ( bacspec )</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="keywordflow">              ENDIF</span>  <span class="comment">!! ARCTC</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;              <span class="comment">! End of test FLCX.OR.FLCY</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;After spatial advection&quot;</span>, 1)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After spatial advection&quot;</span>)</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;          <span class="comment">! 3.6.4 Intra-spectral part 2</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">flcth</a> .OR. <a class="code" href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">flck</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            <span class="keywordflow">DO</span> itloc=itloch+1, ntloc</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="preprocessor"></span>              <span class="comment">!$OMP PARALLEL PRIVATE (JSEA,ISEA,IX,IY,DEPTH,IXrel)</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;              <span class="comment">!$OMP DO SCHEDULE (DYNAMIC,1)</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;              <span class="keywordflow">DO</span> jsea = 1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                <span class="keyword">CALL </span>init_get_isea(isea, jsea)</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                depth  = max( <a class="code" href="namespacew3gdatmd.html#a2dadaadcc7dbc940f8b3b267ed06a597">dmin</a> , <a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(isea) )</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">ungtype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="preprocessor"></span>                    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a1f30ee4349738120d2f73c56f6ea2923">iobp_loc</a>(jsea) .NE. 1) cycle</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                    <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#addf9a452930d73b382eea45436929034">iobp</a>(isea) .NE. 1) cycle</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="keywordflow">                ENDIF</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix) .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                  <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                    ixrel = jsea</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                    ixrel = ix</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                  <span class="keywordflow">IF</span>( <a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a> .EQ. <a class="code" href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">smctype</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                    j = 1</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="preprocessor">#ifdef W3_SMC</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!!Li    Refraction and GCT in theta direction is done by rotation.</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                    <span class="keyword">CALL </span><a class="code" href="namespacew3psmcmd.html#acdac9c3652423c237a8122e91e7a0e4a">w3krtn</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aa6f29a64e772be7fbf59f3061d4e6978">dhdx</a>(isea), <a class="code" href="namespacew3adatmd.html#a528e5c99e65966c5ecca52fc751cdc58">dhdy</a>(isea), <a class="code" href="namespacew3adatmd.html#a115d225c7877e15bdb8ab3a554c5e67e">dhlmt</a>(:,isea),          &amp;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea), <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ix),               &amp;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ix), <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ix), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ix),       &amp;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ix), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ix), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea) )</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                  <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                    j = 1</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="preprocessor">#ifdef W3_PR1</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro1md.html#ae08c00a2c7907d23998e413b9eb6167c">w3ktp1</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea),       &amp;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ixrel),     &amp;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ixrel),               &amp;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ixrel), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea))</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR2</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro2md.html#aece5b76209f20456b27e78c092fd6b4b">w3ktp2</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea),       &amp;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ixrel),     &amp;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ixrel),               &amp;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ixrel), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea))</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PR3</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3pro3md.html#a22b7a45b518b51fc432d6ebe5ed5d48f">w3ktp3</a> ( isea, facth, fack, <a class="code" href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">cthg0s</a>(isea),       &amp;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                         <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(:,isea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(:,isea), depth,                  &amp;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">dddx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">dddy</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea),       &amp;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                         <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea), <a class="code" href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">dcxdx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">dcxdy</a>(iy,ixrel),     &amp;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                         <a class="code" href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">dcydx</a>(iy,ixrel), <a class="code" href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">dcydy</a>(iy,ixrel),               &amp;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">dcdx</a>(:,iy,ixrel), <a class="code" href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">dcdy</a>(:,iy,ixrel), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea), &amp;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                         <a class="code" href="namespacew3adatmd.html#a2472f8af7829f731ec1a0f6506005b59">cflthmax</a>(jsea), <a class="code" href="namespacew3adatmd.html#aad766a34f23e9b3bbce063e2f8b9736f">cflkmax</a>(jsea) )</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="preprocessor"></span>                    <span class="comment">!</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="keywordflow">                  END IF</span>  <span class="comment">!! GTYPE</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="keywordflow">              END DO</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="preprocessor"></span>              <span class="comment">!$OMP END DO</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;              <span class="comment">!$OMP END PARALLEL</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;After intraspectral adv.&quot;</span>, 1)</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;fter intraspectral adv.&quot;</span>)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;          ugdtupdate = .false.</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;          <span class="comment">! 3.6 End propapgation  = = = = = = = = = = = = = = = = = = = = = = = =</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;          <span class="comment">! 3.7 Calculate and integrate source terms.</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;370       <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#a256ca10a028a394f3c7a2f0ca95667f0">flsou</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            d50=0.0002</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            reflec(:)=0.</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            refled(:)=0</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            psic=0.</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_DEBUGSRC</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;ITIME=&#39;</span>, <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <span class="stringliteral">&#39; IT=&#39;</span>, it</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="keyword">CALL </span>all_vaold_integral_print(<span class="stringliteral">&quot;VAOLD before W3SRCE_IMP_POST&quot;</span>, 1)</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;VA before W3SRCE_IMP_POST&quot;</span>, 1)</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a> .le. <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     Values for DEBUG_NODE=&#39;</span>, <a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VA)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VAOLD)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#adfa3c3e4ffbc58db1d4f4d86877eb8cf">vaold</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VSTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">vstot</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VDTOT)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">vdtot</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="preprocessor"></span>            <span class="comment">!$OMP PARALLEL PRIVATE (JSEA,ISEA,IX,IY,DELA,DELX,DELY,        &amp;</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;            <span class="comment">!$OMP&amp;                  REFLEC,REFLED,D50,PSIC,TMP1,TMP2,TMP3,TMP4)</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            <span class="comment">!$OMP DO SCHEDULE (DYNAMIC,1)</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <span class="keywordflow">DO</span> jsea=1, <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;              <span class="keyword">CALL </span>init_get_isea(isea, jsea)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;              ix     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,1)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;              iy     = <a class="code" href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">mapsf</a>(isea,2)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;              dela=1.</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;              delx=1.</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;              dely=1.</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="preprocessor">#ifdef W3_REF1</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a>.EQ.<a class="code" href="namespacew3gdatmd.html#a79e88ab04db1d3ac00f3e45d2625312c">rlgtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                delx=<a class="code" href="namespacew3gdatmd.html#ace4b7064f5b270ac5564b3484566042d">sx</a>*<a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea)/facx</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                dely=<a class="code" href="namespacew3gdatmd.html#ae8e13cd23548b33eaaae230040049539">sy</a>/facx</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                dela=delx*dely</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;              <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">gtype</a>.EQ.<a class="code" href="namespacew3gdatmd.html#a063c55199a8786edf383f3c6359108f2">clgtype</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                <span class="comment">! Maybe what follows works also for RLGTYPE ... to be verified</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                delx=<a class="code" href="namespacew3gdatmd.html#a26759ceeed28f07100b31cab17d5c7ea">hpfac</a>(iy,ix)/ facx</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                dely=<a class="code" href="namespacew3gdatmd.html#ad0202e8b0d4d789838ffaf63de3be312">hqfac</a>(iy,ix)/ facx</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                dela=delx*dely</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="preprocessor"></span>              <span class="comment">!</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="preprocessor">#ifdef W3_REF1</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="preprocessor"></span>              reflec=<a class="code" href="namespacew3gdatmd.html#a84f9a09b83a4c65df6185b83e26be0ae">reflc</a>(:,isea)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;              reflec(4)=<a class="code" href="namespacew3wdatmd.html#a4c5b7b938201316f96216714e8aa5da5">berg</a>(isea)*reflec(4)</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;              refled=<a class="code" href="namespacew3gdatmd.html#a466f03db630a1aaa5437b8c30c2722a3">refld</a>(:,isea)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_BT4</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="preprocessor"></span>              d50=<a class="code" href="namespacew3gdatmd.html#a148a77b8c3bf5f6274bd25c1e5e4c30d">sed_d50</a>(isea)</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;              psic=<a class="code" href="namespacew3gdatmd.html#a3a9e8350eb31a71dd85af858ca7d97bd">sed_psic</a>(isea)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">mapsta</a>(iy,ix) .EQ. 1 .AND. <a class="code" href="namespacew3gdatmd.html#a20388956775ff9ffe6da81c7e914c6fa">flagst</a>(isea)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                tmp1   = <a class="code" href="namespacew3adatmd.html#a4d5c09dd83ee23836341131df8bef0cd">whitecap</a>(jsea,1:4)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                tmp2   = <a class="code" href="namespacew3adatmd.html#a03d3f63e3189fe1b637898b707a19824">bedforms</a>(jsea,1:3)</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                tmp3   = <a class="code" href="namespacew3adatmd.html#ad20a49e2cabde21aa37a22ea87f2cbdb">taubbl</a>(jsea,1:2)</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                tmp4   = <a class="code" href="namespacew3adatmd.html#a179bbc1c35de5c5f106ff107fc7053c5">tauice</a>(jsea,1:2)</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> (<a class="code" href="namespacew3gdatmd.html#a2324653ee9eefd860fe277dc83c8e073">fssource</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="namespacew3srcemd.html#a1eba2fe496738bdd2aee6e835d064045">w3srce</a>(<a class="code" href="namespaceconstants.html#aff31fa8129f4d628c35a514371b1be19">srce_imp_post</a>,it,isea,jsea,ix,iy,imod,     &amp;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#adfa3c3e4ffbc58db1d4f4d86877eb8cf">vaold</a>(:,jsea), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea),                        &amp;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                       vsiodummy,vdiodummy,<a class="code" href="namespacew3wdatmd.html#a24c895280e10751a3396a14462552aa4">shavetot</a>(jsea),               &amp;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a2f49fab96f67af285b8ccd46e2439294">alpha</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,jsea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,isea),                  &amp;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                       <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,isea), <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea), <a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(isea), <a class="code" href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">u10</a>(isea),  &amp;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a01dd3a2f2005cd24b5b07468b217cdb7">u10d</a>(isea),                                       &amp;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="preprocessor">#ifdef W3_FLX5</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="preprocessor"></span>                       <a class="code" href="namespacew3adatmd.html#a169cdcb1ad0be4046b70d04720e9075a">taua</a>(isea), <a class="code" href="namespacew3adatmd.html#a816cd10227f361872854d2e9d5897189">tauadir</a>(isea),                        &amp;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="preprocessor"></span>                       <a class="code" href="namespacew3adatmd.html#a1f9e1a2b29d3ef362960cb92c7151239">as</a>(isea), <a class="code" href="namespacew3wdatmd.html#a5268804018b2fd994091fb7af42f61e6">ust</a>(isea),                              &amp;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#ad9ea52f8b5bc1a26a34e0e30cc9f3b80">ustdir</a>(isea), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea), <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea),                 &amp;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#a2c813f9962425c9a3b22aa9e1bdc8c23">ice</a>(isea), <a class="code" href="namespacew3wdatmd.html#a82429c6f49a881c7b7bd1722a879129a">iceh</a>(isea), <a class="code" href="namespacew3wdatmd.html#aef670a8d6c1723d7c0b4797aeaedc075">icef</a>(isea),                &amp;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#aa45cc09f73e0f9570153921446de4802">icedmax</a>(isea),                                    &amp;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                       reflec, refled, delx, dely, dela,                 &amp;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                       <a class="code" href="namespacew3gdatmd.html#a61cadb0c4a6348fd421419b6aadf525b">trnx</a>(iy,ix), <a class="code" href="namespacew3gdatmd.html#acd3e7ae02814c69fc9324dc915858654">trny</a>(iy,ix), <a class="code" href="namespacew3wdatmd.html#a4c5b7b938201316f96216714e8aa5da5">berg</a>(isea),             &amp;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#acd22302f4efdce8264a63cb414a77a8c">fpis</a>(isea), <a class="code" href="namespacew3adatmd.html#a6890e5fa08d022433cfe314aac88944a">dtdyn</a>(jsea),                          &amp;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a150a3fab6d4a2db874aff23e94edcccf">fcut</a>(jsea), dtg, tauwx(jsea), tauwy(jsea),        &amp;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a5815a5e5db5057647c4fcb5f0e8074cc">tauox</a>(jsea), <a class="code" href="namespacew3adatmd.html#a919d21c98d221807f8b0e1396df10f68">tauoy</a>(jsea), <a class="code" href="namespacew3adatmd.html#a678edbd1a5e1a8efb55658b63d46e7f2">tauwix</a>(jsea),           &amp;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a9e21a5411799a5e9c496f94a98f8a8f1">tauwiy</a>(jsea), <a class="code" href="namespacew3adatmd.html#a890a58325991ff8ffb0eaaed7c7a5b2e">tauwnx</a>(jsea),                       &amp;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a3d8350daaed64832e6d59d70965a034b">tauwny</a>(jsea),  <a class="code" href="namespacew3adatmd.html#a365e54d83b1e2d7d446a6c573c4442fe">phiaw</a>(jsea), <a class="code" href="namespacew3adatmd.html#a6f59c884d68bc4696a47dc2afa3dc19e">charn</a>(jsea),          &amp;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                       <a class="code" href="namespacew3adatmd.html#ac02ea099394a1abc67864b699abdae83">tws</a>(jsea),<a class="code" href="namespacew3adatmd.html#a4d452918b35b8b72c08389a1993240e0">phioc</a>(jsea), tmp1, d50, psic, tmp2,     &amp;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                       <a class="code" href="namespacew3adatmd.html#aee58911c6e89169fec3a6fe601c4344e">phibbl</a>(jsea), tmp3, tmp4, <a class="code" href="namespacew3adatmd.html#a38ffe354e8a494678e53465842bfcba4">phice</a>(jsea),            &amp;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a1d57a74d37bd727e82acb579ec010a68">tauocx</a>(jsea), <a class="code" href="namespacew3adatmd.html#a07dcce783dd8aed189a74a7347570df8">tauocy</a>(jsea), <a class="code" href="namespacew3adatmd.html#af9561b789f9f6236ed9560f1fd543a2b">wnmean</a>(jsea),         &amp;</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#aa626e09614f191b606dbd343a57d5ab4">rhoair</a>(isea), <a class="code" href="namespacew3wdatmd.html#a040679b85e93b0f3960bbc31fcd6bd37">asf</a>(isea))</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">CALL </span><a class="code" href="namespacew3srcemd.html#a1eba2fe496738bdd2aee6e835d064045">w3srce</a>(<a class="code" href="namespaceconstants.html#a5f8ec04f27567075cfc11321ce27f4d9">srce_direct</a>, it, isea, jsea, ix, iy, imod, &amp;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                       vaolddummy, <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,jsea),                           &amp;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                       vsiodummy, vdiodummy, shavetotiodummy,            &amp;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a2f49fab96f67af285b8ccd46e2439294">alpha</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,jsea), <a class="code" href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">wn</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,isea),                  &amp;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                       <a class="code" href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">cg</a>(1:<a class="code" href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">nk</a>,isea), <a class="code" href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">clats</a>(isea), <a class="code" href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">dw</a>(isea), <a class="code" href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">u10</a>(isea),  &amp;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a01dd3a2f2005cd24b5b07468b217cdb7">u10d</a>(isea),                                       &amp;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="preprocessor">#ifdef W3_FLX5</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="preprocessor"></span>                       <a class="code" href="namespacew3adatmd.html#a169cdcb1ad0be4046b70d04720e9075a">taua</a>(isea), <a class="code" href="namespacew3adatmd.html#a816cd10227f361872854d2e9d5897189">tauadir</a>(isea),                        &amp;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="preprocessor"></span>                       <a class="code" href="namespacew3adatmd.html#a1f9e1a2b29d3ef362960cb92c7151239">as</a>(isea), <a class="code" href="namespacew3wdatmd.html#a5268804018b2fd994091fb7af42f61e6">ust</a>(isea),                              &amp;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#ad9ea52f8b5bc1a26a34e0e30cc9f3b80">ustdir</a>(isea), <a class="code" href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">cx</a>(isea), <a class="code" href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">cy</a>(isea),                 &amp;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#a2c813f9962425c9a3b22aa9e1bdc8c23">ice</a>(isea), <a class="code" href="namespacew3wdatmd.html#a82429c6f49a881c7b7bd1722a879129a">iceh</a>(isea), <a class="code" href="namespacew3wdatmd.html#aef670a8d6c1723d7c0b4797aeaedc075">icef</a>(isea),                &amp;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#aa45cc09f73e0f9570153921446de4802">icedmax</a>(isea),                                    &amp;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                       reflec, refled, delx, dely, dela,                 &amp;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                       <a class="code" href="namespacew3gdatmd.html#a61cadb0c4a6348fd421419b6aadf525b">trnx</a>(iy,ix), <a class="code" href="namespacew3gdatmd.html#acd3e7ae02814c69fc9324dc915858654">trny</a>(iy,ix), <a class="code" href="namespacew3wdatmd.html#a4c5b7b938201316f96216714e8aa5da5">berg</a>(isea),             &amp;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#acd22302f4efdce8264a63cb414a77a8c">fpis</a>(isea), <a class="code" href="namespacew3adatmd.html#a6890e5fa08d022433cfe314aac88944a">dtdyn</a>(jsea),                          &amp;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a150a3fab6d4a2db874aff23e94edcccf">fcut</a>(jsea), dtg, tauwx(jsea), tauwy(jsea),        &amp;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a5815a5e5db5057647c4fcb5f0e8074cc">tauox</a>(jsea), <a class="code" href="namespacew3adatmd.html#a919d21c98d221807f8b0e1396df10f68">tauoy</a>(jsea), <a class="code" href="namespacew3adatmd.html#a678edbd1a5e1a8efb55658b63d46e7f2">tauwix</a>(jsea),           &amp;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a9e21a5411799a5e9c496f94a98f8a8f1">tauwiy</a>(jsea), <a class="code" href="namespacew3adatmd.html#a890a58325991ff8ffb0eaaed7c7a5b2e">tauwnx</a>(jsea),                       &amp;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a3d8350daaed64832e6d59d70965a034b">tauwny</a>(jsea),  <a class="code" href="namespacew3adatmd.html#a365e54d83b1e2d7d446a6c573c4442fe">phiaw</a>(jsea), <a class="code" href="namespacew3adatmd.html#a6f59c884d68bc4696a47dc2afa3dc19e">charn</a>(jsea),          &amp;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                       <a class="code" href="namespacew3adatmd.html#ac02ea099394a1abc67864b699abdae83">tws</a>(jsea), <a class="code" href="namespacew3adatmd.html#a4d452918b35b8b72c08389a1993240e0">phioc</a>(jsea), tmp1, d50, psic,tmp2,     &amp;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                       <a class="code" href="namespacew3adatmd.html#aee58911c6e89169fec3a6fe601c4344e">phibbl</a>(jsea), tmp3, tmp4 , <a class="code" href="namespacew3adatmd.html#a38ffe354e8a494678e53465842bfcba4">phice</a>(jsea),           &amp;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                       <a class="code" href="namespacew3adatmd.html#a1d57a74d37bd727e82acb579ec010a68">tauocx</a>(jsea), <a class="code" href="namespacew3adatmd.html#a07dcce783dd8aed189a74a7347570df8">tauocy</a>(jsea), <a class="code" href="namespacew3adatmd.html#af9561b789f9f6236ed9560f1fd543a2b">wnmean</a>(jsea),         &amp;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#aa626e09614f191b606dbd343a57d5ab4">rhoair</a>(isea), <a class="code" href="namespacew3wdatmd.html#a040679b85e93b0f3960bbc31fcd6bd37">asf</a>(isea))</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="preprocessor"></span>                <a class="code" href="namespacew3adatmd.html#a4d5c09dd83ee23836341131df8bef0cd">whitecap</a>(jsea,1:4) = tmp1</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                <a class="code" href="namespacew3adatmd.html#a03d3f63e3189fe1b637898b707a19824">bedforms</a>(jsea,1:3) = tmp2</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                <a class="code" href="namespacew3adatmd.html#ad20a49e2cabde21aa37a22ea87f2cbdb">taubbl</a>(jsea,1:2) = tmp3</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                <a class="code" href="namespacew3adatmd.html#a179bbc1c35de5c5f106ff107fc7053c5">tauice</a>(jsea,1:2) = tmp4</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                <a class="code" href="namespacew3wdatmd.html#a5268804018b2fd994091fb7af42f61e6">ust</a>(isea) = <a class="code" href="namespaceconstants.html#a68363e10dc3879aff798962c524a73d0">undef</a></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                <a class="code" href="namespacew3wdatmd.html#ad9ea52f8b5bc1a26a34e0e30cc9f3b80">ustdir</a>(isea) = <a class="code" href="namespaceconstants.html#a68363e10dc3879aff798962c524a73d0">undef</a></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                <a class="code" href="namespacew3adatmd.html#a6890e5fa08d022433cfe314aac88944a">dtdyn</a>(jsea) = <a class="code" href="namespaceconstants.html#a68363e10dc3879aff798962c524a73d0">undef</a></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                <a class="code" href="namespacew3adatmd.html#a150a3fab6d4a2db874aff23e94edcccf">fcut</a>(jsea) = <a class="code" href="namespaceconstants.html#a68363e10dc3879aff798962c524a73d0">undef</a></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                <span class="comment">!                    VA(:,JSEA)  = 0.</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="keywordflow">            END DO</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="preprocessor">#ifdef W3_OMPG</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="preprocessor"></span>            <span class="comment">!$OMP END DO</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="comment">!$OMP END PARALLEL</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_DEBUGSRC</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;ITIME=&#39;</span>, <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <span class="stringliteral">&#39; IT=&#39;</span>, it</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            <span class="keyword">CALL </span>all_vaold_integral_print(<span class="stringliteral">&quot;VAOLD after W3SRCE_IMP_PRE_POST&quot;</span>, 1)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;VA after W3SRCE_IMP_PRE_POST&quot;</span>, 1)</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a> .le. <a class="code" href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">nseal</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     Values for DEBUG_NODE=&#39;</span>, <a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     sum(VA)=&#39;</span>, sum(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;              <span class="keyword">WRITE</span>(740+<a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>,*) <span class="stringliteral">&#39;     min/max(VA)=&#39;</span>, minval(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>)), maxval(<a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>(:,<a class="code" href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">debug_node</a>))</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;After source terms&quot;</span>, 1)</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="preprocessor"></span>          <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;After source terms&quot;</span>)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="preprocessor"></span>          <span class="comment">!</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;          <span class="comment">! End of interations for DTMAX &lt; 1s</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="preprocessor">#ifdef W3_SEC1</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="preprocessor"></span>          <span class="keywordflow">IF</span> (it.EQ.0) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <span class="keywordflow">IF</span> (it.GT.0) dtg=dtgtemp</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160; </div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        <span class="comment">! 3.8 Update global time step.</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="comment">!     (Branch point FLDRY, IT=0)</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;380     <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        <span class="keywordflow">IF</span> (it.NE.nt) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;          dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , tcalc )</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;          dtg    = dttst / real(nt-it)</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordflow">IF</span> ( flact .AND. it.NE.nt .AND. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.EQ.<a class="code" href="namespacew3odatmd.html#a5442839e64fe6e007c3e465344e562a6">naplog</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , idtime )</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a8790356422ed442ebe4600878b76907a">idlast</a> .NE. <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a>,900) <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a>, idtime(01:19), idact, outid</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <a class="code" href="namespacew3adatmd.html#a8790356422ed442ebe4600878b76907a">idlast</a> = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1)</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a>,901) <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a>, idtime(12:19), idact, outid</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;          flact  = .false.</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;          idact  = <span class="stringliteral">&#39;         &#39;</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="preprocessor">#ifdef W3_DEBUGCOH</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span>all_va_integral_print(imod, <span class="stringliteral">&quot;end of time loop&quot;</span>, 1)</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="preprocessor"></span>        <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;end of time loop&quot;</span>)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;W3WAVE, step 6.21.1&quot;</span>)</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9030)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="preprocessor"></span>      <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE END TIME LOOP&#39;</span>)</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <span class="comment">!     End of loop over time steps</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <span class="comment">! ==================================================================== /</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;400   <span class="keywordflow">CONTINUE</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <span class="comment">! 4.  Perform output to file if requested ---------------------------- /</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="comment">! 4.a Check if time is output time</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="comment">!     Delay if data assimilation time.</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>(1)  .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        dttst  = 1.</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        dttst   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> )</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a017ad3a882377916066bce5f03c23765">tdn</a>(1)  .EQ. -1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        dttst1 = 1.</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        dttst1  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3idatmd.html#a017ad3a882377916066bce5f03c23765">tdn</a> )</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      dttst2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tend )</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      flag_o = .NOT.skip_o .OR. ( skip_o .AND. dttst2.NE.0. )</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="preprocessor"></span>      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9040) <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>, <a class="code" href="namespacew3idatmd.html#a017ad3a882377916066bce5f03c23765">tdn</a>, dttst, dttst1, flag_o</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="preprocessor"></span>      <span class="comment">!</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <span class="keywordflow">IF</span> ( dttst.LE.0. .AND. dttst1.NE.0. .AND. flag_o ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9041)</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        <span class="comment">! 4.b Processing and MPP preparations</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(1) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;          floutg = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,1)).EQ.0.</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;          floutg = .false.</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(7) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;          floutg2 = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,7)).EQ.0.</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;          floutg2 = .false.</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        flpart = .false.</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(1) .AND. flpfld ) flpart = flpart .OR. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,1)).EQ.0.</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(6) ) flpart = flpart .OR. <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,6)).EQ.0.</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9042) local, flpart, floutg</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordflow">IF</span> ( local .AND. flpart ) <span class="keyword">CALL </span><a class="code" href="namespacew3iosfmd.html#ad73dd75724e9742eed9354f564481464">w3cprt</a> ( imod )</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="keywordflow">IF</span> ( local .AND. (floutg .OR. floutg2) ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;          <span class="keyword">CALL </span><a class="code" href="namespacew3iogomd.html#a29d80cc57aa6c280d775fbea9750990c">w3outg</a> ( <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>, flpfld, floutg, floutg2 )</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="preprocessor"></span>        flgmpi = .false.</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        nrqmax = 0</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( (floutg) .OR. (floutg2 .AND. sbsed) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;          <span class="keywordflow">IF</span> (.NOT. <a class="code" href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">lpdlib</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3odatmd.html#a87f108b0b6396d24df1c3dbe7c3da731">nrqgo</a>.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3odatmd.html#a87f108b0b6396d24df1c3dbe7c3da731">nrqgo</a>, <a class="code" href="namespacew3odatmd.html#af5127f71e5c9013e127b2eaccbca5ccd">irqgo</a> , ierr_mpi )</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="preprocessor"></span> </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="preprocessor"></span>              flgmpi(0) = .true.</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;              nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#a87f108b0b6396d24df1c3dbe7c3da731">nrqgo</a> )</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;1a&#39;</span>, <a class="code" href="namespacew3odatmd.html#a87f108b0b6396d24df1c3dbe7c3da731">nrqgo</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#aa1616dd0386dc34441d8f6e2b7bce030">napfld</a></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="preprocessor"></span>            <span class="comment">!</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (<a class="code" href="namespacew3odatmd.html#acae4c727f28b29263a3ee2dfa72d10b7">nrqgo2</a>.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="preprocessor"></span>              <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3odatmd.html#acae4c727f28b29263a3ee2dfa72d10b7">nrqgo2</a>, <a class="code" href="namespacew3odatmd.html#a3aac70fa6eada42919e22a65be5a9170">irqgo2</a>, ierr_mpi )</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="preprocessor"></span>              flgmpi(1) = .true.</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;              nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#acae4c727f28b29263a3ee2dfa72d10b7">nrqgo2</a> )</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="preprocessor"></span>              <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;1b&#39;</span>, <a class="code" href="namespacew3odatmd.html#acae4c727f28b29263a3ee2dfa72d10b7">nrqgo2</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#aa1616dd0386dc34441d8f6e2b7bce030">napfld</a></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="preprocessor"></span><span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_PDLIB</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="preprocessor"></span>            <span class="keyword">CALL </span><a class="code" href="namespacepdlib__field__vec.html#aaefa22a0d64dcc21acbe49d8e1f27734">do_output_exchanges</a>(imod)</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span> <span class="comment">! IF (.NOT. LPDLIB) THEN</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE AFTER TIME LOOP 1&#39;</span>)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(2) .AND. <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,2)).EQ.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>, <a class="code" href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">irqpo1</a>, ierr_mpi )</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;            flgmpi(2) = .true.</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;            nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a> )</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;2 &#39;</span>, <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#a86e40dfd9101dbbdf8d8e95d8bfe4e3a">nappnt</a></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(4) .AND. <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,4)).EQ.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;            <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>, <a class="code" href="namespacew3odatmd.html#a2916a56c768d1d5f4de7edd39ccf8f6f">irqrs</a> , ierr_mpi )</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            flgmpi(4) = .true.</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a> )</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;4 &#39;</span>, <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#ab9a776e44f5dc414c7372c90f535bfd0">naprst</a></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(8) .AND. <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,8)).EQ.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>, <a class="code" href="namespacew3odatmd.html#a2916a56c768d1d5f4de7edd39ccf8f6f">irqrs</a> , ierr_mpi )</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            flgmpi(8) = .true.</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a> )</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;8 &#39;</span>, <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#ab9a776e44f5dc414c7372c90f535bfd0">naprst</a></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(5) .AND. <a class="code" href="namespacew3odatmd.html#ada0275bb802f8670c02b8ac42ce4db54">nrqbp</a>.NE.0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,5)).EQ.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;            <span class="keyword">CALL </span>mpi_startall ( <a class="code" href="namespacew3odatmd.html#ada0275bb802f8670c02b8ac42ce4db54">nrqbp</a> , <a class="code" href="namespacew3odatmd.html#a716896b5b8b01a026c8bc64c26fbe861">irqbp1</a>, ierr_mpi )</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;            flgmpi(5) = .true.</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#ada0275bb802f8670c02b8ac42ce4db54">nrqbp</a> )</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;5a&#39;</span>, <a class="code" href="namespacew3odatmd.html#ada0275bb802f8670c02b8ac42ce4db54">nrqbp</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#acfc04add9f8cdb195bff72bc1330b041">napbpt</a></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(5) .AND. <a class="code" href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">nrqbp2</a>.NE.0 .AND. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.EQ.<a class="code" href="namespacew3odatmd.html#acfc04add9f8cdb195bff72bc1330b041">napbpt</a>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,5)).EQ.0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            <span class="keyword">CALL </span>mpi_startall (<a class="code" href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">nrqbp2</a>,<a class="code" href="namespacew3odatmd.html#abc41ba1527cddde20c95c798e9a3a3d6">irqbp2</a>,ierr_mpi)</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            nrqmax    = max( nrqmax , <a class="code" href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">nrqbp2</a> )</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="preprocessor"></span>            <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9043) <span class="stringliteral">&#39;5b&#39;</span>, <a class="code" href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">nrqbp2</a>, nrqmax, <a class="code" href="namespacew3odatmd.html#acfc04add9f8cdb195bff72bc1330b041">napbpt</a></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="preprocessor"></span><span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( nrqmax .NE. 0 ) <span class="keyword">ALLOCATE</span> ( statio(mpi_status_size,nrqmax) )</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="preprocessor"></span>        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE AFTER TIME LOOP 2&#39;</span>)</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        <span class="comment">! 4.c Reset next output time</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>(1) = -1</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>(2) =  0</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        <span class="keywordflow">DO</span> j=1, <a class="code" href="namespacew3odatmd.html#a8f5a1eaad48354e6b56f1ff69ff00dd2">notype</a></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160; </div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            <span class="comment">! 4.d Perform output</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="preprocessor">#ifdef W3_NL5</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">IF</span> (j .EQ. 2) <a class="code" href="namespacew3odatmd.html#a01f9396ffeaff48b2d8695e7d1ae36ae">tosnl5</a>  = <a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:, 2)</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="preprocessor"></span>            tout(:) = <a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,j)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            dttst   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tout )</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;              <span class="keywordflow">IF</span> ( ( j .EQ. 1 )              &amp;</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="preprocessor"></span>                   .OR. ( j .EQ. 7 )         &amp;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="preprocessor"></span>                   ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#aa1616dd0386dc34441d8f6e2b7bce030">napfld</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( flgmpi(1) ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#acae4c727f28b29263a3ee2dfa72d10b7">nrqgo2</a>, <a class="code" href="namespacew3odatmd.html#a3aac70fa6eada42919e22a65be5a9170">irqgo2</a>, statio, ierr_mpi )</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                  flgmpi(1) = .false.</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> ( j .EQ. 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="preprocessor"></span>                    <span class="keyword">CALL </span><a class="code" href="namespacew3iogomd.html#ac44ac8e56555154f14a2747c6e61263a">w3iogo</a>( <span class="stringliteral">&#39;WRITE&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(7), itest, imod &amp;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="preprocessor">#ifdef W3_ASCII</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="preprocessor"></span>                            ,<a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(14)                          &amp;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="preprocessor"></span>                            )</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                  <span class="comment">!     Generate output flag file for fields and SBS coupling.</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                  jj = len_trim( <a class="code" href="namespacew3gdatmd.html#abeb9b7e95d4bec175d3427770dd2a80f">filext</a> )</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, idtime )</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                  foutname = <span class="stringliteral">&#39;Field_done.&#39;</span> // idtime(1:4) &amp;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                       // idtime(6:7) // idtime(9:10) &amp;</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                       // idtime(12:13) // <span class="stringliteral">&#39;.&#39;</span> // <a class="code" href="namespacew3gdatmd.html#abeb9b7e95d4bec175d3427770dd2a80f">filext</a>(1:jj)</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="preprocessor"></span>                  <span class="comment">!</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="preprocessor">#ifdef W3_SBS</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">OPEN</span>( unit=ndsoflg, <a class="code" href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a>=foutname)</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                  <span class="keyword">CLOSE</span>( ndsoflg )</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( j .EQ. 2 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                <span class="comment">!   Point output</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#a86e40dfd9101dbbdf8d8e95d8bfe4e3a">nappnt</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                  <span class="comment">!   Gets the necessary spectral data</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                  <span class="comment">!</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                  <span class="keyword">CALL </span><a class="code" href="namespacew3iopomd.html#a9bbc253bffd32ee330cad4928783178e">w3iope</a> ( <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a> )</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="preprocessor">#ifdef W3_BIN2NC</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">CALL </span><a class="code" href="namespacew3iopomd.html#a4ce260ff2acd21d1c3dacd3425b08301">w3iopon</a> ( <span class="stringliteral">&#39;WRITE&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(8), itest, imod )</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">CALL </span><a class="code" href="namespacew3iopomd.html#a3fafdfab8e46b11a34dd7041f06d17f6">w3iopo</a> ( <span class="stringliteral">&#39;WRITE&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(8), itest, imod &amp;                          </div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="preprocessor">#ifdef W3_ASCII</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="preprocessor"></span>                          ,<a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(15)                           &amp;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="preprocessor"></span>                          )</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="preprocessor"></span><span class="keywordflow">                  END IF</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( j .EQ. 3 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                <span class="comment">! Track output</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3iotrmd.html#ab4cac641972a06fdf42200a925032397">w3iotr</a> ( <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(11), <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(12), <a class="code" href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">va</a>, imod )</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( j .EQ. 4 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3iorsmd.html#a240c023a9106fb17ea812621029c5fce">w3iors</a> (<span class="stringliteral">&#39;HOT&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(6), xxx, imod, <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(8) )</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                itest = <a class="code" href="namespacew3gdatmd.html#a7382f3e82edb48fd3b166eec7476997d">rstype</a></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( j .EQ. 5 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#acfc04add9f8cdb195bff72bc1330b041">napbpt</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="preprocessor"></span>                  <span class="keywordflow">IF</span> (<a class="code" href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">nrqbp2</a>.NE.0) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">nrqbp2</a>, <a class="code" href="namespacew3odatmd.html#abc41ba1527cddde20c95c798e9a3a3d6">irqbp2</a>,statio, ierr_mpi )</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="preprocessor"></span>                  <span class="keyword">CALL </span><a class="code" href="namespacew3iobcmd.html#a019a5e37867ef70ddb68edd47abb01ce">w3iobc</a> ( <span class="stringliteral">&#39;WRITE&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(10),         &amp;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                       <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, itest, imod )</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( j .EQ. 6 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                <span class="keyword">CALL </span><a class="code" href="namespacew3iosfmd.html#a66a80d58f4389d946c7db600edd8b536">w3iosf</a> ( <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(13), imod )</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="preprocessor">#ifdef W3_OASIS</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span> ( j .EQ. 7 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                <span class="comment">! Send variables to atmospheric or ocean circulation or ice model</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;                <span class="comment">!</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                <span class="keywordflow">IF</span> (<a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>(7).NE.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                  <span class="keywordflow">IF</span> ( (mod(<a class="code" href="namespacew3oacpmd.html#a03021aaaa8a0151addefd94d3bbd0602">id_oasis_time</a>,nint(<a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>(7))) .EQ. 0 ) .AND. &amp;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;                       (<a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#afd7fc170cf4a118a6a4996a349906a41">time00</a>, <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>) .GT. 0.0) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                    <span class="keywordflow">IF</span> ( (<a class="code" href="namespacew3oacpmd.html#a18ef249660ccfaae10f579b697932a0c">cplt0</a> .AND. (<a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, timen) .GT. 0.0)) .OR. &amp;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                         .NOT. <a class="code" href="namespacew3oacpmd.html#a18ef249660ccfaae10f579b697932a0c">cplt0</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                      <span class="keywordflow">IF</span> (<a class="code" href="namespacew3oacpmd.html#a18ef249660ccfaae10f579b697932a0c">cplt0</a>) <a class="code" href="namespacew3oacpmd.html#a03021aaaa8a0151addefd94d3bbd0602">id_oasis_time</a> = nint(<a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#afd7fc170cf4a118a6a4996a349906a41">time00</a> , <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> ))</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160; </div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASACM</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="preprocessor"></span>                      <span class="keyword">CALL </span><a class="code" href="namespacew3agcmmd.html#a0771a75b5e4498340cc6591ebfe1c9a8">snd_fields_to_atmos</a>()</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASOCM</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="preprocessor"></span>                      <span class="keyword">CALL </span><a class="code" href="namespacew3ogcmmd.html#a2b8b896ac770500a569caff3baba06fd">snd_fields_to_ocean</a>()</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASICM</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="preprocessor"></span>                      <span class="keyword">CALL </span><a class="code" href="namespacew3igcmmd.html#a5cb75732015e4fc711d470dc75f1a206">snd_fields_to_ice</a>()</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_OASIS</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="preprocessor"></span>                      <span class="keywordflow">IF</span> (.NOT. <a class="code" href="namespacew3oacpmd.html#a18ef249660ccfaae10f579b697932a0c">cplt0</a>) <a class="code" href="namespacew3oacpmd.html#a03021aaaa8a0151addefd94d3bbd0602">id_oasis_time</a> = nint(<a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#afd7fc170cf4a118a6a4996a349906a41">time00</a> , <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> ))</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="keywordflow">                    ENDIF</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="keywordflow">                  ENDIF</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="keywordflow">                ENDIF</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="preprocessor"></span><span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;              <span class="comment">!</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;              <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( tout, <a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>(j) )</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;              <a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,j) = tout</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;              tlst        = <a class="code" href="namespacew3odatmd.html#a811019b8e0198c95c111311b1a36b66d">tolast</a>(:,j)</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;              dttst       = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tout , tlst )</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;              <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j)    = dttst.GE.0.</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                outid(2*j-1:2*j-1) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="preprocessor">#ifdef W3_OASIS</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="preprocessor"></span>                <span class="keywordflow">IF</span> ( (<a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>(7).NE.0) .AND.           &amp;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                     (<a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3wdatmd.html#afd7fc170cf4a118a6a4996a349906a41">time00</a>).EQ.0 .OR.  &amp;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                     <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3wdatmd.html#acfba70b45b1c101a4c94dc975e407254">timeend</a>).EQ.0) ) outid(13:13) = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                outid(2*j-1:2*j-1) = <span class="stringliteral">&#39;L&#39;</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            <span class="comment">! 4.e Update next output time</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;              <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>(1).EQ.-1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;                <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = tout</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;              <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tout , <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> )</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                <span class="keywordflow">IF</span> ( dttst.GT.0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                  <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = tout</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="keywordflow">                END IF</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            <span class="comment">!</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="keywordflow">        END DO</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE AFTER TIME LOOP 3&#39;</span>)</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160; </div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        <span class="comment">! If there is a second stream of restart files then J=8 and FLOUT(8)=.TRUE.</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        j=8</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;          <span class="comment">! 4.d Perform output</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;          tout(:) = <a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,j)</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;          dttst   = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tout )</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;          <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3iorsmd.html#a240c023a9106fb17ea812621029c5fce">w3iors</a> (<span class="stringliteral">&#39;HOT&#39;</span>, <a class="code" href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">nds</a>(6), xxx, imod, <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(8) )</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;            itest = <a class="code" href="namespacew3gdatmd.html#a7382f3e82edb48fd3b166eec7476997d">rstype</a></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">tick21</a> ( tout, <a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>(j) )</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            <a class="code" href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">tonext</a>(:,j) = tout</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;            tlst        = <a class="code" href="namespacew3odatmd.html#a811019b8e0198c95c111311b1a36b66d">tolast</a>(:,j)</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;            dttst       = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tout , tlst )</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j)    = dttst.GE.0.</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;              outid(2*j-1:2*j-1) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="preprocessor">#ifdef W3_OASIS</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="preprocessor"></span>              <span class="keywordflow">IF</span> ( (<a class="code" href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">dtout</a>(7).NE.0) .AND.           &amp;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                   (<a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3wdatmd.html#afd7fc170cf4a118a6a4996a349906a41">time00</a>).EQ.0 .OR.  &amp;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                   <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>(<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>,<a class="code" href="namespacew3wdatmd.html#acfba70b45b1c101a4c94dc975e407254">timeend</a>).EQ.0) ) outid(13:13) = <span class="stringliteral">&#39; &#39;</span></div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;              outid(2*j-1:2*j-1) = <span class="stringliteral">&#39;L&#39;</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;          <span class="comment">! 4.e Update next output time</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;          <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">flout</a>(j) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a>(1).EQ.-1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;              <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = tout</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;              dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( tout , <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> )</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;              <span class="keywordflow">IF</span> ( dttst.GT.0.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                <a class="code" href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">tofrst</a> = tout</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="keywordflow">              END IF</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="keywordflow">            END IF</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="keywordflow">          END IF</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        <span class="comment">!        END OF CHECKPOINT</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE AFTER TIME LOOP 3&#39;</span>)</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="preprocessor">#ifdef W3_MPI</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">IF</span> ( flgmpi(0) ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#a87f108b0b6396d24df1c3dbe7c3da731">nrqgo</a>, <a class="code" href="namespacew3odatmd.html#af5127f71e5c9013e127b2eaccbca5ccd">irqgo</a> , statio, ierr_mpi )</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <span class="keywordflow">IF</span> ( flgmpi(2) ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">nrqpo</a>, <a class="code" href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">irqpo1</a>, statio, ierr_mpi )</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <span class="keywordflow">IF</span> ( flgmpi(4) ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>, <a class="code" href="namespacew3odatmd.html#a2916a56c768d1d5f4de7edd39ccf8f6f">irqrs</a> , statio, ierr_mpi )</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="keywordflow">IF</span> ( flgmpi(8) ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">nrqrs</a>, <a class="code" href="namespacew3odatmd.html#a2916a56c768d1d5f4de7edd39ccf8f6f">irqrs</a> , statio, ierr_mpi )</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="keywordflow">IF</span> ( flgmpi(5) ) <span class="keyword">CALL </span>mpi_waitall ( <a class="code" href="namespacew3odatmd.html#ada0275bb802f8670c02b8ac42ce4db54">nrqbp</a>, <a class="code" href="namespacew3odatmd.html#a716896b5b8b01a026c8bc64c26fbe861">irqbp1</a>, statio, ierr_mpi )</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <span class="keywordflow">IF</span> ( nrqmax .NE. 0 ) <span class="keyword">DEALLOCATE</span> ( statio )</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="preprocessor"></span>        <span class="comment">!</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="preprocessor"></span>        <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">ndst</a>,9044)</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="preprocessor"></span><span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Before update log file&quot;</span>)</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="preprocessor"></span>      <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE AFTER TIME LOOP 4&#39;</span>)</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <span class="comment">! 5.  Update log file ------------------------------------------------ /</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.EQ.<a class="code" href="namespacew3odatmd.html#a5442839e64fe6e007c3e465344e562a6">naplog</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">stme21</a> ( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , idtime )</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">flcur</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;          dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , <a class="code" href="namespacew3idatmd.html#ad70d5c6e1f261d24716765d7bfebf366">tcn</a> )</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;          <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) idact(7:7) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#adcca631fb490998384d35ba60ebb8d6c">flwind</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;          dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , <a class="code" href="namespacew3idatmd.html#ada3fd04c642166b9b0f23a9d7eb46603">twn</a> )</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;          <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) idact(3:3) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a9dc8a62b7e0ae88d2d53ac0ed3e1d6cc">fltaua</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;          dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , <a class="code" href="namespacew3idatmd.html#ac4c78c77cd36d3b05d4d79f236c70f34">tun</a> )</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;          <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) idact(9:9) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#ad2c7a25bbd93d62ee0b514eb46c2101d">flrhoa</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;          dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , <a class="code" href="namespacew3idatmd.html#a0e18f271cd635642ad54f48a73401d60">trn</a> )</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;          <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) idact(11:11) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3idatmd.html#a017ad3a882377916066bce5f03c23765">tdn</a>(1) .GT. 0  ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;          dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a> , <a class="code" href="namespacew3idatmd.html#a017ad3a882377916066bce5f03c23765">tdn</a> )</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;          <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) idact(21:21) = <span class="stringliteral">&#39;X&#39;</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3adatmd.html#a8790356422ed442ebe4600878b76907a">idlast</a>.NE.<a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;          <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a>,900) <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a>, idtime(1:19), idact, outid</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;          <a class="code" href="namespacew3adatmd.html#a8790356422ed442ebe4600878b76907a">idlast</a> = <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>(1)</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;          <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a>,901) <a class="code" href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">itime</a>, <a class="code" href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">ipass</a>, idtime(12:19), idact, outid</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="keywordflow">        END IF</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="comment">!</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="keywordflow">      END IF</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      idact  = <span class="stringliteral">&#39;         &#39;</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      outid  = <span class="stringliteral">&#39;           &#39;</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      flact  = .false.</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="comment">! 6.  If time is not ending time, branch back to 2 ------------------- /</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      <span class="comment">!</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      dttst  = <a class="code" href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">dsec21</a>( <a class="code" href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">time</a>, tend )</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      <span class="keywordflow">IF</span> ( dttst .EQ. 0. ) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="preprocessor">#ifdef W3_TIMINGS</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="preprocessor"></span>      <span class="keyword">CALL </span><a class="code" href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">print_my_time</a>(<span class="stringliteral">&quot;Continuing the loop&quot;</span>)</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="preprocessor"></span><span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE AFTER TIME LOOP 5&#39;</span>)</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">IF</span> ( tstamp .AND. <a class="code" href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">screen</a>.NE.<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a> .AND. <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a>.EQ.<a class="code" href="namespacew3odatmd.html#ac465fc564dba68a335292494392cc7f9">napout</a> ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      <span class="keyword">CALL </span><a class="code" href="namespacew3servmd.html#a4ff12f04b0c56a558d749b1cfed9837c">wwtime</a> ( sttime )</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">screen</a>,951) sttime</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="keywordflow">IF</span> ( <a class="code" href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">iaproc</a> .EQ. <a class="code" href="namespacew3odatmd.html#a5442839e64fe6e007c3e465344e562a6">naplog</a> ) <span class="keyword">WRITE</span> (<a class="code" href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">ndso</a>,902)</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keyword">DEALLOCATE</span>(field)</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <span class="keyword">DEALLOCATE</span>(tauwx, tauwy)</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">print_memcheck</a>(memunit, <span class="stringliteral">&#39;memcheck_____:&#39;</span>//<span class="stringliteral">&#39; WW3_WAVE END W3WAVE&#39;</span>)</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <span class="comment">! Formats</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;900 <span class="keyword">FORMAT</span> (4x,i6,<span class="stringliteral">&#39;|&#39;</span>,i6,<span class="stringliteral">&#39;| &#39;</span>, a19  ,<span class="stringliteral">&#39; | &#39;</span>,a,<span class="stringliteral">&#39; | &#39;</span>,a,<span class="stringliteral">&#39; |&#39;</span>)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;901 <span class="keyword">FORMAT</span> (4x,i6,<span class="stringliteral">&#39;|&#39;</span>,i6,<span class="stringliteral">&#39;| &#39;</span>,11x,a8,<span class="stringliteral">&#39; | &#39;</span>,a,<span class="stringliteral">&#39; | &#39;</span>,a,<span class="stringliteral">&#39; |&#39;</span>)</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;902 <span class="keyword">FORMAT</span> (2x,<span class="stringliteral">&#39;--------+------+---------------------+&#39;</span>                  &amp;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;         ,<span class="stringliteral">&#39;-----------------------+------------------+&#39;</span>)</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;<span class="preprocessor">#ifdef W3_IC3</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="preprocessor"></span>920 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39;     Updating k and Cg from ice param. 1,2,3,4.&#39;</span>/)</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="preprocessor"></span>950 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39;  WAVEWATCH III calculating for &#39;</span>,a,<span class="stringliteral">&#39; at &#39;</span>,a)</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;951 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39;  WAVEWATCH III reached the end of a computation&#39;</span>,          &amp;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;         <span class="stringliteral">&#39; loop at &#39;</span>,a)</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;1000 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;         <span class="stringliteral">&#39;     ENDING TIME BEFORE STARTING TIME &#39;</span>/)</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;1001 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;         <span class="stringliteral">&#39;     NEW WATER LEVEL BEFORE OLD WATER LEVEL &#39;</span>/)</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;1002 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;         <span class="stringliteral">&#39;     ILLEGAL CURRENT INTERVAL &#39;</span>/)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;1003 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;         <span class="stringliteral">&#39;     ILLEGAL WIND INTERVAL &#39;</span>/)</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;1004 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;         <span class="stringliteral">&#39;     NEW ICE FIELD BEFORE OLD ICE FIELD &#39;</span>/)</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;1005 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;         <span class="stringliteral">&#39;     NEW IC1 FIELD BEFORE OLD IC1 FIELD &#39;</span>/)</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;1007 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;         <span class="stringliteral">&#39;     NEW ATM MOMENTUM BEFORE OLD ATM MOMENTUM &#39;</span>/)</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;1008 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;         <span class="stringliteral">&#39;     NEW AIR DENSITY BEFORE OLD AIR DENSITY &#39;</span>/)</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="preprocessor">#ifdef W3_IS2</span></div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="preprocessor"></span>1006 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;         <span class="stringliteral">&#39;     NEW IC5 FIELD BEFORE OLD IC5 FIELD &#39;</span>/)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="preprocessor"></span>1030 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III WARING IN W3WAVE :&#39;</span>/                   &amp;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;         <span class="stringliteral">&#39;     AT LEAST ONE PROCESSOR HAS 0 ACTIVE POINTS&#39;</span>,              &amp;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;         <span class="stringliteral">&#39; IN GRID&#39;</span>,i3)</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="preprocessor">#ifdef W3_REFRX</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="preprocessor"></span>1040 <span class="keyword">FORMAT</span> (/<span class="stringliteral">&#39; *** WAVEWATCH III ERROR IN W3WAVE :&#39;</span>/                    &amp;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;         <span class="stringliteral">&#39;     EXPERIMENTAL FEATURE !/REFRX NOT FULLY IMPLEMENTED.&#39;</span>/)</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="preprocessor"></span>    <span class="comment">!</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="preprocessor"></span>9000 <span class="keyword">FORMAT</span> (                                                            &amp;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;         <span class="stringliteral">&#39;============================================================&#39;</span>, &amp;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;         <span class="stringliteral">&#39;====================&#39;</span>/                                         &amp;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;         <span class="stringliteral">&#39; TEST W3WAVE : RUN MODEL&#39;</span>,i3,<span class="stringliteral">&#39; FILEXT [&#39;</span>,a,                    &amp;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;         <span class="stringliteral">&#39;] UP TO &#39;</span>,i8.8,i7.6 /                                          &amp;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;         <span class="stringliteral">&#39;====================&#39;</span>,                                         &amp;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;         <span class="stringliteral">&#39;============================================================&#39;</span>)</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;9010 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT INT. =&#39;</span>,f12.1,<span class="stringliteral">&#39;   FLZERO = &#39;</span>,l1)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;9011 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT LEV. =&#39;</span>,f12.1)</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;9012 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT CUR. =&#39;</span>,f12.1/                           &amp;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;         <span class="stringliteral">&#39;                        &#39;</span>,f12.1/                               &amp;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;         <span class="stringliteral">&#39;                        &#39;</span>,f12.1)</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;9013 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT WIND =&#39;</span>,f12.1/                           &amp;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;         <span class="stringliteral">&#39;                        &#39;</span>,f12.1/                               &amp;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;         <span class="stringliteral">&#39;                        &#39;</span>,f12.1)</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;9014 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT ICE  =&#39;</span>,f12.1)</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;9015 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT IC1  =&#39;</span>,f12.1)</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;9016 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT IC5  =&#39;</span>,f12.1)</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;9017 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT TAU  =&#39;</span>,f12.1)</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;9018 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : DT RHO  =&#39;</span>,f12.1)</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;9020 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : IT0, NT, DTG :&#39;</span>,2i4,f8.1)</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;9021 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : ITIME etc&#39;</span>,i6,i4,i10.8,i7.6,1x,2l1,         &amp;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;         2f6.2,f7.1,f6.2)</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;9022 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : SKIP TO 400 IN 3.5&#39;</span>)</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;9023 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : SKIP TO 380 IN 3.5&#39;</span>)</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;9030 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : END OF COMPUTATION LOOP&#39;</span>)</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;9040 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : CHECKING FOR OUTPUT&#39;</span>/                       &amp;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;         <span class="stringliteral">&#39;               TOFRST           :&#39;</span>,i9.8,i7.6/                  &amp;</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;         <span class="stringliteral">&#39;               TND              :&#39;</span>,i9.8,i7.6/                  &amp;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;         <span class="stringliteral">&#39;               DTTST[1], FLAG_O :&#39;</span>,2f8.1,l4)</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;9041 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : PERFORMING OUTPUT&#39;</span>)</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;9042 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : OUTPUT COMPUTATION FLAGS: &#39;</span>,3l2)</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_MPIT</span></div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="preprocessor"></span>9043 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : TYPE, NRQ, NRQMAX, NA : &#39;</span>,a2,3i6)</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef W3_T</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="preprocessor"></span>9044 <span class="keyword">FORMAT</span> (<span class="stringliteral">&#39; TEST W3WAVE : END OF OUTPUT&#39;</span>)</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="preprocessor"></span>    <span class="comment">!/</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <span class="comment">!/ End of W3WAVE ----------------------------------------------------- /</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="comment">!/</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="w3profsmd__pdlib_8F90_source.html#l02387">pdlib_w3profsmd::all_field_integral_print()</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l02292">pdlib_w3profsmd::all_va_integral_print()</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l02220">pdlib_w3profsmd::all_vaold_integral_print()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00687">w3adatmd::alpha</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01204">w3gdatmd::angarc</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l05026">pdlib_w3profsmd::apply_boundary_condition_va()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01264">w3gdatmd::arctc</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::as</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::asf</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l00114">pdlib_w3profsmd::aspar_diag_all</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l00114">pdlib_w3profsmd::aspar_jac</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l00114">pdlib_w3profsmd::b_jac</a>, <a class="el" href="w3adatmd_8F90_source.html#l00614">w3adatmd::bedforms</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::berg</a>, <a class="el" href="w3sic3md_8F90_source.html#l00088">w3sic3md::calledic3table</a>, <a class="el" href="w3adatmd_8F90_source.html#l00620">w3adatmd::cflkmax</a>, <a class="el" href="w3adatmd_8F90_source.html#l00620">w3adatmd::cflthmax</a>, <a class="el" href="w3adatmd_8F90_source.html#l00620">w3adatmd::cflxymax</a>, <a class="el" href="w3adatmd_8F90_source.html#l00575">w3adatmd::cg</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::charn</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01196">w3gdatmd::clats</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00625">w3gdatmd::clgtype</a>, <a class="el" href="w3oacpmd_8F90_source.html#l00080">w3oacpmd::cplt0</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01198">w3gdatmd::cthg0s</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::cx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::cy</a>, <a class="el" href="constants_8F90_source.html#l00063">constants::dair</a>, <a class="el" href="w3adatmd_8F90_source.html#l00629">w3adatmd::dcdx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00629">w3adatmd::dcdy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00627">w3adatmd::dcxdx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00627">w3adatmd::dcxdy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00627">w3adatmd::dcydx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00627">w3adatmd::dcydy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00627">w3adatmd::dddx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00627">w3adatmd::dddy</a>, <a class="el" href="constants_8F90_source.html#l00099">constants::debug_node</a>, <a class="el" href="constants_8F90_source.html#l00077">constants::dera</a>, <a class="el" href="w3adatmd_8F90_source.html#l00631">w3adatmd::dhdx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00631">w3adatmd::dhdy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00631">w3adatmd::dhlmt</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dmin</a>, <a class="el" href="pdlib__field__vec_8F90_source.html#l00787">pdlib_field_vec::do_output_exchanges()</a>, <a class="el" href="w3timemd_8F90_source.html#l00333">w3timemd::dsec21()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dtcfli</a>, <a class="el" href="w3adatmd_8F90_source.html#l00620">w3adatmd::dtdyn</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01232">w3gdatmd::dth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::dtmax</a>, <a class="el" href="w3odatmd_8F90_source.html#l00467">w3odatmd::dtout</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::dw</a>, <a class="el" href="w3servmd_8F90_source.html#l00736">w3servmd::extcde()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00620">w3adatmd::fcut</a>, <a class="el" href="CMakeLists_8txt_source.html#l00003">file()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01224">w3gdatmd::filext</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01219">w3gdatmd::flagll</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01221">w3gdatmd::flagst</a>, <a class="el" href="w3odatmd_8F90_source.html#l00546">w3odatmd::flbpi</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flck</a>, <a class="el" href="w3adatmd_8F90_source.html#l00688">w3adatmd::flcold</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flcth</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::flcur</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flcx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flcy</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::fldry</a>, <a class="el" href="w3idatmd_8F90_source.html#l00264">w3idatmd::flic1</a>, <a class="el" href="w3idatmd_8F90_source.html#l00264">w3idatmd::flic2</a>, <a class="el" href="w3idatmd_8F90_source.html#l00264">w3idatmd::flic3</a>, <a class="el" href="w3idatmd_8F90_source.html#l00264">w3idatmd::flic4</a>, <a class="el" href="w3idatmd_8F90_source.html#l00264">w3idatmd::flic5</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::flice</a>, <a class="el" href="w3adatmd_8F90_source.html#l00688">w3adatmd::fliwnd</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::fllev</a>, <a class="el" href="w3odatmd_8F90_source.html#l00478">w3odatmd::flogr2</a>, <a class="el" href="w3odatmd_8F90_source.html#l00478">w3odatmd::flogrd</a>, <a class="el" href="w3odatmd_8F90_source.html#l00468">w3odatmd::flout</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::flrhoa</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01217">w3gdatmd::flsou</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::fltaua</a>, <a class="el" href="w3idatmd_8F90_source.html#l00261">w3idatmd::flwind</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::fpis</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01406">w3gdatmd::fsfreqshift</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01406">w3gdatmd::fsrefraction</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01406">w3gdatmd::fssource</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01405">w3gdatmd::fstotalexp</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01405">w3gdatmd::fstotalimp</a>, <a class="el" href="w3idatmd_8F90_source.html#l00242">w3idatmd::ga0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00242">w3idatmd::gan</a>, <a class="el" href="w3idatmd_8F90_source.html#l00242">w3idatmd::gd0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00242">w3idatmd::gdn</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01094">w3gdatmd::gtype</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01211">w3gdatmd::hpfac</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01212">w3gdatmd::hqfac</a>, <a class="el" href="w3adatmd_8F90_source.html#l00374">w3adatmd::iadata</a>, <a class="el" href="w3adatmd_8F90_source.html#l00674">w3adatmd::iappro</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::iaproc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01148">w3gdatmd::ic3pars</a>, <a class="el" href="w3sic3md_8F90_source.html#l01963">w3sic3md::ic3table_cheng()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::ice</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::icedmax</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::icef</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::iceh</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01171">w3gdatmd::iclbac</a>, <a class="el" href="w3oacpmd_8F90_source.html#l00078">w3oacpmd::id_oasis_time</a>, <a class="el" href="w3adatmd_8F90_source.html#l00686">w3adatmd::idlast</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00618">w3gdatmd::igrid</a>, <a class="el" href="w3idatmd_8F90_source.html#l00160">w3idatmd::iidata</a>, <a class="el" href="CMakeLists_8txt_source.html#l00015">include()</a>, <a class="el" href="w3idatmd_8F90_source.html#l00260">w3idatmd::inflags1</a>, <a class="el" href="w3parall_8F90_source.html#l01398">w3parall::init_get_isea()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01129">w3gdatmd::iobp</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01117">w3gdatmd::iobp_loc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00321">w3odatmd::ioutp</a>, <a class="el" href="w3adatmd_8F90_source.html#l00686">w3adatmd::ipass</a>, <a class="el" href="yownodepool_8F90_source.html#l00116">yownodepool::iplg</a>, <a class="el" href="w3odatmd_8F90_source.html#l00538">w3odatmd::irqbp1</a>, <a class="el" href="w3odatmd_8F90_source.html#l00538">w3odatmd::irqbp2</a>, <a class="el" href="w3odatmd_8F90_source.html#l00476">w3odatmd::irqgo</a>, <a class="el" href="w3odatmd_8F90_source.html#l00476">w3odatmd::irqgo2</a>, <a class="el" href="w3odatmd_8F90_source.html#l00490">w3odatmd::irqpo1</a>, <a class="el" href="w3odatmd_8F90_source.html#l00524">w3odatmd::irqrs</a>, <a class="el" href="w3adatmd_8F90_source.html#l00681">w3adatmd::irqsg1</a>, <a class="el" href="w3adatmd_8F90_source.html#l00686">w3adatmd::itime</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00134">w3wdatmd::iwdata</a>, <a class="el" href="constants_8F90_source.html#l00101">constants::lpdlib</a>, <a class="el" href="w3parall_8F90_source.html#l00089">w3parall::lsloc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapfs</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsf</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01163">w3gdatmd::mapsta</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::mpi_comm_wave</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::napbpt</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naperr</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::napfld</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naplog</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::napout</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::nappnt</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naproc</a>, <a class="el" href="w3odatmd_8F90_source.html#l00457">w3odatmd::naprst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01168">w3gdatmd::nbac</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01168">w3gdatmd::nbgl</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01167">w3gdatmd::ncel</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::nds</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndse</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndso</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::ndst</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01168">w3gdatmd::nglo</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01181">w3gdatmd::nitersec1</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nk</a>, <a class="el" href="w3odatmd_8F90_source.html#l00326">w3odatmd::noge</a>, <a class="el" href="w3odatmd_8F90_source.html#l00327">w3odatmd::notype</a>, <a class="el" href="yownodepool_8F90_source.html#l00093">yownodepool::np</a>, <a class="el" href="yownodepool_8F90_source.html#l00099">yownodepool::npa</a>, <a class="el" href="w3odatmd_8F90_source.html#l00533">w3odatmd::nrqbp</a>, <a class="el" href="w3odatmd_8F90_source.html#l00533">w3odatmd::nrqbp2</a>, <a class="el" href="w3odatmd_8F90_source.html#l00475">w3odatmd::nrqgo</a>, <a class="el" href="w3odatmd_8F90_source.html#l00475">w3odatmd::nrqgo2</a>, <a class="el" href="w3odatmd_8F90_source.html#l00486">w3odatmd::nrqpo</a>, <a class="el" href="w3odatmd_8F90_source.html#l00523">w3odatmd::nrqrs</a>, <a class="el" href="w3adatmd_8F90_source.html#l00676">w3adatmd::nrqsg1</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nseal</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01230">w3gdatmd::nth</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::nx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01097">w3gdatmd::ny</a>, <a class="el" href="w3parall_8F90_source.html#l00082">w3parall::pdlib_nseal</a>, <a class="el" href="w3parall_8F90_source.html#l00082">w3parall::pdlib_nsealm</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l00632">pdlib_w3profsmd::pdlib_w3xypug()</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l02807">pdlib_w3profsmd::pdlib_w3xypug_block_explicit()</a>, <a class="el" href="w3profsmd__pdlib_8F90_source.html#l02736">pdlib_w3profsmd::pdlib_w3xypug_block_implicit()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::phiaw</a>, <a class="el" href="w3adatmd_8F90_source.html#l00614">w3adatmd::phibbl</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::phice</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::phioc</a>, <a class="el" href="w3servmd_8F90_source.html#l02033">w3servmd::print_memcheck()</a>, <a class="el" href="w3parall_8F90_source.html#l00200">w3parall::print_my_time()</a>, <a class="el" href="constants_8F90_source.html#l00079">constants::radius</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01101">w3gdatmd::reflc</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01102">w3gdatmd::refld</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::rhoair</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00624">w3gdatmd::rlgtype</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01095">w3gdatmd::rstype</a>, <a class="el" href="w3odatmd_8F90_source.html#l00456">w3odatmd::screen</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01214">w3gdatmd::sed_d50</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01214">w3gdatmd::sed_psic</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00193">w3wdatmd::shavetot</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01234">w3gdatmd::sig</a>, <a class="el" href="w3psmcmd_8F90_source.html#l03042">w3psmcmd::smcdcxy()</a>, <a class="el" href="w3psmcmd_8F90_source.html#l02897">w3psmcmd::smcdhxy()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00627">w3gdatmd::smctype</a>, <a class="el" href="w3agcmmd_8F90_source.html#l00089">w3agcmmd::snd_fields_to_atmos()</a>, <a class="el" href="w3igcmmd_8F90_source.html#l00077">w3igcmmd::snd_fields_to_ice()</a>, <a class="el" href="w3ogcmmd_8F90_source.html#l00063">w3ogcmmd::snd_fields_to_ocean()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01204">w3gdatmd::spcbac</a>, <a class="el" href="constants_8F90_source.html#l00096">constants::srce_direct</a>, <a class="el" href="constants_8F90_source.html#l00097">constants::srce_imp_post</a>, <a class="el" href="constants_8F90_source.html#l00098">constants::srce_imp_pre</a>, <a class="el" href="w3servmd_8F90_source.html#l01518">w3servmd::ssort1()</a>, <a class="el" href="w3timemd_8F90_source.html#l00682">w3timemd::stme21()</a>, <a class="el" href="w3odatmd_8F90_source.html#l00515">w3odatmd::stop</a>, <a class="el" href="w3servmd_8F90_source.html#l00148">w3servmd::strace()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::sx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01183">w3gdatmd::sy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::taua</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::tauadir</a>, <a class="el" href="w3adatmd_8F90_source.html#l00614">w3adatmd::taubbl</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::tauice</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::tauocx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::tauocy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::tauox</a>, <a class="el" href="w3adatmd_8F90_source.html#l00607">w3adatmd::tauoy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::tauwix</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::tauwiy</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::tauwnx</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::tauwny</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tbpi0</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tbpin</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tc0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tcn</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tdn</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tg0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tgn</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::ti1</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::ti5</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::tic1</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::tic5</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::tice</a>, <a class="el" href="w3timemd_8F90_source.html#l00084">w3timemd::tick21()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::time</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00175">w3wdatmd::time00</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00176">w3wdatmd::timeend</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tin</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00172">w3wdatmd::tlev</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tln</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tofrst</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tolast</a>, <a class="el" href="w3odatmd_8F90_source.html#l00464">w3odatmd::tonext</a>, <a class="el" href="w3odatmd_8F90_source.html#l00462">w3odatmd::tosnl5</a>, <a class="el" href="constants_8F90_source.html#l00074">constants::tpiinv</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tr0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::trn</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01200">w3gdatmd::trnx</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01200">w3gdatmd::trny</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tu0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tun</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::tw0</a>, <a class="el" href="w3idatmd_8F90_source.html#l00236">w3idatmd::twn</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::tws</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::u10</a>, <a class="el" href="w3adatmd_8F90_source.html#l00584">w3adatmd::u10d</a>, <a class="el" href="w3triamd_8F90_source.html#l02039">w3triamd::ug_gradients()</a>, <a class="el" href="constants_8F90_source.html#l00084">constants::undef</a>, <a class="el" href="w3gdatmd_8F90_source.html#l00626">w3gdatmd::ungtype</a>, <a class="el" href="w3uostmd_8F90_source.html#l00232">w3uostmd::uost_setgrid()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::ust</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::ustdir</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00183">w3wdatmd::va</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00192">w3wdatmd::vaold</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00191">w3wdatmd::vdtot</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00191">w3wdatmd::vstot</a>, <a class="el" href="w3servmd_8F90_source.html#l00977">w3servmd::w3acturn()</a>, <a class="el" href="w3profsmd_8F90_source.html#l00272">w3profsmd::w3cflug()</a>, <a class="el" href="w3pro3md_8F90_source.html#l01971">w3pro3md::w3cflxy()</a>, <a class="el" href="w3iosfmd_8F90_source.html#l00109">w3iosfmd::w3cprt()</a>, <a class="el" href="w3updtmd_8F90_source.html#l03139">w3updtmd::w3dzxy()</a>, <a class="el" href="w3wavemd_8F90_source.html#l02938">w3gath()</a>, <a class="el" href="w3psmcmd_8F90_source.html#l03185">w3psmcmd::w3gathsmc()</a>, <a class="el" href="w3sic3md_8F90_source.html#l01801">w3sic3md::w3ic3wncg_cheng()</a>, <a class="el" href="w3sic3md_8F90_source.html#l00658">w3sic3md::w3ic3wncg_v1()</a>, <a class="el" href="w3iobcmd_8F90_source.html#l00099">w3iobcmd::w3iobc()</a>, <a class="el" href="w3iogomd_8F90_source.html#l02396">w3iogomd::w3iogo()</a>, <a class="el" href="w3iopomd_8F90_source.html#l00697">w3iopomd::w3iope()</a>, <a class="el" href="w3iopomd_8F90_source.html#l01907">w3iopomd::w3iopo()</a>, <a class="el" href="w3iopomd_8F90_source.html#l01747">w3iopomd::w3iopon()</a>, <a class="el" href="w3iorsmd_8F90_source.html#l00113">w3iorsmd::w3iors()</a>, <a class="el" href="w3iosfmd_8F90_source.html#l00361">w3iosfmd::w3iosf()</a>, <a class="el" href="w3iotrmd_8F90_source.html#l00105">w3iotrmd::w3iotr()</a>, <a class="el" href="w3psmcmd_8F90_source.html#l00969">w3psmcmd::w3krtn()</a>, <a class="el" href="w3pro1md_8F90_source.html#l00900">w3pro1md::w3ktp1()</a>, <a class="el" href="w3pro2md_8F90_source.html#l01305">w3pro2md::w3ktp2()</a>, <a class="el" href="w3pro3md_8F90_source.html#l01512">w3pro3md::w3ktp3()</a>, <a class="el" href="w3pro1md_8F90_source.html#l00108">w3pro1md::w3map1()</a>, <a class="el" href="w3pro2md_8F90_source.html#l00136">w3pro2md::w3map2()</a>, <a class="el" href="w3pro3md_8F90_source.html#l00140">w3pro3md::w3map3()</a>, <a class="el" href="w3pro3md_8F90_source.html#l00525">w3pro3md::w3mapt()</a>, <a class="el" href="w3wavemd_8F90_source.html#l03568">w3nmin()</a>, <a class="el" href="w3iogomd_8F90_source.html#l01198">w3iogomd::w3outg()</a>, <a class="el" href="w3psmcmd_8F90_source.html#l00137">w3psmcmd::w3psmc()</a>, <a class="el" href="w3wavemd_8F90_source.html#l03256">w3scat()</a>, <a class="el" href="w3psmcmd_8F90_source.html#l03420">w3psmcmd::w3scatsmc()</a>, <a class="el" href="w3adatmd_8F90_source.html#l02645">w3adatmd::w3seta()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l02152">w3gdatmd::w3setg()</a>, <a class="el" href="w3idatmd_8F90_source.html#l00819">w3idatmd::w3seti()</a>, <a class="el" href="w3odatmd_8F90_source.html#l01523">w3odatmd::w3seto()</a>, <a class="el" href="w3wdatmd_8F90_source.html#l00660">w3wdatmd::w3setw()</a>, <a class="el" href="w3srcemd_8F90_source.html#l00195">w3srcemd::w3srce()</a>, <a class="el" href="w3updtmd_8F90_source.html#l01314">w3updtmd::w3ubpt()</a>, <a class="el" href="w3updtmd_8F90_source.html#l00172">w3updtmd::w3ucur()</a>, <a class="el" href="w3updtmd_8F90_source.html#l01513">w3updtmd::w3uic1()</a>, <a class="el" href="w3updtmd_8F90_source.html#l01624">w3updtmd::w3uic5()</a>, <a class="el" href="w3updtmd_8F90_source.html#l01756">w3updtmd::w3uice()</a>, <a class="el" href="w3updtmd_8F90_source.html#l01050">w3updtmd::w3uini()</a>, <a class="el" href="w3updtmd_8F90_source.html#l02013">w3updtmd::w3ulev()</a>, <a class="el" href="w3updtmd_8F90_source.html#l02552">w3updtmd::w3urho()</a>, <a class="el" href="w3updtmd_8F90_source.html#l00829">w3updtmd::w3utau()</a>, <a class="el" href="w3updtmd_8F90_source.html#l02736">w3updtmd::w3utrn()</a>, <a class="el" href="w3updtmd_8F90_source.html#l00489">w3updtmd::w3uwnd()</a>, <a class="el" href="w3pro1md_8F90_source.html#l00303">w3pro1md::w3xyp1()</a>, <a class="el" href="w3pro2md_8F90_source.html#l00509">w3pro2md::w3xyp2()</a>, <a class="el" href="w3pro3md_8F90_source.html#l00639">w3pro3md::w3xyp3()</a>, <a class="el" href="w3profsmd_8F90_source.html#l00063">w3profsmd::w3xypug()</a>, <a class="el" href="w3wavset_8F90_source.html#l03075">w3wavset::wave_setup_computation()</a>, <a class="el" href="w3adatmd_8F90_source.html#l00603">w3adatmd::whitecap</a>, <a class="el" href="w3adatmd_8F90_source.html#l00575">w3adatmd::wn</a>, <a class="el" href="w3adatmd_8F90_source.html#l00587">w3adatmd::wnmean</a>, <a class="el" href="w3servmd_8F90_source.html#l00664">w3servmd::wwtime()</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01205">w3gdatmd::xgrd</a>, <a class="el" href="w3gdatmd_8F90_source.html#l01205">w3gdatmd::ygrd</a>, and <a class="el" href="w3gdatmd_8F90_source.html#l01195">w3gdatmd::zb</a>.</p>

<p class="reference">Referenced by <a class="el" href="wmwavemd_8F90_source.html#l00091">wmwavemd::wmwave()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacepdlib__w3profsmd_html_a9a2856f96ec8c63ba45fabaee8632034"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#a9a2856f96ec8c63ba45fabaee8632034">pdlib_w3profsmd::aspar_diag_all</a></div><div class="ttdeci">real, dimension(:,:), allocatable aspar_diag_all</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l00114">w3profsmd_pdlib.F90:114</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a4a019b36b65e812462eacc03cb8c805b"><div class="ttname"><a href="namespacew3idatmd.html#a4a019b36b65e812462eacc03cb8c805b">w3idatmd::gdn</a></div><div class="ttdeci">real, pointer gdn</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00242">w3idatmd.F90:242</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_af51536ea003579d04bb805183993f8ac"><div class="ttname"><a href="namespacew3gdatmd.html#af51536ea003579d04bb805183993f8ac">w3gdatmd::nk</a></div><div class="ttdeci">integer, pointer nk</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a474c83a5ea93395610364fc1f0c75b1e"><div class="ttname"><a href="namespacew3odatmd.html#a474c83a5ea93395610364fc1f0c75b1e">w3odatmd::nrqbp2</a></div><div class="ttdeci">integer, pointer nrqbp2</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00533">w3odatmd.F90:533</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a656a9d6fe55319863647f66759d86e3a"><div class="ttname"><a href="namespacew3wdatmd.html#a656a9d6fe55319863647f66759d86e3a">w3wdatmd::iwdata</a></div><div class="ttdeci">integer iwdata</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00134">w3wdatmd.F90:134</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a60d0fcb312ff963cc69ba23c1a6c8cff"><div class="ttname"><a href="namespacew3gdatmd.html#a60d0fcb312ff963cc69ba23c1a6c8cff">w3gdatmd::nseal</a></div><div class="ttdeci">integer, pointer nseal</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01097">w3gdatmd.F90:1097</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a8fa813e24da2f99107bb8a001a582842"><div class="ttname"><a href="namespacew3odatmd.html#a8fa813e24da2f99107bb8a001a582842">w3odatmd::tbpi0</a></div><div class="ttdeci">integer, dimension(:), pointer tbpi0</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a3faf2a3d2d54ac342cf9591d5a73c931"><div class="ttname"><a href="namespaceconstants.html#a3faf2a3d2d54ac342cf9591d5a73c931">constants::srce_imp_pre</a></div><div class="ttdeci">integer, parameter srce_imp_pre</div><div class="ttdoc">srce_imp_pre</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00098">constants.F90:98</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a32487c213ce877b1194cb0244ebfafc7"><div class="ttname"><a href="namespacew3timemd.html#a32487c213ce877b1194cb0244ebfafc7">w3timemd::dsec21</a></div><div class="ttdeci">real function dsec21(TIME1, TIME2)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00333">w3timemd.F90:333</a></div></div>
<div class="ttc" id="anamespacew3triamd_html_ac5ba612fd291a65f6528b5616a7b3465"><div class="ttname"><a href="namespacew3triamd.html#ac5ba612fd291a65f6528b5616a7b3465">w3triamd::ug_gradients</a></div><div class="ttdeci">subroutine ug_gradients(PARAM, DIFFX, DIFFY)</div><div class="ttdoc">Calculate gradients at a point via its connection.</div><div class="ttdef"><b>Definition:</b> <a href="w3triamd_8F90_source.html#l02039">w3triamd.F90:2039</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a38ffe354e8a494678e53465842bfcba4"><div class="ttname"><a href="namespacew3adatmd.html#a38ffe354e8a494678e53465842bfcba4">w3adatmd::phice</a></div><div class="ttdeci">real, dimension(:), pointer phice</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="aCMakeLists_8txt_html_a8c90ab403bf8fd22fc61c4912dbfce20"><div class="ttname"><a href="CMakeLists_8txt.html#a8c90ab403bf8fd22fc61c4912dbfce20">include</a></div><div class="ttdeci">cmake src_list cmake include(${CMAKE_CURRENT_SOURCE_DIR}/cmake/check_switches.cmake) check_switches(&quot;$</div><div class="ttdef"><b>Definition:</b> <a href="CMakeLists_8txt_source.html#l00015">CMakeLists.txt:15</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_aa632438d41b3b855e4d77e5267b2712d"><div class="ttname"><a href="namespacew3odatmd.html#aa632438d41b3b855e4d77e5267b2712d">w3odatmd::nrqpo</a></div><div class="ttdeci">integer, pointer nrqpo</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00486">w3odatmd.F90:486</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a67c48aac303564691d4f117704bc8d30"><div class="ttname"><a href="namespacew3gdatmd.html#a67c48aac303564691d4f117704bc8d30">w3gdatmd::nitersec1</a></div><div class="ttdeci">integer, pointer nitersec1</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01181">w3gdatmd.F90:1181</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_a7695cd67695f227dbbaa3b12570c11bd"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#a7695cd67695f227dbbaa3b12570c11bd">pdlib_w3profsmd::all_field_integral_print</a></div><div class="ttdeci">subroutine all_field_integral_print(FIELD, string)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l02387">w3profsmd_pdlib.F90:2387</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a82429c6f49a881c7b7bd1722a879129a"><div class="ttname"><a href="namespacew3wdatmd.html#a82429c6f49a881c7b7bd1722a879129a">w3wdatmd::iceh</a></div><div class="ttdeci">real, dimension(:), pointer iceh</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ada3fd04c642166b9b0f23a9d7eb46603"><div class="ttname"><a href="namespacew3idatmd.html#ada3fd04c642166b9b0f23a9d7eb46603">w3idatmd::twn</a></div><div class="ttdeci">integer, dimension(:), pointer twn</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3agcmmd_html"><div class="ttname"><a href="namespacew3agcmmd.html">w3agcmmd</a></div><div class="ttdoc">Module used for coupling applications between atmospheric model and WW3 with OASIS3-MCT.</div><div class="ttdef"><b>Definition:</b> <a href="w3agcmmd_8F90_source.html#l00023">w3agcmmd.F90:23</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_afbd06f609252e097fb41aabfffce4e73"><div class="ttname"><a href="namespacew3idatmd.html#afbd06f609252e097fb41aabfffce4e73">w3idatmd::inflags1</a></div><div class="ttdeci">logical, dimension(:), pointer inflags1</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00260">w3idatmd.F90:260</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a6f59c884d68bc4696a47dc2afa3dc19e"><div class="ttname"><a href="namespacew3adatmd.html#a6f59c884d68bc4696a47dc2afa3dc19e">w3adatmd::charn</a></div><div class="ttdeci">real, dimension(:), pointer charn</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a6890e5fa08d022433cfe314aac88944a"><div class="ttname"><a href="namespacew3adatmd.html#a6890e5fa08d022433cfe314aac88944a">w3adatmd::dtdyn</a></div><div class="ttdeci">real, dimension(:), pointer dtdyn</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00620">w3adatmd.F90:620</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_aa963b1ff04f7cd17a26f4f8bc57aaca8"><div class="ttname"><a href="namespacew3psmcmd.html#aa963b1ff04f7cd17a26f4f8bc57aaca8">w3psmcmd::w3scatsmc</a></div><div class="ttdeci">subroutine w3scatsmc(ISPEC, MAPSTA, FIELD)</div><div class="ttdoc">SMC version of W3GATH.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l03420">w3psmcmd.F90:3420</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_acd22302f4efdce8264a63cb414a77a8c"><div class="ttname"><a href="namespacew3wdatmd.html#acd22302f4efdce8264a63cb414a77a8c">w3wdatmd::fpis</a></div><div class="ttdeci">real, dimension(:), pointer fpis</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a4b6f7577a00b480afcec77e672fb25b2"><div class="ttname"><a href="namespacew3gdatmd.html#a4b6f7577a00b480afcec77e672fb25b2">w3gdatmd::dth</a></div><div class="ttdeci">real, pointer dth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01232">w3gdatmd.F90:1232</a></div></div>
<div class="ttc" id="anamespacew3triamd_html"><div class="ttname"><a href="namespacew3triamd.html">w3triamd</a></div><div class="ttdoc">Reads triangle and unstructured grid information.</div><div class="ttdef"><b>Definition:</b> <a href="w3triamd_8F90_source.html#l00021">w3triamd.F90:21</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_acae4c727f28b29263a3ee2dfa72d10b7"><div class="ttname"><a href="namespacew3odatmd.html#acae4c727f28b29263a3ee2dfa72d10b7">w3odatmd::nrqgo2</a></div><div class="ttdeci">integer, pointer nrqgo2</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00475">w3odatmd.F90:475</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a1f9e1a2b29d3ef362960cb92c7151239"><div class="ttname"><a href="namespacew3adatmd.html#a1f9e1a2b29d3ef362960cb92c7151239">w3adatmd::as</a></div><div class="ttdeci">real, dimension(:), pointer as</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a24c895280e10751a3396a14462552aa4"><div class="ttname"><a href="namespacew3wdatmd.html#a24c895280e10751a3396a14462552aa4">w3wdatmd::shavetot</a></div><div class="ttdeci">logical, dimension(:), pointer shavetot</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00193">w3wdatmd.F90:193</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a01f9396ffeaff48b2d8695e7d1ae36ae"><div class="ttname"><a href="namespacew3odatmd.html#a01f9396ffeaff48b2d8695e7d1ae36ae">w3odatmd::tosnl5</a></div><div class="ttdeci">integer, dimension(:), pointer tosnl5</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00462">w3odatmd.F90:462</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adff59174f70e9631f993d0d98127f586"><div class="ttname"><a href="namespacew3gdatmd.html#adff59174f70e9631f993d0d98127f586">w3gdatmd::ygrd</a></div><div class="ttdeci">double precision, dimension(:,:), pointer ygrd</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01205">w3gdatmd.F90:1205</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a8f5a1eaad48354e6b56f1ff69ff00dd2"><div class="ttname"><a href="namespacew3odatmd.html#a8f5a1eaad48354e6b56f1ff69ff00dd2">w3odatmd::notype</a></div><div class="ttdeci">integer notype</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00327">w3odatmd.F90:327</a></div></div>
<div class="ttc" id="anamespacew3uostmd_html"><div class="ttname"><a href="namespacew3uostmd.html">w3uostmd</a></div><div class="ttdoc">Parmeterization of the unresolved obstacles.</div><div class="ttdef"><b>Definition:</b> <a href="w3uostmd_8F90_source.html#l00022">w3uostmd.F90:22</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html"><div class="ttname"><a href="namespacew3adatmd.html">w3adatmd</a></div><div class="ttdoc">Define data structures to set up wave model auxiliary data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00026">w3adatmd.F90:26</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ae9ea4c0ae82712f485b0a6b9b546a0f4"><div class="ttname"><a href="namespacew3gdatmd.html#ae9ea4c0ae82712f485b0a6b9b546a0f4">w3gdatmd::nspec</a></div><div class="ttdeci">integer, pointer nspec</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3iosfmd_html_ad73dd75724e9742eed9354f564481464"><div class="ttname"><a href="namespacew3iosfmd.html#ad73dd75724e9742eed9354f564481464">w3iosfmd::w3cprt</a></div><div class="ttdeci">subroutine w3cprt(IMOD)</div><div class="ttdoc">Partitioning of spectra into fields for all grid points that are locally stored.</div><div class="ttdef"><b>Definition:</b> <a href="w3iosfmd_8F90_source.html#l00109">w3iosfmd.F90:109</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a61cadb0c4a6348fd421419b6aadf525b"><div class="ttname"><a href="namespacew3gdatmd.html#a61cadb0c4a6348fd421419b6aadf525b">w3gdatmd::trnx</a></div><div class="ttdeci">real, dimension(:,:), pointer trnx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01200">w3gdatmd.F90:1200</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a3ea089a19a1435b25e579dfd8cdde3e0"><div class="ttname"><a href="namespacew3adatmd.html#a3ea089a19a1435b25e579dfd8cdde3e0">w3adatmd::dcdx</a></div><div class="ttdeci">real, dimension(:,:,:), pointer dcdx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00629">w3adatmd.F90:629</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a792972a6a5a50a0ecf7247862528f086"><div class="ttname"><a href="namespaceconstants.html#a792972a6a5a50a0ecf7247862528f086">constants::dair</a></div><div class="ttdeci">real, parameter dair</div><div class="ttdoc">DAIR Density of air (kg/m3).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00063">constants.F90:63</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a402553559a19acce826e61b338e8fd47"><div class="ttname"><a href="namespacew3adatmd.html#a402553559a19acce826e61b338e8fd47">w3adatmd::nrqsg2</a></div><div class="ttdeci">integer, pointer nrqsg2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a081d78fa85ae3d71307db972c92ddcb8"><div class="ttname"><a href="namespacew3gdatmd.html#a081d78fa85ae3d71307db972c92ddcb8">w3gdatmd::zb</a></div><div class="ttdeci">real, dimension(:), pointer zb</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01195">w3gdatmd.F90:1195</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a7ca2bfab88e5cd9e0eda00a6147d1806"><div class="ttname"><a href="namespaceconstants.html#a7ca2bfab88e5cd9e0eda00a6147d1806">constants::dera</a></div><div class="ttdeci">real, parameter dera</div><div class="ttdoc">DERA Conversion factor from degrees to radians.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00077">constants.F90:77</a></div></div>
<div class="ttc" id="anamespacew3pro3md_html_a22b7a45b518b51fc432d6ebe5ed5d48f"><div class="ttname"><a href="namespacew3pro3md.html#a22b7a45b518b51fc432d6ebe5ed5d48f">w3pro3md::w3ktp3</a></div><div class="ttdeci">subroutine w3ktp3(ISEA, FACTH, FACK, CTHG0, CG, WN, DW, DDDX, DDDY, CX, CY, DCXDX, DCXDY, DCYDX, DCYDY, DCDX, DCDY, VA, CFLTHMAX, CFLKMAX)</div><div class="ttdoc">Propagation in spectral space.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro3md_8F90_source.html#l01512">w3pro3md.F90:1512</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a20388956775ff9ffe6da81c7e914c6fa"><div class="ttname"><a href="namespacew3gdatmd.html#a20388956775ff9ffe6da81c7e914c6fa">w3gdatmd::flagst</a></div><div class="ttdeci">logical, dimension(:), pointer flagst</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01221">w3gdatmd.F90:1221</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ab1451f01c0706fb65b2c7e1fa1ad1ba6"><div class="ttname"><a href="namespacew3gdatmd.html#ab1451f01c0706fb65b2c7e1fa1ad1ba6">w3gdatmd::ungtype</a></div><div class="ttdeci">integer, parameter ungtype</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00626">w3gdatmd.F90:626</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_a578b5955197616107c38b96b44e6cf5d"><div class="ttname"><a href="namespacew3updtmd.html#a578b5955197616107c38b96b44e6cf5d">w3updtmd::w3ucur</a></div><div class="ttdeci">subroutine w3ucur(FLFRST)</div><div class="ttdoc">Interpolate the current field to the present time.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l00172">w3updtmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a2dadaadcc7dbc940f8b3b267ed06a597"><div class="ttname"><a href="namespacew3gdatmd.html#a2dadaadcc7dbc940f8b3b267ed06a597">w3gdatmd::dmin</a></div><div class="ttdeci">real, pointer dmin</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a5f8ec04f27567075cfc11321ce27f4d9"><div class="ttname"><a href="namespaceconstants.html#a5f8ec04f27567075cfc11321ce27f4d9">constants::srce_direct</a></div><div class="ttdeci">integer, parameter srce_direct</div><div class="ttdoc">srce_direct</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00096">constants.F90:96</a></div></div>
<div class="ttc" id="anamespacew3wavset_html"><div class="ttname"><a href="namespacew3wavset.html">w3wavset</a></div><div class="ttdoc">Implicit solution of wave setup problem following Dingemans for structured and unstructured grids.</div><div class="ttdef"><b>Definition:</b> <a href="w3wavset_8F90_source.html#l00018">w3wavset.F90:18</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html"><div class="ttname"><a href="namespacew3wdatmd.html">w3wdatmd</a></div><div class="ttdoc">Define data structures to set up wave model dynamic data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00018">w3wdatmd.F90:18</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_ad11d338d589100bb11aed0ecc4a6441e"><div class="ttname"><a href="namespacew3updtmd.html#ad11d338d589100bb11aed0ecc4a6441e">w3updtmd::w3urho</a></div><div class="ttdeci">subroutine w3urho(FLFRST)</div><div class="ttdoc">Interpolate air density field to the given time.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l02552">w3updtmd.F90:2552</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a528e5c99e65966c5ecca52fc751cdc58"><div class="ttname"><a href="namespacew3adatmd.html#a528e5c99e65966c5ecca52fc751cdc58">w3adatmd::dhdy</a></div><div class="ttdeci">real, dimension(:), pointer dhdy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00631">w3adatmd.F90:631</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a115d225c7877e15bdb8ab3a554c5e67e"><div class="ttname"><a href="namespacew3adatmd.html#a115d225c7877e15bdb8ab3a554c5e67e">w3adatmd::dhlmt</a></div><div class="ttdeci">real, dimension(:,:), pointer dhlmt</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00631">w3adatmd.F90:631</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a179bbc1c35de5c5f106ff107fc7053c5"><div class="ttname"><a href="namespacew3adatmd.html#a179bbc1c35de5c5f106ff107fc7053c5">w3adatmd::tauice</a></div><div class="ttdeci">real, dimension(:,:), pointer tauice</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_aa0f0fc927e295c0742a760166a327a14"><div class="ttname"><a href="namespacew3updtmd.html#aa0f0fc927e295c0742a760166a327a14">w3updtmd::w3uini</a></div><div class="ttdeci">subroutine w3uini(A)</div><div class="ttdoc">Initialize the wave field with fetch-limited spectra before the actual calculation start.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l01050">w3updtmd.F90:1050</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a148a77b8c3bf5f6274bd25c1e5e4c30d"><div class="ttname"><a href="namespacew3gdatmd.html#a148a77b8c3bf5f6274bd25c1e5e4c30d">w3gdatmd::sed_d50</a></div><div class="ttdeci">real, dimension(:), pointer sed_d50</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01214">w3gdatmd.F90:1214</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_abcee4be4cbb13ffe97f054063aacf932"><div class="ttname"><a href="namespacew3adatmd.html#abcee4be4cbb13ffe97f054063aacf932">w3adatmd::cflxymax</a></div><div class="ttdeci">real, dimension(:), pointer cflxymax</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00620">w3adatmd.F90:620</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_adaccc46c70348e68ea06c9e0977522e6"><div class="ttname"><a href="namespacew3adatmd.html#adaccc46c70348e68ea06c9e0977522e6">w3adatmd::cg</a></div><div class="ttdeci">real, dimension(:,:), pointer cg</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00575">w3adatmd.F90:575</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ac02ea099394a1abc67864b699abdae83"><div class="ttname"><a href="namespacew3adatmd.html#ac02ea099394a1abc67864b699abdae83">w3adatmd::tws</a></div><div class="ttdeci">real, dimension(:), pointer tws</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_a66c1a390b74205c189b73c138070214d"><div class="ttname"><a href="namespacew3psmcmd.html#a66c1a390b74205c189b73c138070214d">w3psmcmd::smcdhxy</a></div><div class="ttdeci">subroutine smcdhxy</div><div class="ttdoc">Calculates water-depth gradient for refraction.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l02897">w3psmcmd.F90:2897</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a150a3fab6d4a2db874aff23e94edcccf"><div class="ttname"><a href="namespacew3adatmd.html#a150a3fab6d4a2db874aff23e94edcccf">w3adatmd::fcut</a></div><div class="ttdeci">real, dimension(:), pointer fcut</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00620">w3adatmd.F90:620</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a79e88ab04db1d3ac00f3e45d2625312c"><div class="ttname"><a href="namespacew3gdatmd.html#a79e88ab04db1d3ac00f3e45d2625312c">w3gdatmd::rlgtype</a></div><div class="ttdeci">integer, parameter rlgtype</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00624">w3gdatmd.F90:624</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a3c3df716a34d6bf987427f80907087db"><div class="ttname"><a href="namespacew3adatmd.html#a3c3df716a34d6bf987427f80907087db">w3adatmd::nsploc</a></div><div class="ttdeci">integer, pointer nsploc</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a681fab510c2b7ef119b4a5eaf1f7a3f3"><div class="ttname"><a href="namespacew3odatmd.html#a681fab510c2b7ef119b4a5eaf1f7a3f3">w3odatmd::flogr2</a></div><div class="ttdeci">logical, dimension(:,:), pointer flogr2</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00478">w3odatmd.F90:478</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_a6f24b19ae09bf47426ada64d8798627e"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#a6f24b19ae09bf47426ada64d8798627e">pdlib_w3profsmd::aspar_jac</a></div><div class="ttdeci">real, dimension(:,:), allocatable aspar_jac</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l00114">w3profsmd_pdlib.F90:114</a></div></div>
<div class="ttc" id="anamespacew3pro2md_html_aece5b76209f20456b27e78c092fd6b4b"><div class="ttname"><a href="namespacew3pro2md.html#aece5b76209f20456b27e78c092fd6b4b">w3pro2md::w3ktp2</a></div><div class="ttdeci">subroutine w3ktp2(ISEA, FACTH, FACK, CTHG0, CG, WN, DEPTH, DDDX, DDDY, CX, CY, DCXDX, DCXDY, DCYDX, DCYDY, DCDX, DCDY, VA)</div><div class="ttdoc">Propagation in spectral space.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro2md_8F90_source.html#l01305">w3pro2md.F90:1305</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a296967256735bfdfc5b9aebd20218710"><div class="ttname"><a href="namespacew3adatmd.html#a296967256735bfdfc5b9aebd20218710">w3adatmd::bispl</a></div><div class="ttdeci">integer, dimension(:), pointer bispl</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00680">w3adatmd.F90:680</a></div></div>
<div class="ttc" id="anamespacew3parall_html_a0876a0343ba7eebd915d0859d8c78e30"><div class="ttname"><a href="namespacew3parall.html#a0876a0343ba7eebd915d0859d8c78e30">w3parall::lsloc</a></div><div class="ttdeci">logical, parameter lsloc</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l00089">w3parall.F90:89</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_afa9c18e382373af88df0f16b91a82065"><div class="ttname"><a href="namespacew3adatmd.html#afa9c18e382373af88df0f16b91a82065">w3adatmd::dw</a></div><div class="ttdeci">real, dimension(:), pointer dw</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3iorsmd_html_a240c023a9106fb17ea812621029c5fce"><div class="ttname"><a href="namespacew3iorsmd.html#a240c023a9106fb17ea812621029c5fce">w3iorsmd::w3iors</a></div><div class="ttdeci">subroutine w3iors(INXOUT, NDSR, DUMFPI, IMOD, FLRSTRT)</div><div class="ttdoc">Reads/writes restart files.</div><div class="ttdef"><b>Definition:</b> <a href="w3iorsmd_8F90_source.html#l00113">w3iorsmd.F90:113</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a01dd3a2f2005cd24b5b07468b217cdb7"><div class="ttname"><a href="namespacew3adatmd.html#a01dd3a2f2005cd24b5b07468b217cdb7">w3adatmd::u10d</a></div><div class="ttdeci">real, dimension(:), pointer u10d</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a84f9a09b83a4c65df6185b83e26be0ae"><div class="ttname"><a href="namespacew3gdatmd.html#a84f9a09b83a4c65df6185b83e26be0ae">w3gdatmd::reflc</a></div><div class="ttdeci">real, dimension(:,:), pointer reflc</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01101">w3gdatmd.F90:1101</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_aad527950f206377d049ee70b94ed4ba7"><div class="ttname"><a href="namespacew3odatmd.html#aad527950f206377d049ee70b94ed4ba7">w3odatmd::dtout</a></div><div class="ttdeci">real, dimension(:), pointer dtout</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00467">w3odatmd.F90:467</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad451ba3fd6cfdb044986de89e4e4e4f8"><div class="ttname"><a href="namespacew3gdatmd.html#ad451ba3fd6cfdb044986de89e4e4e4f8">w3gdatmd::sig</a></div><div class="ttdeci">real, dimension(:), pointer sig</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01234">w3gdatmd.F90:1234</a></div></div>
<div class="ttc" id="anamespacew3profsmd_html"><div class="ttname"><a href="namespacew3profsmd.html">w3profsmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd_8F90_source.html#l00003">w3profsmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_aef670a8d6c1723d7c0b4797aeaedc075"><div class="ttname"><a href="namespacew3wdatmd.html#aef670a8d6c1723d7c0b4797aeaedc075">w3wdatmd::icef</a></div><div class="ttdeci">real, dimension(:), pointer icef</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a74463b1ffb13fda60c4b7f6c20c2123c"><div class="ttname"><a href="namespacew3gdatmd.html#a74463b1ffb13fda60c4b7f6c20c2123c">w3gdatmd::xgrd</a></div><div class="ttdeci">double precision, dimension(:,:), pointer xgrd</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01205">w3gdatmd.F90:1205</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ae8e13cd23548b33eaaae230040049539"><div class="ttname"><a href="namespacew3gdatmd.html#ae8e13cd23548b33eaaae230040049539">w3gdatmd::sy</a></div><div class="ttdeci">real, pointer sy</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_abaa3489602a308c21fefc7e3359dfa6e"><div class="ttname"><a href="namespacew3gdatmd.html#abaa3489602a308c21fefc7e3359dfa6e">w3gdatmd::flck</a></div><div class="ttdeci">logical, pointer flck</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3pro3md_html_a65d9779614cc6e8e9180f4128de0e673"><div class="ttname"><a href="namespacew3pro3md.html#a65d9779614cc6e8e9180f4128de0e673">w3pro3md::w3xyp3</a></div><div class="ttdeci">subroutine w3xyp3(ISP, DTG, MAPSTA, MAPFS, VQ, VGX, VGY)</div><div class="ttdoc">Propagation in phyiscal space for a given spectral component.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro3md_8F90_source.html#l00639">w3pro3md.F90:639</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a189f1113da93ad048b3b62aa0951f9f5"><div class="ttname"><a href="namespacew3idatmd.html#a189f1113da93ad048b3b62aa0951f9f5">w3idatmd::ti5</a></div><div class="ttdeci">integer, dimension(:), pointer ti5</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a0562b2c290aa03249c1b196abc8f76a1"><div class="ttname"><a href="namespacew3gdatmd.html#a0562b2c290aa03249c1b196abc8f76a1">w3gdatmd::fsrefraction</a></div><div class="ttdeci">logical, pointer fsrefraction</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01406">w3gdatmd.F90:1406</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a982588d9c5fbf625de3abe149df867ad"><div class="ttname"><a href="namespacew3adatmd.html#a982588d9c5fbf625de3abe149df867ad">w3adatmd::ipass</a></div><div class="ttdeci">integer, pointer ipass</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00686">w3adatmd.F90:686</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a36a4047055987bb52cab303f0207f676"><div class="ttname"><a href="namespacew3odatmd.html#a36a4047055987bb52cab303f0207f676">w3odatmd::iaproc</a></div><div class="ttdeci">integer, pointer iaproc</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a40321cbf97d9ff690b041ed4c5866b71"><div class="ttname"><a href="namespacew3adatmd.html#a40321cbf97d9ff690b041ed4c5866b71">w3adatmd::iadata</a></div><div class="ttdeci">integer iadata</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00374">w3adatmd.F90:374</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a6ce31197926cd11c3696617a44407616"><div class="ttname"><a href="namespacew3idatmd.html#a6ce31197926cd11c3696617a44407616">w3idatmd::gan</a></div><div class="ttdeci">real, pointer gan</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00242">w3idatmd.F90:242</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html"><div class="ttname"><a href="namespacew3updtmd.html">w3updtmd</a></div><div class="ttdoc">Bundles all input updating routines for WAVEWATCH III.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l00022">w3updtmd.F90:22</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a91e6f2e680d6b6e615a4eb6828182bf6"><div class="ttname"><a href="namespacew3wdatmd.html#a91e6f2e680d6b6e615a4eb6828182bf6">w3wdatmd::time</a></div><div class="ttdeci">integer, dimension(:), pointer time</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a07dcce783dd8aed189a74a7347570df8"><div class="ttname"><a href="namespacew3adatmd.html#a07dcce783dd8aed189a74a7347570df8">w3adatmd::tauocy</a></div><div class="ttdeci">real, dimension(:), pointer tauocy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_af26b24a4c6da8cdb20568a2883599969"><div class="ttname"><a href="namespacew3odatmd.html#af26b24a4c6da8cdb20568a2883599969">w3odatmd::irqpo1</a></div><div class="ttdeci">integer, dimension(:), pointer irqpo1</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00490">w3odatmd.F90:490</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a84217f6f8c1bd90696eb220db08af4c6"><div class="ttname"><a href="namespacew3idatmd.html#a84217f6f8c1bd90696eb220db08af4c6">w3idatmd::flic4</a></div><div class="ttdeci">logical, pointer flic4</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00264">w3idatmd.F90:264</a></div></div>
<div class="ttc" id="anamespaceconstants_html_aff31fa8129f4d628c35a514371b1be19"><div class="ttname"><a href="namespaceconstants.html#aff31fa8129f4d628c35a514371b1be19">constants::srce_imp_post</a></div><div class="ttdeci">integer, parameter srce_imp_post</div><div class="ttdoc">srce_imp_post</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00097">constants.F90:97</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_ace014a54222141d85f417972cd4dd60d"><div class="ttname"><a href="namespacew3updtmd.html#ace014a54222141d85f417972cd4dd60d">w3updtmd::w3ubpt</a></div><div class="ttdeci">subroutine w3ubpt</div><div class="ttdoc">Update spectra at the active boundary points.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l01314">w3updtmd.F90:1314</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a4a12f6a80542f3f220bbd5ad2ac9057f"><div class="ttname"><a href="namespacew3gdatmd.html#a4a12f6a80542f3f220bbd5ad2ac9057f">w3gdatmd::ny</a></div><div class="ttdeci">integer, pointer ny</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01097">w3gdatmd.F90:1097</a></div></div>
<div class="ttc" id="anamespaceyownodepool_html_aeb9586089a351e66fced1e5fa617e2ec"><div class="ttname"><a href="namespaceyownodepool.html#aeb9586089a351e66fced1e5fa617e2ec">yownodepool::iplg</a></div><div class="ttdeci">integer, dimension(:), allocatable, public iplg</div><div class="ttdoc">Node local to global mapping.</div><div class="ttdef"><b>Definition:</b> <a href="yownodepool_8F90_source.html#l00116">yownodepool.F90:116</a></div></div>
<div class="ttc" id="anamespacew3srcemd_html_a1eba2fe496738bdd2aee6e835d064045"><div class="ttname"><a href="namespacew3srcemd.html#a1eba2fe496738bdd2aee6e835d064045">w3srcemd::w3srce</a></div><div class="ttdeci">subroutine w3srce(srce_call, IT, ISEA, JSEA, IX, IY, IMOD, SPECOLD, SPEC, VSIO, VDIO, SHAVEIO, ALPHA, WN1, CG1, CLATSL, D_INP, U10ABS, U10DIR, ifdef W3_FLX5</div><div class="ttdoc">Calculate and integrate source terms for a single grid point.</div><div class="ttdef"><b>Definition:</b> <a href="w3srcemd_8F90_source.html#l00195">w3srcemd.F90:195</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a6fe933a63abaaed11d4e7c61c9ecd8c2"><div class="ttname"><a href="namespacew3odatmd.html#a6fe933a63abaaed11d4e7c61c9ecd8c2">w3odatmd::tbpin</a></div><div class="ttdeci">integer, dimension(:), pointer tbpin</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ab445dafdaf1059fda1bf2968429d7f25"><div class="ttname"><a href="namespacew3idatmd.html#ab445dafdaf1059fda1bf2968429d7f25">w3idatmd::tg0</a></div><div class="ttdeci">integer, dimension(:), pointer tg0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a650e9a3dbdf70196bf427799a16564c1"><div class="ttname"><a href="namespacew3gdatmd.html#a650e9a3dbdf70196bf427799a16564c1">w3gdatmd::iclbac</a></div><div class="ttdeci">integer, dimension(:), pointer iclbac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01171">w3gdatmd.F90:1171</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a581fbacd6df17da34ac6eae6a2dd9298"><div class="ttname"><a href="namespacew3adatmd.html#a581fbacd6df17da34ac6eae6a2dd9298">w3adatmd::iappro</a></div><div class="ttdeci">integer, dimension(:), pointer iappro</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00674">w3adatmd.F90:674</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a2324653ee9eefd860fe277dc83c8e073"><div class="ttname"><a href="namespacew3gdatmd.html#a2324653ee9eefd860fe277dc83c8e073">w3gdatmd::fssource</a></div><div class="ttdeci">logical, pointer fssource</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01406">w3gdatmd.F90:1406</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a83178e31a5472cd0f4e837ab64e9c16f"><div class="ttname"><a href="namespacew3odatmd.html#a83178e31a5472cd0f4e837ab64e9c16f">w3odatmd::ioutp</a></div><div class="ttdeci">integer ioutp</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00321">w3odatmd.F90:321</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a1f30ee4349738120d2f73c56f6ea2923"><div class="ttname"><a href="namespacew3gdatmd.html#a1f30ee4349738120d2f73c56f6ea2923">w3gdatmd::iobp_loc</a></div><div class="ttdeci">integer *2, dimension(:), pointer iobp_loc</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01117">w3gdatmd.F90:1117</a></div></div>
<div class="ttc" id="anamespaceyownodepool_html_ab77f5a6052a07d32d3f2debc49086fdc"><div class="ttname"><a href="namespaceyownodepool.html#ab77f5a6052a07d32d3f2debc49086fdc">yownodepool::npa</a></div><div class="ttdeci">integer, public npa</div><div class="ttdoc">number of ghost + resident nodes this partition holds</div><div class="ttdef"><b>Definition:</b> <a href="yownodepool_8F90_source.html#l00099">yownodepool.F90:99</a></div></div>
<div class="ttc" id="anamespacew3sic3md_html_a30512b9b491d5dffe72a182e0bc04de8"><div class="ttname"><a href="namespacew3sic3md.html#a30512b9b491d5dffe72a182e0bc04de8">w3sic3md::calledic3table</a></div><div class="ttdeci">integer, save calledic3table</div><div class="ttdef"><b>Definition:</b> <a href="w3sic3md_8F90_source.html#l00088">w3sic3md.F90:88</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a39d5d567aa1a036c1863ced7728f1105"><div class="ttname"><a href="namespacew3odatmd.html#a39d5d567aa1a036c1863ced7728f1105">w3odatmd::flbpi</a></div><div class="ttdeci">logical, pointer flbpi</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00546">w3odatmd.F90:546</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a26efd8bf935279cb1bc2b2dfd68f39b1"><div class="ttname"><a href="namespacew3wdatmd.html#a26efd8bf935279cb1bc2b2dfd68f39b1">w3wdatmd::va</a></div><div class="ttdeci">real, dimension(:,:), pointer va</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ae03d5d6e45e60d9f331592664b703b19"><div class="ttname"><a href="namespacew3idatmd.html#ae03d5d6e45e60d9f331592664b703b19">w3idatmd::flcur</a></div><div class="ttdeci">logical, pointer flcur</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3iobcmd_html_a019a5e37867ef70ddb68edd47abb01ce"><div class="ttname"><a href="namespacew3iobcmd.html#a019a5e37867ef70ddb68edd47abb01ce">w3iobcmd::w3iobc</a></div><div class="ttdeci">subroutine w3iobc(INXOUT, NDSB, TIME1, TIME2, IOTST, IMOD)</div><div class="ttdoc">Write/read boundary conditions file(s).</div><div class="ttdef"><b>Definition:</b> <a href="w3iobcmd_8F90_source.html#l00099">w3iobcmd.F90:99</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_acfc04add9f8cdb195bff72bc1330b041"><div class="ttname"><a href="namespacew3odatmd.html#acfc04add9f8cdb195bff72bc1330b041">w3odatmd::napbpt</a></div><div class="ttdeci">integer, pointer napbpt</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a678edbd1a5e1a8efb55658b63d46e7f2"><div class="ttname"><a href="namespacew3adatmd.html#a678edbd1a5e1a8efb55658b63d46e7f2">w3adatmd::tauwix</a></div><div class="ttdeci">real, dimension(:), pointer tauwix</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a7f2151c09ba8cc1cc43838f3a99e6be2"><div class="ttname"><a href="namespacew3idatmd.html#a7f2151c09ba8cc1cc43838f3a99e6be2">w3idatmd::tu0</a></div><div class="ttdeci">integer, dimension(:), pointer tu0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a3079307963b24f5148c3363572308f88"><div class="ttname"><a href="namespacew3gdatmd.html#a3079307963b24f5148c3363572308f88">w3gdatmd::spcbac</a></div><div class="ttdeci">real, dimension(:,:), pointer spcbac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01204">w3gdatmd.F90:1204</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_a72384e08e3a5a05766bafc9c2ad74d6a"><div class="ttname"><a href="namespacew3updtmd.html#a72384e08e3a5a05766bafc9c2ad74d6a">w3updtmd::w3ulev</a></div><div class="ttdeci">subroutine w3ulev(A, VA)</div><div class="ttdoc">Update the water level.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l02013">w3updtmd.F90:2013</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_aea7af2b5e78ec678af5ff29f531d4075"><div class="ttname"><a href="namespacew3adatmd.html#aea7af2b5e78ec678af5ff29f531d4075">w3adatmd::dcydx</a></div><div class="ttdeci">real, dimension(:,:), pointer dcydx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00627">w3adatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3pro3md_html"><div class="ttname"><a href="namespacew3pro3md.html">w3pro3md</a></div><div class="ttdoc">Bundles routines for third order propagation scheme in single module.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro3md_8F90_source.html#l00023">w3pro3md.F90:23</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ad0202e8b0d4d789838ffaf63de3be312"><div class="ttname"><a href="namespacew3gdatmd.html#ad0202e8b0d4d789838ffaf63de3be312">w3gdatmd::hqfac</a></div><div class="ttdeci">real, dimension(:,:), pointer hqfac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01212">w3gdatmd.F90:1212</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a1ab605165ff755c6c378199958590018"><div class="ttname"><a href="namespacew3wdatmd.html#a1ab605165ff755c6c378199958590018">w3wdatmd::tlev</a></div><div class="ttdeci">integer, dimension(:), pointer tlev</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ae8baca0b90b2c23f25933a57f86dd6a5"><div class="ttname"><a href="namespacew3idatmd.html#ae8baca0b90b2c23f25933a57f86dd6a5">w3idatmd::flic5</a></div><div class="ttdeci">logical, pointer flic5</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00264">w3idatmd.F90:264</a></div></div>
<div class="ttc" id="anamespacew3igcmmd_html_a5cb75732015e4fc711d470dc75f1a206"><div class="ttname"><a href="namespacew3igcmmd.html#a5cb75732015e4fc711d470dc75f1a206">w3igcmmd::snd_fields_to_ice</a></div><div class="ttdeci">subroutine, public snd_fields_to_ice()</div><div class="ttdoc">Send coupling fields to ice model.</div><div class="ttdef"><b>Definition:</b> <a href="w3igcmmd_8F90_source.html#l00077">w3igcmmd.F90:77</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a34675c0b462ef817c553220b95d22d85"><div class="ttname"><a href="namespacew3gdatmd.html#a34675c0b462ef817c553220b95d22d85">w3gdatmd::nglo</a></div><div class="ttdeci">integer, pointer nglo</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01168">w3gdatmd.F90:1168</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a85874d43058e50547ab59d1f6fdc21c2"><div class="ttname"><a href="namespacew3gdatmd.html#a85874d43058e50547ab59d1f6fdc21c2">w3gdatmd::w3setg</a></div><div class="ttdeci">subroutine w3setg(IMOD, NDSE, NDST)</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l02152">w3gdatmd.F90:2152</a></div></div>
<div class="ttc" id="anamespacew3pro1md_html"><div class="ttname"><a href="namespacew3pro1md.html">w3pro1md</a></div><div class="ttdoc">Bundles routines for first order propagation scheme in single module.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro1md_8F90_source.html#l00023">w3pro1md.F90:23</a></div></div>
<div class="ttc" id="anamespacew3pro2md_html"><div class="ttname"><a href="namespacew3pro2md.html">w3pro2md</a></div><div class="ttdoc">Bundles routines for third order porpagation scheme in single module.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro2md_8F90_source.html#l00024">w3pro2md.F90:24</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a0851078625aaed8195c185821c599411"><div class="ttname"><a href="namespacew3servmd.html#a0851078625aaed8195c185821c599411">w3servmd::w3acturn</a></div><div class="ttdeci">subroutine w3acturn(NDirc, NFreq, Alpha, Spectr)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00977">w3servmd.F90:977</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a9e21a5411799a5e9c496f94a98f8a8f1"><div class="ttname"><a href="namespacew3adatmd.html#a9e21a5411799a5e9c496f94a98f8a8f1">w3adatmd::tauwiy</a></div><div class="ttdeci">real, dimension(:), pointer tauwiy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ad20a49e2cabde21aa37a22ea87f2cbdb"><div class="ttname"><a href="namespacew3adatmd.html#ad20a49e2cabde21aa37a22ea87f2cbdb">w3adatmd::taubbl</a></div><div class="ttdeci">real, dimension(:,:), pointer taubbl</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00614">w3adatmd.F90:614</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a4ff12f04b0c56a558d749b1cfed9837c"><div class="ttname"><a href="namespacew3servmd.html#a4ff12f04b0c56a558d749b1cfed9837c">w3servmd::wwtime</a></div><div class="ttdeci">subroutine wwtime(STRNG)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00664">w3servmd.F90:664</a></div></div>
<div class="ttc" id="anamespacescrip__timers_html_a13e5d8b1f71ebc95443c31da01c7d687"><div class="ttname"><a href="namespacescrip__timers.html#a13e5d8b1f71ebc95443c31da01c7d687">scrip_timers::status</a></div><div class="ttdeci">character(len=8), dimension(max_timers), save status</div><div class="ttdef"><b>Definition:</b> <a href="scrip__timers_8f_source.html#l00063">scrip_timers.f:63</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a2e5aeb0943bf5031dc1f9552e5159290"><div class="ttname"><a href="namespacew3odatmd.html#a2e5aeb0943bf5031dc1f9552e5159290">w3odatmd::ndse</a></div><div class="ttdeci">integer, pointer ndse</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a4c5b7b938201316f96216714e8aa5da5"><div class="ttname"><a href="namespacew3wdatmd.html#a4c5b7b938201316f96216714e8aa5da5">w3wdatmd::berg</a></div><div class="ttdeci">real, dimension(:), pointer berg</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ab2c0f2e6e7524fb061d841ba7a7324a1"><div class="ttname"><a href="namespacew3adatmd.html#ab2c0f2e6e7524fb061d841ba7a7324a1">w3adatmd::w3seta</a></div><div class="ttdeci">subroutine w3seta(IMOD, NDSE, NDST)</div><div class="ttdoc">Select one of the WAVEWATCH III grids / models.</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l02645">w3adatmd.F90:2645</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a3d8350daaed64832e6d59d70965a034b"><div class="ttname"><a href="namespacew3adatmd.html#a3d8350daaed64832e6d59d70965a034b">w3adatmd::tauwny</a></div><div class="ttdeci">real, dimension(:), pointer tauwny</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a7382f3e82edb48fd3b166eec7476997d"><div class="ttname"><a href="namespacew3gdatmd.html#a7382f3e82edb48fd3b166eec7476997d">w3gdatmd::rstype</a></div><div class="ttdeci">integer, pointer rstype</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01095">w3gdatmd.F90:1095</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aab61e99d161fc0c2bca0cde5c4c975ee"><div class="ttname"><a href="namespacew3gdatmd.html#aab61e99d161fc0c2bca0cde5c4c975ee">w3gdatmd::mapfs</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapfs</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01163">w3gdatmd.F90:1163</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a7ef077701293c27bbb6c4ad7d7377975"><div class="ttname"><a href="namespacew3odatmd.html#a7ef077701293c27bbb6c4ad7d7377975">w3odatmd::tonext</a></div><div class="ttdeci">integer, dimension(:,:), pointer tonext</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a6f229c5cdeb68cf99a791a112772b0df"><div class="ttname"><a href="namespacew3idatmd.html#a6f229c5cdeb68cf99a791a112772b0df">w3idatmd::fllev</a></div><div class="ttdeci">logical, pointer fllev</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ad662a4598657ac9a833ab5babfe6d819"><div class="ttname"><a href="namespacew3adatmd.html#ad662a4598657ac9a833ab5babfe6d819">w3adatmd::dcdy</a></div><div class="ttdeci">real, dimension(:,:,:), pointer dcdy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00629">w3adatmd.F90:629</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ad8349dc3d81fccb0311084ccecfe6f49"><div class="ttname"><a href="namespacew3odatmd.html#ad8349dc3d81fccb0311084ccecfe6f49">w3odatmd::naperr</a></div><div class="ttdeci">integer, pointer naperr</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a8b59b4d408269981d91de0eea81fd951"><div class="ttname"><a href="namespacew3odatmd.html#a8b59b4d408269981d91de0eea81fd951">w3odatmd::stop</a></div><div class="ttdeci">logical, pointer stop</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00515">w3odatmd.F90:515</a></div></div>
<div class="ttc" id="anamespacew3sic3md_html_aa47c09ce75e4fb6cec196b92d4a4d49f"><div class="ttname"><a href="namespacew3sic3md.html#aa47c09ce75e4fb6cec196b92d4a4d49f">w3sic3md::ic3table_cheng</a></div><div class="ttdeci">subroutine, public ic3table_cheng(ICE2, ICE3, ICE4)</div><div class="ttdef"><b>Definition:</b> <a href="w3sic3md_8F90_source.html#l01963">w3sic3md.F90:1963</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a365e54d83b1e2d7d446a6c573c4442fe"><div class="ttname"><a href="namespacew3adatmd.html#a365e54d83b1e2d7d446a6c573c4442fe">w3adatmd::phiaw</a></div><div class="ttdeci">real, dimension(:), pointer phiaw</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3iotrmd_html_ab4cac641972a06fdf42200a925032397"><div class="ttname"><a href="namespacew3iotrmd.html#ab4cac641972a06fdf42200a925032397">w3iotrmd::w3iotr</a></div><div class="ttdeci">subroutine w3iotr(NDSINP, NDSOUT, A, IMOD)</div><div class="ttdoc">Perform output of spectral information along provided tracks.</div><div class="ttdef"><b>Definition:</b> <a href="w3iotrmd_8F90_source.html#l00105">w3iotrmd.F90:105</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a7a54c117c225ecac6c2bd3f41eb14f68"><div class="ttname"><a href="namespacew3wdatmd.html#a7a54c117c225ecac6c2bd3f41eb14f68">w3wdatmd::vdtot</a></div><div class="ttdeci">real, dimension(:,:), pointer vdtot</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00191">w3wdatmd.F90:191</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_aee58911c6e89169fec3a6fe601c4344e"><div class="ttname"><a href="namespacew3adatmd.html#aee58911c6e89169fec3a6fe601c4344e">w3adatmd::phibbl</a></div><div class="ttdeci">real, dimension(:), pointer phibbl</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00614">w3adatmd.F90:614</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ada1d468125fb69652e0f1a3e872683cd"><div class="ttname"><a href="namespacew3adatmd.html#ada1d468125fb69652e0f1a3e872683cd">w3adatmd::mpibuf</a></div><div class="ttdeci">integer, parameter mpibuf</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00376">w3adatmd.F90:376</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a466f03db630a1aaa5437b8c30c2722a3"><div class="ttname"><a href="namespacew3gdatmd.html#a466f03db630a1aaa5437b8c30c2722a3">w3gdatmd::refld</a></div><div class="ttdeci">integer, dimension(:,:), pointer refld</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01102">w3gdatmd.F90:1102</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a3a9e8350eb31a71dd85af858ca7d97bd"><div class="ttname"><a href="namespacew3gdatmd.html#a3a9e8350eb31a71dd85af858ca7d97bd">w3gdatmd::sed_psic</a></div><div class="ttdeci">real, dimension(:), pointer sed_psic</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01214">w3gdatmd.F90:1214</a></div></div>
<div class="ttc" id="anamespacew3parall_html_a73c588d37e952e093a55352ad8a56754"><div class="ttname"><a href="namespacew3parall.html#a73c588d37e952e093a55352ad8a56754">w3parall::pdlib_nsealm</a></div><div class="ttdeci">integer pdlib_nsealm</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l00082">w3parall.F90:82</a></div></div>
<div class="ttc" id="anamespacew3agcmmd_html_a0771a75b5e4498340cc6591ebfe1c9a8"><div class="ttname"><a href="namespacew3agcmmd.html#a0771a75b5e4498340cc6591ebfe1c9a8">w3agcmmd::snd_fields_to_atmos</a></div><div class="ttdeci">subroutine, public snd_fields_to_atmos()</div><div class="ttdoc">Send coupling fields to atmospheric model.</div><div class="ttdef"><b>Definition:</b> <a href="w3agcmmd_8F90_source.html#l00089">w3agcmmd.F90:89</a></div></div>
<div class="ttc" id="anamespaceyownodepool_html"><div class="ttname"><a href="namespaceyownodepool.html">yownodepool</a></div><div class="ttdoc">Has data that belong to nodes.</div><div class="ttdef"><b>Definition:</b> <a href="yownodepool_8F90_source.html#l00039">yownodepool.F90:39</a></div></div>
<div class="ttc" id="anamespaceconstants_html_ad8b244917fc2f2b94d397086522af7a1"><div class="ttname"><a href="namespaceconstants.html#ad8b244917fc2f2b94d397086522af7a1">constants::lpdlib</a></div><div class="ttdeci">logical lpdlib</div><div class="ttdoc">LPDLIB Logical for using the PDLIB library.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00101">constants.F90:101</a></div></div>
<div class="ttc" id="anamespacepdlib__field__vec_html_aaefa22a0d64dcc21acbe49d8e1f27734"><div class="ttname"><a href="namespacepdlib__field__vec.html#aaefa22a0d64dcc21acbe49d8e1f27734">pdlib_field_vec::do_output_exchanges</a></div><div class="ttdeci">subroutine do_output_exchanges(IMOD)</div><div class="ttdef"><b>Definition:</b> <a href="pdlib__field__vec_8F90_source.html#l00787">pdlib_field_vec.F90:787</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a2472f8af7829f731ec1a0f6506005b59"><div class="ttname"><a href="namespacew3adatmd.html#a2472f8af7829f731ec1a0f6506005b59">w3adatmd::cflthmax</a></div><div class="ttdeci">real, dimension(:), pointer cflthmax</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00620">w3adatmd.F90:620</a></div></div>
<div class="ttc" id="anamespacew3pro3md_html_aabe1620330467de15ca418ae8c5c2508"><div class="ttname"><a href="namespacew3pro3md.html#aabe1620330467de15ca418ae8c5c2508">w3pro3md::w3cflxy</a></div><div class="ttdeci">subroutine w3cflxy(ISEA, DTG, MAPSTA, MAPFS, CFLXYMAX, VGX, VGY)</div><div class="ttdoc">Computes the maximum CFL number for spatial advection.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro3md_8F90_source.html#l01971">w3pro3md.F90:1971</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adfe669e78e9532f40ba6888dabf3c208"><div class="ttname"><a href="namespacew3gdatmd.html#adfe669e78e9532f40ba6888dabf3c208">w3gdatmd::nsea</a></div><div class="ttdeci">integer, pointer nsea</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01097">w3gdatmd.F90:1097</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a063c55199a8786edf383f3c6359108f2"><div class="ttname"><a href="namespacew3gdatmd.html#a063c55199a8786edf383f3c6359108f2">w3gdatmd::clgtype</a></div><div class="ttdeci">integer, parameter clgtype</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00625">w3gdatmd.F90:625</a></div></div>
<div class="ttc" id="anamespacew3servmd_html"><div class="ttname"><a href="namespacew3servmd.html">w3servmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00003">w3servmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a696380e75dd4fa693f8fbf438600a06e"><div class="ttname"><a href="namespacew3wdatmd.html#a696380e75dd4fa693f8fbf438600a06e">w3wdatmd::vstot</a></div><div class="ttdeci">real, dimension(:,:), pointer vstot</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00191">w3wdatmd.F90:191</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a413b7df61021527a9bf03402ef18f720"><div class="ttname"><a href="namespacew3adatmd.html#a413b7df61021527a9bf03402ef18f720">w3adatmd::dcxdx</a></div><div class="ttdeci">real, dimension(:,:), pointer dcxdx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00627">w3adatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a720da8acfb369bb59c63e6cd20bb7015"><div class="ttname"><a href="namespacew3odatmd.html#a720da8acfb369bb59c63e6cd20bb7015">w3odatmd::flogrd</a></div><div class="ttdeci">logical, dimension(:,:), pointer flogrd</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00478">w3odatmd.F90:478</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a5442839e64fe6e007c3e465344e562a6"><div class="ttname"><a href="namespacew3odatmd.html#a5442839e64fe6e007c3e465344e562a6">w3odatmd::naplog</a></div><div class="ttdeci">integer, pointer naplog</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_ab69e9d8da2213bbdab66cbdb3b60badc"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#ab69e9d8da2213bbdab66cbdb3b60badc">pdlib_w3profsmd::all_vaold_integral_print</a></div><div class="ttdeci">subroutine all_vaold_integral_print(string, choice)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l02220">w3profsmd_pdlib.F90:2220</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a03d3f63e3189fe1b637898b707a19824"><div class="ttname"><a href="namespacew3adatmd.html#a03d3f63e3189fe1b637898b707a19824">w3adatmd::bedforms</a></div><div class="ttdeci">real, dimension(:,:), pointer bedforms</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00614">w3adatmd.F90:614</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a95c4c90a667b622273c7c5a734fa4d8b"><div class="ttname"><a href="namespacew3gdatmd.html#a95c4c90a667b622273c7c5a734fa4d8b">w3gdatmd::nbac</a></div><div class="ttdeci">integer, pointer nbac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01168">w3gdatmd.F90:1168</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a3996a3e8c926f774b969de60786d957d"><div class="ttname"><a href="namespacew3timemd.html#a3996a3e8c926f774b969de60786d957d">w3timemd::tick21</a></div><div class="ttdeci">subroutine tick21(TIME, DTIME)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00084">w3timemd.F90:84</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_aecc5543cbd995a96c37e0836f9c69e3c"><div class="ttname"><a href="namespacew3wdatmd.html#aecc5543cbd995a96c37e0836f9c69e3c">w3wdatmd::tic1</a></div><div class="ttdeci">integer, dimension(:), pointer tic1</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_a54ee1b549a62a0f752ae0c0a5b6cf7e8"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#a54ee1b549a62a0f752ae0c0a5b6cf7e8">pdlib_w3profsmd::pdlib_w3xypug</a></div><div class="ttdeci">subroutine pdlib_w3xypug(ISP, FACX, FACY, DTG, VGX, VGY, LCALC)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l00632">w3profsmd_pdlib.F90:632</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_ac0bd6dc2f0effae7dce2f111cde16802"><div class="ttname"><a href="namespacew3wdatmd.html#ac0bd6dc2f0effae7dce2f111cde16802">w3wdatmd::w3setw</a></div><div class="ttdeci">subroutine w3setw(IMOD, NDSE, NDST)</div><div class="ttdoc">Select one of the WAVEWATCH III grids / models.</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00660">w3wdatmd.F90:660</a></div></div>
<div class="ttc" id="anamespacew3ogcmmd_html"><div class="ttname"><a href="namespacew3ogcmmd.html">w3ogcmmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3ogcmmd_8F90_source.html#l00003">w3ogcmmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a921ed1ae97819563ed92448ff8498cfe"><div class="ttname"><a href="namespacew3odatmd.html#a921ed1ae97819563ed92448ff8498cfe">w3odatmd::noge</a></div><div class="ttdeci">integer, dimension(nogrp) noge</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00326">w3odatmd.F90:326</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ac7c512a398f6dca9c750cb6214acb1ad"><div class="ttname"><a href="namespacew3adatmd.html#ac7c512a398f6dca9c750cb6214acb1ad">w3adatmd::irqsg1</a></div><div class="ttdeci">integer, dimension(:,:), pointer irqsg1</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00681">w3adatmd.F90:681</a></div></div>
<div class="ttc" id="anamespaceconstants_html_ab81445207bb044b4a638d50ecf4470e5"><div class="ttname"><a href="namespaceconstants.html#ab81445207bb044b4a638d50ecf4470e5">constants::tpiinv</a></div><div class="ttdeci">real, parameter tpiinv</div><div class="ttdoc">TPIINV Inverse of 2*Pi.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00074">constants.F90:74</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a716896b5b8b01a026c8bc64c26fbe861"><div class="ttname"><a href="namespacew3odatmd.html#a716896b5b8b01a026c8bc64c26fbe861">w3odatmd::irqbp1</a></div><div class="ttdeci">integer, dimension(:), pointer irqbp1</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00538">w3odatmd.F90:538</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a40de4775d7cb1e739098ef04139a6019"><div class="ttname"><a href="namespacew3odatmd.html#a40de4775d7cb1e739098ef04139a6019">w3odatmd::w3seto</a></div><div class="ttdeci">subroutine w3seto(IMOD, NDSERR, NDSTST)</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l01523">w3odatmd.F90:1523</a></div></div>
<div class="ttc" id="anamespacew3timemd_html_a86ec2ee307c805e375e36c1d28ab2dbb"><div class="ttname"><a href="namespacew3timemd.html#a86ec2ee307c805e375e36c1d28ab2dbb">w3timemd::stme21</a></div><div class="ttdeci">subroutine stme21(TIME, DTME21)</div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00682">w3timemd.F90:682</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a7a276711653fc12363b32b4e056ae532"><div class="ttname"><a href="namespacew3servmd.html#a7a276711653fc12363b32b4e056ae532">w3servmd::print_memcheck</a></div><div class="ttdeci">subroutine print_memcheck(iun, msg)</div><div class="ttdoc">Write memory statistics if requested.</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l02033">w3servmd.F90:2033</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a846808e0efa51a39c1f1d78f308bcab3"><div class="ttname"><a href="namespacew3adatmd.html#a846808e0efa51a39c1f1d78f308bcab3">w3adatmd::gstore</a></div><div class="ttdeci">real, dimension(:,:), pointer gstore</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00682">w3adatmd.F90:682</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a890a58325991ff8ffb0eaaed7c7a5b2e"><div class="ttname"><a href="namespacew3adatmd.html#a890a58325991ff8ffb0eaaed7c7a5b2e">w3adatmd::tauwnx</a></div><div class="ttdeci">real, dimension(:), pointer tauwnx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a3da4213bb3b6a7340de1053d4e8f02a5"><div class="ttname"><a href="namespacew3idatmd.html#a3da4213bb3b6a7340de1053d4e8f02a5">w3idatmd::flic2</a></div><div class="ttdeci">logical, pointer flic2</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00264">w3idatmd.F90:264</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a2f49fab96f67af285b8ccd46e2439294"><div class="ttname"><a href="namespacew3adatmd.html#a2f49fab96f67af285b8ccd46e2439294">w3adatmd::alpha</a></div><div class="ttdeci">real, dimension(:,:), pointer alpha</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00687">w3adatmd.F90:687</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a61494bd0f5e2421669fd4442b1517bbe"><div class="ttname"><a href="namespacew3servmd.html#a61494bd0f5e2421669fd4442b1517bbe">w3servmd::ssort1</a></div><div class="ttdeci">subroutine ssort1(X, Y, N, KFLAG)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l01518">w3servmd.F90:1518</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a52768c6ed6f8d86daccb2c8454bb3cb4"><div class="ttname"><a href="namespacew3gdatmd.html#a52768c6ed6f8d86daccb2c8454bb3cb4">w3gdatmd::flcth</a></div><div class="ttdeci">logical, pointer flcth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3profsmd_html_a3f27659e77da56d3ce04e92336cf1e1a"><div class="ttname"><a href="namespacew3profsmd.html#a3f27659e77da56d3ce04e92336cf1e1a">w3profsmd::w3xypug</a></div><div class="ttdeci">subroutine w3xypug(ISP, FACX, FACY, DTG, VQ, VGX, VGY, LCALC)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd_8F90_source.html#l00063">w3profsmd.F90:63</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_acd2df21b8b595f4f5d2d22f0a4e4e9b3"><div class="ttname"><a href="namespacew3gdatmd.html#acd2df21b8b595f4f5d2d22f0a4e4e9b3">w3gdatmd::nth</a></div><div class="ttdeci">integer, pointer nth</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01230">w3gdatmd.F90:1230</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a34e33a3956adbd1ec3097c91a454f18c"><div class="ttname"><a href="namespacew3idatmd.html#a34e33a3956adbd1ec3097c91a454f18c">w3idatmd::flic3</a></div><div class="ttdeci">logical, pointer flic3</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00264">w3idatmd.F90:264</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html"><div class="ttname"><a href="namespacew3odatmd.html">w3odatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00003">w3odatmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3oacpmd_html"><div class="ttname"><a href="namespacew3oacpmd.html">w3oacpmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3oacpmd_8F90_source.html#l00003">w3oacpmd.F90:3</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ad5d577b4482b907d086bfcfb4dff7312"><div class="ttname"><a href="namespacew3adatmd.html#ad5d577b4482b907d086bfcfb4dff7312">w3adatmd::dddy</a></div><div class="ttdeci">real, dimension(:,:), pointer dddy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00627">w3adatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aad204763c51cb0df15891498f423285b"><div class="ttname"><a href="namespacew3gdatmd.html#aad204763c51cb0df15891498f423285b">w3gdatmd::clats</a></div><div class="ttdeci">real, dimension(:), pointer clats</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01196">w3gdatmd.F90:1196</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ac0554636f2c325ce03b75bdf4f2d5e50"><div class="ttname"><a href="namespacew3idatmd.html#ac0554636f2c325ce03b75bdf4f2d5e50">w3idatmd::iidata</a></div><div class="ttdeci">integer iidata</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00160">w3idatmd.F90:160</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a3aac70fa6eada42919e22a65be5a9170"><div class="ttname"><a href="namespacew3odatmd.html#a3aac70fa6eada42919e22a65be5a9170">w3odatmd::irqgo2</a></div><div class="ttdeci">integer, dimension(:), pointer irqgo2</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00476">w3odatmd.F90:476</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a22d25387c040ce7d3410bbb81e2b7aba"><div class="ttname"><a href="namespacew3odatmd.html#a22d25387c040ce7d3410bbb81e2b7aba">w3odatmd::nds</a></div><div class="ttdeci">integer, dimension(:), pointer nds</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_a80aecdb3367ca9330f8e9fcf630f249b"><div class="ttname"><a href="namespacew3updtmd.html#a80aecdb3367ca9330f8e9fcf630f249b">w3updtmd::w3uice</a></div><div class="ttdeci">subroutine w3uice(VA)</div><div class="ttdoc">Update ice map in the wave model.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l01756">w3updtmd.F90:1756</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_afd68f1a9ca145d4d4a0a6bf3c7e22d62"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#afd68f1a9ca145d4d4a0a6bf3c7e22d62">pdlib_w3profsmd::pdlib_w3xypug_block_explicit</a></div><div class="ttdeci">subroutine pdlib_w3xypug_block_explicit(IMOD, FACX, FACY, DTG, VGX, VGY, LCALC)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l02807">w3profsmd_pdlib.F90:2807</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ae1717af7650517c1b0644a3ccd6f31b2"><div class="ttname"><a href="namespacew3adatmd.html#ae1717af7650517c1b0644a3ccd6f31b2">w3adatmd::cy</a></div><div class="ttdeci">real, dimension(:), pointer cy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3srcemd_html"><div class="ttname"><a href="namespacew3srcemd.html">w3srcemd</a></div><div class="ttdoc">Source term integration routine.</div><div class="ttdef"><b>Definition:</b> <a href="w3srcemd_8F90_source.html#l00024">w3srcemd.F90:24</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a8790356422ed442ebe4600878b76907a"><div class="ttname"><a href="namespacew3adatmd.html#a8790356422ed442ebe4600878b76907a">w3adatmd::idlast</a></div><div class="ttdeci">integer, pointer idlast</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00686">w3adatmd.F90:686</a></div></div>
<div class="ttc" id="anamespacew3pro1md_html_a96de654f1927ba56977aa3512de722e5"><div class="ttname"><a href="namespacew3pro1md.html#a96de654f1927ba56977aa3512de722e5">w3pro1md::w3map1</a></div><div class="ttdeci">subroutine w3map1(MAPSTA)</div><div class="ttdoc">Generate 'map' arrays for the first order upstream scheme.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro1md_8F90_source.html#l00108">w3pro1md.F90:108</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a256ca10a028a394f3c7a2f0ca95667f0"><div class="ttname"><a href="namespacew3gdatmd.html#a256ca10a028a394f3c7a2f0ca95667f0">w3gdatmd::flsou</a></div><div class="ttdeci">logical, pointer flsou</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3iobcmd_html"><div class="ttname"><a href="namespacew3iobcmd.html">w3iobcmd</a></div><div class="ttdoc">Processing of boundary data output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iobcmd_8F90_source.html#l00014">w3iobcmd.F90:14</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a3694ddee654a559b4e8d19409c8c8074"><div class="ttname"><a href="namespacew3odatmd.html#a3694ddee654a559b4e8d19409c8c8074">w3odatmd::screen</a></div><div class="ttdeci">integer, pointer screen</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a169cdcb1ad0be4046b70d04720e9075a"><div class="ttname"><a href="namespacew3adatmd.html#a169cdcb1ad0be4046b70d04720e9075a">w3adatmd::taua</a></div><div class="ttdeci">real, dimension(:), pointer taua</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aa599ecb57c894afbc3640fd24e7a5492"><div class="ttname"><a href="namespacew3gdatmd.html#aa599ecb57c894afbc3640fd24e7a5492">w3gdatmd::angarc</a></div><div class="ttdeci">real, dimension(:), pointer angarc</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01204">w3gdatmd.F90:1204</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a811019b8e0198c95c111311b1a36b66d"><div class="ttname"><a href="namespacew3odatmd.html#a811019b8e0198c95c111311b1a36b66d">w3odatmd::tolast</a></div><div class="ttdeci">integer, dimension(:,:), pointer tolast</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_aabf770709d5ddc3608aadc2f72374c1e"><div class="ttname"><a href="namespacew3idatmd.html#aabf770709d5ddc3608aadc2f72374c1e">w3idatmd::gd0</a></div><div class="ttdeci">real, pointer gd0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00242">w3idatmd.F90:242</a></div></div>
<div class="ttc" id="anamespacew3sic3md_html_aac4486692decf3a3d9f1f6e54a6728d1"><div class="ttname"><a href="namespacew3sic3md.html#aac4486692decf3a3d9f1f6e54a6728d1">w3sic3md::w3ic3wncg_cheng</a></div><div class="ttdeci">subroutine, public w3ic3wncg_cheng(WN_R, WN_I, CG, ICE1, ICE2, ICE3, ICE4, DPT)</div><div class="ttdef"><b>Definition:</b> <a href="w3sic3md_8F90_source.html#l01801">w3sic3md.F90:1801</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_a4087dea72336c68afcff08eaeee05ed6"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#a4087dea72336c68afcff08eaeee05ed6">pdlib_w3profsmd::pdlib_w3xypug_block_implicit</a></div><div class="ttdeci">subroutine pdlib_w3xypug_block_implicit(IMOD, FACX, FACY, DTG, VGX, VGY, LCALC)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l02736">w3profsmd_pdlib.F90:2736</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a0749d133d47bf436563c3cfd18a3130f"><div class="ttname"><a href="namespacew3gdatmd.html#a0749d133d47bf436563c3cfd18a3130f">w3gdatmd::mapsf</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapsf</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01163">w3gdatmd.F90:1163</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_abe5a8f2b70d9f709dd356ec593814b70"><div class="ttname"><a href="namespacew3idatmd.html#abe5a8f2b70d9f709dd356ec593814b70">w3idatmd::ti1</a></div><div class="ttdeci">integer, dimension(:), pointer ti1</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a5fb3206737f511149173f90ece6bb54f"><div class="ttname"><a href="namespacew3odatmd.html#a5fb3206737f511149173f90ece6bb54f">w3odatmd::naproc</a></div><div class="ttdeci">integer, pointer naproc</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3parall_html_a795203b1205ca798c62c6aaa05abf4ff"><div class="ttname"><a href="namespacew3parall.html#a795203b1205ca798c62c6aaa05abf4ff">w3parall::print_my_time</a></div><div class="ttdeci">subroutine print_my_time(string)</div><div class="ttdoc">Print timings.</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l00200">w3parall.F90:200</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ab2e24ebfb64255d0fc873c171b8ec169"><div class="ttname"><a href="namespacew3gdatmd.html#ab2e24ebfb64255d0fc873c171b8ec169">w3gdatmd::nbgl</a></div><div class="ttdeci">integer, pointer nbgl</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01168">w3gdatmd.F90:1168</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_af395fc4465c603b1c92b8644e8b168d9"><div class="ttname"><a href="namespacew3gdatmd.html#af395fc4465c603b1c92b8644e8b168d9">w3gdatmd::igrid</a></div><div class="ttdeci">integer igrid</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00618">w3gdatmd.F90:618</a></div></div>
<div class="ttc" id="anamespaceyownodepool_html_a2bfec316a2280fff5c93b744f6e7e77e"><div class="ttname"><a href="namespaceyownodepool.html#a2bfec316a2280fff5c93b744f6e7e77e">yownodepool::np</a></div><div class="ttdeci">integer, public np</div><div class="ttdoc">number of nodes, local</div><div class="ttdef"><b>Definition:</b> <a href="yownodepool_8F90_source.html#l00093">yownodepool.F90:93</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_af9561b789f9f6236ed9560f1fd543a2b"><div class="ttname"><a href="namespacew3adatmd.html#af9561b789f9f6236ed9560f1fd543a2b">w3adatmd::wnmean</a></div><div class="ttdeci">real, dimension(:), pointer wnmean</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00587">w3adatmd.F90:587</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_aad766a34f23e9b3bbce063e2f8b9736f"><div class="ttname"><a href="namespacew3adatmd.html#aad766a34f23e9b3bbce063e2f8b9736f">w3adatmd::cflkmax</a></div><div class="ttdeci">real, dimension(:), pointer cflkmax</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00620">w3adatmd.F90:620</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_abc41ba1527cddde20c95c798e9a3a3d6"><div class="ttname"><a href="namespacew3odatmd.html#abc41ba1527cddde20c95c798e9a3a3d6">w3odatmd::irqbp2</a></div><div class="ttdeci">integer, dimension(:), pointer irqbp2</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00538">w3odatmd.F90:538</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_af5e19c195842dc07f7b05db5f0e81aad"><div class="ttname"><a href="namespacew3adatmd.html#af5e19c195842dc07f7b05db5f0e81aad">w3adatmd::sstore</a></div><div class="ttdeci">real, dimension(:,:), pointer sstore</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00682">w3adatmd.F90:682</a></div></div>
<div class="ttc" id="anamespacew3iogomd_html_ac44ac8e56555154f14a2747c6e61263a"><div class="ttname"><a href="namespacew3iogomd.html#ac44ac8e56555154f14a2747c6e61263a">w3iogomd::w3iogo</a></div><div class="ttdeci">subroutine w3iogo(INXOUT, NDSOG, IOTST, IMOD ifdef W3_ASCII</div><div class="ttdoc">Read/write gridded output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iogomd_8F90_source.html#l02396">w3iogomd.F90:2396</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a0d197238708114cc861c919bb7b0f04f"><div class="ttname"><a href="namespacew3idatmd.html#a0d197238708114cc861c919bb7b0f04f">w3idatmd::w3seti</a></div><div class="ttdeci">subroutine w3seti(IMOD, NDSE, NDST)</div><div class="ttdoc">Select one of the WAVEWATCH III grids / models.</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00819">w3idatmd.F90:819</a></div></div>
<div class="ttc" id="anamespacew3parall_html_aee1ccd850c86a682a087913c5230b24f"><div class="ttname"><a href="namespacew3parall.html#aee1ccd850c86a682a087913c5230b24f">w3parall::pdlib_nseal</a></div><div class="ttdeci">integer pdlib_nseal</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l00082">w3parall.F90:82</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_a37c36b4294153346e7c39c54b2fddf8c"><div class="ttname"><a href="namespacew3updtmd.html#a37c36b4294153346e7c39c54b2fddf8c">w3updtmd::w3uic5</a></div><div class="ttdeci">subroutine w3uic5(FLFRST)</div><div class="ttdoc">Update ice floe mean and max diameters in the wave model.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l01624">w3updtmd.F90:1624</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a44cb2e659c5f016ce0a8da57489d6a67"><div class="ttname"><a href="namespacew3gdatmd.html#a44cb2e659c5f016ce0a8da57489d6a67">w3gdatmd::smctype</a></div><div class="ttdeci">integer, parameter smctype</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00627">w3gdatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a3c7f1ae2338120cabcf04b5ba9869e3c"><div class="ttname"><a href="namespacew3gdatmd.html#a3c7f1ae2338120cabcf04b5ba9869e3c">w3gdatmd::cthg0s</a></div><div class="ttdeci">real, dimension(:), pointer cthg0s</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01198">w3gdatmd.F90:1198</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a4d452918b35b8b72c08389a1993240e0"><div class="ttname"><a href="namespacew3adatmd.html#a4d452918b35b8b72c08389a1993240e0">w3adatmd::phioc</a></div><div class="ttdeci">real, dimension(:), pointer phioc</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="aCMakeLists_8txt_html_a4ab12fe9f35a3436724ef90e0da910d1"><div class="ttname"><a href="CMakeLists_8txt.html#a4ab12fe9f35a3436724ef90e0da910d1">file</a></div><div class="ttdeci">file(STRINGS ${CMAKE_BINARY_DIR}/switch switch_strings) separate_arguments(switches UNIX_COMMAND $</div><div class="ttdef"><b>Definition:</b> <a href="CMakeLists_8txt_source.html#l00003">CMakeLists.txt:3</a></div></div>
<div class="ttc" id="anamespacew3iogrmd_html"><div class="ttname"><a href="namespacew3iogrmd.html">w3iogrmd</a></div><div class="ttdoc">Reading/writing of model definition file.</div><div class="ttdef"><b>Definition:</b> <a href="w3iogrmd_8F90_source.html#l00020">w3iogrmd.F90:20</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a4dceccc29b7e5529102409498706a17f"><div class="ttname"><a href="namespaceconstants.html#a4dceccc29b7e5529102409498706a17f">constants::radius</a></div><div class="ttdeci">real, parameter radius</div><div class="ttdoc">RADIUS Radius of the earth (m).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00079">constants.F90:79</a></div></div>
<div class="ttc" id="anamespacew3iopomd_html_a4ce260ff2acd21d1c3dacd3425b08301"><div class="ttname"><a href="namespacew3iopomd.html#a4ce260ff2acd21d1c3dacd3425b08301">w3iopomd::w3iopon</a></div><div class="ttdeci">subroutine w3iopon(INXOUT, NDSOP, IOTST, IMOD)</div><div class="ttdoc">Read or write the netCDF point output file, depending on the value of the first parameter.</div><div class="ttdef"><b>Definition:</b> <a href="w3iopomd_8F90_source.html#l01747">w3iopomd.F90:1747</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_aefb8afd640481add784340ae8c0adf3d"><div class="ttname"><a href="namespacew3odatmd.html#aefb8afd640481add784340ae8c0adf3d">w3odatmd::nrqrs</a></div><div class="ttdeci">integer, pointer nrqrs</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00523">w3odatmd.F90:523</a></div></div>
<div class="ttc" id="anamespacew3wavset_html_ae485fd028484633bed078aef2bfed499"><div class="ttname"><a href="namespacew3wavset.html#ae485fd028484633bed078aef2bfed499">w3wavset::wave_setup_computation</a></div><div class="ttdeci">subroutine wave_setup_computation</div><div class="ttdoc">General driver.</div><div class="ttdef"><b>Definition:</b> <a href="w3wavset_8F90_source.html#l03075">w3wavset.F90:3075</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a2087a76dd0ef641047dfa5788f9833fd"><div class="ttname"><a href="namespacew3adatmd.html#a2087a76dd0ef641047dfa5788f9833fd">w3adatmd::wn</a></div><div class="ttdeci">real, dimension(:,:), pointer wn</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00575">w3adatmd.F90:575</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_af512f4f684985cd9e281d986e72a5d57"><div class="ttname"><a href="namespacew3updtmd.html#af512f4f684985cd9e281d986e72a5d57">w3updtmd::w3dzxy</a></div><div class="ttdeci">subroutine w3dzxy(ZZ, ZUNIT, DZZDX, DZZDY)</div><div class="ttdoc">Calculate derivatives of a field.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l03139">w3updtmd.F90:3139</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a462275896cfb782abf4f540a9b3df157"><div class="ttname"><a href="namespacew3adatmd.html#a462275896cfb782abf4f540a9b3df157">w3adatmd::u10</a></div><div class="ttdeci">real, dimension(:), pointer u10</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a9c8d9683b5bbc9081fbf10995a834ee6"><div class="ttname"><a href="namespacew3gdatmd.html#a9c8d9683b5bbc9081fbf10995a834ee6">w3gdatmd::fstotalexp</a></div><div class="ttdeci">logical, pointer fstotalexp</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01405">w3gdatmd.F90:1405</a></div></div>
<div class="ttc" id="anamespacew3igcmmd_html"><div class="ttname"><a href="namespacew3igcmmd.html">w3igcmmd</a></div><div class="ttdoc">Module used for coupling applications between ice model and WW3 with OASIS3-MCT.</div><div class="ttdef"><b>Definition:</b> <a href="w3igcmmd_8F90_source.html#l00015">w3igcmmd.F90:15</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a2916a56c768d1d5f4de7edd39ccf8f6f"><div class="ttname"><a href="namespacew3odatmd.html#a2916a56c768d1d5f4de7edd39ccf8f6f">w3odatmd::irqrs</a></div><div class="ttdeci">integer, dimension(:), pointer irqrs</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00524">w3odatmd.F90:524</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a440981c75b91c0e7a45f0bed69c15d24"><div class="ttname"><a href="namespacew3adatmd.html#a440981c75b91c0e7a45f0bed69c15d24">w3adatmd::fliwnd</a></div><div class="ttdeci">logical, pointer fliwnd</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00688">w3adatmd.F90:688</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_acfba70b45b1c101a4c94dc975e407254"><div class="ttname"><a href="namespacew3wdatmd.html#acfba70b45b1c101a4c94dc975e407254">w3wdatmd::timeend</a></div><div class="ttdeci">integer, dimension(:), pointer timeend</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00176">w3wdatmd.F90:176</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a24bad95c553d2db484ea23bbd94e2328"><div class="ttname"><a href="namespacew3adatmd.html#a24bad95c553d2db484ea23bbd94e2328">w3adatmd::dcydy</a></div><div class="ttdeci">real, dimension(:,:), pointer dcydy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00627">w3adatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a017ad3a882377916066bce5f03c23765"><div class="ttname"><a href="namespacew3idatmd.html#a017ad3a882377916066bce5f03c23765">w3idatmd::tdn</a></div><div class="ttdeci">integer, dimension(:), pointer tdn</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a9b7bb5578bdf960761d68a2c7f903176"><div class="ttname"><a href="namespacew3odatmd.html#a9b7bb5578bdf960761d68a2c7f903176">w3odatmd::flout</a></div><div class="ttdeci">logical, dimension(:), pointer flout</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00468">w3odatmd.F90:468</a></div></div>
<div class="ttc" id="anamespacew3iogomd_html"><div class="ttname"><a href="namespacew3iogomd.html">w3iogomd</a></div><div class="ttdoc">Gridded output of mean wave parameters.</div><div class="ttdef"><b>Definition:</b> <a href="w3iogomd_8F90_source.html#l00015">w3iogomd.F90:15</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_adcca631fb490998384d35ba60ebb8d6c"><div class="ttname"><a href="namespacew3idatmd.html#adcca631fb490998384d35ba60ebb8d6c">w3idatmd::flwind</a></div><div class="ttdeci">logical, pointer flwind</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a852d8b4384e2cfd7c84c71aa11932f39"><div class="ttname"><a href="namespacew3idatmd.html#a852d8b4384e2cfd7c84c71aa11932f39">w3idatmd::ga0</a></div><div class="ttdeci">real, pointer ga0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00242">w3idatmd.F90:242</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_a3b050f1196ad182ba44915b0c7bfb22f"><div class="ttname"><a href="namespacew3servmd.html#a3b050f1196ad182ba44915b0c7bfb22f">w3servmd::strace</a></div><div class="ttdeci">subroutine strace(IENT, SNAME)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00148">w3servmd.F90:148</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_aa45cc09f73e0f9570153921446de4802"><div class="ttname"><a href="namespacew3wdatmd.html#aa45cc09f73e0f9570153921446de4802">w3wdatmd::icedmax</a></div><div class="ttdeci">real, dimension(:), pointer icedmax</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3oacpmd_html_a03021aaaa8a0151addefd94d3bbd0602"><div class="ttname"><a href="namespacew3oacpmd.html#a03021aaaa8a0151addefd94d3bbd0602">w3oacpmd::id_oasis_time</a></div><div class="ttdeci">integer, public id_oasis_time</div><div class="ttdef"><b>Definition:</b> <a href="w3oacpmd_8F90_source.html#l00078">w3oacpmd.F90:78</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a77210c5b64d791072462f4d3948210aa"><div class="ttname"><a href="namespacew3gdatmd.html#a77210c5b64d791072462f4d3948210aa">w3gdatmd::gtype</a></div><div class="ttdeci">integer, pointer gtype</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01094">w3gdatmd.F90:1094</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html"><div class="ttname"><a href="namespacew3idatmd.html">w3idatmd</a></div><div class="ttdoc">Define data structures to set up wave model input data for several models simultaneously.</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00016">w3idatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a7b9857d79942df1b8ca7ae64675e4355"><div class="ttname"><a href="namespacew3odatmd.html#a7b9857d79942df1b8ca7ae64675e4355">w3odatmd::ndso</a></div><div class="ttdeci">integer, pointer ndso</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a2c813f9962425c9a3b22aa9e1bdc8c23"><div class="ttname"><a href="namespacew3wdatmd.html#a2c813f9962425c9a3b22aa9e1bdc8c23">w3wdatmd::ice</a></div><div class="ttdeci">real, dimension(:), pointer ice</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_ade6e16e82c7a1c78df101d9cbc494e5c"><div class="ttname"><a href="namespacew3updtmd.html#ade6e16e82c7a1c78df101d9cbc494e5c">w3updtmd::w3utau</a></div><div class="ttdeci">subroutine w3utau(FLFRST)</div><div class="ttdoc">Interpolate atmosphere momentum fields to the given time.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l00829">w3updtmd.F90:829</a></div></div>
<div class="ttc" id="anamespacew3sis2md_html"><div class="ttname"><a href="namespacew3sis2md.html">w3sis2md</a></div><div class="ttdoc">Floe-size dependant scattering of waves in the marginal ice zone.</div><div class="ttdef"><b>Definition:</b> <a href="w3sis2md_8F90_source.html#l00033">w3sis2md.F90:33</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a16d621a05fe4a29f27135ab1d1709205"><div class="ttname"><a href="namespacew3gdatmd.html#a16d621a05fe4a29f27135ab1d1709205">w3gdatmd::flcy</a></div><div class="ttdeci">logical, pointer flcy</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a4d5c09dd83ee23836341131df8bef0cd"><div class="ttname"><a href="namespacew3adatmd.html#a4d5c09dd83ee23836341131df8bef0cd">w3adatmd::whitecap</a></div><div class="ttdeci">real, dimension(:,:), pointer whitecap</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00603">w3adatmd.F90:603</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a86e40dfd9101dbbdf8d8e95d8bfe4e3a"><div class="ttname"><a href="namespacew3odatmd.html#a86e40dfd9101dbbdf8d8e95d8bfe4e3a">w3odatmd::nappnt</a></div><div class="ttdeci">integer, pointer nappnt</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ac465fc564dba68a335292494392cc7f9"><div class="ttname"><a href="namespacew3odatmd.html#ac465fc564dba68a335292494392cc7f9">w3odatmd::napout</a></div><div class="ttdeci">integer, pointer napout</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacepdlib__field__vec_html"><div class="ttname"><a href="namespacepdlib__field__vec.html">pdlib_field_vec</a></div><div class="ttdef"><b>Definition:</b> <a href="pdlib__field__vec_8F90_source.html#l00001">pdlib_field_vec.F90:1</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a6a53b6f153d86cd9ab7b382128a0a2bf"><div class="ttname"><a href="namespacew3gdatmd.html#a6a53b6f153d86cd9ab7b382128a0a2bf">w3gdatmd::fldry</a></div><div class="ttdeci">logical, pointer fldry</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3uostmd_html_a7f150bdd9996668dc90556523a8a0e18"><div class="ttname"><a href="namespacew3uostmd.html#a7f150bdd9996668dc90556523a8a0e18">w3uostmd::uost_setgrid</a></div><div class="ttdeci">subroutine, public uost_setgrid(IGRID)</div><div class="ttdoc">Sets the current grid in the sourceterm object.</div><div class="ttdef"><b>Definition:</b> <a href="w3uostmd_8F90_source.html#l00232">w3uostmd.F90:232</a></div></div>
<div class="ttc" id="anamespacew3pro1md_html_a7e9cd1ea9310363dffaffc0d1f4edec5"><div class="ttname"><a href="namespacew3pro1md.html#a7e9cd1ea9310363dffaffc0d1f4edec5">w3pro1md::w3xyp1</a></div><div class="ttdeci">subroutine w3xyp1(ISP, DTG, MAPSTA, FIELD, VGX, VGY)</div><div class="ttdoc">Propagation in physical space for a given spectral component.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro1md_8F90_source.html#l00303">w3pro1md.F90:303</a></div></div>
<div class="ttc" id="anamespacew3pro3md_html_a3ddb9e958aa30a451ec26e940263ad6b"><div class="ttname"><a href="namespacew3pro3md.html#a3ddb9e958aa30a451ec26e940263ad6b">w3pro3md::w3map3</a></div><div class="ttdeci">subroutine w3map3</div><div class="ttdoc">Generate 'map' arrays for the ULTIMATE QUICKEST scheme.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro3md_8F90_source.html#l00140">w3pro3md.F90:140</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a43c4fb87c0217c6c64fddbe622918fa4"><div class="ttname"><a href="namespacew3idatmd.html#a43c4fb87c0217c6c64fddbe622918fa4">w3idatmd::tc0</a></div><div class="ttdeci">integer, dimension(:), pointer tc0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3ogcmmd_html_a2b8b896ac770500a569caff3baba06fd"><div class="ttname"><a href="namespacew3ogcmmd.html#a2b8b896ac770500a569caff3baba06fd">w3ogcmmd::snd_fields_to_ocean</a></div><div class="ttdeci">subroutine, public snd_fields_to_ocean()</div><div class="ttdef"><b>Definition:</b> <a href="w3ogcmmd_8F90_source.html#l00063">w3ogcmmd.F90:63</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a5815a5e5db5057647c4fcb5f0e8074cc"><div class="ttname"><a href="namespacew3adatmd.html#a5815a5e5db5057647c4fcb5f0e8074cc">w3adatmd::tauox</a></div><div class="ttdeci">real, dimension(:), pointer tauox</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_af18fcfeebde40801af91008732e25cd2"><div class="ttname"><a href="namespacew3idatmd.html#af18fcfeebde40801af91008732e25cd2">w3idatmd::tw0</a></div><div class="ttdeci">integer, dimension(:), pointer tw0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_afd38249ce59819daee86c6bc40805a3d"><div class="ttname"><a href="namespacew3idatmd.html#afd38249ce59819daee86c6bc40805a3d">w3idatmd::tin</a></div><div class="ttdeci">integer, dimension(:), pointer tin</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html"><div class="ttname"><a href="namespacew3psmcmd.html">w3psmcmd</a></div><div class="ttdoc">Spherical Multiple-Cell (SMC) grid routines.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l00018">w3psmcmd.F90:18</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_aa1616dd0386dc34441d8f6e2b7bce030"><div class="ttname"><a href="namespacew3odatmd.html#aa1616dd0386dc34441d8f6e2b7bce030">w3odatmd::napfld</a></div><div class="ttdeci">integer, pointer napfld</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a26759ceeed28f07100b31cab17d5c7ea"><div class="ttname"><a href="namespacew3gdatmd.html#a26759ceeed28f07100b31cab17d5c7ea">w3gdatmd::hpfac</a></div><div class="ttdeci">real, dimension(:,:), pointer hpfac</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01211">w3gdatmd.F90:1211</a></div></div>
<div class="ttc" id="anamespacew3parall_html_a22d21e5ec9142a2ac7039576de612e84"><div class="ttname"><a href="namespacew3parall.html#a22d21e5ec9142a2ac7039576de612e84">w3parall::init_get_jsea_isproc</a></div><div class="ttdeci">subroutine init_get_jsea_isproc(ISEA, JSEA, ISPROC)</div><div class="ttdoc">Set JSEA for all schemes.</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l01163">w3parall.F90:1163</a></div></div>
<div class="ttc" id="anamespacew3oacpmd_html_a18ef249660ccfaae10f579b697932a0c"><div class="ttname"><a href="namespacew3oacpmd.html#a18ef249660ccfaae10f579b697932a0c">w3oacpmd::cplt0</a></div><div class="ttdeci">logical, public cplt0</div><div class="ttdef"><b>Definition:</b> <a href="w3oacpmd_8F90_source.html#l00080">w3oacpmd.F90:80</a></div></div>
<div class="ttc" id="anamespacew3pro2md_html_a74e542a8d41f921542394a284bf08ed5"><div class="ttname"><a href="namespacew3pro2md.html#a74e542a8d41f921542394a284bf08ed5">w3pro2md::w3xyp2</a></div><div class="ttdeci">subroutine w3xyp2(ISP, DTG, MAPSTA, MAPFS, VQ, VGX, VGY)</div><div class="ttdoc">Propagation in physical space for a given spectral component.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro2md_8F90_source.html#l00509">w3pro2md.F90:509</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_afd7fc170cf4a118a6a4996a349906a41"><div class="ttname"><a href="namespacew3wdatmd.html#afd7fc170cf4a118a6a4996a349906a41">w3wdatmd::time00</a></div><div class="ttdeci">integer, dimension(:), pointer time00</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00175">w3wdatmd.F90:175</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_addf9a452930d73b382eea45436929034"><div class="ttname"><a href="namespacew3gdatmd.html#addf9a452930d73b382eea45436929034">w3gdatmd::iobp</a></div><div class="ttdeci">integer *2, dimension(:), pointer iobp</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01129">w3gdatmd.F90:1129</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a9f115000f1f94bd033b010971ab19b23"><div class="ttname"><a href="namespacew3odatmd.html#a9f115000f1f94bd033b010971ab19b23">w3odatmd::tofrst</a></div><div class="ttdeci">integer, dimension(:), pointer tofrst</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00464">w3odatmd.F90:464</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a9dc8a62b7e0ae88d2d53ac0ed3e1d6cc"><div class="ttname"><a href="namespacew3idatmd.html#a9dc8a62b7e0ae88d2d53ac0ed3e1d6cc">w3idatmd::fltaua</a></div><div class="ttdeci">logical, pointer fltaua</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ace4b7064f5b270ac5564b3484566042d"><div class="ttname"><a href="namespacew3gdatmd.html#ace4b7064f5b270ac5564b3484566042d">w3gdatmd::sx</a></div><div class="ttdeci">real, pointer sx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_abe07088ac5bfde0d0d6ea1d0860667c4"><div class="ttname"><a href="namespacew3odatmd.html#abe07088ac5bfde0d0d6ea1d0860667c4">w3odatmd::ndst</a></div><div class="ttdeci">integer, pointer ndst</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00456">w3odatmd.F90:456</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a5268804018b2fd994091fb7af42f61e6"><div class="ttname"><a href="namespacew3wdatmd.html#a5268804018b2fd994091fb7af42f61e6">w3wdatmd::ust</a></div><div class="ttdeci">real, dimension(:), pointer ust</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adc964175192aa2fdcbe615e5892effdd"><div class="ttname"><a href="namespacew3gdatmd.html#adc964175192aa2fdcbe615e5892effdd">w3gdatmd::flcx</a></div><div class="ttdeci">logical, pointer flcx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01217">w3gdatmd.F90:1217</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a3783f725d94c2d2e4fc946f2677f4939"><div class="ttname"><a href="namespacew3adatmd.html#a3783f725d94c2d2e4fc946f2677f4939">w3adatmd::mpi_comm_wave</a></div><div class="ttdeci">integer, pointer mpi_comm_wave</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a828be63ff34b0a8047fff5fa45e5bb03"><div class="ttname"><a href="namespaceconstants.html#a828be63ff34b0a8047fff5fa45e5bb03">constants::debug_node</a></div><div class="ttdeci">integer, parameter debug_node</div><div class="ttdoc">DEBUG_NODE Node number used for debugging.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00099">constants.F90:99</a></div></div>
<div class="ttc" id="anamespaceconstants_html"><div class="ttname"><a href="namespaceconstants.html">constants</a></div><div class="ttdoc">Define some much-used constants for global use (all defined as PARAMETER).</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00020">constants.F90:20</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a919d21c98d221807f8b0e1396df10f68"><div class="ttname"><a href="namespacew3adatmd.html#a919d21c98d221807f8b0e1396df10f68">w3adatmd::tauoy</a></div><div class="ttdeci">real, dimension(:), pointer tauoy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="anamespacew3profsmd_html_a3e21a85c8c5b52f908b6334c1db8803d"><div class="ttname"><a href="namespacew3profsmd.html#a3e21a85c8c5b52f908b6334c1db8803d">w3profsmd::w3cflug</a></div><div class="ttdeci">subroutine w3cflug(ISEA, NKCFL, FACX, FACY, DT, MAPFS, CFLXYMAX, VGX, VGY)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd_8F90_source.html#l00272">w3profsmd.F90:272</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ac9bc6df416055b178710b9c7b880346e"><div class="ttname"><a href="namespacew3gdatmd.html#ac9bc6df416055b178710b9c7b880346e">w3gdatmd::ic3pars</a></div><div class="ttdeci">real, dimension(:), pointer ic3pars</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01148">w3gdatmd.F90:1148</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html"><div class="ttname"><a href="namespacew3gdatmd.html">w3gdatmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l00016">w3gdatmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a882a07450a1ea1b297ef4a428c64cc56"><div class="ttname"><a href="namespacew3adatmd.html#a882a07450a1ea1b297ef4a428c64cc56">w3adatmd::flcold</a></div><div class="ttdeci">logical, pointer flcold</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00688">w3adatmd.F90:688</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ad2c7a25bbd93d62ee0b514eb46c2101d"><div class="ttname"><a href="namespacew3idatmd.html#ad2c7a25bbd93d62ee0b514eb46c2101d">w3idatmd::flrhoa</a></div><div class="ttdeci">logical, pointer flrhoa</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_a962fc82166d5a68baa41d3c3dc9fffa6"><div class="ttname"><a href="namespacew3psmcmd.html#a962fc82166d5a68baa41d3c3dc9fffa6">w3psmcmd::w3gathsmc</a></div><div class="ttdeci">subroutine w3gathsmc(ISPEC, FIELD)</div><div class="ttdoc">SMC version of W3GATH.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l03185">w3psmcmd.F90:3185</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_ab4d74556ffdcf29caff951827fe6f2ea"><div class="ttname"><a href="namespacew3adatmd.html#ab4d74556ffdcf29caff951827fe6f2ea">w3adatmd::dcxdy</a></div><div class="ttdeci">real, dimension(:,:), pointer dcxdy</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00627">w3adatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_aab92af4a45337d957b401970e2a9e492"><div class="ttname"><a href="namespacew3updtmd.html#aab92af4a45337d957b401970e2a9e492">w3updtmd::w3uic1</a></div><div class="ttdeci">subroutine w3uic1(FLFRST)</div><div class="ttdoc">Update ice thickness in the wave model.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l01513">w3updtmd.F90:1513</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a608ecea2ecff3c7334783046328a518c"><div class="ttname"><a href="namespacew3gdatmd.html#a608ecea2ecff3c7334783046328a518c">w3gdatmd::arctc</a></div><div class="ttdeci">logical, pointer arctc</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01264">w3gdatmd.F90:1264</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a816cd10227f361872854d2e9d5897189"><div class="ttname"><a href="namespacew3adatmd.html#a816cd10227f361872854d2e9d5897189">w3adatmd::tauadir</a></div><div class="ttdeci">real, dimension(:), pointer tauadir</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3servmd_html_af5f50eeba6151acaef53bd9fbd767871"><div class="ttname"><a href="namespacew3servmd.html#af5f50eeba6151acaef53bd9fbd767871">w3servmd::extcde</a></div><div class="ttdeci">subroutine extcde(IEXIT, UNIT, MSG, FILE, LINE, COMM)</div><div class="ttdef"><b>Definition:</b> <a href="w3servmd_8F90_source.html#l00736">w3servmd.F90:736</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_ab719f4a306a71097e22857589eb59622"><div class="ttname"><a href="namespacew3gdatmd.html#ab719f4a306a71097e22857589eb59622">w3gdatmd::dtcfli</a></div><div class="ttdeci">real, pointer dtcfli</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a61432ab148519f8cbc734fda4b0a5038"><div class="ttname"><a href="namespacew3adatmd.html#a61432ab148519f8cbc734fda4b0a5038">w3adatmd::ibfloc</a></div><div class="ttdeci">integer, pointer ibfloc</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_aa626e09614f191b606dbd343a57d5ab4"><div class="ttname"><a href="namespacew3wdatmd.html#aa626e09614f191b606dbd343a57d5ab4">w3wdatmd::rhoair</a></div><div class="ttdeci">real, dimension(:), pointer rhoair</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_abe0038cb9642cb1acb6242fbe1a31c36"><div class="ttname"><a href="namespacew3adatmd.html#abe0038cb9642cb1acb6242fbe1a31c36">w3adatmd::bstat</a></div><div class="ttdeci">integer, dimension(:), pointer bstat</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00680">w3adatmd.F90:680</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a9861e40146c42386bd4fe4390a7eb28d"><div class="ttname"><a href="namespacew3idatmd.html#a9861e40146c42386bd4fe4390a7eb28d">w3idatmd::flice</a></div><div class="ttdeci">logical, pointer flice</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00261">w3idatmd.F90:261</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a224a30ca5b2053f75fe90155d20fda7a"><div class="ttname"><a href="namespacew3adatmd.html#a224a30ca5b2053f75fe90155d20fda7a">w3adatmd::nrqsg1</a></div><div class="ttdeci">integer, pointer nrqsg1</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_adcca98a47abf7a6cc59226f0daf4ddbe"><div class="ttname"><a href="namespacew3gdatmd.html#adcca98a47abf7a6cc59226f0daf4ddbe">w3gdatmd::ncel</a></div><div class="ttdeci">integer, pointer ncel</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01167">w3gdatmd.F90:1167</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_ad9ea52f8b5bc1a26a34e0e30cc9f3b80"><div class="ttname"><a href="namespacew3wdatmd.html#ad9ea52f8b5bc1a26a34e0e30cc9f3b80">w3wdatmd::ustdir</a></div><div class="ttdeci">real, dimension(:), pointer ustdir</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3iogomd_html_a29d80cc57aa6c280d775fbea9750990c"><div class="ttname"><a href="namespacew3iogomd.html#a29d80cc57aa6c280d775fbea9750990c">w3iogomd::w3outg</a></div><div class="ttdeci">subroutine w3outg(A, FLPART, FLOUTG, FLOUTG2)</div><div class="ttdoc">Fill necessary arrays with gridded data for output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iogomd_8F90_source.html#l01198">w3iogomd.F90:1198</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_abd8542257a7c3f085db7e50a9a8c6b9f"><div class="ttname"><a href="namespacew3adatmd.html#abd8542257a7c3f085db7e50a9a8c6b9f">w3adatmd::itime</a></div><div class="ttdeci">integer, pointer itime</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00686">w3adatmd.F90:686</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_af299d7224d0fb5c176bb51badbe642fb"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#af299d7224d0fb5c176bb51badbe642fb">pdlib_w3profsmd::all_va_integral_print</a></div><div class="ttdeci">subroutine all_va_integral_print(IMOD, string, choice)</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l02292">w3profsmd_pdlib.F90:2292</a></div></div>
<div class="ttc" id="anamespacew3iosfmd_html_a66a80d58f4389d946c7db600edd8b536"><div class="ttname"><a href="namespacew3iosfmd.html#a66a80d58f4389d946c7db600edd8b536">w3iosfmd::w3iosf</a></div><div class="ttdeci">subroutine w3iosf(NDSPT, IMOD)</div><div class="ttdoc">Write partitioned spectral data to file.</div><div class="ttdef"><b>Definition:</b> <a href="w3iosfmd_8F90_source.html#l00361">w3iosfmd.F90:361</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_aacb8d17fa474df8ab94305f4177fbca8"><div class="ttname"><a href="namespacew3adatmd.html#aacb8d17fa474df8ab94305f4177fbca8">w3adatmd::dddx</a></div><div class="ttdeci">real, dimension(:,:), pointer dddx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00627">w3adatmd.F90:627</a></div></div>
<div class="ttc" id="anamespacew3sic3md_html_a72ddfeb0539730005d8af242bd2fb79d"><div class="ttname"><a href="namespacew3sic3md.html#a72ddfeb0539730005d8af242bd2fb79d">w3sic3md::w3ic3wncg_v1</a></div><div class="ttdeci">subroutine, public w3ic3wncg_v1(WN_R, WN_I, CG, ICE1, ICE2, ICE3, ICE4, DPT)</div><div class="ttdef"><b>Definition:</b> <a href="w3sic3md_8F90_source.html#l00658">w3sic3md.F90:658</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a0897257770e3ac747c45f0e92288b33f"><div class="ttname"><a href="namespacew3adatmd.html#a0897257770e3ac747c45f0e92288b33f">w3adatmd::irqsg2</a></div><div class="ttdeci">integer, dimension(:,:), pointer irqsg2</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00681">w3adatmd.F90:681</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a1c9f38c7339e6c45e9251d3bc47a57e7"><div class="ttname"><a href="namespacew3idatmd.html#a1c9f38c7339e6c45e9251d3bc47a57e7">w3idatmd::tln</a></div><div class="ttdeci">integer, dimension(:), pointer tln</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a9daf84dcc555c7f642334663a5c9f678"><div class="ttname"><a href="namespacew3adatmd.html#a9daf84dcc555c7f642334663a5c9f678">w3adatmd::isploc</a></div><div class="ttdeci">integer, pointer isploc</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00676">w3adatmd.F90:676</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a09857a3a83837ff0e5e260c209f43dfa"><div class="ttname"><a href="namespacew3adatmd.html#a09857a3a83837ff0e5e260c209f43dfa">w3adatmd::cx</a></div><div class="ttdeci">real, dimension(:), pointer cx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00584">w3adatmd.F90:584</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a0e0a999259afdc6d3e50cc46bb1d2d1d"><div class="ttname"><a href="namespacew3gdatmd.html#a0e0a999259afdc6d3e50cc46bb1d2d1d">w3gdatmd::nx</a></div><div class="ttdeci">integer, pointer nx</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01097">w3gdatmd.F90:1097</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a6c84e7ce56ee8dd1e66047efb58ae545"><div class="ttname"><a href="namespacew3wdatmd.html#a6c84e7ce56ee8dd1e66047efb58ae545">w3wdatmd::tic5</a></div><div class="ttdeci">integer, dimension(:), pointer tic5</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a0e18f271cd635642ad54f48a73401d60"><div class="ttname"><a href="namespacew3idatmd.html#a0e18f271cd635642ad54f48a73401d60">w3idatmd::trn</a></div><div class="ttdeci">integer, dimension(:), pointer trn</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_ab48ebaa11df3f33e2c8183fba42deb35"><div class="ttname"><a href="namespacew3psmcmd.html#ab48ebaa11df3f33e2c8183fba42deb35">w3psmcmd::w3psmc</a></div><div class="ttdeci">subroutine w3psmc(ISP, DTG, VQ)</div><div class="ttdoc">Propagation in phyiscal space for a given spectral component.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l00137">w3psmcmd.F90:137</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_afe733a06094e01f0c34208268374d03e"><div class="ttname"><a href="namespacew3gdatmd.html#afe733a06094e01f0c34208268374d03e">w3gdatmd::fsfreqshift</a></div><div class="ttdeci">logical, pointer fsfreqshift</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01406">w3gdatmd.F90:1406</a></div></div>
<div class="ttc" id="anamespacew3timemd_html"><div class="ttname"><a href="namespacew3timemd.html">w3timemd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3timemd_8F90_source.html#l00003">w3timemd.F90:3</a></div></div>
<div class="ttc" id="anamespaceconstants_html_a68363e10dc3879aff798962c524a73d0"><div class="ttname"><a href="namespaceconstants.html#a68363e10dc3879aff798962c524a73d0">constants::undef</a></div><div class="ttdeci">real undef</div><div class="ttdoc">UNDEF Value for undefined variable in output.</div><div class="ttdef"><b>Definition:</b> <a href="constants_8F90_source.html#l00084">constants.F90:84</a></div></div>
<div class="ttc" id="anamespacew3tidemd_html_a508706110696e22b54c774b1a9a51346"><div class="ttname"><a href="namespacew3tidemd.html#a508706110696e22b54c774b1a9a51346">w3tidemd::fac</a></div><div class="ttdeci">double precision, parameter fac</div><div class="ttdef"><b>Definition:</b> <a href="w3tidemd_8F90_source.html#l00087">w3tidemd.F90:87</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ada0275bb802f8670c02b8ac42ce4db54"><div class="ttname"><a href="namespacew3odatmd.html#ada0275bb802f8670c02b8ac42ce4db54">w3odatmd::nrqbp</a></div><div class="ttdeci">integer, pointer nrqbp</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00533">w3odatmd.F90:533</a></div></div>
<div class="ttc" id="anamespacew3parall_html"><div class="ttname"><a href="namespacew3parall.html">w3parall</a></div><div class="ttdoc">Parallel routines for implicit solver.</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l00022">w3parall.F90:22</a></div></div>
<div class="ttc" id="anamespacew3iopomd_html_a3fafdfab8e46b11a34dd7041f06d17f6"><div class="ttname"><a href="namespacew3iopomd.html#a3fafdfab8e46b11a34dd7041f06d17f6">w3iopomd::w3iopo</a></div><div class="ttdeci">subroutine w3iopo(INXOUT, NDSOP, IOTST, IMOD ifdef W3_ASCII</div><div class="ttdoc">Read or write point output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iopomd_8F90_source.html#l01907">w3iopomd.F90:1907</a></div></div>
<div class="ttc" id="anamespacew3iotrmd_html"><div class="ttname"><a href="namespacew3iotrmd.html">w3iotrmd</a></div><div class="ttdoc">Generate track output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iotrmd_8F90_source.html#l00014">w3iotrmd.F90:14</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_aa1e901d192ea0797931744db67caef59"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#aa1e901d192ea0797931744db67caef59">pdlib_w3profsmd::b_jac</a></div><div class="ttdeci">real, dimension(:,:), allocatable b_jac</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l00114">w3profsmd_pdlib.F90:114</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_af5127f71e5c9013e127b2eaccbca5ccd"><div class="ttname"><a href="namespacew3odatmd.html#af5127f71e5c9013e127b2eaccbca5ccd">w3odatmd::irqgo</a></div><div class="ttdeci">integer, dimension(:), pointer irqgo</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00476">w3odatmd.F90:476</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_a87f108b0b6396d24df1c3dbe7c3da731"><div class="ttname"><a href="namespacew3odatmd.html#a87f108b0b6396d24df1c3dbe7c3da731">w3odatmd::nrqgo</a></div><div class="ttdeci">integer, pointer nrqgo</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00475">w3odatmd.F90:475</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a5e8c7eaf07d6ec026aac523e229d53b2"><div class="ttname"><a href="namespacew3gdatmd.html#a5e8c7eaf07d6ec026aac523e229d53b2">w3gdatmd::fstotalimp</a></div><div class="ttdeci">logical, pointer fstotalimp</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01405">w3gdatmd.F90:1405</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ac4c78c77cd36d3b05d4d79f236c70f34"><div class="ttname"><a href="namespacew3idatmd.html#ac4c78c77cd36d3b05d4d79f236c70f34">w3idatmd::tun</a></div><div class="ttdeci">integer, dimension(:), pointer tun</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3odatmd_html_ab9a776e44f5dc414c7372c90f535bfd0"><div class="ttname"><a href="namespacew3odatmd.html#ab9a776e44f5dc414c7372c90f535bfd0">w3odatmd::naprst</a></div><div class="ttdeci">integer, pointer naprst</div><div class="ttdef"><b>Definition:</b> <a href="w3odatmd_8F90_source.html#l00457">w3odatmd.F90:457</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a0e7b428c965dabf38ea4bf8cbc07a0ec"><div class="ttname"><a href="namespacew3idatmd.html#a0e7b428c965dabf38ea4bf8cbc07a0ec">w3idatmd::tr0</a></div><div class="ttdeci">integer, dimension(:), pointer tr0</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3pro3md_html_a1e6b4cae3e0bf68fd6857e52ae3210c0"><div class="ttname"><a href="namespacew3pro3md.html#a1e6b4cae3e0bf68fd6857e52ae3210c0">w3pro3md::w3mapt</a></div><div class="ttdeci">subroutine w3mapt</div><div class="ttdoc">Generate 'map' arrays for the ULTIMATE QUICKEST scheme to combine GSE alleviation with obstructions.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro3md_8F90_source.html#l00525">w3pro3md.F90:525</a></div></div>
<div class="ttc" id="anamespacew3iopomd_html_a9bbc253bffd32ee330cad4928783178e"><div class="ttname"><a href="namespacew3iopomd.html#a9bbc253bffd32ee330cad4928783178e">w3iopomd::w3iope</a></div><div class="ttdeci">subroutine w3iope(A)</div><div class="ttdoc">Extract point output data and store in output COMMONs.</div><div class="ttdef"><b>Definition:</b> <a href="w3iopomd_8F90_source.html#l00697">w3iopomd.F90:697</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_a50937661d782c54631373514d6561f71"><div class="ttname"><a href="namespacew3updtmd.html#a50937661d782c54631373514d6561f71">w3updtmd::w3utrn</a></div><div class="ttdeci">subroutine w3utrn(TRNX, TRNY)</div><div class="ttdoc">Update cell boundary transparencies for general use in propagation routines.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l02736">w3updtmd.F90:2736</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aa1dedf011701000d3c8a2b58fa819e65"><div class="ttname"><a href="namespacew3gdatmd.html#aa1dedf011701000d3c8a2b58fa819e65">w3gdatmd::mapsta</a></div><div class="ttdeci">integer, dimension(:,:), pointer mapsta</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01163">w3gdatmd.F90:1163</a></div></div>
<div class="ttc" id="anamespacew3updtmd_html_afea7dd47fb438fe49c36c45802a59ec3"><div class="ttname"><a href="namespacew3updtmd.html#afea7dd47fb438fe49c36c45802a59ec3">w3updtmd::w3uwnd</a></div><div class="ttdeci">subroutine w3uwnd(FLFRST, VGX, VGY)</div><div class="ttdoc">Interpolate wind fields to the given time.</div><div class="ttdef"><b>Definition:</b> <a href="w3updtmd_8F90_source.html#l00489">w3updtmd.F90:489</a></div></div>
<div class="ttc" id="anamespacew3pro2md_html_aaa7a36f453793970b41eabd01a22efd8"><div class="ttname"><a href="namespacew3pro2md.html#aaa7a36f453793970b41eabd01a22efd8">w3pro2md::w3map2</a></div><div class="ttdeci">subroutine w3map2</div><div class="ttdoc">Generate 'map' arrays for the ULTIMATE QUICKEST scheme.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro2md_8F90_source.html#l00136">w3pro2md.F90:136</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_adfa3c3e4ffbc58db1d4f4d86877eb8cf"><div class="ttname"><a href="namespacew3wdatmd.html#adfa3c3e4ffbc58db1d4f4d86877eb8cf">w3wdatmd::vaold</a></div><div class="ttdeci">real, dimension(:,:), pointer vaold</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00192">w3wdatmd.F90:192</a></div></div>
<div class="ttc" id="anamespacew3iorsmd_html"><div class="ttname"><a href="namespacew3iorsmd.html">w3iorsmd</a></div><div class="ttdoc">Read/write restart files.</div><div class="ttdef"><b>Definition:</b> <a href="w3iorsmd_8F90_source.html#l00014">w3iorsmd.F90:14</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a270079df5d11fa510b5a2db8d511e143"><div class="ttname"><a href="namespacew3wdatmd.html#a270079df5d11fa510b5a2db8d511e143">w3wdatmd::tice</a></div><div class="ttdeci">integer, dimension(:), pointer tice</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00172">w3wdatmd.F90:172</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_acd3e7ae02814c69fc9324dc915858654"><div class="ttname"><a href="namespacew3gdatmd.html#acd3e7ae02814c69fc9324dc915858654">w3gdatmd::trny</a></div><div class="ttdeci">real, dimension(:,:), pointer trny</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01200">w3gdatmd.F90:1200</a></div></div>
<div class="ttc" id="anamespacew3iosfmd_html"><div class="ttname"><a href="namespacew3iosfmd.html">w3iosfmd</a></div><div class="ttdoc">I/O and computational routines for the wave-field separation output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iosfmd_8F90_source.html#l00016">w3iosfmd.F90:16</a></div></div>
<div class="ttc" id="anamespacew3iopomd_html"><div class="ttname"><a href="namespacew3iopomd.html">w3iopomd</a></div><div class="ttdoc">Process point output.</div><div class="ttdef"><b>Definition:</b> <a href="w3iopomd_8F90_source.html#l00019">w3iopomd.F90:19</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_a1d57a74d37bd727e82acb579ec010a68"><div class="ttname"><a href="namespacew3adatmd.html#a1d57a74d37bd727e82acb579ec010a68">w3adatmd::tauocx</a></div><div class="ttdeci">real, dimension(:), pointer tauocx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00607">w3adatmd.F90:607</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_aa48e147109f92b138611d3b62674d738"><div class="ttname"><a href="namespacew3idatmd.html#aa48e147109f92b138611d3b62674d738">w3idatmd::tgn</a></div><div class="ttdeci">integer, dimension(:), pointer tgn</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html"><div class="ttname"><a href="namespacepdlib__w3profsmd.html">pdlib_w3profsmd</a></div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l00004">w3profsmd_pdlib.F90:4</a></div></div>
<div class="ttc" id="anamespacepdlib__w3profsmd_html_a2f448c554d696e07d0c44b62c5ca4fac"><div class="ttname"><a href="namespacepdlib__w3profsmd.html#a2f448c554d696e07d0c44b62c5ca4fac">pdlib_w3profsmd::apply_boundary_condition_va</a></div><div class="ttdeci">subroutine apply_boundary_condition_va</div><div class="ttdef"><b>Definition:</b> <a href="w3profsmd__pdlib_8F90_source.html#l05026">w3profsmd_pdlib.F90:5026</a></div></div>
<div class="ttc" id="anamespacew3parall_html_aa67a4fafe08f0720282ad106b7ba3763"><div class="ttname"><a href="namespacew3parall.html#aa67a4fafe08f0720282ad106b7ba3763">w3parall::init_get_isea</a></div><div class="ttdeci">subroutine init_get_isea(ISEA, JSEA)</div><div class="ttdoc">Set ISEA for all schemes.</div><div class="ttdef"><b>Definition:</b> <a href="w3parall_8F90_source.html#l01398">w3parall.F90:1398</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_ad70d5c6e1f261d24716765d7bfebf366"><div class="ttname"><a href="namespacew3idatmd.html#ad70d5c6e1f261d24716765d7bfebf366">w3idatmd::tcn</a></div><div class="ttdeci">integer, dimension(:), pointer tcn</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00236">w3idatmd.F90:236</a></div></div>
<div class="ttc" id="anamespacew3adatmd_html_aa6f29a64e772be7fbf59f3061d4e6978"><div class="ttname"><a href="namespacew3adatmd.html#aa6f29a64e772be7fbf59f3061d4e6978">w3adatmd::dhdx</a></div><div class="ttdeci">real, dimension(:), pointer dhdx</div><div class="ttdef"><b>Definition:</b> <a href="w3adatmd_8F90_source.html#l00631">w3adatmd.F90:631</a></div></div>
<div class="ttc" id="anamespacew3idatmd_html_a85cf2903005c250a233a16c987eb2cc5"><div class="ttname"><a href="namespacew3idatmd.html#a85cf2903005c250a233a16c987eb2cc5">w3idatmd::flic1</a></div><div class="ttdeci">logical, pointer flic1</div><div class="ttdef"><b>Definition:</b> <a href="w3idatmd_8F90_source.html#l00264">w3idatmd.F90:264</a></div></div>
<div class="ttc" id="anamespacew3sic3md_html"><div class="ttname"><a href="namespacew3sic3md.html">w3sic3md</a></div><div class="ttdef"><b>Definition:</b> <a href="w3sic3md_8F90_source.html#l00003">w3sic3md.F90:3</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_acdac9c3652423c237a8122e91e7a0e4a"><div class="ttname"><a href="namespacew3psmcmd.html#acdac9c3652423c237a8122e91e7a0e4a">w3psmcmd::w3krtn</a></div><div class="ttdeci">subroutine w3krtn(ISEA, FACTH, FACK, CTHG0, CG, WN, DEPTH, DDDX, DDDY, ALFLMT, CX, CY, DCXDX, DCXDY, DCYDX, DCYDY, DCDX, DCDY, VA)</div><div class="ttdoc">Refraction and great-circle turning by spectral rotation.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l00969">w3psmcmd.F90:969</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_a9524bdcdd2307c71564f9df2df040a6b"><div class="ttname"><a href="namespacew3gdatmd.html#a9524bdcdd2307c71564f9df2df040a6b">w3gdatmd::dtmax</a></div><div class="ttdeci">real, pointer dtmax</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01183">w3gdatmd.F90:1183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_aacc0010db11c3f9311b00a816a0e20c2"><div class="ttname"><a href="namespacew3gdatmd.html#aacc0010db11c3f9311b00a816a0e20c2">w3gdatmd::flagll</a></div><div class="ttdeci">logical, pointer flagll</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01219">w3gdatmd.F90:1219</a></div></div>
<div class="ttc" id="anamespacew3pro1md_html_ae08c00a2c7907d23998e413b9eb6167c"><div class="ttname"><a href="namespacew3pro1md.html#ae08c00a2c7907d23998e413b9eb6167c">w3pro1md::w3ktp1</a></div><div class="ttdeci">subroutine w3ktp1(ISEA, FACTH, FACK, CTHG0, CG, WN, DEPTH, DDDX, DDDY, CX, CY, DCXDX, DCXDY, DCYDX, DCYDY, DCDX, DCDY, VA)</div><div class="ttdoc">Propagation in spectral space.</div><div class="ttdef"><b>Definition:</b> <a href="w3pro1md_8F90_source.html#l00900">w3pro1md.F90:900</a></div></div>
<div class="ttc" id="anamespacew3wdatmd_html_a040679b85e93b0f3960bbc31fcd6bd37"><div class="ttname"><a href="namespacew3wdatmd.html#a040679b85e93b0f3960bbc31fcd6bd37">w3wdatmd::asf</a></div><div class="ttdeci">real, dimension(:), pointer asf</div><div class="ttdef"><b>Definition:</b> <a href="w3wdatmd_8F90_source.html#l00183">w3wdatmd.F90:183</a></div></div>
<div class="ttc" id="anamespacew3gdatmd_html_abeb9b7e95d4bec175d3427770dd2a80f"><div class="ttname"><a href="namespacew3gdatmd.html#abeb9b7e95d4bec175d3427770dd2a80f">w3gdatmd::filext</a></div><div class="ttdeci">character(len=13), pointer filext</div><div class="ttdef"><b>Definition:</b> <a href="w3gdatmd_8F90_source.html#l01224">w3gdatmd.F90:1224</a></div></div>
<div class="ttc" id="anamespacew3psmcmd_html_a2c642900a28afbe55fa4a80cd2e298c2"><div class="ttname"><a href="namespacew3psmcmd.html#a2c642900a28afbe55fa4a80cd2e298c2">w3psmcmd::smcdcxy</a></div><div class="ttdeci">subroutine smcdcxy</div><div class="ttdoc">Calculates current velocity gradient for refraction.</div><div class="ttdef"><b>Definition:</b> <a href="w3psmcmd_8F90_source.html#l03042">w3psmcmd.F90:3042</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacew3wavemd.html">w3wavemd</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
